<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Eclipse GlassFish Add-On Component Development Guide, Release 7</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Eclipse GlassFish Add-On Component Development Guide, Release 7</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#eclipse-glassfish-server">Eclipse GlassFish</a></li>
<li><a href="#preface">Preface</a>
<ul class="sectlevel2">
<li><a href="#glassfish-server-documentation-set">Eclipse GlassFish Documentation Set</a></li>
<li><a href="#related-documentation">Related Documentation</a></li>
<li><a href="#typographic-conventions">Typographic Conventions</a></li>
<li><a href="#symbol-conventions">Symbol Conventions</a></li>
<li><a href="#default-paths-and-file-names">Default Paths and File Names</a></li>
</ul>
</li>
<li><a href="#introduction-to-the-development-environment-for-eclipse-glassfish-add-on-components">Introduction to the Development Environment for Eclipse GlassFish Add-On Components</a>
<ul class="sectlevel2">
<li><a href="#glassfish-server-modular-architecture-and-add-on-components">Eclipse GlassFish Modular Architecture and Add-On Components</a></li>
<li><a href="#osgi-alliance-module-management-subsystem">OSGi Alliance Module Management Subsystem</a></li>
<li><a href="#hundred-kilobyte-kernel">Hundred-Kilobyte Kernel</a></li>
<li><a href="#overview-of-the-development-process-for-an-add-on-component">Overview of the Development Process for an Add-On Component</a>
<ul class="sectlevel3">
<li><a href="#writing-hk2-components">Writing HK2 Components</a></li>
<li><a href="#extending-the-administration-console">Extending the Administration Console</a></li>
<li><a href="#extending-the-asadmin-utility">Extending the <code>asadmin</code> Utility</a></li>
<li><a href="#adding-monitoring-capabilities">Adding Monitoring Capabilities</a></li>
<li><a href="#adding-configuration-data-for-a-component">Adding Configuration Data for a Component</a></li>
<li><a href="#adding-container-capabilities">Adding Container Capabilities</a></li>
<li><a href="#creating-a-session-persistence-module">Creating a Session Persistence Module</a></li>
<li><a href="#packaging-and-delivering-an-add-on-component">Packaging and Delivering an Add-On Component</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#writing-hk2-components-2">Writing HK2 Components</a>
<ul class="sectlevel2">
<li><a href="#hk2-component-model">HK2 Component Model</a></li>
<li><a href="#services-in-the-hk2-component-model">Services in the HK2 Component Model</a></li>
<li><a href="#hk2-runtime">HK2 Runtime</a>
<ul class="sectlevel3">
<li><a href="#scopes-of-services">Scopes of Services</a></li>
<li><a href="#instantiation-of-components-in-hk2">Instantiation of Components in HK2</a></li>
<li><a href="#hk2-lifecycle-interfaces">HK2 Lifecycle Interfaces</a></li>
</ul>
</li>
<li><a href="#inversion-of-control">Inversion of Control</a>
<ul class="sectlevel3">
<li><a href="#injecting-hk2-components">Injecting HK2 Components</a></li>
<li><a href="#instantiation-cascading-in-hk2">Instantiation Cascading in HK2</a></li>
</ul>
</li>
<li><a href="#identifying-a-class-as-an-add-on-component">Identifying a Class as an Add-On Component</a></li>
<li><a href="#using-the-apache-maven-build-system-to-develop-hk2-components">Using the Apache Maven Build System to Develop HK2 Components</a></li>
</ul>
</li>
<li><a href="#extending-the-administration-console-2">Extending the Administration Console</a>
<ul class="sectlevel2">
<li><a href="#administration-console-architecture">Administration Console Architecture</a>
<ul class="sectlevel3">
<li><a href="#implementing-a-console-provider">Implementing a Console Provider</a></li>
</ul>
</li>
<li><a href="#about-administration-console-templates">About Administration Console Templates</a></li>
<li><a href="#about-integration-points">About Integration Points</a></li>
<li><a href="#specifying-the-id-of-an-add-on-component">Specifying the ID of an Add-On Component</a></li>
<li><a href="#adding-functionality-to-the-administration-console">Adding Functionality to the Administration Console</a>
<ul class="sectlevel3">
<li><a href="#adding-a-node-to-the-navigation-tree">Adding a Node to the Navigation Tree</a></li>
<li><a href="#adding-tabs-to-a-page">Adding Tabs to a Page</a></li>
<li><a href="#adding-a-task-to-the-common-tasks-page">Adding a Task to the Common Tasks Page</a></li>
<li><a href="#adding-a-task-group-to-the-common-tasks-page">Adding a Task Group to the Common Tasks Page</a></li>
<li><a href="#adding-content-to-a-page">Adding Content to a Page</a></li>
<li><a href="#adding-a-page-to-the-administration-console">Adding a Page to the Administration Console</a></li>
</ul>
</li>
<li><a href="#adding-internationalization-support">Adding Internationalization Support</a></li>
<li><a href="#changing-the-theme-or-brand-of-the-administration-console">Changing the Theme or Brand of the Administration Console</a></li>
<li><a href="#creating-an-integration-point-type">Creating an Integration Point Type</a>
<ul class="sectlevel3">
<li><a href="#to-create-an-integration-point-type">To Create an Integration Point Type</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#extending-the-asadmin-utility-2">Extending the <code>asadmin</code> Utility</a>
<ul class="sectlevel2">
<li><a href="#about-the-administrative-command-infrastructure-of-glassfish-server">About the Administrative Command Infrastructure of Eclipse GlassFish</a></li>
<li><a href="#adding-an-asadmin-subcommand">Adding an <code>asadmin</code> Subcommand</a>
<ul class="sectlevel3">
<li><a href="#representing-an-asadmin-subcommand-as-a-java-class">Representing an <code>asadmin</code> Subcommand as a Java Class</a></li>
<li><a href="#specifying-the-name-of-an-asadmin-subcommand">Specifying the Name of an <code>asadmin</code> Subcommand</a></li>
<li><a href="#ensuring-that-an-admincommand-implementation-is-stateless">Ensuring That an <code>AdminCommand</code> Implementation Is Stateless</a></li>
<li><a href="#example-of-adding-an-asadmin-subcommand">Example of Adding an <code>asadmin</code> Subcommand</a></li>
</ul>
</li>
<li><a href="#adding-parameters-to-an-asadmin-subcommand">Adding Parameters to an <code>asadmin</code> Subcommand</a>
<ul class="sectlevel3">
<li><a href="#representing-a-parameter-of-an-asadmin-subcommand">Representing a Parameter of an <code>asadmin</code> Subcommand</a></li>
<li><a href="#identifying-a-parameter-of-an-asadmin-subcommand">Identifying a Parameter of an <code>asadmin</code> Subcommand</a></li>
<li><a href="#specifying-whether-a-parameter-is-an-option-or-an-operand">Specifying Whether a Parameter Is an Option or an Operand</a></li>
<li><a href="#specifying-the-name-of-an-option">Specifying the Name of an Option</a></li>
<li><a href="#specifying-the-acceptable-values-of-a-parameter">Specifying the Acceptable Values of a Parameter</a></li>
<li><a href="#specifying-the-default-value-of-a-parameter">Specifying the Default Value of a Parameter</a></li>
<li><a href="#specifying-whether-a-parameter-is-required-or-optional">Specifying Whether a Parameter Is Required or Optional</a></li>
<li><a href="#example-of-adding-parameters-to-an-asadmin-subcommand">Example of Adding Parameters to an <code>asadmin</code> Subcommand</a></li>
</ul>
</li>
<li><a href="#making-asadmin-subcommands-cluster-aware">Making <code>asadmin</code> Subcommands Cluster-Aware</a>
<ul class="sectlevel3">
<li><a href="#specifying-allowed-targets">Specifying Allowed Targets</a></li>
<li><a href="#the-target-utility">The <code>Target</code> Utility</a></li>
<li><a href="#specifying-asadmin-subcommand-execution">Specifying <code>asadmin</code> Subcommand Execution</a></li>
<li><a href="#subcommand-preprocessing-and-postprocessing">Subcommand Preprocessing and Postprocessing</a></li>
<li><a href="#running-a-command-from-another-command">Running a Command from Another Command</a></li>
</ul>
</li>
<li><a href="#adding-message-text-strings-to-an-asadmin-subcommand">Adding Message Text Strings to an <code>asadmin</code> Subcommand</a></li>
<li><a href="#enabling-an-asadmin-subcommand-to-run">Enabling an <code>asadmin</code> Subcommand to Run</a></li>
<li><a href="#setting-the-context-of-an-asadmin-subcommand">Setting the Context of an <code>asadmin</code> Subcommand</a></li>
<li><a href="#changing-the-brand-in-the-glassfish-server-cli">Changing the Brand in the Eclipse GlassFish CLI</a></li>
<li><a href="#examples-of-extending-the-asadmin-utility">Examples of Extending the <code>asadmin</code> Utility</a></li>
<li><a href="#implementing-create-delete-and-list-commands-using-annotations">Implementing Create, Delete, and List Commands Using Annotations</a>
<ul class="sectlevel3">
<li><a href="#command-patterns">Command Patterns</a></li>
<li><a href="#resolvers">Resolvers</a></li>
<li><a href="#the-create-annotation">The <code>@Create</code> Annotation</a></li>
<li><a href="#the-delete-annotation">The <code>@Delete</code> Annotation</a></li>
<li><a href="#the-listing-annotation">The <code>@Listing</code> Annotation</a></li>
<li><a href="#create-command-decorators">Create Command Decorators</a></li>
<li><a href="#delete-command-decorators">Delete Command Decorators</a></li>
<li><a href="#specifying-command-execution">Specifying Command Execution</a></li>
<li><a href="#using-multiple-command-annotations">Using Multiple Command Annotations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#adding-monitoring-capabilities-2">Adding Monitoring Capabilities</a>
<ul class="sectlevel2">
<li><a href="#defining-statistics-that-are-to-be-monitored">Defining Statistics That Are to Be Monitored</a>
<ul class="sectlevel3">
<li><a href="#defining-an-event-provider">Defining an Event Provider</a></li>
<li><a href="#sending-an-event">Sending an Event</a></li>
</ul>
</li>
<li><a href="#updating-the-monitorable-object-tree">Updating the Monitorable Object Tree</a>
<ul class="sectlevel3">
<li><a href="#creating-event-listeners">Creating Event Listeners</a></li>
<li><a href="#representing-a-components-statistics-in-an-event-listener-class">Representing a Component&#8217;s Statistics in an Event Listener Class</a></li>
<li><a href="#subscribing-to-events-from-event-provider-classes">Subscribing to Events From Event Provider Classes</a></li>
<li><a href="#listening-for-events-from-classes-that-are-not-event-providers">Listening for Events From Classes That Are Not Event Providers</a></li>
<li><a href="#registering-an-event-listener">Registering an Event Listener</a></li>
</ul>
</li>
<li><a href="#dotted-names-and-rest-urls-for-an-add-on-components-statistics">Dotted Names and REST URLs for an Add-On Component&#8217;s Statistics</a></li>
<li><a href="#adding-a-type-to-the-monitor-command">Adding a Type to the <code>monitor</code> Command</a></li>
<li><a href="#example-of-adding-monitoring-capabilities">Example of Adding Monitoring Capabilities</a></li>
</ul>
</li>
<li><a href="#adding-configuration-data-for-a-component-2">Adding Configuration Data for a Component</a>
<ul class="sectlevel2">
<li><a href="#how-glassfish-server-stores-configuration-data">How Eclipse GlassFish Stores Configuration Data</a></li>
<li><a href="#defining-an-element">Defining an Element</a>
<ul class="sectlevel3">
<li><a href="#to-define-an-element">To Define an Element</a></li>
</ul>
</li>
<li><a href="#defining-an-attribute-of-an-element">Defining an Attribute of an Element</a>
<ul class="sectlevel3">
<li><a href="#representing-an-attribute-of-an-element">Representing an Attribute of an Element</a></li>
<li><a href="#specifying-the-data-type-of-an-attribute">Specifying the Data Type of an Attribute</a></li>
<li><a href="#identifying-an-attribute-of-an-element">Identifying an Attribute of an Element</a></li>
<li><a href="#specifying-the-name-of-an-attribute">Specifying the Name of an Attribute</a></li>
<li><a href="#specifying-the-default-value-of-an-attribute">Specifying the Default Value of an Attribute</a></li>
<li><a href="#specifying-whether-an-attribute-is-required-or-optional">Specifying Whether an Attribute Is Required or Optional</a></li>
<li><a href="#example-of-defining-an-attribute-of-an-element">Example of Defining an Attribute of an Element</a></li>
</ul>
</li>
<li><a href="#defining-a-subelement">Defining a Subelement</a>
<ul class="sectlevel3">
<li><a href="#to-define-a-subelement">To Define a Subelement</a></li>
</ul>
</li>
<li><a href="#validating-configuration-data">Validating Configuration Data</a></li>
<li><a href="#initializing-a-components-configuration-data">Initializing a Component&#8217;s Configuration Data</a>
<ul class="sectlevel3">
<li><a href="#to-define-a-components-initial-configuration-data">To Define a Component&#8217;s Initial Configuration Data</a></li>
<li><a href="#to-write-a-components-initial-configuration-data-to-the-domain-xml-file">To Write a Component&#8217;s Initial Configuration Data to the <code>domain.xml</code> File</a></li>
</ul>
</li>
<li><a href="#creating-a-transaction-to-update-configuration-data">Creating a Transaction to Update Configuration Data</a>
<ul class="sectlevel3">
<li><a href="#to-create-a-transaction-to-update-configuration-data">To Create a Transaction to Update Configuration Data</a></li>
</ul>
</li>
<li><a href="#dotted-names-and-rest-urls-of-configuration-attributes">Dotted Names and REST URLs of Configuration Attributes</a></li>
<li><a href="#examples-of-adding-configuration-data-for-a-component">Examples of Adding Configuration Data for a Component</a></li>
</ul>
</li>
<li><a href="#adding-container-capabilities-2">Adding Container Capabilities</a>
<ul class="sectlevel2">
<li><a href="#creating-a-container-implementation">Creating a <code>Container</code> Implementation</a>
<ul class="sectlevel3">
<li><a href="#marking-the-class-with-the-service-annotation">Marking the Class With the <code>@Service</code> Annotation</a></li>
<li><a href="#implementing-the-container-interface">Implementing the <code>Container</code> Interface</a></li>
</ul>
</li>
<li><a href="#adding-an-archive-type">Adding an Archive Type</a>
<ul class="sectlevel3">
<li><a href="#implementing-the-archivehandler-interface">Implementing the <code>ArchiveHandler</code> Interface</a></li>
</ul>
</li>
<li><a href="#creating-connector-modules">Creating Connector Modules</a>
<ul class="sectlevel3">
<li><a href="#associating-file-types-with-containers-by-using-the-sniffer-interface">Associating File Types With Containers by Using the <code>Sniffer</code> Interface</a></li>
</ul>
</li>
<li><a href="#example-of-adding-container-capabilities">Example of Adding Container Capabilities</a>
<ul class="sectlevel3">
<li><a href="#container-component-code">Container Component Code</a></li>
<li><a href="#web-client-code">Web Client Code</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#creating-a-session-persistence-module-2">Creating a Session Persistence Module</a>
<ul class="sectlevel2">
<li><a href="#implementing-the-persistencestrategybuilder-interface">Implementing the <code>PersistenceStrategyBuilder</code> Interface</a></li>
</ul>
</li>
<li><a href="#packaging-integrating-and-delivering-an-add-on-component">Packaging, Integrating, and Delivering an Add-On Component</a>
<ul class="sectlevel2">
<li><a href="#packaging-an-add-on-component">Packaging an Add-On Component</a></li>
<li><a href="#integrating-an-add-on-component-with-glassfish-server">Integrating an Add-On Component With Eclipse GlassFish</a></li>
<li><a href="#delivering-an-add-on-component-through-update-tool">Delivering an Add-On Component Through Update Tool</a></li>
</ul>
</li>
<li><a href="#a-integration-point-reference">Integration Point Reference</a>
<ul class="sectlevel2">
<li><a href="#integration-point-attributes">Integration Point Attributes</a></li>
<li><a href="#org-glassfish-adminguinavnode-integration-point"><code>org.glassfish.admingui:navNode</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguirightpanel-integration-point"><code>org.glassfish.admingui:rightPanel</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguirightpaneltitle-integration-point"><code>org.glassfish.admingui:rightPanelTitle</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguiserverinsttab-integration-point"><code>org.glassfish.admingui:serverInstTab</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguicommontask-integration-point"><code>org.glassfish.admingui:commonTask</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguiconfiguration-integration-point"><code>org.glassfish.admingui:configuration</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguiresources-integration-point"><code>org.glassfish.admingui:resources</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguicustomtheme-integration-point"><code>org.glassfish.admingui:customtheme</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguimasthead-integration-point"><code>org.glassfish.admingui:masthead</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguiloginimage-integration-point"><code>org.glassfish.admingui:loginimage</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguiloginform-integration-point"><code>org.glassfish.admingui:loginform</code> Integration Point</a></li>
<li><a href="#org-glassfish-adminguiversioninfo-integration-point"><code>org.glassfish.admingui:versioninfo</code> Integration Point</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="eclipse-glassfish-server"><a class="anchor" href="#eclipse-glassfish-server"></a>Eclipse GlassFish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add-On Component Development Guide</p>
</div>
<div class="paragraph">
<p>Release 7</p>
</div>
<div class="paragraph">
<p>Contributed 2018 - 2024</p>
</div>
<div class="paragraph">
<p>This document explains how to use published interfaces of Eclipse GlassFish to develop add-on components for Eclipse GlassFish. This document explains how to perform only those tasks that
ensure that the add-on component is suitable for Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>This document is for software developers who are developing add-on
components for Eclipse GlassFish. This document assumes that the
developers are working with a distribution of Eclipse GlassFish. Access
to the source code of the GlassFish project is not required to perform
the tasks in this document. This document also assumes the ability to
program in the Java language.</p>
</div>
<hr>
<div class="paragraph">
<p>Eclipse GlassFish Add-On Component Development Guide,
Release 7</p>
</div>
<div class="paragraph">
<p>Copyright © 2013, 2019 Oracle and/or its affiliates. All rights reserved.</p>
</div>
<div class="paragraph">
<p>This program and the accompanying materials are made available under the
terms of the Eclipse Public License v. 2.0, which is available at
<a href="http://www.eclipse.org/legal/epl-2.0" class="bare">http://www.eclipse.org/legal/epl-2.0</a>.</p>
</div>
<div class="paragraph">
<p>SPDX-License-Identifier: EPL-2.0</p>
</div>
<div class="paragraph">
<p>Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.</p>
</div>
<div class="paragraph">
<p>Intel and Intel Xeon are trademarks or registered trademarks of Intel
Corporation. All SPARC trademarks are used under license and are
trademarks or registered trademarks of SPARC International, Inc. AMD,
Opteron, the AMD logo, and the AMD Opteron logo are trademarks or
registered trademarks of Advanced Micro Devices. UNIX is a registered
trademark of The Open Group.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHoAAAAoCAYAAAAxH+4YAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4gsHAhURI94LCQAADalJREFUeNrtnHmw19QVxz+/t0EeyKJVXBAxWAUVcUcbE6xaRTvWsVXrUlsdbZUaday4MCLWjVbEVm2sjLbVukxVFFrtQlUUEuO4gguCGxERkMciD/QReNuvf+RErnnJ75ffAwo678xkXn5Zbu69Z7nnfM+5r0AKhY6OZgfq725AD2Bf4DBgIFAPtACLgFnAS0ATsE6zg3a6aKuiQqmboaP3BYYDPwVOAWqBdmHuZ8AXwmxNXnGBacC7wFKgqApMF205qklqMoBmB4SOfiQwGvi+3F4IPAH4wDvAx5odhIn3dwO+Dewmmr2qa4q3Mo0WJhc0OyiGjn4ZMA7oI7fHAI8AizQ7aC1l5uVaAajR7KCla4q3Moq1OXT08aGjF+V4N3T0vUNHr1Kfi58t1U7yvIu2EgbL+SUKk/3Q0XfpYtg3g1RNPQK4Xn6+BZyl2cHiNNPcRV/TNTp09N7Ag8CJwDrgMM0O3uxi8jdPo4cLkwEu3lRMtkyj0/fT7uW91pk2N7adjZmDjR1XLo0WMORe4GzgbeBAzQ5aVUbLR7tV2Har6/ltWQNwPT/+3UtAmP5iYRYAvuv56+Ln42fld7USFhZdz2+uUPhqFQH/Sh8t0ygIVpCFLxTlnXZ1PGr/0q5bpnGIhKl7Ad2BVcCbwFOu5wdZ7VimUQNUVzjv64VXRSCOkNpriBCuk+XCBKAtjqUT8fa6Cj94O3BZ2uAt09As0zgauBowMhgyWfozG2hTJuJKYLwyqO4V9mseMEjOrwVuUu4NFcBnpzLCshJ4HLhDwKGiMra4n1WWaRwD/AHYM2uOLNOYClzlev4HKcyeoljavLSDzFt3YC5wJHBxlUhZT6ABeFGzg2KGJNMJyUpjcj9gEvBUFpOFTgVeAK6zTKOHMgFqu2s60a/Ps/ooQv55jja2Ay4A3gDOUy2UjLEAnC5jVJn8BRGiqM7nycDTlmnsm2IZmioc2xdire4CngXqgGeAQTWyPkOEVX+Wo7GiPFcKz65XJ0xhci3wKDAi8fzzwEfS5u7A0XK9G3Ac8PtODHpT0FIgTJjyetEaZCJvt0xjmev5TyoauSMwVu4DzAd+CwRiTnsDFvALoBdR7mA0cE4ZJoZl/K1G4c9Hcj4NWA7sWCMfAXg/p4a0AqY0VMqbT9OMSQkmTxXzvQxolk7WAdsDtwD7AD8DVmWthZuR2gEbmK4wLCYTuAfYlijZc6FlGk+7nr9OfJCdgCGKYoxwPX9xwsJNA/4D3AjcD/y9TH/uAO4uo2DtwArxIVYq1xfWsCEhsbSCrFOD6/l5tF/V5v2AHym3HgQucD0/TDguoev5qy3TOAWodz2/aQswOaZG1/MbUxzJJyzT2AX4nThLg4Wxs+XR3kob7yWZLNTiev5zwHMVLDlL0xzcPFQjmkRsFnKGVbnTkAqDzhBfADEt45NMTqx1RWBLMrnUWAD+Jk5PNdBXrFBMy5XzwZZpnAx4wJo4SkhEEnnG2B47yp1l9CdJlCwHyLK/ZRqlzHw18LYaIgEHyvUi8JLr+e+mTF65yd3ilMGUYuxgifX6lChlayneswu8YZnGIlmqPgHedT1/Sc4x9gcOtkyjvQRfVgCfqOGfyuhZct4zJazKYuL9ZbS6N3CoOCGxy99H8Wz9CiR5S1KxhOCdo8TzK8Rxi59ZaZnGNUQZv11iGVEY3yZr6KeWabwC3OB6/qIy8/GTMqFWnViZcWlOW42yrgwIHb02R2qxQJRvLke1ynk35XdRJmZrZzJpptIyjXrgQnEiYzBjruv5byeE9wXgEOByCcV6JpRlBzn2A061TMNwPX9uCWZvK0cp2j4L7KkR7k8DhonWLc8xAWvLxNY9EhrfrKA0hbjDW7lGVwEzckCRK4Hb0sbjev6nEjaNtkxjiCCAg4EDgMPFEa6WeX8O2LHEfDQTVfNkUbcUXKAD4nU/8FegXw5GNwN7CIyXFzBZoYRj1RK73/010Ohy9DFwrev5XiJy6CDArufPE1Qufqa7IHwXCx/6WaZxkuv5/8j41g2CNraVsUCpwlAjFSUzJI4+IXT0OWXW6gIQxo5WTuelzTKNdwQIqQKOsExjoOv5CzIw3s54pZuDAsEWVHPYIijibOBR1/PnCBJWVNdxudZPni2mjGedZRo3Agcpa/dQIIvRLcBaiUY65XWj2UFD6Oi3iITdodnB+k0RXiXM3sOyVmmCNV9nmcb5IgRf4sSJiTrQ9fzXtxCT2wULn5EATNqAphhHkD4XVW2WCGMcMAA4yvX8RlVYlfFUJeaylLa2d5bJADVx3KzZwcOho48EbgZGl4mnh1umsbqMZ77I9fxPFCl/zTKNp4DTFK+1v2UaF7qeP1+dAMs0DhAUaF/LNM5MwIslveIKQqJcEKjr+UsqDP8KgnLtKr99yzROjLNUCTozgRS+WuJTAy3TOLyEMBTED3rL9fyWNNONwuyzQ0efETq6odmBHwMoxz3awZt+OsckTQSuSFw7C9ifDUD/McCHlmkEwBy5djCws/LOZMs0DnI9f07KN3awTKMcs+90Pf/STipCoZMh2RjgIfm9NzDfMo2ZwExZCnYCRgrEG9M81/OfLdHuRXKU8592B5akeZZxeS9yfqSs1YNyxtW5QhPRqlbgOyIoajWpDvxAjp0TDt0/E45fVYX9aE2xNlltFZT7VZ1htGj448CtCcdohJjziRJyfYXJcYycWO4qzUW3lFyjVWYLY68FDggdvV6zg7UKbJk3LdgdWJycAGH2SoEEfyyDO4yO+d8lEodOBaa6nr9eMb8NRAUSefyEWgX5i2kuG5InSxP3QrEsTSKoFadBpZ/rLdMYK2DUGUTp2O1SHp8F/Bu41/X8hSlLTCD9bclpfdZket3qD4XZ7aGjz1Ikvk0ksr0Ck7cmaz1zPX8tcJ9lGlOAbwHbyAEReP85sNz1/DUpa+xUorRmMWc/klm0S9hQRZL0MxaKw1irAjuVarT0txl4xDKN/8oY+8jfWgk1V4qlaogTFSnr/QTAqWCs7eRLNYtYb6La7CywIatGqlztVGfrqErVhZWrGdvYb6aNMXkv61oXddH/n5Ian3cXRynrkdVm2vVS36+0L5X2s5J5ydt2pc/mtbiFnMwsSPzbnAgj3tHs4AP1o7GXHjr6gYLn1gGzNTuYUaL9k4D5mh3MUa4NF6/zJbUgInT0GuB7wAeaHXwo1+olVAvUNuTejoLItUqfVwEvaHYQho5eSKuRi8cROvpZwAfAKyn7y3oDx6Z47kXgec0OlivPVovj+Z5mB/MyvtUdOEni72XAk5odNGbsbRtIVOs3Pa7YlTBuN7nWXNIZK0FVRCm3ZmFcXEp6jYQRqjNXkOtXiPe9FugVOvqDwM+BlpSQ7S8CkIxVrl0sKNqZCdy8TuLUgaGjD9HsoIko8X8b8IASj6PEsQ+Jo1IlXumC0NFHaXYwPW0iZRwj5T1f+rAw0W5/orRgtfSvyIaK1BF8NWdQB9wpx7wUJg8R6HMQUW1YPbA8dPSTNTt4OaWPhwCPAT8U57RAVE58OvBymkNWaUx6swTkg4k2xf8p5ZljieqgHBl4X+B8otqvURlxeS861o3Xy5FmhbqL5KvATU861nbFwtxMVFXaV6xBHXBX6Oi7qxhCgsZLuDUMKaBMPDdX+tdblOB5ojRhNwkNk9Shf/LtGmCytLO3Zge9ier4GoFpoaN3T5mzWEEnh44+UKxSHVHWsJClqZVQI9Em+MVyrE6YlG5ifl4FfqPZQVEQt/sERLh6E7kGNaIZw0JHvxWlwqMEbv2ZZgeNmh3MBL4rpu8oFRRSfAGLKJU4TjTmIlkeVE0siolcL+FnO7Bes4NmCU/zjuUEonqz0zQ7eE+Wk8VEhQZ9gHMzhL1ZNHdm6Oh9yuDkFTP6PGHYI2Im90rcryNKYc6KA3dlwHPILoz/MvujPF8s4UfUElVnXimw4Nk5/I0qpf2lEiPvlNQwobFEe8Eniok0gX3i+wkNK6SdV4Ao7ip9mxkLkLwfV/7skTGW1cKPnrKE9CyFc1TK6OXAh3LMp+PujTaRsgFAdWJt2VXWnyzorkeKqWsrIan1mh38kaiadBxRLXU5DDruTw8BL1alePbDxVQvCx39UqKdDk3ITtPNsIU4Bpb2VJeR0NFjIWzIGEs34DVZl0cK0LN+UzF6qmYHo4GrROoXJDRiLVG1yvHA8YpJPJzof6Dcn9HuS8CI0NF3kMH2l7V0fonSpljjryfaMVGOya3SlwFExXoNwIvJaEF8iV5EJT4TxCncBjg+dPS9NsPu0uniZT+QsAST5O8jpaBmzQ6eAUaJ4BbLYt2VgOZp7rtCU8QDfDx09PfF6x4mzsu4jHcuFemcFzr6fKJ87gKifUtJRhRFy2MNXRI6+hjxWrO2E2mAq2hjE/ArzQ5mJ0LCwaIdEzU7uELR9n5Ee6x+Ldh12jfKwcPtyf7Jt5eEjn458OfQ0dcKjr8HUbnVKM0OFmakjNXvPSDLy9CN1egi0c6J2eVAAs0O1kjC4lzgdTHxVxHtuV6VFvBrdvAWUTbnIXH2JgBHaHbwYcogW8Tb/5fyvgv8kigNmKSPJAS8SY5LgaGaHdwjoWByPqaoIaO03yD+wHsp7bdKXx4rYTpbJfzzU7zugmYHDxGlZ+8V/2EycKhmB5PkfrK9OURZsEbFko4h2lCQum3nf8vVJ/NUdLY+AAAAAElFTkSuQmCC" alt="Eclipse Logo"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preface"><a class="anchor" href="#preface"></a>Preface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document explains how to use published interfaces of
Eclipse GlassFish to develop add-on components
for Eclipse GlassFish.
This document explains how to perform only those tasks that
ensure that the add-on component is suitable for Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>This document is for software developers who are developing add-on
components for Eclipse GlassFish. This document assumes that the
developers are working with a distribution of Eclipse GlassFish. Access
to the source code of the GlassFish project is not required to perform
the tasks in this document. This document also assumes the ability to
program in the Java language.</p>
</div>
<div class="paragraph">
<p>This preface contains information about and conventions for the entire
Eclipse GlassFish (Eclipse GlassFish) documentation set.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish 7 is developed through the GlassFish project
open-source community at <a href="https://github.com/eclipse-ee4j/glassfish" class="bare">https://github.com/eclipse-ee4j/glassfish</a>.
The GlassFish project provides a structured process for developing the
Eclipse GlassFish platform that makes the new features of the Jakarta EE
platform available faster, while maintaining the most important feature
of Jakarta EE: compatibility. It enables Java developers to access the
Eclipse GlassFish source code and to contribute to the development of the
Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#glassfish-server-documentation-set">Eclipse GlassFish Documentation Set</a></p>
</li>
<li>
<p><a href="#related-documentation">Related Documentation</a></p>
</li>
<li>
<p><a href="#typographic-conventions">Typographic Conventions</a></p>
</li>
<li>
<p><a href="#symbol-conventions">Symbol Conventions</a></p>
</li>
<li>
<p><a href="#default-paths-and-file-names">Default Paths and File Names</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="glassfish-server-documentation-set"><a class="anchor" href="#glassfish-server-documentation-set"></a>Eclipse GlassFish Documentation Set</h3>
<div class="paragraph">
<p>The Eclipse GlassFish documentation set describes deployment planning and
system installation. For an introduction to Eclipse GlassFish, refer to
the books in the order in which they are listed in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Book Title</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="release-notes.html#GSRLN">Release Notes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides late-breaking information about
the software and the documentation and includes a comprehensive,
table-based summary of the supported hardware, operating system, Java
Development Kit (JDK), and database drivers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="quick-start-guide.html#GSQSG">Quick Start Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to get started with the Eclipse GlassFish product.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="installation-guide.html#GSING">Installation Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to install the software and its components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="upgrade-guide.html#GSUPG">Upgrade Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to upgrade to the latest version of Eclipse GlassFish.
This guide also describes differences between adjacent product releases and configuration
options that can result in incompatibility with the product specifications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="deployment-planning-guide.html#GSPLG">Deployment Planning Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to build a production deployment of Eclipse GlassFish that meets the requirements of
your system and enterprise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="administration-guide.html#GSADG">Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to configure, monitor, and manage Eclipse GlassFish subsystems and components
from the command line by using the <a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a> utility.
Instructions for performing these tasks from the Administration Console are provided
in the Administration Console online help.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="security-guide.html#GSSCG">Security Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides instructions for configuring and administering Eclipse GlassFish security.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="application-deployment-guide.html#GSDPG">Application Deployment Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to assemble and deploy applications to the Eclipse GlassFish and provides information
about deployment descriptors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="application-development-guide.html#GSDVG">Application Development Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to create and implement Java Platform, Enterprise Edition (Jakarta EE platform)
applications that are intended to run on the Eclipse GlassFish.
These applications follow the open Java standards model for Jakarta EE components
and application programmer interfaces (APIs).
This guide provides information about developer tools, security, and debugging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="add-on-component-development-guide.html#GSACG">Add-On Component Development Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to use published interfaces of Eclipse GlassFish to develop add-on components
for Eclipse GlassFish.
This document explains how to perform only those tasks that ensure that the add-on component
is suitable for Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="embedded-server-guide.html#GSESG">Embedded Server Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to run applications in embedded Eclipse GlassFish and to develop applications
in which Eclipse GlassFish is embedded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="ha-administration-guide.html#GSHAG">High Availability Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to configure Eclipse GlassFish to provide higher availability and
scalability through failover and load balancing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="performance-tuning-guide.html#GSPTG">Performance Tuning Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to optimize the performance of Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="troubleshooting-guide.html#GSTSG">Troubleshooting Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes common problems that you might encounter when using Eclipse GlassFish and explains how to solve them.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="error-messages-reference.html#GSEMR">Error Message Reference</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes error messages that you might encounter when using Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="reference-manual.html#GSRFM">Reference Manual</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides reference information in man page format for Eclipse GlassFish administration commands, utility
commands, and related concepts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-release-notes/toc.html">Message Queue Release Notes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes new features, compatibility issues, and existing bugs for Open Message Queue.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-tech-over/toc.html">Message Queue Technical Overview</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides an introduction to the technology, concepts, architecture, capabilities, and features of
the Message Queue messaging service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html">Message Queue Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to set up and manage a Message Queue messaging system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-jmx/toc.html">Message Queue Developer&#8217;s Guide for JMX Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the application programming interface in Message Queue for
programmatically configuring and monitoring Message Queue resources in
conformance with the Java Management Extensions (JMX).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-java/toc.html">Message Queue Developer&#8217;s Guide for Java Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides information about concepts and procedures for developing Java messaging
applications (Java clients) that work with Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-c/toc.html">Message Queue Developer&#8217;s Guide for C Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides programming and reference information for developers working with
Message Queue who want to use the C language binding to the Message
Queue messaging service to send, receive, and process Message Queue messages.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="related-documentation"><a class="anchor" href="#related-documentation"></a>Related Documentation</h3>
<div class="paragraph">
<p>The following tutorials explain how to develop Jakarta EE applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/eclipse-ee4j/jakartaee-firstcup-examples">
Your First Cup: An Introduction to the Jakarta EE Platform</a>.
For beginning Jakarta EE programmers, this short tutorial explains the entire
process for developing a simple enterprise application.
The sample application is a web application that consists of a component that is
based on the Enterprise JavaBeans specification, a JAX-RS web service,
and a JavaServer Faces component for the web front end.</p>
</li>
<li>
<p><a href="https://eclipse-ee4j.github.io/jakartaee-tutorial">The Jakarta EE Tutorial</a>.
This comprehensive tutorial explains how to use Jakarta EE platform technologies
and APIs to develop Jakarta EE applications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Javadoc tool reference documentation for packages that are provided with
Eclipse GlassFish is available as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Jakarta EE specifications and API specification is
located at <a href="https://jakarta.ee/specifications/" class="bare">https://jakarta.ee/specifications/</a>.</p>
</li>
<li>
<p>The API specification for Eclipse GlassFish 7, including Jakarta EE
platform packages and nonplatform packages that are specific to the
Eclipse GlassFish product, is located at
<a href="https://glassfish.org/docs/" class="bare">https://glassfish.org/docs/</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about creating enterprise applications in the NetBeans
Integrated Development Environment (IDE), see the
<a href="https://netbeans.apache.org/kb/docs/java-ee.html">
NetBeans Documentation, Training &amp; Support page</a>.</p>
</div>
<div class="paragraph">
<p>For information about the Derby database for use with
the Eclipse GlassFish, see the <a href="https://db.apache.org/derby/index.html">Derby page</a>.</p>
</div>
<div class="paragraph">
<p>The Jakarta EE Samples project is a collection of sample applications that
demonstrate a broad range of Jakarta EE technologies. The Jakarta EE Samples
are bundled with the Jakarta EE Software Development Kit (SDK) and are also
available from the repository
(<code><a href="https://github.com/eclipse-ee4j/glassfish-samples" class="bare">https://github.com/eclipse-ee4j/glassfish-samples</a></code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="typographic-conventions"><a class="anchor" href="#typographic-conventions"></a>Typographic Conventions</h3>
<div class="paragraph">
<p>The following table describes the typographic changes that are used in
this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 37%;">
<col style="width: 49%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Typeface</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AaBbCc123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The names of commands, files, and directories, and onscreen computer output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edit your <code>.login</code> file.</p>
<p class="tableblock">Use <code>ls</code> <code>a</code> to list all files.</p>
<p class="tableblock"><code>machine_name% you have mail.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AaBbCc123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What you type, contrasted with onscreen computer output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>machine_name%</code> <code>su</code></p>
<p class="tableblock"><code>Password:</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AaBbCc123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A placeholder to be replaced with a real name or value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The command to remove a file is <code>rm</code> filename.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AaBbCc123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Book titles, new terms, and terms to be emphasized (note that some emphasized items appear bold online)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read Chapter 6 in the User&#8217;s Guide.</p>
<p class="tableblock">A cache is a copy that is stored locally.</p>
<p class="tableblock">Do not save the file.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="symbol-conventions"><a class="anchor" href="#symbol-conventions"></a>Symbol Conventions</h3>
<div class="paragraph">
<p>The following table explains symbols that might be used in this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 26%;">
<col style="width: 28%;">
<col style="width: 36%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbol</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains optional arguments and command options.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ls [-l]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>-l</code> option is not required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{ | }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains a set of choices for a required command option.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-d {y|n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>-d</code> option requires that you use either the <code>y</code> argument or the <code>n</code> argument.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${ }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a variable reference.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${com.sun.javaRoot}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the value of the <code>com.sun.javaRoot</code> variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joins simultaneous multiple keystrokes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control-A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Press the Control key while you press the A key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joins consecutive multiple keystrokes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ctrl+A+N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Press the Control key, release it, and then press the subsequent keys.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates menu item selection in a graphical user interface.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File &gt; New &gt; Templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">From the File menu, choose New. From the New submenu, choose Templates.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="default-paths-and-file-names"><a class="anchor" href="#default-paths-and-file-names"></a>Default Paths and File Names</h3>
<div class="paragraph">
<p>The following table describes the default paths and file names that are
used in this book.</p>
</div>
<table class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Placeholder</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Represents the base installation directory for Eclipse GlassFish.
In configuration files, as-install is represented as follows:
<code>${com.sun.aas.installRoot}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Installations on the Oracle Solaris operating system, Linux operating
system, and Mac OS operating system:</p>
<div class="paragraph">
<p>user&#8217;s-home-directory<code>/glassfish7/glassfish</code></p>
</div>
</li>
<li>
<p>Installations on the Windows operating system:</p>
<div class="paragraph">
<p>SystemDrive<code>:\glassfish7\glassfish</code></p>
</div>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install-parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the parent of the base installation directory for Eclipse GlassFish.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Installations on the Oracle Solaris operating system, Linux operating
system, and Mac operating system:</p>
<div class="paragraph">
<p>user&#8217;s-home-directory<code>/glassfish7</code></p>
</div>
</li>
<li>
<p>Installations on the Windows operating system:</p>
<div class="paragraph">
<p>SystemDrive<code>:\glassfish7</code></p>
</div>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-root-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory in which a domain is created by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install<code>/domains/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory in which a domain&#8217;s configuration is stored.
In configuration files, domain-dir is represented as follows:
<code>${com.sun.aas.instanceRoot}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-root-dir/domain-name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory for a server instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir/instance-name</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction-to-the-development-environment-for-eclipse-glassfish-add-on-components"><a class="anchor" href="#introduction-to-the-development-environment-for-eclipse-glassfish-add-on-components"></a>Introduction to the Development Environment for Eclipse GlassFish Add-On Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Eclipse GlassFish enables an external vendor such as
an independent software vendor (ISV), original equipment manufacturer
(OEM), or system integrator to incorporate Eclipse GlassFish into a new
product with the vendor&#8217;s own brand name. External vendors can extend
the functionality of Eclipse GlassFish by developing add-on components
for Eclipse GlassFish. Eclipse GlassFish provides interfaces to enable
add-on components to be configured, managed, and monitored through
existing Eclipse GlassFish tools such as the Administration Console and
the <code>asadmin</code> utility.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#glassfish-server-modular-architecture-and-add-on-components">Eclipse GlassFish Modular Architecture and Add-On Components</a></p>
</li>
<li>
<p><a href="#osgi-alliance-module-management-subsystem">OSGi Alliance Module Management Subsystem</a></p>
</li>
<li>
<p><a href="#hundred-kilobyte-kernel">Hundred-Kilobyte Kernel</a></p>
</li>
<li>
<p><a href="#overview-of-the-development-process-for-an-add-on-component">Overview of the Development Process for an Add-On Component</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="glassfish-server-modular-architecture-and-add-on-components"><a class="anchor" href="#glassfish-server-modular-architecture-and-add-on-components"></a>Eclipse GlassFish Modular Architecture and Add-On Components</h3>
<div class="paragraph">
<p>Eclipse GlassFish has a modular architecture in which the features of
Eclipse GlassFish are provided by a consistent set of components that
interact with each other. Each component provides a small set of
functionally related features.</p>
</div>
<div class="paragraph">
<p>The modular architecture of Eclipse GlassFish enables users to download
and install only the components that are required for the applications
that are being deployed. As a result, start-up times, memory
consumption, and disk space requirements are all minimized.</p>
</div>
<div class="paragraph">
<p>The modular architecture of Eclipse GlassFish enables you to extend the
basic functionality of Eclipse GlassFish by developing add-on components.
An add-on component is an encapsulated definition of reusable code that
has the following characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The component provides a set of Java classes.</p>
</li>
<li>
<p>The component offers services and public interfaces.</p>
</li>
<li>
<p>The component implements the public interfaces with a set of private classes.</p>
</li>
<li>
<p>The component depends on other components.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add-on components that you develop interact with Eclipse GlassFish in the
same way as components that are supplied in Eclipse GlassFish
distributions.</p>
</div>
<div class="paragraph">
<p>You can create and offer new or updated add-on components at any time.
Eclipse GlassFish administrators can install add-on components and update
or remove installed components after Eclipse GlassFish is installed. For
more information, see "<a href="administration-guide.html#GSADG00014">Extending and Updating Eclipse GlassFish</a>" in Eclipse GlassFish Administration Guide.</p>
</div>
</div>
<div class="sect2">
<h3 id="osgi-alliance-module-management-subsystem"><a class="anchor" href="#osgi-alliance-module-management-subsystem"></a>OSGi Alliance Module Management Subsystem</h3>
<div class="paragraph">
<p>To enable components to be added when required, Eclipse GlassFish
provides a lightweight and extensible kernel that uses the module
management subsystem from the <a href="http://www.osgi.org/">OSGi Alliance</a>
(<code><a href="http://www.osgi.org/" class="bare">http://www.osgi.org/</a></code>). Any Eclipse GlassFish component that plugs in
to this kernel must be implemented as an OSGi bundle. To enable an
add-on component to plug in to the Eclipse GlassFish kernel in the same
way as other components, package the component as an OSGi bundle. For
more information, see
<a href="#packaging-an-add-on-component">Packaging an Add-On
Component</a>.</p>
</div>
<div class="paragraph">
<p>The default OSGi module management subsystem in Eclipse GlassFish is the
Apache Felix <a href="http://felix.apache.org">OSGi framework</a>
(<code><a href="http://felix.apache.org" class="bare">http://felix.apache.org</a></code>). However, the Eclipse GlassFish kernel uses
only the <a href="http://www.osgi.org/Release4/HomePage">OSGi Service Platform
Release 4</a> (<code><a href="http://www.osgi.org/Release4/HomePage" class="bare">http://www.osgi.org/Release4/HomePage</a></code>) API. Therefore,
Eclipse GlassFish supports other OSGi module management subsystems that
are compatible with the OSGi Service Platform Release 4 API.</p>
</div>
</div>
<div class="sect2">
<h3 id="hundred-kilobyte-kernel"><a class="anchor" href="#hundred-kilobyte-kernel"></a>Hundred-Kilobyte Kernel</h3>
<div class="paragraph">
<p>The <a href="https://github.com/eclipse-ee4j/glassfish-hk2">Hundred-Kilobyte Kernel (HK2)</a>
(<code><a href="https://github.com/eclipse-ee4j/glassfish-hk2" class="bare">https://github.com/eclipse-ee4j/glassfish-hk2</a></code>) is the lightweight and extensible kernel
of Eclipse GlassFish. HK2 consists of the following technologies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Module subsystem. The HK2 module subsystem provides isolation between
components of the Eclipse GlassFish. The HK2 module subsystem is
compatible with existing technologies such as the OSGi framework.</p>
</li>
<li>
<p>Component model. The HK2 component model eases the development of
components that are also services. Eclipse GlassFish discovers these
components automatically and dynamically. HK2 components use injection
of dependencies to express dependencies on other components. Eclipse GlassFish provides two-way mappings between the services of an HK2
component and OSGi services.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information, see <a href="#writing-hk2-components">Writing
HK2 Components</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="overview-of-the-development-process-for-an-add-on-component"><a class="anchor" href="#overview-of-the-development-process-for-an-add-on-component"></a>Overview of the Development Process for an Add-On Component</h3>
<div class="paragraph">
<p>To ensure that an add-on component behaves identically to components
that are supplied in Eclipse GlassFish distributions, the component must
meet the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the component generates management data, configuration data, or
monitoring data, it must provide that data to other Eclipse GlassFish
components in the same way as other Eclipse GlassFish components.</p>
</li>
<li>
<p>If the component generates management data, configuration data, or
monitoring data, it must provide that data to users through Eclipse GlassFish administrative interfaces such as Administration Console and the
<code>asadmin</code> utility.</p>
</li>
<li>
<p>The component must be packaged and delivered as an OSGi bundle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To develop add-on components that meet these requirements, follow the
development process that is described in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#writing-hk2-components">Writing HK2 Components</a></p>
</li>
<li>
<p>&lt;&lt;Extending the Administration Console]</p>
</li>
<li>
<p>&lt;&lt;Extending the <code>asadmin</code> Utility]</p>
</li>
<li>
<p><a href="#adding-monitoring-capabilities">Adding Monitoring Capabilities</a></p>
</li>
<li>
<p><a href="#adding-configuration-data-for-a-component">Adding Configuration Data for a Component</a></p>
</li>
<li>
<p><a href="#adding-container-capabilities">Adding Container Capabilities</a></p>
</li>
<li>
<p><a href="#creating-a-session-persistence-module">Creating a Session Persistence Module</a></p>
</li>
<li>
<p><a href="#packaging-and-delivering-an-add-on-component">Packaging and Delivering an Add-On Component</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="writing-hk2-components"><a class="anchor" href="#writing-hk2-components"></a>Writing HK2 Components</h4>
<div class="paragraph">
<p>The Hundred-Kilobyte Kernel (HK2) is the lightweight and extensible
kernel of Eclipse GlassFish. To interact with Eclipse GlassFish, add-on
components plug in to this kernel. In the HK2 component model, the
functions of an add-on component are declared through a contract-service
implementation paradigm. An HK2 contract identifies and describes the
building blocks or the extension points of an application. An HK2
service implements an HK2 contract.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="#writing-hk2-components">Writing
HK2 Components</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="extending-the-administration-console"><a class="anchor" href="#extending-the-administration-console"></a>Extending the Administration Console</h4>
<div class="paragraph">
<p>The Administration Console is a browser-based tool for administering
Eclipse GlassFish. It features an easy-to-navigate interface and online
help. Extending the Administration Console enables you to provide a
graphical user interface for administering your add-on component. You
can use any of the user interface features of the Administration
Console, such as tree nodes, links on the Common Tasks page, tabs and
sub-tabs, property sheets, and JavaServer Faces pages. Your add-on
component implements a marker interface and provides a configuration
file that describes how your customizations integrate with the
Administration Console.</p>
</div>
<div class="paragraph">
<p>For more information, see
<a href="#extending-the-administration-console">Extending the Administration
Console</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="extending-the-asadmin-utility"><a class="anchor" href="#extending-the-asadmin-utility"></a>Extending the <code>asadmin</code> Utility</h4>
<div class="paragraph">
<p>The <code>asadmin</code> utility is a command-line tool for configuring and
administering Eclipse GlassFish. Extending the <code>asadmin</code> utility enables
you to provide administrative interfaces for an add-on component that
are consistent with the interfaces of other Eclipse GlassFish components.
A user can run <code>asadmin</code> subcommands either from a command prompt or
from a script. For more information about the <code>asadmin</code> utility, see the
<a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a> man page.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="#extending-the-asadmin-utility">Extending the
<code>asadmin</code> Utility</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="adding-monitoring-capabilities"><a class="anchor" href="#adding-monitoring-capabilities"></a>Adding Monitoring Capabilities</h4>
<div class="paragraph">
<p>Monitoring is the process of reviewing the statistics of a system to
improve performance or solve problems. By monitoring the state of
components and services that are deployed in the Eclipse GlassFish,
system administrators can identify performance bottlenecks, predict
failures, perform root cause analysis, and ensure that everything is
functioning as expected. Monitoring data can also be useful in
performance tuning and capacity planning.</p>
</div>
<div class="paragraph">
<p>An add-on component typically generates statistics that the Eclipse GlassFish can gather at run time. Adding monitoring capabilities enables an
add-on component to provide statistics to Eclipse GlassFish in the same
way as components that are supplied in Eclipse GlassFish distributions.
As a result, system administrators can use the same administrative
interfaces to monitor statistics from any installed Eclipse GlassFish
component, regardless of the origin of the component.</p>
</div>
<div class="paragraph">
<p>For more information, see
<a href="#adding-monitoring-capabilities">Adding Monitoring Capabilities</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="adding-configuration-data-for-a-component"><a class="anchor" href="#adding-configuration-data-for-a-component"></a>Adding Configuration Data for a Component</h4>
<div class="paragraph">
<p>The configuration data of a component determines the characteristics and
runtime behavior of a component. Eclipse GlassFish provides interfaces to
enable an add-on component to store its configuration data in the same
way as other Eclipse GlassFish components. These interfaces are similar
to interfaces that are defined in
<a href="https://jakarta.ee/specifications/xml-binding/3.0/">Jakarta XML Binding 3.0</a>
(<code><a href="https://jakarta.ee/specifications/xml-binding/3.0/" class="bare">https://jakarta.ee/specifications/xml-binding/3.0/</a></code>). By using these interfaces to
store configuration data, you ensure that the add-on component is fully
integrated with Eclipse GlassFish. As a result, administrators can
configure an add-on component in the same way as they can configure
other Eclipse GlassFish components.</p>
</div>
<div class="paragraph">
<p>For more information, see
<a href="#adding-configuration-data-for-a-component">
Adding Configuration Data for a Component</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="adding-container-capabilities"><a class="anchor" href="#adding-container-capabilities"></a>Adding Container Capabilities</h4>
<div class="paragraph">
<p>Applications run on Eclipse GlassFish in containers. Eclipse GlassFish
enables you to create containers that extend or replace the existing
containers of Eclipse GlassFish. Adding container capabilities enables
you to run new types of applications and to deploy new archive types in
Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>For more information, see
<a href="#adding-container-capabilities">Adding Container Capabilities</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-session-persistence-module"><a class="anchor" href="#creating-a-session-persistence-module"></a>Creating a Session Persistence Module</h4>
<div class="paragraph">
<p>Eclipse GlassFish enables you to create a session persistence module in
the web container for high availability-related functionality by
implementing the <code>PersistenceStrategyBuilder</code> interface . Using the
<code>PersistenceStrategyBuilder</code> interface in an HK2 service makes the
session manager extensible because you can implement a new persistence
type without having to modify the web container code.</p>
</div>
<div class="paragraph">
<p>For information about other high-availability, session persistence
solutions, see "<a href="ha-administration-guide.html#configuring-high-availability-session-persistence-and-failover">Configuring High Availability Session
Persistence and Failover</a>" in Eclipse GlassFish High
Availability Administration Guide.</p>
</div>
<div class="paragraph">
<p>For more information, see
<a href="#creating-a-session-persistence-module">Creating a Session
Persistence Module</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="packaging-and-delivering-an-add-on-component"><a class="anchor" href="#packaging-and-delivering-an-add-on-component"></a>Packaging and Delivering an Add-On Component</h4>
<div class="paragraph">
<p>Packaging an add-on component enables the component to interact with the
Eclipse GlassFish kernel in the same way as other components. Integrating
a component with Eclipse GlassFish enables Eclipse GlassFish to discover
the component at runtime. If an add-on component is an extension or
update to existing installations of Eclipse GlassFish, deliver the
component through Update Tool.</p>
</div>
<div class="paragraph">
<p>For more information, see
<a href="#packaging-integrating-and-delivering-an-add-on-component">Packaging, Integrating,
and Delivering an Add-On Component</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-hk2-components-2"><a class="anchor" href="#writing-hk2-components-2"></a>Writing HK2 Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Hundred-Kilobyte Kernel (HK2) is the lightweight and extensible
kernel of Eclipse GlassFish. To interact with Eclipse GlassFish, add-on
components plug in to this kernel. In the HK2 component model, the
functions of an add-on component are declared through a contract-service
implementation paradigm. An HK2 contract identifies and describes the
building blocks or the extension points of an application. An HK2
service implements an HK2 contract.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#hk2-component-model">HK2 Component Model</a></p>
</li>
<li>
<p><a href="#services-in-the-hk2-component-model">Services in the HK2 Component Model</a></p>
</li>
<li>
<p><a href="#hk2-runtime">HK2 Runtime</a></p>
</li>
<li>
<p><a href="#inversion-of-control">Inversion of Control</a></p>
</li>
<li>
<p><a href="#identifying-a-class-as-an-add-on-component">Identifying a Class as an Add-On Component</a></p>
</li>
<li>
<p><a href="#using-the-apache-maven-build-system-to-develop-hk2-components">Using the Apache Maven Build System to Develop HK2 Components</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="hk2-component-model"><a class="anchor" href="#hk2-component-model"></a>HK2 Component Model</h3>
<div class="paragraph">
<p>The Hundred-Kilobyte Kernel (HK2) provides a module system and component
model for building complex software systems. HK2 forms the core of
Eclipse GlassFish&#8217;s architecture.</p>
</div>
<div class="paragraph">
<p>The module system is responsible for instantiating classes that
constitute the application functionality. The HK2 runtime complements
the module system by creating objects. It configures such objects by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Injecting other objects that are needed by a newly instantiated object</p>
</li>
<li>
<p>Injecting configuration information needed for that object</p>
</li>
<li>
<p>Making newly created objects available, so that they can then be
injected to other objects that need it</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="services-in-the-hk2-component-model"><a class="anchor" href="#services-in-the-hk2-component-model"></a>Services in the HK2 Component Model</h3>
<div class="paragraph">
<p>An HK2 service identifies the building blocks or the extension points of
an application. A service is a plain-old Java object (POJO) with the
following characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The object implements an interface.</p>
</li>
<li>
<p>The object is declared in a JAR file with the <code>META-INF/services</code>
file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To clearly separate the contract interface and its implementation, the
HK2 runtime requires the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which interfaces are contracts</p>
</li>
<li>
<p>Which implementations of such interfaces are services</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Interfaces that define a contract are identified by the
<code>org.jvnet.hk2.annotations.Contract</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Target</span>(TYPE)
<span class="directive">public</span> <span class="annotation">@interface</span> Contract {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Implementations of such contracts should be identified with an
<code>org.jvnet.hk2.annotations.Service</code> annotation so that the HK2 runtime
can recognize them as <code>@Contract</code> implementations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Target</span>(TYPE)
<span class="directive">public</span> <span class="annotation">@interface</span> Service {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Service.html"><code>Service</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Service.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Service.html</a></code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="hk2-runtime"><a class="anchor" href="#hk2-runtime"></a>HK2 Runtime</h3>
<div class="paragraph">
<p>Once Services are defined, the HK2 runtime can be used to instantiate or
retrieve instances of services. Each service instance has a scope,
specified as singleton, per thread, per application, or a custom scope.</p>
</div>
<div class="sect3">
<h4 id="scopes-of-services"><a class="anchor" href="#scopes-of-services"></a>Scopes of Services</h4>
<div class="paragraph">
<p>You can specify the scope of a service by adding an
<code>org.jvnet.hk2.annotations.Scoped</code> annotation to the class-level of your
<code>@Service</code> implementation class. Scopes are also services, so they can
be custom defined and added to the HK2 runtime before being used by
other services. Each scope is responsible for storing the service
instances to which it is tied; therefore, the HK2 runtime does not rely
on predefined scopes (although it comes with a few predefined ones).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Contract</span>
<span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">Scope</span> {
    <span class="directive">public</span> <span class="directive">abstract</span> ScopeInstance current();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following code fragment shows how to set the scope for a service to
the predefined <code>Singleton</code> scope:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>
<span class="directive">public</span> Singleton <span class="directive">implements</span> Scope {
    ...
}

<span class="annotation">@Scope</span>(Singleton.class)
<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SingletonService</span> <span class="directive">implements</span> RandomContract {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define a new <code>Scope</code> implementation and use that scope on your
<code>@Service</code> implementations. You will see that the HK2 runtime uses the
<code>Scope</code> instance to store and retrieve service instances tied to that
scope.</p>
</div>
</div>
<div class="sect3">
<h4 id="instantiation-of-components-in-hk2"><a class="anchor" href="#instantiation-of-components-in-hk2"></a>Instantiation of Components in HK2</h4>
<div class="paragraph">
<p>Do not call the <code>new</code> method to instantiate components. Instead,
retrieve components by using the <code>Habitat</code> instance. The simplest way to
use the <code>Habitat</code> instance is through a <code>getComponent(Class`T
`contract)</code> call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> &lt;T&gt; T getComponent(<span class="predefined-type">Class</span>&lt;T&gt; clazz) <span class="directive">throws</span> ComponentException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>More APIs are available at
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/Habitat.html"><code>Habitat</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/Habitat.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/Habitat.html</a></code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="hk2-lifecycle-interfaces"><a class="anchor" href="#hk2-lifecycle-interfaces"></a>HK2 Lifecycle Interfaces</h4>
<div class="paragraph">
<p>Components can attach behaviors to their construction and destruction
events by implementing the
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/PostConstruct.html"><code>org.jvnet.hk2.component.PostConstruct</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/PostConstruct.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/PostConstruct.html</a></code>)
interface, the
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/PreDestroy.html"><code>org.jvnet.hk2.component.PreDestroy</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/PreDestroy.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/component/PreDestroy.html</a></code>)
interface, or both. These are interfaces rather than annotations for
performance reasons.</p>
</div>
<div class="paragraph">
<p>The <code>PostConstruct</code> interface defines a single method, <code>postConstruct</code>,
which is called after a component has been initialized and all its
dependencies have been injected.</p>
</div>
<div class="paragraph">
<p>The <code>PreDestroy</code> interface defines a single method, <code>preDestroy</code>, which
is called just before a component is removed from the system.</p>
</div>
<div id="ghoqv" class="paragraph">
<p>Example 2-1 Example Implementation of <code>PostContruct</code> and <code>PreDestroy</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.example.container.MyContainer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyContainer</span> <span class="directive">implements</span> <span class="predefined-type">Container</span>, PostConstruct, PreDestroy {
    <span class="annotation">@Inject</span>
    <span class="predefined-type">Logger</span> logger;
    ...
    public <span class="type">void</span> postConstruct() {
        logger.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Starting up.</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="type">void</span> preDestroy() {
        logger.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Shutting down.</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inversion-of-control"><a class="anchor" href="#inversion-of-control"></a>Inversion of Control</h3>
<div class="paragraph">
<p>Inversion of control (IoC) refers to a style of software architecture
where the behavior of a system is determined by the runtime capabilities
of the individual, discrete components that make up the system. This
architecture is different from traditional styles of software
architecture, where all the components of a system are specified at
design-time. With IoC, discrete components respond to high-level events
to perform actions. While performing these actions, the components
typically rely on other components to provide other actions. In an IoC
system, components use injection to gain access to other components.</p>
</div>
<div class="sect3">
<h4 id="injecting-hk2-components"><a class="anchor" href="#injecting-hk2-components"></a>Injecting HK2 Components</h4>
<div class="paragraph">
<p>Services usually rely on other services to perform their tasks. The HK2
runtime identifies the <code>@Contract</code> implementations required by a service
by using the
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Inject.html"><code>org.jvnet.hk2.annotations.Inject</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Inject.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Inject.html</a></code>)
annotation. <code>Inject</code> can be placed on fields or setter methods of any
service instantiated by the HK2 runtime. The target service is retrieved
and injected during the calling service&#8217;s instantiation by the component
manager.</p>
</div>
<div class="paragraph">
<p>The following example shows how to use <code>@Inject</code> at the field level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
ConfigService config;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to use <code>@Inject</code> at the setter level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
<span class="directive">public</span> <span class="type">void</span> set(ConfigService svc) {...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Injection can further qualify the intended injected service
implementation by using a name and scope from which the service should
be available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>(Scope=Singleton.class, name=<span class="string"><span class="delimiter">&quot;</span><span class="content">deploy</span><span class="delimiter">&quot;</span></span>)
AdminCommand deployCommand;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="instantiation-cascading-in-hk2"><a class="anchor" href="#instantiation-cascading-in-hk2"></a>Instantiation Cascading in HK2</h4>
<div class="paragraph">
<p>Injection of instances that have not been already instantiated triggers
more instantiation. You can see this as a component instantiation
cascade where some code requests for a high-level service will, by using
the <code>@Inject</code> annotation, require more injection and instantiation of
lower level services. This cascading feature keeps the implementation as
private as possible while relying on interfaces and the separation of
contracts and providers.</p>
</div>
<div id="ghquz" class="paragraph">
<p>Example 2-2 Example of Instantiation Cascading</p>
</div>
<div class="paragraph">
<p>The following example shows how the instantiation of <code>DeploymentService</code>
as a <code>Startup</code> contract implementation will trigger the instantiation of
the <code>ConfigService</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Contract</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Startup</span> {...}

<span class="predefined-type">Iterable</span>&lt;Startup&gt; startups;
startups = habitat.getComponents(Startup.class);

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DeploymentService</span> <span class="directive">implements</span> Startup {
    <span class="annotation">@Inject</span>
    ConfigService config;
}

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="predefined-type">Class</span> ConfigService <span class="directive">implements</span> ... {...}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="identifying-a-class-as-an-add-on-component"><a class="anchor" href="#identifying-a-class-as-an-add-on-component"></a>Identifying a Class as an Add-On Component</h3>
<div class="paragraph">
<p>Eclipse GlassFish discovers add-on components by identifying Java
programming language classes that are annotated with the
<code>org.jvnet.hk2.annotation.Service</code> annotation.</p>
</div>
<div class="paragraph">
<p>To identify a class as an implementation of an Eclipse GlassFish service,
add the <code>org.jvnet.hk2.annotations.Service</code> annotation at the
class-definition level of your Java programming language class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SamplePlugin</span> <span class="directive">implements</span> ConsoleProvider {
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Service</code> annotation has the following elements. All elements are
optional.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>name</code></dt>
<dd>
<p>The name of the service. The default value is an empty string.</p>
</dd>
<dt class="hdlist1"><code>scope</code></dt>
<dd>
<p>The scope to which this service implementation is tied. The default
value is <code>org.glassfish.hk2.scopes.PerLookup.class</code>.</p>
</dd>
<dt class="hdlist1"><code>factory</code></dt>
<dd>
<p>The factory class for the service implementation, if the service is
created by a factory class rather than by calling the default
constructor. If this element is specified, the factory component is
activated, and <code>Factory.getObject</code> is used instead of the default
constructor. The default value of the <code>factory</code> element is
<code>org.jvnet.hk2.component.Factory.class</code>.</p>
</dd>
</dl>
</div>
<div id="ghoip" class="paragraph">
<p>Example 2-3 Example of the Optional Elements of the <code>@Service</code> Annotation</p>
</div>
<div class="paragraph">
<p>The following example shows how to use the optional elements of the
<code>@Service</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span> (name=<span class="string"><span class="delimiter">&quot;</span><span class="content">MyService</span><span class="delimiter">&quot;</span></span>,
    scope=com.example.PerRequest.class,
    factory=com.example.MyCustomFactory)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SamplePlugin</span> <span class="directive">implements</span> ConsoleProvider {
...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-the-apache-maven-build-system-to-develop-hk2-components"><a class="anchor" href="#using-the-apache-maven-build-system-to-develop-hk2-components"></a>Using the Apache Maven Build System to Develop HK2 Components</h3>
<div class="paragraph">
<p>If you are using Maven 2 to build HK2 components, invoke the
<code>auto-depends</code> plug-in for Maven so that the <code>META-INF/services</code> files
are generated automatically during build time.</p>
</div>
<div id="ghqsa" class="paragraph">
<p>Example 2-4 Example of the Maven Plug-In Configuration</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.glassfish.hk2<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>hk2-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;includes&gt;</span>
            <span class="tag">&lt;include&gt;</span>com/example/**<span class="tag">&lt;/include&gt;</span>
        <span class="tag">&lt;/includes&gt;</span>
    <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div id="ghoik" class="paragraph">
<p>Example 2-5 Example of <code>META-INF/services</code> File Generation</p>
</div>
<div class="paragraph">
<p>This example shows how to use
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Contract.html"><code>@Contract</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Contract.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Contract.html</a></code>)
and
<a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Service.html"><code>@Service</code></a>
(<code><a href="http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Service.html" class="bare">http://hk2.java.net/auto-depends/apidocs/org/jvnet/hk2/annotations/Service.html</a></code>)
and the resulting <code>META-INF/services</code> files.</p>
</div>
<div class="paragraph">
<p>The interfaces and classes in this example are as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.wallaby.annotations</span>;
<span class="annotation">@Contract</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Startup</span> {...}

<span class="keyword">package</span> <span class="namespace">com.example.wombat</span>;
<span class="annotation">@Contract</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">RandomContract</span> {...}

<span class="keyword">package</span> <span class="namespace">com.example.wallaby</span>;
<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyService</span> <span class="directive">implements</span> Startup, RandomContract, <span class="predefined-type">PropertyChangeListener</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These interfaces and classes generate this <code>META-INF/services</code> file with
the <code>MyService</code> content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>com.example.wallaby.annotations.Startup
com.example.wombat.RandomContract</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extending-the-administration-console-2"><a class="anchor" href="#extending-the-administration-console-2"></a>Extending the Administration Console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Administration Console is a browser-based tool for administering
Eclipse GlassFish. It features an easy-to-navigate interface and online
help. Extending the Administration Console enables you to provide a
graphical user interface for administering your add-on component. You
can use any of the user interface features of the Administration
Console, such as tree nodes, links on the Common Tasks page, tabs and
sub-tabs, property sheets, and Jakarta Server Faces pages. Your add-on
component implements a marker interface and provides a configuration
file that describes how your customizations integrate with the
Administration Console.</p>
</div>
<div class="paragraph">
<p>This chapter refers to a simple example called <code>console-sample-ip</code> that
illustrates how to provide Administration Console features for a
hypothetical add-on component.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#administration-console-architecture">Administration Console Architecture</a></p>
</li>
<li>
<p><a href="#about-administration-console-templates">About Administration Console Templates</a></p>
</li>
<li>
<p><a href="#about-integration-points">About Integration Points</a></p>
</li>
<li>
<p><a href="#specifying-the-id-of-an-add-on-component">Specifying the ID of an Add-On Component</a></p>
</li>
<li>
<p><a href="#adding-functionality-to-the-administration-console">Adding Functionality to the Administration Console</a></p>
</li>
<li>
<p><a href="#adding-internationalization-support">Adding Internationalization Support</a></p>
</li>
<li>
<p><a href="#changing-the-theme-or-brand-of-the-administration-console">Changing the Theme or Brand of the Administration Console</a></p>
</li>
<li>
<p><a href="#creating-an-integration-point-type">Creating an Integration Point Type</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="administration-console-architecture"><a class="anchor" href="#administration-console-architecture"></a>Administration Console Architecture</h3>
<div class="paragraph">
<p>The Administration Console is a web application that is composed of OSGi
bundles. These bundles provide all the features of the Administration
Console, such as the Web Applications, Update Center, and Security
content. To provide support for your add-on component, create your own
OSGi bundle that implements the parts of the user interface that you
need. Place your bundle in the <code>modules</code> directory of your Eclipse GlassFish installation,
along with the other Administration Console bundles.</p>
</div>
<div class="paragraph">
<p>To learn how to package the Administration Console features for an
add-on component, go to the <code>modules</code> directory of your Eclipse GlassFish
installation and examine the contents of the files named
<code>console-</code>componentname<code>-plugin.jar</code>. Place the <code>console-sample-ip</code>
project bundle in the same place to deploy it and examine the changes
that it makes to the Administration Console.</p>
</div>
<div class="paragraph">
<p>The Administration Console includes a Console Add-On Component Service.
The Console Add-On Component Service is an HK2 service that acts as a
façade to all theAdministration Console add-on components. The Console
Add-On Component Service queries the various console providers for
integration points so that it can perform the actions needed for the
integration (adding a tree node or a new tab, for example). The
interface name for this service is
<code>org.glassfish.api.admingui.ConsolePluginService</code>.</p>
</div>
<div class="paragraph">
<p>For details about the Hundred-Kilobyte Kernel (HK2) project, see
<a href="#hundred-kilobyte-kernel">Hundred-Kilobyte Kernel</a> and
<a href="#hk2-component-model">HK2 Component Model</a>.</p>
</div>
<div class="paragraph">
<p>Each add-on component must contain a console provider implementation.
This is a Java class that implements the
<code>org.glassfish.api.admingui.ConsoleProvider</code> interface and uses the HK2
<code>@Service</code> annotation. The console provider allows your add-on component
to specify where your integration point configuration file is located.
This configuration file communicates to the Console Add-On Component
Service the customizations that your add-on component makes to the
Administration Console.</p>
</div>
<div class="sect3">
<h4 id="implementing-a-console-provider"><a class="anchor" href="#implementing-a-console-provider"></a>Implementing a Console Provider</h4>
<div class="paragraph">
<p>The <code>org.glassfish.api.admingui.ConsoleProvider</code> interface has one
required method, <code>getConfiguration</code>. The <code>getConfiguration</code> method
returns the location of the <code>console-config.xml</code> file as a
<code>java.net.URL</code>. If <code>getConfiguration</code> returns <code>null</code>, the default
location, <code>META-INF/admingui/console-config.xml</code>, is used. The
<code>console-config.xml</code> file is described in <a href="#about-integration-points">About Integration
Points</a>.</p>
</div>
<div class="paragraph">
<p>To implement the console provider for your add-on component, write a
Java class that is similar to the following example.</p>
</div>
<div id="ghosz" class="paragraph">
<p>Example 3-1 Example <code>ConsoleProvider</code> Implementation</p>
</div>
<div class="paragraph">
<p>This example shows a simple implementation of the <code>ConsoleProvider</code>
interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.admingui.plugin</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.admingui.ConsoleProvider</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;

<span class="keyword">import</span> <span class="include">java.net.URL</span>;

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SamplePlugin</span> <span class="directive">implements</span> ConsoleProvider {

    <span class="directive">public</span> <span class="predefined-type">URL</span> getConfiguration() { <span class="keyword">return</span> <span class="predefined-constant">null</span>; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This implementation of <code>getConfiguration</code> returns null to specify that
the configuration file is in the default location. If you place the file
in a nonstandard location or give it a name other than
<code>console-config.xml</code>, your implementation of <code>getConfiguration</code> must
return the URL where the file can be found.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="about-administration-console-templates"><a class="anchor" href="#about-administration-console-templates"></a>About Administration Console Templates</h3>
<div class="paragraph">
<p>Eclipse GlassFish includes a set of templates that make it easier to
create Jakarta Server Faces pages for your add-on component. These templates
use Templating for Jakarta Server Faces Technology, which is also known as
JSFTemplating.</p>
</div>
<div class="paragraph">
<p>Examples of JSFTemplating technology can be found in the following
sections of this chapter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#creating-a-javaserver-faces-page-for-your-node">Creating a Jakarta Server Faces Page for Your Node</a></p>
</li>
<li>
<p><a href="#creating-javaserver-faces-pages-for-your-tabs">Creating Jakarta Server Faces Pages for Your Tabs</a></p>
</li>
<li>
<p><a href="#creating-a-javaserver-faces-page-for-your-task">Creating a Jakarta Server Faces Page for Your Task</a></p>
</li>
<li>
<p><a href="#creating-a-javaserver-faces-page-for-your-task-group">Creating a Jakarta Server Faces Page for Your Task Group</a></p>
</li>
<li>
<p><a href="#creating-a-javaserver-faces-page-for-your-page-content">Creating a Jakarta Server Faces Page for Your Page Content</a></p>
</li>
<li>
<p><a href="#adding-a-page-to-the-administration-console">Adding a Page to the Administration Console</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="about-integration-points"><a class="anchor" href="#about-integration-points"></a>About Integration Points</h3>
<div class="paragraph">
<p>The integration points for your add-on component are the individual
Administration Console user interface features that your add-on
component will extend. You can implement the following kinds of
integration points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nodes in the navigation tree</p>
</li>
<li>
<p>Elements on the Common Tasks page of the Administration Console</p>
</li>
<li>
<p>Jakarta Server Faces pages</p>
</li>
<li>
<p>Tabs and sub-tabs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Specify all the integration points in a file named <code>console-config.xml</code>.
In the example, this file is in the directory
<code>project/src/main/resources/META-INF/admingui/</code>. The following sections
describe how to create this file.</p>
</div>
<div class="paragraph">
<p>In addition, create Jakarta Server Faces pages that contain JSF code
fragments to implement the integration points. In the example, these
files are in the directory <code>project/src/main/resources/</code>. The content of
these files depends on the integration point you are implementing. The
following sections describe how to create these JavaServer Faces pages.</p>
</div>
<div class="paragraph">
<p>For reference information on integration points, see
<a href="#a-integration-point-reference">Integration Point Reference</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="specifying-the-id-of-an-add-on-component"><a class="anchor" href="#specifying-the-id-of-an-add-on-component"></a>Specifying the ID of an Add-On Component</h3>
<div class="paragraph">
<p>The <code>console-config.xml</code> file consists of a <code>console-config</code> element
that encloses a series of <code>integration-point</code> elements. The
<code>console-config</code> element has one attribute, <code>id</code>, which specifies a
unique name or ID value for the add-on component.</p>
</div>
<div class="paragraph">
<p>In the example, the element is declared as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;console-config</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sample</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    ...
<span class="tag">&lt;/console-config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You will also specify this ID value when you construct URLs to images,
resources and pages in your add-on component. See <a href="#adding-a-node-to-the-navigation-tree">Adding a
Node to the Navigation Tree</a> for an example.</p>
</div>
<div class="paragraph">
<p>For example, a URL to an image named <code>my.gif</code> might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:image</span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/resource/sample/images/my.gif</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The URL is constructed as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/resource</code> is required to locate any resource URL.</p>
</li>
<li>
<p><code>sample</code> is the add-on component ID. You must choose a unique ID
value.</p>
</li>
<li>
<p><code>images</code> is a folder under the root of the add-on component JAR file.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-functionality-to-the-administration-console"><a class="anchor" href="#adding-functionality-to-the-administration-console"></a>Adding Functionality to the Administration Console</h3>
<div class="paragraph">
<p>The <code>integration-point</code> elements in the <code>console-config.xml</code> file
specify attributes for the user interface features that you choose to
implement. The example file provides examples of most of the available
kinds of integration points at this release. Your own add-on component
can use some or all of them.</p>
</div>
<div class="paragraph">
<p>For each <code>integration-point</code> element, specify the following attributes.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>An identifier for the integration point.</p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>The ID of the integration point&#8217;s parent.</p>
</dd>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p>The type of the integration point.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of integration
points for add-on components that specify the same <code>parentId</code>. A lower
number specifies a higher priority (for example, 100 represents a
higher priority than 400). The integration points for add-on
components are always placed after those in the basic Administration
Console. You might need to experiment to place the integration point
where you want it. This attribute is optional.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>The content for the integration point, typically a JavaServer Faces
page. In the example, you can find the JavaServer Faces pages in the
directory <code>project/src/main/resources/</code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The order in which these attributes are specified does not matter, and
in the example <code>console-config.xml</code> file the order varies. To improve
readability, this chapter uses the same order throughout.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#adding-a-node-to-the-navigation-tree">Adding a Node to the Navigation Tree</a></p>
</li>
<li>
<p><a href="#adding-tabs-to-a-page">Adding Tabs to a Page</a></p>
</li>
<li>
<p><a href="#adding-a-task-to-the-common-tasks-page">Adding a Task to the Common Tasks Page</a></p>
</li>
<li>
<p><a href="#adding-a-task-group-to-the-common-tasks-page">Adding a Task Group to the Common Tasks Page</a></p>
</li>
<li>
<p><a href="#adding-content-to-a-page">Adding Content to a Page</a></p>
</li>
<li>
<p><a href="#adding-a-page-to-the-administration-console">Adding a Page to the Administration Console</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="adding-a-node-to-the-navigation-tree"><a class="anchor" href="#adding-a-node-to-the-navigation-tree"></a>Adding a Node to the Navigation Tree</h4>
<div class="paragraph">
<p>You can add a node to the navigation tree, either at the top level or
under another node. To add a node, use an integration point of type
<code>org.glassfish.admingui:navNode</code>. Use the <code>parentId</code> attribute to
specify where the new node should be placed. Any tree node, including
those added by other add-on components, can be specified. Examples
include the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>tree</code></dt>
<dd>
<p>At the top level</p>
</dd>
<dt class="hdlist1"><code>applicationServer</code></dt>
<dd>
<p>Under the Eclipse GlassFish node</p>
</dd>
<dt class="hdlist1"><code>applications</code></dt>
<dd>
<p>Under the Applications node</p>
</dd>
<dt class="hdlist1"><code>resources</code></dt>
<dd>
<p>Under the Resources node</p>
</dd>
<dt class="hdlist1"><code>configuration</code></dt>
<dd>
<p>Under the Configuration node</p>
</dd>
<dt class="hdlist1"><code>webContainer</code></dt>
<dd>
<p>Under the Web Container node</p>
</dd>
<dt class="hdlist1"><code>httpService</code></dt>
<dd>
<p>Under the HTTP Service node</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>webContainer</code> and <code>httpService</code> nodes are available only if you
installed the web container module for the Administration Console (the
<code>console-web-gui.jar</code> OSGi bundle).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you do not specify a <code>parentId</code>, the new content is added to the root
of the integration point, in this case the top level node, <code>tree</code>.</p>
</div>
<div id="ghpmb" class="paragraph">
<p>Example 3-2 Example Tree Node Integration Point</p>
</div>
<div class="paragraph">
<p>For example, the following <code>integration-point</code> element uses a <code>parentId</code>
of <code>tree</code> to place the new node at the top level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;integration-point</span>
                <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">samplenode</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">tree</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:treeNode</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleNode.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example specifies the following values in addition to the
<code>parentId</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>id</code> value, <code>sampleNode</code>, specifies the integration point ID.</p>
</li>
<li>
<p>The <code>type</code> value, <code>org.glassfish.admingui:treeNode</code>, specifies the
integration point type as a tree node.</p>
</li>
<li>
<p>The <code>priority</code> value, <code>200</code>, specifies the order of the node on the
tree.</p>
</li>
<li>
<p>The <code>content</code> value, <code>sampleNode.jsf</code>, specifies the JavaServer Faces
page that displays the node.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The example <code>console-config.xml</code> file provides other examples of tree
nodes under the Resources and Configuration nodes.</p>
</div>
<div class="sect4">
<h5 id="creating-a-javaserver-faces-page-for-your-node"><a class="anchor" href="#creating-a-javaserver-faces-page-for-your-node"></a>Creating a Jakarta Server Faces Page for Your Node</h5>
<div class="paragraph">
<p>A Jakarta Server Faces page for a tree node uses the tag <code>sun:treeNode</code>.
This tag provides all the capabilities of the Project Woodstock tag
<code>webuijsf:treeNode</code>.</p>
</div>
<div id="ghpmn" class="paragraph">
<p>Example 3-3 Example Jakarta Server Faces Page for a Tree Node</p>
</div>
<div class="paragraph">
<p>In the example, the <code>sampleNode.jsf</code> file has the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:treeNode</span>
        <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">treenode1</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SampleTop</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/sample/page/testPage.jsf?name=SampleTop</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">imageURL</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/resource/sample/images/sample.png</span><span class="delimiter">&quot;</span></span>
       <span class="tag">&gt;</span>
    <span class="tag">&lt;sun:treeNode</span>
            <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">treenodebb</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SampleBB</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/sample/page/testPage.jsf?name=SampleBB</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">imageURL</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">resource/sample/images/sample.png</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/sun:treeNode&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This file uses the <code>sun:treenode</code> tag to specify both a top-level tree
node and another node nested beneath it. In your own JavaServer Faces
pages, specify the attributes of this tag as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>A unique identifier for the tree node.</p>
</dd>
<dt class="hdlist1"><code>text</code></dt>
<dd>
<p>The node name that appears in the tree.</p>
</dd>
<dt class="hdlist1"><code>url</code></dt>
<dd>
<p>The location of the JavaServer Faces page that appears when you click
the node. In the example, most of the integration points use a very
simple Jakarta Server Faces page called <code>testPage.jsf</code>, which is in the
<code>src/main/resources/page/</code> directory. Specify the integration point
<code>id</code> value as the root of the URL; in this case, it is <code>sample</code> (see
<a href="#specifying-the-id-of-an-add-on-component">Specifying the ID of an Add-On Component</a>). The rest of
the URL is relative to the <code>src/main/resources/</code> directory, where
<code>sampleNode.jsf</code> resides.
The <code>url</code> tag in this example passes a <code>name</code> parameter to the
Jakarta Server Faces page.</p>
</dd>
<dt class="hdlist1"><code>imageURL</code></dt>
<dd>
<p>The location of a graphic to display next to the node name. In the
example, the graphic is always <code>sample.png</code>, which is in the
<code>src/main/resources/images/</code> directory. The URL for this image is an
absolute path, <code>/resource/`sample</code>/images/sample.png`, where sample in
the path is the integration point <code>id</code> value (see
<a href="#specifying-the-id-of-an-add-on-component">Specifying the ID of an Add-On Component</a>).</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-tabs-to-a-page"><a class="anchor" href="#adding-tabs-to-a-page"></a>Adding Tabs to a Page</h4>
<div class="paragraph">
<p>You can add a tab to an existing tab set, or you can create a tab set
for your own page. One way to add a tab or tab set is to use an
integration point of type <code>org.glassfish.admingui:serverInstTab</code>, which
adds a tab to the tab set on the main Eclipse GlassFish page of the
Administration Console. You can also create sub-tabs. Once again, the
<code>parentId</code> element specifies where to place the tab or tab set.</p>
</div>
<div id="ghplc" class="paragraph">
<p>Example 3-4 Example Tab Integration Point</p>
</div>
<div class="paragraph">
<p>In the example, the following <code>integration-point</code> element adds a new tab
on the main Eclipse GlassFish page of the Administration Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;integration-point</span>
            <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampletab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">serverinsttabs</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:serverInstTab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">500</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleTab.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example specifies the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>id</code> value, <code>sampleTab</code>, specifies the integration point ID.</p>
</li>
<li>
<p>The <code>parentId</code> value, <code>serverInstTabs</code>, specifies the tab set
associated with the server instance. The Eclipse GlassFish page is the
only one of the default Administration Console pages that has a tab set.</p>
</li>
<li>
<p>The <code>type</code> value, <code>org.glassfish.admingui:serverInstTab</code>, specifies
the integration point type as a tab associated with the server instance.</p>
</li>
<li>
<p>The <code>priority</code> value, <code>500</code>, specifies the order of the tab within the
tab set. This value is optional.</p>
</li>
<li>
<p>The <code>content</code> value, <code>sampleTab.jsf</code>, specifies the Jakarta Server Faces
page that displays the tab.</p>
</li>
</ul>
</div>
<div id="ghplu" class="paragraph">
<p>Example 3-5 Example Tab Set Integration Points</p>
</div>
<div class="paragraph">
<p>The following <code>integration-point</code> elements add a new tab with two
sub-tabs, also on the main Eclipse GlassFish page of the Administration
Console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;integration-point</span>
            <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampletabwithsubtab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">serverinsttabs</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:serverInstTab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">300</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleTabWithSubTab.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span>
        <span class="tag">&lt;integration-point</span>
            <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">samplesubtab1</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampletabwithsubtab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:serverInstTab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">300</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleSubTab1.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span>
        <span class="tag">&lt;integration-point</span>
            <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">samplesubtab2</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampletabwithsubtab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:serverInstTab</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">400</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleSubTab2.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These examples specify the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>id</code> values, <code>sampleTabWithSubTab</code>, <code>sampleSubTab1</code>, and
<code>sampleSubTab2</code>, specify the integration point IDs for the tab and its
sub-tabs.</p>
</li>
<li>
<p>The <code>parentId</code> of the new tab, <code>serverInstTabs</code>, specifies the tab set
associated with the server instance. The <code>parentId</code> of the two sub-tabs,
<code>sampleTabWithSubTab</code>, is the <code>id</code> value of this new tab.</p>
</li>
<li>
<p>The <code>type</code> value, <code>org.glassfish.admingui:serverInstTab</code>, specifies
the integration point type for all the tabs as a tab associated with the
server instance.</p>
</li>
<li>
<p>The <code>priority</code> values specify the order of the tabs within the tab
set. This value is optional. In this case, the priority value for
<code>sampleTabWithSubTab</code> is <code>300</code>, which is higher than the value for
<code>sampleTab</code>. That means that <code>sampleTabWithSubTab</code> appears to the left
of <code>sampleTab</code> in the Administration Console. The priority values for
<code>sampleSubTab1</code> and <code>sampleSubTab2</code> are <code>300</code> and <code>400</code> respectively, so
<code>sampleSubTab1</code> appears to the left of <code>sampleSubTab2</code>.</p>
</li>
<li>
<p>The <code>content</code> values, <code>sampleTabWithSubTab.jsf</code>, <code>sampleSubTab1.jsf</code>,
and <code>sampleSubTab2.jsf</code>, specify the Jakarta Server Faces pages that display
the tabs.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="creating-javaserver-faces-pages-for-your-tabs"><a class="anchor" href="#creating-javaserver-faces-pages-for-your-tabs"></a>Creating Jakarta Server Faces Pages for Your Tabs</h5>
<div class="paragraph">
<p>A Jakarta Server Faces page for a tab uses the tag <code>sun:tab</code>. This tag
provides all the capabilities of the Project Woodstock tag
<code>webuijsf:tab</code>.</p>
</div>
<div id="ghpnt" class="paragraph">
<p>Example 3-6 Example Jakarta Server Faces Page for a Tab</p>
</div>
<div class="paragraph">
<p>In the example, the <code>sampleTab.jsf</code> file has the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:tab</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampletab</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">immediate</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample First Tab</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="doctype">&lt;!command
        setSessionAttribute(key=&quot;serverInstTabs&quot; value=&quot;sampleTab&quot;);
        gf.redirect(page=&quot;#{request.contextPath}/page/tabPage.jsf?name=Sample%20First%20Tab&quot;);
    /&gt;</span>
<span class="tag">&lt;/sun:tab&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the actual file there are no line breaks in the <code>gf.redirect</code> value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In your own Jakarta Server Faces pages, specify the attributes of this tag
as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>A unique identifier for the tab, in this case <code>sampleTab</code>.</p>
</dd>
<dt class="hdlist1"><code>immediate</code></dt>
<dd>
<p>If set to true, event handling for this component should be handled
immediately (in the Apply Request Values phase) rather than waiting
until the Invoke Application phase.</p>
</dd>
<dt class="hdlist1"><code>text</code></dt>
<dd>
<p>The tab name that appears in the tab set.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The JSF page displays tab content differently from the way the page for
a node displays node content. It invokes two handlers for the <code>command</code>
event: <code>setSessionAttribute</code> and <code>gf.redirect</code>. The <code>gf.redirect</code>
handler has the same effect for a tab that the <code>url</code> attribute has for a
node. It navigates to a simple Jakarta Server Faces page called
<code>tabPage.jsf</code>, in the <code>src/main/resources/page/</code> directory, passing the
text "Sample First Tab" to the page in a <code>name</code> parameter.</p>
</div>
<div class="paragraph">
<p>The <code>sampleSubTab1.jsf</code> and <code>sampleSubTab2.jsf</code> files are almost
identical to <code>sampleTab.jsf</code>. The most important difference is that each
sets the session attribute <code>serverInstTabs</code> to the base name of the
Jakarta Server Faces file that corresponds to that tab:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>setSessionAttribute(key=&quot;serverInstTabs&quot; value=&quot;sampleTab&quot;);
setSessionAttribute(key=&quot;serverInstTabs&quot; value=&quot;sampleSubTab1&quot;);
setSessionAttribute(key=&quot;serverInstTabs&quot; value=&quot;sampleSubTab2&quot;);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-task-to-the-common-tasks-page"><a class="anchor" href="#adding-a-task-to-the-common-tasks-page"></a>Adding a Task to the Common Tasks Page</h4>
<div class="paragraph">
<p>You can add either a single task or a group of tasks to the Common Tasks
page of the Administration Console. To add a task or task group, use an
integration point of type <code>org.glassfish.admingui:commonTask</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="#adding-a-task-group-to-the-common-tasks-page">Adding a Task Group to the Common Tasks Page</a> for
information on adding a task group.</p>
</div>
<div id="ghpox" class="paragraph">
<p>Example 3-7 Example Task Integration Point</p>
</div>
<div class="paragraph">
<p>In the example <code>console-config.xml</code> file, the following
<code>integration-point</code> element adds a task to the Deployment task group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;integration-point</span>
                <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">samplecommontask</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">deployment</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:commonTask</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleCommonTask.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example specifies the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>id</code> value, <code>sampleCommonTask</code>, specifies the integration point ID.</p>
</li>
<li>
<p>The <code>parentId</code> value, <code>deployment</code>, specifies that the task is to be
placed in the Deployment task group.</p>
</li>
<li>
<p>The <code>type</code> value, <code>org.glassfish.admingui:commonTask</code>, specifies the
integration point type as a common task.</p>
</li>
<li>
<p>The <code>priority</code> value, <code>200</code>, specifies the order of the task within
the task group.</p>
</li>
<li>
<p>The <code>content</code> value, <code>sampleCommonTask.jsf</code>, specifies the JavaServer
Faces page that displays the task.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="creating-a-javaserver-faces-page-for-your-task"><a class="anchor" href="#creating-a-javaserver-faces-page-for-your-task"></a>Creating a Jakarta Server Faces Page for Your Task</h5>
<div class="paragraph">
<p>A Jakarta Server Faces page for a task uses the tag <code>sun:commonTask</code>.
This tag provides all the capabilities of the Project Woodstock tag <code>webuijsf:commonTask</code>.</p>
</div>
<div id="gjkgd" class="paragraph">
<p>Example 3-8 Example Jakarta Server Faces Page for a Task</p>
</div>
<div class="paragraph">
<p>In the example, the <code>sampleCommonTask.jsf</code> file has the following
content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:commonTask</span>
        <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample Application Page</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">toolTip</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample Application Page</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">onClick</span>=<span class="string"><span class="delimiter">&quot;</span><span class="keyword">return</span> admingui.woodstock.commonTaskHandler(<span class="string"><span class="delimiter">'</span><span class="content">treeForm:tree:applications:ejb</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">#{request.contextPath}/sample/page/testPage.jsf?name=Sample%20Application%20Page</span><span class="delimiter">'</span></span>);<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;/sun:commonTask&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the actual file, there is no line break in the <code>onClick</code> attribute value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This file uses the <code>sun:commonTask</code> tag to specify the task. In your own
Jakarta Server Faces pages, specify the attributes of this tag as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>text</code></dt>
<dd>
<p>The task name that appears on the Common Tasks page.</p>
</dd>
<dt class="hdlist1"><code>toolTip</code></dt>
<dd>
<p>The text that appears when a user places the mouse cursor over the
task name.</p>
</dd>
<dt class="hdlist1"><code>onClick</code></dt>
<dd>
<p>Scripting code that is to be executed when a user clicks the task
name.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-task-group-to-the-common-tasks-page"><a class="anchor" href="#adding-a-task-group-to-the-common-tasks-page"></a>Adding a Task Group to the Common Tasks Page</h4>
<div class="paragraph">
<p>You can add a new group of tasks to the Common Tasks page to display the
most important tasks for your add-on component. To add a task group, use
an integration point of type <code>org.glassfish.admingui:commonTask</code>.</p>
</div>
<div id="ghplk" class="paragraph">
<p>Example 3-9 Example Task Group Integration Point</p>
</div>
<div class="paragraph">
<p>In the example <code>console-config.xml</code> file, the following
<code>integration-point</code> element adds a new task group to the Common Tasks
page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">       <span class="tag">&lt;integration-point</span>
            <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">samplegroup</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">commontaskssection</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:commonTask</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">500</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleTaskGroup.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example specifies the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>id</code> value, <code>sampleGroup</code>, specifies the integration point ID.</p>
</li>
<li>
<p>The <code>parentId</code> value, <code>commonTasksSection</code>, specifies that the task
group is to be placed on the Common Tasks page.</p>
</li>
<li>
<p>The <code>type</code> value, <code>org.glassfish.admingui:commonTask</code>, specifies the
integration point type as a common task.</p>
</li>
<li>
<p>The <code>priority</code> value, <code>500</code>, specifies the order of the task group on
the Common Tasks page. The low value places it at the end of the page.</p>
</li>
<li>
<p>The <code>content</code> value, <code>sampleTaskGroup.jsf</code>, specifies the JavaServer
Faces page that displays the task.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="creating-a-javaserver-faces-page-for-your-task-group"><a class="anchor" href="#creating-a-javaserver-faces-page-for-your-task-group"></a>Creating a Jakarta Server Faces Page for Your Task Group</h5>
<div class="paragraph">
<p>A Jakarta Server Faces page for a task group uses the tag
<code>sun:commonTasksGroup</code>. This tag provides all the capabilities of the
Project Woodstock tag <code>webuijsf:commonTasksGroup</code>.</p>
</div>
<div id="ghpqe" class="paragraph">
<p>Example 3-10 Example Jakarta Server Faces Page for a Task Group</p>
</div>
<div class="paragraph">
<p>In the example, the <code>sampleTaskGroup.jsf</code> file has the following
content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:commonTasksGroup</span> <span class="attribute-name">title</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">My Own Sample Group</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;sun:commonTask</span>
            <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Go To Sample Resource</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">toolTip</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Go To Sample Resource</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">onClick</span>=<span class="string"><span class="delimiter">&quot;</span><span class="keyword">return</span> admingui.woodstock.commonTaskHandler(<span class="string"><span class="delimiter">'</span><span class="content">form:tree:resources:treeNode1</span><span class="delimiter">'</span></span>,
            <span class="string"><span class="delimiter">'</span><span class="content">#{request.contextPath}/sample/page/testPage.jsf?name=Sample%20Resource%20Page</span><span class="delimiter">'</span></span>);<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;/sun:commonTask&gt;</span>
    <span class="tag">&lt;sun:commonTask</span>
            <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample Configuration</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">toolTip</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Go To Sample Configuration</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">onClick</span>=<span class="string"><span class="delimiter">&quot;</span><span class="keyword">return</span> admingui.woodstock.commonTaskHandler(<span class="string"><span class="delimiter">'</span><span class="content">form:tree:configuration:sampleConfigNode</span><span class="delimiter">'</span></span>,
            <span class="string"><span class="delimiter">'</span><span class="content">#{request.contextPath}/sample/page/testPage.jsf?name=Sample%20Configuration%20Page</span><span class="delimiter">'</span></span>);<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;/sun:commonTask&gt;</span>
<span class="tag">&lt;/sun:commonTasksGroup&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the actual file, there are no line breaks in the <code>onClick</code> attribute values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This file uses the <code>sun:commonTasksGroup</code> tag to specify the task group,
and two <code>sun:commonTask</code> tags to specify the tasks in the task group.
The <code>sun:commonTasksGroup</code> tag has only one attribute, <code>title</code>, which
specifies the name of the task group.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-content-to-a-page"><a class="anchor" href="#adding-content-to-a-page"></a>Adding Content to a Page</h4>
<div class="paragraph">
<p>You can add content for your add-on component to an existing top-level
page, such as the Configuration page or the Resources page.
To add content to one of these pages, use an integration point of type
<code>org.glassfish.admingui:configuration</code> or <code>org.glassfish.admingui:resources</code>.</p>
</div>
<div id="ghpnu" class="paragraph">
<p>Example 3-11 Example Resources Page Implementation Point</p>
</div>
<div class="paragraph">
<p>In the example <code>console-config.xml</code> file, the following
<code>integration-point</code> element adds new content to the top-level Resources page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;integration-point</span>
                <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleresourcelink</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">parentid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">propsheetsection</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:resources</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">100</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampleResourceLink.jsf</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example specifies the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>id</code> value, <code>sampleResourceLink</code>, specifies the integration point ID.</p>
</li>
<li>
<p>The <code>parentId</code> value, <code>propSheetSection</code>, specifies that the content
is to be a section of a property sheet on the page.</p>
</li>
<li>
<p>The <code>type</code> value, <code>org.glassfish.admingui:resources</code>, specifies the
integration point type as the Resources page.</p>
<div class="paragraph">
<p>To add content to the Configuration page, specify the <code>type</code> value as
<code>org.glassfish.admingui:configuration</code>.</p>
</div>
</li>
<li>
<p>The <code>priority</code> value, <code>100</code>, specifies the order of the content on the
Resources page. The high value places it at the top of the page.</p>
</li>
<li>
<p>The <code>content</code> value, <code>sampleResourceLink.jsf</code>, specifies the
JavaServer Faces page that displays the new content on the Resources page.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Another <code>integration-point</code> element in the <code>console-config.xml</code> file
places similar content on the Configuration page.</p>
</div>
<div class="sect4">
<h5 id="creating-a-javaserver-faces-page-for-your-page-content"><a class="anchor" href="#creating-a-javaserver-faces-page-for-your-page-content"></a>Creating a Jakarta Server Faces Page for Your Page Content</h5>
<div class="paragraph">
<p>A Jakarta Server Faces page for page content often uses the tag
<code>sun:property</code> to specify a property on a property sheet. This tag
provides all the capabilities of the Project Woodstock tag
<code>webuijsf:property</code>.</p>
</div>
<div id="ghpoz" class="paragraph">
<p>Example 3-12 Example Jakarta Server Faces Page for a Resource Page Item</p>
</div>
<div class="paragraph">
<p>In the example, the <code>sampleResourceLink.jsf</code> file has the following
content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:property&gt;</span>
    <span class="tag">&lt;sun:hyperlink</span>
        <span class="attribute-name">toolTip</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample Resource</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/sample/page/testPage.jsf?name=Sample%20Resource%20Page</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;sun:image</span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/resource/sample/images/sample.png</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;sun:staticText</span> <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample Resource</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;/sun:hyperlink&gt;</span>
<span class="tag">&lt;/sun:property&gt;</span>

<span class="tag">&lt;sun:property&gt;</span>
    <span class="tag">&lt;sun:hyperlink</span>
        <span class="attribute-name">toolTip</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Another</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/sample/page/testPage.jsf?name=Another</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;sun:image</span> <span class="attribute-name">url</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/resource/sample/images/sample.png</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;sun:staticText</span> <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Another</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;/sun:hyperlink&gt;</span>
<span class="tag">&lt;/sun:property&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The file specifies two simple properties on the property sheet, one
above the other. Each consists of a <code>sun:hyperlink</code> element (a link to a
URL). Within each <code>sun:hyperlink</code> element is nested a <code>sun:image</code>
element, specifying an image, and a <code>sun:staticText</code> element, specifying
the text to be placed next to the image.</p>
</div>
<div class="paragraph">
<p>Each <code>sun:hyperlink</code> element uses a <code>toolTip</code> attribute and a <code>url</code>
attribute. Each <code>url</code> attribute references the <code>testPage.jsf</code> file that
is used elsewhere in the example, specifying different content for the
<code>name</code> parameter.</p>
</div>
<div class="paragraph">
<p>You can use many other kinds of user interface elements within a
<code>sun:property</code> element.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-page-to-the-administration-console"><a class="anchor" href="#adding-a-page-to-the-administration-console"></a>Adding a Page to the Administration Console</h4>
<div class="paragraph">
<p>Your add-on component may require new configuration tasks. In addition
to implementing commands that accomplish these tasks (see
<a href="#extending-the-asadmin-utility">Chapter 4, "Extending the <code>asadmin</code>
Utility"</a>), you can provide property sheets that enable users to
configure your component or to perform tasks such as creating and
editing resources for it.</p>
</div>
<div id="ghple" class="paragraph">
<p>Example 3-13 Example Jakarta Server Faces Page for a Property Sheet</p>
</div>
<div class="paragraph">
<p>Most of the user interface features used in the example reference the
file <code>testPage.jsf</code> or (for tabs) the file <code>tabPage.jsf</code>. Both files are
in the <code>src/main/resources/page/</code> directory. The <code>testPage.jsf</code> file
looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;!composition template=&quot;/templates/default.layout&quot; guiTitle=&quot;TEST Sample Page Title&quot;&gt;
&lt;!define name=&quot;content&quot;&gt;
&lt;sun:form id=&quot;propertyform&quot;&gt;

&lt;sun:propertySheet id=&quot;propertysheet&quot;&gt;
    &lt;sun:propertySheetSection id=&quot;propertysection&quot;&gt;
       &lt;sun:property id=&quot;prop1&quot; labelAlign=&quot;left&quot; noWrap=&quot;true&quot;
                     overlapLabel=&quot;false&quot; label=&quot;Test Page Name:&quot;&gt;
            &lt;sun:staticText text=&quot;$pageSession{pageName}&quot;&gt;
                &lt;!beforeCreate
                    getRequestValue(key=&quot;name&quot; value=&gt;$page{pageName});
                /&gt;
            &lt;/sun:staticText&gt;
        &lt;/sun:property&gt;
    &lt;/sun:propertySheetSection&gt;
&lt;/sun:propertySheet&gt;
&lt;sun:hidden id=&quot;helpkey&quot; value=&quot;&quot; /&gt;

&lt;/sun:form&gt;
&lt;/define&gt;
&lt;/composition&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The page uses the <code>composition</code> directive to specify that the page uses
the <code>default.layout</code> template and to specify a page title. The page uses
additional directives, events, and tags to specify its content.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-internationalization-support"><a class="anchor" href="#adding-internationalization-support"></a>Adding Internationalization Support</h3>
<div class="paragraph">
<p>To add internationalization support for your add-on component to the
Administration Console, you can place an event and handler like the
following at the top of your page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="doctype">&lt;!initPage
    setResourceBundle(key=&quot;yourI18NKey&quot; bundle=&quot;bundle.package.BundleName&quot;)
/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace the values <code>yourI18NKey</code> and <code>bundle.package.BundleName</code> with
appropriate values for your component.</p>
</div>
</div>
<div class="sect2">
<h3 id="changing-the-theme-or-brand-of-the-administration-console"><a class="anchor" href="#changing-the-theme-or-brand-of-the-administration-console"></a>Changing the Theme or Brand of the Administration Console</h3>
<div class="paragraph">
<p>To change the theme or brand of the Administration Console for your
add-on component, use the integration point type
<code>org.glassfish.admingui:customtheme</code>. This integration point affects the
Cascading Style Sheet (CSS) files and images that are used in the
Administration Console.</p>
</div>
<div id="ghpls" class="paragraph">
<p>Example 3-14 Example Custom Theme Integration Point</p>
</div>
<div class="paragraph">
<p>For example, the following integration point specifies a custom theme:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;integration-point</span>
                <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myownbrand</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:customtheme</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myOwnBrand.properties</span><span class="delimiter">&quot;</span></span>
        <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>priority</code> attribute works differently when you specify it in a
branding integration point from the way it works in other integration
points. You can place multiple branding add-on components in the
<code>modules</code> directory, but only one theme can be applied to the
Administration Console. The <code>priority</code> attribute determines which theme
is used. Specify a value from 1 to 100; the lower the number, the higher
the priority. The integration point with the highest priority will be
used.</p>
</div>
<div class="paragraph">
<p>Additional integration point types also affect the theme or brand of the
Administration Console:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.glassfish.admingui:masthead</code></dt>
<dd>
<p>Specifies the name and location of the include masthead file, which
can be customized with a branding image. This include file will be
integrated on the masthead of the Administration Console.</p>
</dd>
<dt class="hdlist1"><code>org.glassfish.admingui:loginimage</code></dt>
<dd>
<p>Specifies the name and location of the include file containing the
branding login image code that will be integrated with the login page
of the Administration Console.</p>
</dd>
<dt class="hdlist1"><code>org.glassfish.admingui:loginform</code></dt>
<dd>
<p>Specifies the name and location of the include file containing the
customized login form code. This code also contains the login
background image used for the login page for the Administration
Console.</p>
</dd>
<dt class="hdlist1"><code>org.glassfish.admingui:versioninfo</code></dt>
<dd>
<p>Specifies the name and location of the include file containing the
branding image that will be integrated with the content of the version
popup window.</p>
</dd>
</dl>
</div>
<div id="ghpla" class="paragraph">
<p>Example 3-15 Example of Branding Integration Points</p>
</div>
<div class="paragraph">
<p>For example, you might specify the following integration points. The
content for each integration point is defined in an include file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">       <span class="tag">&lt;integration-point</span>
               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myownbrandmast</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:masthead</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">branding/masthead.inc</span><span class="delimiter">&quot;</span></span>
       <span class="tag">/&gt;</span>
       <span class="tag">&lt;integration-point</span>
               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myownbrandlogimg</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:loginimage</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">branding/loginimage.inc</span><span class="delimiter">&quot;</span></span>
       <span class="tag">/&gt;</span>
       <span class="tag">&lt;integration-point</span>
               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myownbrandlogfm</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:loginform</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">branding/loginform.inc</span><span class="delimiter">&quot;</span></span>
       <span class="tag">/&gt;</span>
       <span class="tag">&lt;integration-point</span>
               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myownbrandversinf</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.admingui:versioninfo</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">priority</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">branding/versioninfo.inc</span><span class="delimiter">&quot;</span></span>
       <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To provide your own CSS and images to modify the global look and feel of
the entire application (not just the Administration Console), use the
theming feature of <a href="https://github.com/eclipse-ee4j/glassfish-woodstock">Project
Woodstock</a> (<code><a href="https://github.com/eclipse-ee4j/glassfish-woodstock" class="bare">https://github.com/eclipse-ee4j/glassfish-woodstock</a></code>). Create a theme JAR
file with all the CSS properties and image files that are required by
your Woodstock component. Use a script provided by the Woodstock project
to clone an existing theme, then modify the files and properties as
necessary. Once you have created the theme JAR file, place it in the
<code>WEB-INF/lib</code> directory of the Administration Console so that the
Woodstock theme component will load the theme. In addition, edit the
properties file specified by your integration point
(<code>MyOwnBrand.properties</code>, for example) to specify the name and version
of your theme.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-an-integration-point-type"><a class="anchor" href="#creating-an-integration-point-type"></a>Creating an Integration Point Type</h3>
<div class="paragraph">
<p>If your add-on component provides new content that you would like other
people to extend, you may define your own integration point types. For
example, if you add a new page that provides tabs of monitoring
information, you might want to allow others to add their own tabs to
complement your default tabs. This feature enables your page to behave
like the existing Administration Console pages that you or others can
extend.</p>
</div>
<div class="sect3">
<h4 id="to-create-an-integration-point-type"><a class="anchor" href="#to-create-an-integration-point-type"></a>To Create an Integration Point Type</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Decide on the name of your integration point type.</p>
<div class="paragraph">
<p>The integration point type must be a unique identifier. You might use
the package name of your integration point, with a meaningful name
appended to the end, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.company.project:myMonitoringTabs</code></pre>
</div>
</div>
</li>
<li>
<p>After you have an integration point ID, use handlers to insert the
integration point implementation(s).</p>
<div class="paragraph">
<p>Include code like the following below the place in your Jakarta Server Faces
page where you would like to enable others to add their integration
point implementations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;event&gt;
    &lt;!afterCreate
        getUIComponent(clientid=&quot;clientid:of:root&quot;
                       component=&gt;$attribute{rootComp});
        includeIntegrations(type=&quot;org.company.project:myMonitoringTabs&quot;
                            root=&quot;#{rootComp}&quot;);
    /&gt;
&lt;/event&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Change <code>clientId:of:root</code> to match the <code>clientId</code> of the outermost
component in which you want others to be able to add their content (in
this example, the tab set is the most likely choice). Also include your
integration point ID in place of <code>org.company.project:myMonitoringTabs</code>.
If you omit the <code>root</code> argument to <code>includeIntegrations</code>, all components
on the entire page can be used for the <code>parentId</code> of the integration
points.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extending-the-asadmin-utility-2"><a class="anchor" href="#extending-the-asadmin-utility-2"></a>Extending the <code>asadmin</code> Utility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>asadmin</code> utility is a command-line tool for configuring and
administering Eclipse GlassFish. Extending the <code>asadmin</code> utility enables
you to provide administrative interfaces for an add-on component that
are consistent with the interfaces of other Eclipse GlassFish components.
A user can run <code>asadmin</code> subcommands either from a command prompt or
from a script. For more information about the <code>asadmin</code> utility, see the
<a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a> man page.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#about-the-administrative-command-infrastructure-of-glassfish-server">About the Administrative Command Infrastructure of Eclipse GlassFish</a></p>
</li>
<li>
<p><a href="#adding-an-asadmin-subcommand">Adding an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#adding-parameters-to-an-asadmin-subcommand">Adding Parameters to an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#making-asadmin-subcommands-cluster-aware">Making <code>asadmin</code> Subcommands Cluster-Aware</a></p>
</li>
<li>
<p><a href="#adding-message-text-strings-to-an-asadmin-subcommand">Adding Message Text Strings to an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#enabling-an-asadmin-subcommand-to-run">Enabling an <code>asadmin</code> Subcommand to Run</a></p>
</li>
<li>
<p><a href="#setting-the-context-of-an-asadmin-subcommand">Setting the Context of an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#changing-the-brand-in-the-glassfish-server-cli">Changing the Brand in the Eclipse GlassFish CLI</a></p>
</li>
<li>
<p><a href="#examples-of-extending-the-asadmin-utility">Examples of Extending the <code>asadmin</code> Utility</a></p>
</li>
<li>
<p><a href="#implementing-create-delete-and-list-commands-using-annotations">Implementing Create, Delete, and List Commands Using
Annotations</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="about-the-administrative-command-infrastructure-of-glassfish-server"><a class="anchor" href="#about-the-administrative-command-infrastructure-of-glassfish-server"></a>About the Administrative Command Infrastructure of Eclipse GlassFish</h3>
<div class="paragraph">
<p>To enable multiple containers to be independently packaged and loaded,
the administrative command infrastructure of Eclipse GlassFish provides
the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Location independence. Administration subcommands can be loaded from
any add-on component that is known to Eclipse GlassFish.</p>
</li>
<li>
<p>Extensibility. Administrative subcommands that are available to
Eclipse GlassFish are discovered on demand and not obtained from a preset
list of subcommands.</p>
</li>
<li>
<p>Support for the HK2 architecture. Subcommands can use injection to
express their dependencies, and extraction to provide results to a user.
For more information, see <a href="#writing-hk2-components">Writing
HK2 Components</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-an-asadmin-subcommand"><a class="anchor" href="#adding-an-asadmin-subcommand"></a>Adding an <code>asadmin</code> Subcommand</h3>
<div class="paragraph">
<p>An <code>asadmin</code> subcommand identifies the operation or task that a user is
to perform. Adding an <code>asadmin</code> subcommand enables the user to perform
these tasks and operations through the <code>asadmin</code> utility.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#representing-an-asadmin-subcommand-as-a-java-class">Representing an <code>asadmin</code> Subcommand as a Java Class</a></p>
</li>
<li>
<p><a href="#specifying-the-name-of-an-asadmin-subcommand">Specifying the Name of an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#ensuring-that-an-admincommand-implementation-is-stateless">Ensuring That an <code>AdminCommand</code> Implementation Is
Stateless</a></p>
</li>
<li>
<p><a href="#example-of-adding-an-asadmin-subcommand">Example of Adding an <code>asadmin</code> Subcommand</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="representing-an-asadmin-subcommand-as-a-java-class"><a class="anchor" href="#representing-an-asadmin-subcommand-as-a-java-class"></a>Representing an <code>asadmin</code> Subcommand as a Java Class</h4>
<div class="paragraph">
<p>Each <code>asadmin</code> subcommand that you are adding must be represented as a
Java class. To represent an <code>asadmin</code> subcommand as a Java class, write
a Java class that implements the <code>org.glassfish.api.admin.AdminCommand</code>
interface. Write one class for each subcommand that you are adding. Do
not represent multiple <code>asadmin</code> subcommands in a single class.</p>
</div>
<div class="paragraph">
<p>Annotate the declaration of your implementations of the <code>AdminCommand</code>
interface with the <code>org.jvnet.hk2.annotations.Service</code> annotation. The
<code>@Service</code> annotation ensures that the following requirements for your
implementations are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The implementations are eligible for resource injection and resource extraction.</p>
</li>
<li>
<p>The implementations are location independent, provided that the
component that contains them is made known to the Eclipse GlassFish runtime.</p>
<div class="paragraph">
<p>For information about how to make a component known to the Eclipse GlassFish runtime, see
<a href="#integrating-an-add-on-component-with-glassfish-server">Integrating an Add-On Component With Eclipse GlassFish</a>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-name-of-an-asadmin-subcommand"><a class="anchor" href="#specifying-the-name-of-an-asadmin-subcommand"></a>Specifying the Name of an <code>asadmin</code> Subcommand</h4>
<div class="paragraph">
<p>To specify the name of the subcommand, set the <code>name</code> element of the
<code>@Service</code> annotation to the name.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Subcommand names are case-sensitive.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Subcommands that are supplied in Eclipse GlassFish distributions
typically create, delete, and list objects of a particular type. For
consistency with the names of subcommands that are supplied in Eclipse GlassFish distributions, follow these conventions when specifying the name
of a subcommand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For subcommands that create an object of a particular type, use the name <code>create-`object</code>.`</p>
</li>
<li>
<p>For subcommands that delete an object of a particular type, use the name <code>delete-`object</code>.`</p>
</li>
<li>
<p>For subcommands that list all objects of a particular type, use the name <code>list-`objects</code>.`</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, Eclipse GlassFish provides the following subcommands for
creating, deleting, and listing HTTP listeners:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>create-http-listener</code></p>
</li>
<li>
<p><code>delete-http-listener</code></p>
</li>
<li>
<p><code>list-http-listeners</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You must also ensure that the name of your subcommand is unique.
To obtain a complete list of the names of all <code>asadmin</code> subcommands that
are installed, use the
<a href="reference-manual.html#list-commands"><code>list-commands</code></a> subcommand.
For a complete list of <code>asadmin</code> subcommands that are supplied in
Eclipse GlassFish distributions, see the
<a href="reference-manual.html#GSRFM">Eclipse GlassFish Reference Manual</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ensuring-that-an-admincommand-implementation-is-stateless"><a class="anchor" href="#ensuring-that-an-admincommand-implementation-is-stateless"></a>Ensuring That an <code>AdminCommand</code> Implementation Is Stateless</h4>
<div class="paragraph">
<p>To enable multiple clients to run a subcommand simultaneously, ensure
that the implementation of the <code>AdminCommand</code> interface for the
subcommand is stateless. To ensure that the implementation of the
<code>AdminCommand</code> interface is stateless, annotate the declaration of your
implementation with the <code>org.jvnet.hk2.annotations.Scoped</code> annotation.
In the <code>@Scoped</code> annotation, set the scope as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To instantiate the subcommand for each lookup, set the scope to <code>PerLookup.class</code>.</p>
</li>
<li>
<p>To instantiate the subcommand only once for each session, set the scope to <code>Singleton</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-of-adding-an-asadmin-subcommand"><a class="anchor" href="#example-of-adding-an-asadmin-subcommand"></a>Example of Adding an <code>asadmin</code> Subcommand</h4>
<div id="ghrqq" class="paragraph">
<p>Example 4-1 Adding an <code>asadmin</code> Subcommand</p>
</div>
<div class="paragraph">
<p>This example shows the declaration of the class <code>CreateMycontainer</code> that
represents an <code>asadmin</code> subcommand that is named <code>create-mycontainer</code>.
The subcommand is instantiated for each lookup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.mycontainer</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommand</span>;
...
import org.jvnet.hk2.annotations.Service;
...
import org.jvnet.hk2.annotations.Scoped;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.PerLookup</span>;

<span class="comment">/**
 * Sample subcommand
 */</span>
<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-mycontainer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="predefined-type">Class</span> CreateMycontainer <span class="directive">implements</span> AdminCommand {
<span class="error">…</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-parameters-to-an-asadmin-subcommand"><a class="anchor" href="#adding-parameters-to-an-asadmin-subcommand"></a>Adding Parameters to an <code>asadmin</code> Subcommand</h3>
<div class="paragraph">
<p>The parameters of an <code>asadmin</code> subcommand are the options and operands
of the subcommand.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Options control how the <code>asadmin</code> utility performs a subcommand.</p>
</li>
<li>
<p>Operands are the objects on which a subcommand acts. For example, the
operand of the <a href="reference-manual.html#start-domain"><code>start-domain</code></a> subcommand is the domain
that is to be started.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#representing-a-parameter-of-an-asadmin-subcommand">Representing a Parameter of an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#identifying-a-parameter-of-an-asadmin-subcommand">Identifying a Parameter of an <code>asadmin</code> Subcommand</a></p>
</li>
<li>
<p><a href="#specifying-whether-a-parameter-is-an-option-or-an-operand">Specifying Whether a Parameter Is an Option or an Operand</a></p>
</li>
<li>
<p><a href="#specifying-the-name-of-an-option">Specifying the Name of an Option</a></p>
</li>
<li>
<p><a href="#specifying-the-acceptable-values-of-a-parameter">Specifying the Acceptable Values of a Parameter</a></p>
</li>
<li>
<p><a href="#specifying-the-default-value-of-a-parameter">Specifying the Default Value of a Parameter</a></p>
</li>
<li>
<p><a href="#specifying-whether-a-parameter-is-required-or-optional">Specifying Whether a Parameter Is Required or Optional</a></p>
</li>
<li>
<p><a href="#specifying-whether-a-parameter-can-be-used-multiple-times-on-the-command-line">Specifying Whether a Parameter Can Be Used Multiple
Times on the Command Line</a></p>
</li>
<li>
<p><a href="#example-of-adding-parameters-to-an-asadmin-subcommand">Example of Adding Parameters to an <code>asadmin</code> Subcommand</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="representing-a-parameter-of-an-asadmin-subcommand"><a class="anchor" href="#representing-a-parameter-of-an-asadmin-subcommand"></a>Representing a Parameter of an <code>asadmin</code> Subcommand</h4>
<div class="paragraph">
<p>Represent each parameter of a subcommand in your implementation as a
field or as the property of a JavaBeans specification setter method. Use
the property of a setter method for the following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To provide data encapsulation for the parameter</p>
</li>
<li>
<p>To add code for validating the parameter before the property is set</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="identifying-a-parameter-of-an-asadmin-subcommand"><a class="anchor" href="#identifying-a-parameter-of-an-asadmin-subcommand"></a>Identifying a Parameter of an <code>asadmin</code> Subcommand</h4>
<div class="paragraph">
<p>Identifying a parameter of an <code>asadmin</code> subcommand enables Eclipse GlassFish to perform the following operations at runtime on the parameter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validation. The Eclipse GlassFish determines whether all required
parameters are specified and returns an error if any required parameter
is omitted.</p>
</li>
<li>
<p>Injection. Before the subcommand runs, the Eclipse GlassFish injects
each parameter into the required field or method before the subcommand
is run.</p>
</li>
<li>
<p>Usage message generation. The Eclipse GlassFish uses reflection to
obtain the list of parameters for a subcommand and to generate the usage
message from this list.</p>
</li>
<li>
<p>Localized string display. If the subcommand supports
internationalization and if localized strings are available, the
Eclipse GlassFish can automatically obtain the localized strings for a
subcommand and display them to the user.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To identify a parameter of a subcommand, annotate the declaration of the
item that is associated with the parameter with the
<code>org.glassfish.api.Param</code> annotation. This item is either the field or
setter method that is associated with the parameter.</p>
</div>
<div class="paragraph">
<p>To specify the properties of the parameter, use the elements of the
<code>@Param</code> annotation as explained in the sections that follow.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-whether-a-parameter-is-an-option-or-an-operand"><a class="anchor" href="#specifying-whether-a-parameter-is-an-option-or-an-operand"></a>Specifying Whether a Parameter Is an Option or an Operand</h4>
<div class="paragraph">
<p>Whether a parameter is an option or an operand determines how a user
must specify the parameter when running the subcommand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the parameter is an option, the user must specify the option with
the parameter name.</p>
</li>
<li>
<p>If the parameter is an operand, the user may omit the parameter name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To specify whether a parameter is an option or an operand, set the
<code>primary</code> element of the <code>@Param</code> annotation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the parameter is an option, set the <code>primary</code> element to <code>false</code>.
This value is the default.</p>
</li>
<li>
<p>If the parameter is an operand, set the <code>primary</code> element to <code>true</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-name-of-an-option"><a class="anchor" href="#specifying-the-name-of-an-option"></a>Specifying the Name of an Option</h4>
<div class="paragraph">
<p>The name of an option is the name that a user must type on the command
line to specify the option when running the subcommand.</p>
</div>
<div class="paragraph">
<p>The name of each option that you add in your implementation of an
<code>asadmin</code> subcommand can have a long form and a short form. When running
the subcommand, the user specifies the long form and the short form as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The short form of an option name has a single dash (<code>-</code>) followed by a
single character.</p>
</li>
<li>
<p>The long form of an option name has two dashes (<code>--</code>) followed by an
option word.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the short form and the long form of the name of the option
for specifying terse output are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Short form: <code>-m</code></p>
</li>
<li>
<p>Long form: <code>--monitor</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Option names are case-sensitive.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="specifying-the-long-form-of-an-option-name"><a class="anchor" href="#specifying-the-long-form-of-an-option-name"></a>Specifying the Long Form of an Option Name</h5>
<div class="paragraph">
<p>To specify the long form of an option name, set the <code>name</code> element of
the <code>@Param</code> annotation to a string that specifies the name. If you do
not set this element, the default name depends on how you represent the
option.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you represent the option as a field, the default name is the field
name.</p>
</li>
<li>
<p>If you represent the option as the property of a JavaBeans
specification setter method, the default name is the property name from
the setter method name. For example, if the setter method <code>setPassword</code>
is associated with an option, the property name and the option name are
both <code>password</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="specifying-the-short-form-of-an-option-name"><a class="anchor" href="#specifying-the-short-form-of-an-option-name"></a>Specifying the Short Form of an Option Name</h5>
<div id="ghpvi" class="paragraph">
<p>To specify the short form of an option name, set the <code>shortName</code> element
of the <code>@Param</code> annotation to a single character that specifies the
short form of the parameter. The user can specify this character instead
of the full parameter name, for example <code>-m</code> instead of <code>--monitor</code>. If
you do not set this element, the option has no short form.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-acceptable-values-of-a-parameter"><a class="anchor" href="#specifying-the-acceptable-values-of-a-parameter"></a>Specifying the Acceptable Values of a Parameter</h4>
<div class="paragraph">
<p>When a user runs the subcommand, the Eclipse GlassFish validates option
arguments and operands against the acceptable values that you specify in
your implementation.</p>
</div>
<div class="paragraph">
<p>To specify the acceptable values of a parameter, set the
<code>acceptableValues</code> element of the <code>@Param</code> annotation to a string that
contains a comma-separated list of acceptable values. If you do not set
this element, any string of characters is acceptable.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-default-value-of-a-parameter"><a class="anchor" href="#specifying-the-default-value-of-a-parameter"></a>Specifying the Default Value of a Parameter</h4>
<div class="paragraph">
<p>The default value of a parameter is the value that is applied if a user
omits the parameter when running the subcommand.</p>
</div>
<div class="paragraph">
<p>To specify the default value of a parameter, set the <code>defaultValue</code>
element of the <code>@Param</code> annotation to a string that contains the default
value. You can also compute the default value dynamically by extending
the <code>ParamDefaultCalculator</code> class and setting the <code>defaultCalculator</code>
element of the <code>@Param</code> annotation to this class. If these elements are
not set, the parameter has no default value.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-whether-a-parameter-is-required-or-optional"><a class="anchor" href="#specifying-whether-a-parameter-is-required-or-optional"></a>Specifying Whether a Parameter Is Required or Optional</h4>
<div class="paragraph">
<p>Whether a parameter is required or optional determines how a subcommand
responds if a user omits the parameter when running the subcommand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the parameter is required, the subcommand returns an error.</p>
</li>
<li>
<p>If the parameter is optional, the subcommand runs successfully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To specify whether a parameter is optional or required, set the
<code>optional</code> element of the <code>@Param</code> annotation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the parameter is required, set the <code>optional</code> element to <code>false</code>.
This value is the default.</p>
</li>
<li>
<p>If the parameter is optional, set the <code>optional</code> element to <code>true</code>.</p>
</li>
</ul>
</div>
<div id="specifying-whether-a-parameter-can-be-used-multiple-times-on-the-command-line" class="paragraph">
<p>Specifying Whether a Parameter Can Be Used Multiple Times on the Command
==== Line</p>
</div>
<div class="paragraph">
<p>By default, each parameter can be used once on the command line. To use
the parameter multiple times, set the <code>multiple</code> element of the <code>@Param</code>
annotation to <code>true</code>. The type of the annotated parameter must be an
array.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-of-adding-parameters-to-an-asadmin-subcommand"><a class="anchor" href="#example-of-adding-parameters-to-an-asadmin-subcommand"></a>Example of Adding Parameters to an <code>asadmin</code> Subcommand</h4>
<div id="ghpuh" class="paragraph">
<p>Example 4-2 Adding Parameters to an <code>asadmin</code> Subcommand</p>
</div>
<div class="paragraph">
<p>This example shows the code for adding parameters to an <code>asadmin</code>
subcommand with the properties as shown in the table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represented As</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Acceptable Values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional or
Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option or Operand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--originator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A field that is named <code>originator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any character
string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A field that is named <code>mycontainerDescription</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any
character string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A field that is named <code>enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--containername</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A field that is named <code>containername</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any character
string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operand</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.glassfish.api.Param;
...
{
<span class="comment">//…</span>
    <span class="annotation">@Param</span>
    <span class="predefined-type">String</span> originator;

    <span class="annotation">@Param</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
    <span class="comment">//…</span>
    <span class="predefined-type">String</span> mycontainerDescription

    <span class="annotation">@Param</span> (acceptableValues=<span class="string"><span class="delimiter">&quot;</span><span class="content">true,false</span><span class="delimiter">&quot;</span></span>, defaultValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> enabled

    <span class="annotation">@Param</span>(primary=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> containername;
<span class="comment">//…</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="making-asadmin-subcommands-cluster-aware"><a class="anchor" href="#making-asadmin-subcommands-cluster-aware"></a>Making <code>asadmin</code> Subcommands Cluster-Aware</h3>
<div class="paragraph">
<p>The Eclipse GlassFish <code>asadmin</code> command framework provides support for
making <code>asadmin</code> subcommands work properly in a clustered environment or
with standalone server instances. A command that changes a configuration
is first executed on the domain administration server (DAS) and then
executed on each of the server instances affected by the change.
Annotations provided by the framework determine the instances on which
the command should be replicated and executed. Commands that do not
change a configuration need not be executed on the DAS at all, but only
on the necessary instances. The framework provides support for
collecting the output from the instances and sending a report back to
the user.</p>
</div>
<div class="paragraph">
<p>Subcommands in a multi-instance environment can accept a <code>--target</code>
option to specify the cluster or instance on which the command acts.
From within the command, the <code>Target</code> utility allows the command to
determine information about where it is running. For some commands, it
may be desirable to have a main command that runs on the DAS and
supplemental preprocessing or postprocessing commands that run on the
instances.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#specifying-allowed-targets">Specifying Allowed Targets</a></p>
</li>
<li>
<p><a href="#the-target-utility">The <code>Target</code> Utility</a></p>
</li>
<li>
<p><a href="#specifying-asadmin-subcommand-execution">Specifying <code>asadmin</code> Subcommand Execution</a></p>
</li>
<li>
<p><a href="#subcommand-preprocessing-and-postprocessing">Subcommand Preprocessing and Postprocessing</a></p>
</li>
<li>
<p><a href="#running-a-command-from-another-command">Running a Command from Another Command</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="specifying-allowed-targets"><a class="anchor" href="#specifying-allowed-targets"></a>Specifying Allowed Targets</h4>
<div class="paragraph">
<p>When you define a <code>--target</code> option by using the <code>@Param</code> annotation in
the <code>org.glassfish.api</code> package, possible targets are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>domain</code> — The entire domain</p>
</li>
<li>
<p><code>server</code> — The domain administration server, or DAS</p>
</li>
<li>
<p>cluster — A homogeneous set of server instances that function as a
unit</p>
</li>
<li>
<p>standalone instance — A server instance that isn&#8217;t part of a cluster</p>
</li>
<li>
<p>clustered instance — A server instance that is part of a cluster</p>
</li>
<li>
<p>config — A configuration for a cluster or standalone server instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These possible targets are represented by the following <code>CommandTarget</code>
elements of the <code>@TargetType</code> annotation in the
<code>org.glassfish.config.support</code> package:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CommandTarget.DOMAIN</code></p>
</li>
<li>
<p><code>CommandTarget.DAS</code></p>
</li>
<li>
<p><code>CommandTarget.CLUSTER</code></p>
</li>
<li>
<p><code>CommandTarget.STANDALONE_SERVER</code></p>
</li>
<li>
<p><code>CommandTarget.CLUSTERED_INSTANCE</code></p>
</li>
<li>
<p><code>CommandTarget.CONFIG</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, the allowed targets are <code>server</code> (the DAS), standalone
server instances, clusters, and configurations. Not specifying a
<code>@TargetType</code> annotation is equivalent to specifying the following
<code>@TargetType</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@TargetType</span>(CommandTarget.DAS,CommandTarget.STANDALONE_SERVER,CommandTarget.CLUSTER,CommandTarget.CONFIG)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Subcommands that support other combinations of targets must specify
<code>@TargetType</code> annotations. For example, the <code>create-http-lb</code> subcommand
supports only standalone server instance and cluster targets. Its
<code>@TargetType</code> annotation is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@TargetType</span>(CommandTarget.STANDALONE_SERVER,CommandTarget.CLUSTER)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most subcommands do not act on server instances that are part of a
cluster. This ensures that all server instances in a cluster remain
synchronized. Thus, the <code>CommandTarget.CLUSTERED_INSTANCE</code> element of
the <code>@TargetType</code> annotation is rarely used.</p>
</div>
<div class="paragraph">
<p>An example exception is the <code>enable</code> subcommand. To perform a rolling
upgrade of an application deployed to a cluster, you must be able to
enable the new application (which automatically disables the old) on one
clustered instance at a time. The <code>@TargetType</code> annotation for the
<code>enable</code> subcommand is as follows, all on one line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@TargetType</span>(CommandTarget.DAS,CommandTarget.STANDALONE_INSTANCE,CommandTarget.CLUSTER,
CommandTarget.CLUSTERED_INSTANCE)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>CommandTarget.CLUSTERED_INSTANCE</code> element is specified.</p>
</div>
<div class="paragraph">
<p>The target name specified in the command line is injected into the
subcommand implementation if the following annotation is present:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Param</span>(optional=<span class="predefined-constant">true</span>,defaultValue=SystemPropertyConstants.DEFAULT_SERVER_INSTANCE_NAME)
<span class="predefined-type">String</span> target;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the-target-utility"><a class="anchor" href="#the-target-utility"></a>The <code>Target</code> Utility</h4>
<div class="paragraph">
<p>The <code>Target</code> utility is a service, present in the <code>internal-api</code> module,
<code>org.glassfish.internal.api</code> package, which a command implementation can
obtain by using the following annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span> <span class="predefined-type">Target</span> targetUtil;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use this utility to avoid writing boiler plate code for actions
such as getting the list of server instances for a cluster or checking
if a server instance is part of a cluster. For example, here is an
example of using the utility to obtain the configuration for a target
cluster or server instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Config c = targetUtil.getConfig(target);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Target</code> utility is packaged in the
as-install<code>/modules/internal-api.jar</code> file. Its methods are documented
with comments.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-asadmin-subcommand-execution"><a class="anchor" href="#specifying-asadmin-subcommand-execution"></a>Specifying <code>asadmin</code> Subcommand Execution</h4>
<div class="paragraph">
<p>By default, all <code>asadmin</code> subcommands are automatically replicated and
run on the DAS and all Eclipse GlassFish instances specified in the
<code>--target</code> option. To run a subcommand only on the DAS, use the
following <code>@ExecuteOn</code> annotation in the <code>org.glassfish.api.admin</code> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExecuteOn</span>(RuntimeType.DAS)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>stop-domain</code> subcommand and subcommands that list information are
examples of subcommands that execute only on the DAS.</p>
</div>
<div class="paragraph">
<p>To run a subcommand only on applicable server instances, use the
following <code>@ExecuteOn</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExecuteOn</span>(RuntimeType.INSTANCE)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Not specifying an <code>@ExecuteOn</code> annotation is equivalent to specifying
the following <code>@ExecuteOn</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExecuteOn</span>(RuntimeType.DAS,RuntimeType.INSTANCE)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to <code>RuntimeType</code>, you can specify the following additional
elements with the <code>@ExecuteOn</code> annotation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ifFailure</code> — By default, if errors occur during execution of a
subcommand on a server instance, command execution is considered to have
failed and further execution is stopped. However, you can choose to
ignore the failure or warn the user rather than stopping further command
execution. Specify the <code>ifFailure</code> element and set it to
<code>FailurePolicy.Ignore</code> or <code>FailurePolicy.Warn</code>. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExecuteOn</span>(value={RuntimeType.DAS}, ifFailure=FailurePolicy.Warn)</code></pre>
</div>
</div>
</li>
<li>
<p><code>ifOffline</code> — By default, if a server instance is found to be offline
during the command replication process, command execution is considered
to have failed and further execution is stopped. However, you can choose
to ignore the failure or warn the user rather than stopping further
command execution. Specify the <code>ifOffline</code> element and set it to
<code>FailurePolicy.Ignore</code> or <code>FailurePolicy.Warn</code>. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExecuteOn</span>(value={RuntimeType.DAS}, ifOffline=FailurePolicy.Ignore)</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="subcommand-preprocessing-and-postprocessing"><a class="anchor" href="#subcommand-preprocessing-and-postprocessing"></a>Subcommand Preprocessing and Postprocessing</h4>
<div class="paragraph">
<p>Some <code>asadmin</code> subcommands may require preprocessing or postprocessing.
For example, after an application is deployed to the DAS, references are
created in all applicable server instances, which synchronize with the
DAS. As another example, Message Queue or load balancer settings may
have to be reconfigured whenever a server instance is added to a
cluster.</p>
</div>
<div class="paragraph">
<p>For such cases, the command replication framework provides the
<code>@Supplemental</code> annotation (in the <code>org.glassfish.api.admin</code> package).
An implementation must use the <code>value</code> element of the <code>@Supplemental</code>
annotation to express the supplemented command. This value is the name
of the command as defined by the supplemented command&#8217;s <code>@Service</code>
annotation (in the <code>org.jvnet.hk2.annotations</code> package).</p>
</div>
<div class="paragraph">
<p>For example, the <code>deploy</code> subcommand requires postprocessing. The
deployment command implementation looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">deploy</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ExecuteOn</span>(RuntimeType.DAS)
<span class="directive">public</span> DeployCommand <span class="directive">implements</span> AdminCommand {
<span class="comment">// Do Actual Deployment</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A supplemental command that is run after every successful deployment
looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">DeploymentSupplementalCommand</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Supplemental</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">deploy</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ExecuteOn</span>(RuntimeType.INSTANCE)
<span class="directive">public</span> DeploymentSupplementalCommand <span class="directive">implements</span> AdminCommand {
<span class="comment">// Do logic that happens after deployment has been done</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As another example, a subcommand to create a local server instance might
look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">create-local-instance</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">CreateLocalInstanceCommand</span> <span class="directive">implements</span> AdminCommand {
<span class="comment">// Do local instance creation</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A supplemental command to change Message Queue or load balancer settings
after local instance creation might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">CreateLocalInstanceSupplementalCommand</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Supplemental</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">create-local-instance</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> CreateLocalInstanceSupplementalCommand <span class="directive">implements</span> AdminCommand {
<span class="comment">// Change MQ/LB properties here</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A supplemental command implements AdminCommand, thus it can use the
<code>@Param</code> annotation and expect the corresponding <code>asadmin</code> command
parameters to be injected at runtime. The parameter values available for
injection are the same ones provided for the original command with which
the supplemental command is associated. For example, the
<code>DeploymentSupplementalCommand</code> has access to the parameter values
available to the <code>DeployCommand</code> invocation.</p>
</div>
<div class="paragraph">
<p>An <code>asadmin</code> subcommand can be supplemented with multiple supplemental
commands. In this case, all supplemental commands are run after
completion of the main command but without any guarantee of the order in
which they run.</p>
</div>
<div class="paragraph">
<p>To specify that a supplemental command is run before the main command,
set the <code>on</code> element of the <code>@Supplemental</code> annotation to
<code>Supplemental.Timing.Before</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Supplemental</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">mycommand</span><span class="delimiter">&quot;</span></span>, on=Supplemental.Timing.Before)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Supplemental commands can use the <code>@ExecuteOn</code> annotation as described
in <a href="#specifying-asadmin-subcommand-execution">Specifying <code>asadmin</code> Subcommand Execution</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="running-a-command-from-another-command"><a class="anchor" href="#running-a-command-from-another-command"></a>Running a Command from Another Command</h4>
<div class="paragraph">
<p>An <code>asadmin</code> subcommand or supplemental command might need to run
another subcommand. For example, a subcommand running on the DAS might
need to run a different subcommand on one or more server instances. Such
invocations might use the <code>ClusterExecutor</code> class (in the
<code>org.glassfish.api.admin</code> package), which accepts a <code>ParameterMap</code>, to
pass parameters and their values to the invoked command.</p>
</div>
<div class="paragraph">
<p>The <code>ParameterMapExtractor</code> utility is a service, present in the
<code>common-util</code> module, <code>org.glassfish.common.util.admin</code> package, which
creates a new <code>ParameterMap</code> populated using the parameters and values
of another <code>AdminCommand</code> that has already been injected.</p>
</div>
<div class="paragraph">
<p>To list parameter names you want excluded from the <code>ParameterMap</code>, pass
the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is optional.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-message-text-strings-to-an-asadmin-subcommand"><a class="anchor" href="#adding-message-text-strings-to-an-asadmin-subcommand"></a>Adding Message Text Strings to an <code>asadmin</code> Subcommand</h3>
<div class="paragraph">
<p>A message text string provides useful information to the user about an
<code>asadmin</code> subcommand or a parameter.</p>
</div>
<div class="paragraph">
<p>To provide internationalization support for the text string of a
subcommand or parameter, annotate the declaration of the subcommand or
parameter with the <code>org.glassfish.api.I18n</code> annotation. The <code>@I18n</code>
annotation identifies the resource from the resource bundle that is
associated with your implementation.</p>
</div>
<div class="paragraph">
<p>To add message text strings to an <code>asadmin</code> subcommand, create a plain
text file that is named <code>LocalStrings.properties</code> to contain the
strings. Define each string on a separate line of the file as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>key=string</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">key</dt>
<dd>
<p>A key that maps the string to a subcommand or a parameter. The format
to use for key depends on the target to which the key applies and
whether the target is annotated with the <code>@I18n</code> annotation. See the
following table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36%;">
<col style="width: 64%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Target</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subcommand or parameter with the <code>@I18n</code> annotation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subcommand-name.command.resource-name</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subcommand without the <code>@I18n</code> annotation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subcommand-name.command</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter without the <code>@I18n</code> annotation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subcommand-name.command.param-name</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The replaceable parts of these formats are as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">subcommand-name</dt>
<dd>
<p>The name of the subcommand.</p>
</dd>
<dt class="hdlist1">resource-name</dt>
<dd>
<p>The name of the resource that is specified in the`@I18n` annotation.</p>
</dd>
<dt class="hdlist1">param-name</dt>
<dd>
<p>The name of the parameter.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">string</dt>
<dd>
<p>A string without quotes that contains the text of the message.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To display the message strings to users, you must provide code in your
implementation of the <code>execute</code> method to display the text. For more
information about implementing the <code>execute</code> method, see
<a href="#enabling-an-asadmin-subcommand-to-run">Enabling an <code>asadmin</code> Subcommand to Run</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ghpvm" class="paragraph">
<p>Example 4-3 Adding Message Strings to an <code>asadmin</code> Subcommand</p>
</div>
<div class="paragraph">
<p>This example shows the code for adding message strings to the
<code>create-mycontainer</code> subcommand as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>create-mycontainer</code> subcommand is associated with the message
<code>Creates a custom container</code>. No internationalization support is
provided for this message.</p>
</li>
<li>
<p>The <code>--originator</code> parameter is associated with the message
<code>The originator of the container</code>. No internationalization support is
provided for this message.</p>
</li>
<li>
<p>The <code>--description</code> parameter is associated with the message that is
contained in the resource <code>mydesc</code>, for which internationalization is
provided. This resource contains the message text
<code>A description of the container</code>.</p>
</li>
<li>
<p>The <code>--enabled</code> parameter is associated with the message
<code>Whether the container is enabled or disabled</code>.
No internationalization support is provided for this message.</p>
</li>
<li>
<p>The <code>--containername</code> parameter is associated with the message
<code>The container name</code>. No internationalization support is provided for this message.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The addition of the parameters <code>originator</code>, <code>description</code>, <code>enabled</code>
and <code>containername</code> to the subcommand is shown in <a href="#ghpuh">Example 4-2</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.mycontainer</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommand</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.I18n</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.Param</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Scoped</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.PerLookup</span>;
<span class="comment">//...</span>

<span class="comment">/**
 * Sample subcommand
 */</span>
<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-mycontainer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="predefined-type">Class</span> CreateMycontainer <span class="directive">implements</span> AdminCommand {

    <span class="annotation">@Param</span>
    <span class="predefined-type">String</span> originator;

    <span class="annotation">@Param</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
    <span class="annotation">@I18n</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">mydesc</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> mycontainerDescription

    <span class="annotation">@Param</span> (acceptableValues=<span class="string"><span class="delimiter">&quot;</span><span class="content">true,false</span><span class="delimiter">&quot;</span></span>, defaultValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> enabled

    <span class="annotation">@Param</span>(primary=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> containername;
<span class="comment">//...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following message text strings are defined in the file
<code>LocalStrings.properties</code> for use by the subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>create-mycontainer.command=Creates a custom container
create-mycontainer.command.originator=The originator of the container
create-mycontainer.command.mydesc=A description of the container
create-mycontainer.command.enabled=Whether the container is enabled or disabled
create-mycontainer.command.containername=The container name</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enabling-an-asadmin-subcommand-to-run"><a class="anchor" href="#enabling-an-asadmin-subcommand-to-run"></a>Enabling an <code>asadmin</code> Subcommand to Run</h3>
<div class="paragraph">
<p>To enable an <code>asadmin</code> subcommand to run, implement the <code>execute</code> method
in your implementation of the <code>AdminCommand</code> interface. The declaration
of the <code>execute</code> method in your implementation must be as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="type">void</span> execute(AdminCommandContext context);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pass each parameter of the subcommand as a property to your
implementation of the <code>execute</code> method. Set the key of the property to
the parameter name and set the value of the property to the parameter&#8217;s
value.</p>
</div>
<div class="paragraph">
<p>In the body of the <code>execute</code> method, provide the code for performing the
operation that the command was designed to perform. For examples, see
<a href="#ghrsi">Example 4-6</a> and <a href="#gkbdf">Example 4-7</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="setting-the-context-of-an-asadmin-subcommand"><a class="anchor" href="#setting-the-context-of-an-asadmin-subcommand"></a>Setting the Context of an <code>asadmin</code> Subcommand</h3>
<div class="paragraph">
<p>The <code>org.glassfish.api.admin.AdminCommandContext</code> class provides the
following services to an <code>asadmin</code> subcommand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the parameters of the subcommand</p>
</li>
<li>
<p>Logging</p>
</li>
<li>
<p>Reporting</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To set the context of an <code>asadmin</code> subcommand, pass an
<code>AdminCommandContext</code> object to the <code>execute</code> method of your
implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="changing-the-brand-in-the-glassfish-server-cli"><a class="anchor" href="#changing-the-brand-in-the-glassfish-server-cli"></a>Changing the Brand in the Eclipse GlassFish CLI</h3>
<div class="paragraph">
<p>The brand in the Eclipse GlassFish command-line interface (CLI) consists
of the product name and release information that are displayed in the
following locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the string that the <a href="reference-manual.html#version"><code>version</code></a> subcommand displays</p>
</li>
<li>
<p>In each entry in the <code>server.log</code> file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are incorporating Eclipse GlassFish into a new product with an
external vendor&#8217;s own brand name, change the brand in the Eclipse GlassFish CLI.</p>
</div>
<div class="paragraph">
<p>To change the brand in the Eclipse GlassFish CLI, create an OSGi fragment
bundle that contains a plain text file that is named
<code>src/main/resources/BrandingVersion.properties</code>.</p>
</div>
<div class="paragraph">
<p>In the <code>BrandingVersion.properties</code> file, define the following keyword-value pairs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>product.name=...
product.name.abbreviation=...
product.version=...
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Define each keyword-value pair on a separate line of the file.
Each value is a text string without quotes.</p>
</div>
<div class="paragraph">
<p>The meaning of each keyword-value pair is as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>product.name=Eclipse GlassFish</code></dt>
<dd>
<p>Specifies the full product name without any release information.</p>
</dd>
<dt class="hdlist1"><code>product.name.abbreviation=GF</code></dt>
<dd>
<p>Specifies an abbreviated form of the product name without any release information.</p>
</dd>
<dt class="hdlist1"><code>product.version=2023.02.24</code></dt>
<dd>
<p>Returns the product version. It should follow standard form <code>major.minor.patch[-suffix]</code></p>
</dd>
<dt class="hdlist1"><code>product.build.git.commit=ec1ce24934f0bb174333a9886b58a0d2f9e52b44</code></dt>
<dd>
<p>Specifies the git commit, used for the build.</p>
</dd>
</dl>
</div>
<div id="ghrfh" class="paragraph">
<p>Example 4-4 <code>glassfish-version.properties</code> File for Changing the Brand in
the Eclipse GlassFish CLI</p>
</div>
<div class="paragraph">
<p>This example shows the content of the <code>glassfish-version.properties</code> for
defining the product name and release information of Eclipse GlassFish 7.0.3-SNAPSHOT.
The abbreviated product name is <code>GF</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>product.name=Eclipse GlassFish
product.name.short=GF
product.version=7.0.3-SNAPSHOT
product.build.git.commit=93176e2555176091c8522e43d1d32a0a30652d4a

domain.template.defaultJarFileName=appserver-domain.jar
admin.command.name=asadmin</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-of-extending-the-asadmin-utility"><a class="anchor" href="#examples-of-extending-the-asadmin-utility"></a>Examples of Extending the <code>asadmin</code> Utility</h3>
<div id="ghrnt" class="paragraph">
<p>Example 4-5 <code>asadmin</code> Subcommand With Empty <code>execute</code> Method</p>
</div>
<div class="paragraph">
<p>This example shows a class that represents the <code>asadmin</code> subcommand
<code>create-mycontainer</code>.</p>
</div>
<div class="paragraph">
<p>The usage statement for this subcommand is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin create-mycontainer --originator any-character-string
[--description any-character-string]
[--enabled {true|false}] any-character-string</code></pre>
</div>
</div>
<div class="paragraph">
<p>This subcommand uses injection to specify that a running domain is
required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.mycontainer</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommand</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommandContext</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.I18n</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.Param</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Inject</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Scoped</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.PerLookup</span>;

<span class="comment">/**
 * Sample subcommand
 */</span>
<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-mycontainer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="predefined-type">Class</span> CreateMycontainer <span class="directive">implements</span> AdminCommand {

    <span class="annotation">@Inject</span>
    Domain domain;

    <span class="annotation">@Param</span>
    <span class="predefined-type">String</span> originator;

    <span class="annotation">@Param</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
    <span class="annotation">@I18n</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">mydesc</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> mycontainerDescription

    <span class="annotation">@Param</span> (acceptableValues=<span class="string"><span class="delimiter">&quot;</span><span class="content">true,false</span><span class="delimiter">&quot;</span></span>, defaultValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> enabled

    <span class="annotation">@Param</span>(primary=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> containername;

    <span class="comment">/**
     * Executes the subcommand with the subcommand parameters passed as Properties
     * where the keys are the paramter names and the values the parameter values
     * @param context information
     */</span>
    <span class="directive">public</span> <span class="type">void</span> execute(AdminCommandContext context) {
        <span class="comment">// domain and originator are not null</span>
        <span class="comment">// mycontainerDescription can be null.</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following message text strings are defined in the file
<code>LocalStrings.properties</code> for use by the subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>create-mycontainer.command=Creates a custom container
create-mycontainer.command.originator=The originator of the container
create-mycontainer.command.mydesc=A description of the container
create-mycontainer.command.enabled=Whether the container is enabled or disabled
create-mycontainer.command.containername=The container name</code></pre>
</div>
</div>
<div id="ghrsi" class="paragraph">
<p>Example 4-6 <code>asadmin</code> Subcommand for Retrieving and Displaying Information</p>
</div>
<div class="paragraph">
<p>This example shows a class that represents the <code>asadmin</code> subcommand
<code>list-runtime-environment</code>. The subcommand determines the operating
system or runtime information for Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>The usage statement for this subcommand is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin list-runtime-environment{runtime|os}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.env.cli</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommand</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommandContext</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.ActionReport</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.I18n</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.ActionReport.ExitCode</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.Param</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Inject</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Scoped</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.PerLookup</span>;

<span class="keyword">import</span> <span class="include">java.lang.management.ManagementFactory</span>;
<span class="keyword">import</span> <span class="include">java.lang.management.OperatingSystemMXBean</span>;
<span class="keyword">import</span> <span class="include">java.lang.management.RuntimeMXBean</span>;

<span class="comment">/**
 * Demos asadmin CLI extension
 */</span>
<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">list-runtime-environment</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ListRuntimeEnvironmentCommand</span> <span class="directive">implements</span> AdminCommand {

    <span class="comment">// this value can be either runtime or os for our demo</span>
    <span class="annotation">@Param</span>(primary=<span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> inParam;

    <span class="directive">public</span> <span class="type">void</span> execute(AdminCommandContext context) {

        ActionReport report = context.getActionReport();
        report.setActionExitCode(ExitCode.SUCCESS);

        <span class="comment">// If the inParam is 'os' then this subcommand returns operating system</span>
        <span class="comment">// info and if the inParam is 'runtime' then it returns runtime info.</span>
        <span class="comment">// Both of the above are based on mxbeans.</span>

        <span class="keyword">if</span> (<span class="string"><span class="delimiter">&quot;</span><span class="content">os</span><span class="delimiter">&quot;</span></span>.equals(inParam)) {
            <span class="predefined-type">OperatingSystemMXBean</span> osmb = <span class="predefined-type">ManagementFactory</span>.getOperatingSystemMXBean();
            report.setMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Your machine operating system name = </span><span class="delimiter">&quot;</span></span> + osmb.getName());
        } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string"><span class="delimiter">&quot;</span><span class="content">runtime</span><span class="delimiter">&quot;</span></span>.equals(inParam)) {
            <span class="predefined-type">RuntimeMXBean</span> rtmb = <span class="predefined-type">ManagementFactory</span>.getRuntimeMXBean();
            report.setMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Your JVM name = </span><span class="delimiter">&quot;</span></span> + rtmb.getVmName());
        } <span class="keyword">else</span> {
            report.setActionExitCode(ExitCode.FAILURE);
            report.setMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">operand should be either 'os' or 'runtime'</span><span class="delimiter">&quot;</span></span>);
        }
    }
}</code></pre>
</div>
</div>
<div id="gkbdf" class="paragraph">
<p>Example 4-7 <code>asadmin</code> Subcommand for Updating Configuration Data</p>
</div>
<div class="paragraph">
<p>This example shows a class that represents the <code>asadmin</code> subcommand
<code>configure-greeter-container</code>. The subcommand performs a transaction to
update configuration data for a container component. For more
information about such transactions, see
<a href="#creating-a-transaction-to-update-configuration-data">Creating a Transaction to
Update Configuration Data</a>.</p>
</div>
<div class="paragraph">
<p>The usage statement for this subcommand is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin configure-greeter-container --instances instances [--language language] [--style style]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The acceptable values and default value of each option of the subcommand
are shown in the following table. The table also indicates whether each
option is optional or required.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Acceptable Values</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Optional or Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--instances</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer in the range 1-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--language</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>english</code>, <code>norsk</code>, or <code>francais</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>norsk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--style</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>formal</code>, <code>casual</code>, or <code>expansive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>formal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Code for the container component is shown in
<a href="#example-of-adding-container-capabilities">Example of Adding Container
Capabilities</a>.</p>
</div>
<div class="paragraph">
<p>Code that defines the configuration data for the container component is
shown in <a href="#examples-of-adding-configuration-data-for-a-component">Examples of Adding
Configuration Data for a Component</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter.config</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommand</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.AdminCommandContext</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.Param</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Inject</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Transactions</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.ConfigSupport</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.SingleConfigCode</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.TransactionFailure</span>;

<span class="keyword">import</span> <span class="include">java.beans.PropertyVetoException</span>;

<span class="annotation">@Service</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">configure-greeter-container</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ConfigureGreeterContainerCommand</span> <span class="directive">implements</span> AdminCommand {

    <span class="annotation">@Param</span>(acceptableValues = <span class="string"><span class="delimiter">&quot;</span><span class="content">1,2,3,4,5,6,7,8,9,10</span><span class="delimiter">&quot;</span></span>, defaultValue = <span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> instances;
    <span class="annotation">@Param</span>(acceptableValues = <span class="string"><span class="delimiter">&quot;</span><span class="content">english,norsk,francais</span><span class="delimiter">&quot;</span></span>, defaultValue = <span class="string"><span class="delimiter">&quot;</span><span class="content">norsk</span><span class="delimiter">&quot;</span></span>,
    optional = <span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> language;
    <span class="annotation">@Param</span>(acceptableValues = <span class="string"><span class="delimiter">&quot;</span><span class="content">formal,casual,expansive</span><span class="delimiter">&quot;</span></span>, defaultValue = <span class="string"><span class="delimiter">&quot;</span><span class="content">formal</span><span class="delimiter">&quot;</span></span>,
    optional = <span class="predefined-constant">true</span>)
    <span class="predefined-type">String</span> style;
    <span class="annotation">@Inject</span>
    GreeterContainerConfig config;

    <span class="directive">public</span> <span class="type">void</span> execute(AdminCommandContext adminCommandContext) {
        <span class="keyword">try</span> {
            ConfigSupport.apply(<span class="keyword">new</span> SingleConfigCode&lt;GreeterContainerConfig&gt;() {

                <span class="directive">public</span> <span class="predefined-type">Object</span> run(GreeterContainerConfig greeterContainerConfig)
                        <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>, TransactionFailure {
                    greeterContainerConfig.setNumberOfInstances(instances);
                    greeterContainerConfig.setLanguage(language);
                    greeterContainerConfig.setStyle(style);
                    <span class="keyword">return</span> <span class="predefined-constant">null</span>;
                }
            }, config);
        } <span class="keyword">catch</span> (TransactionFailure e) {
        }

    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implementing-create-delete-and-list-commands-using-annotations"><a class="anchor" href="#implementing-create-delete-and-list-commands-using-annotations"></a>Implementing Create, Delete, and List Commands Using Annotations</h3>
<div class="paragraph">
<p>Many <code>asadmin</code> subcommands simply create, delete, or list objects in the
configuration. Such code is repetitive to write and error prone. To
simplify the writing of these <code>asadmin</code> commands, Eclipse GlassFish
supports annotations that can create, delete, and list configuration
objects from a command invocation. Unless attributes or properties are
set to non-default values or extra actions are required, no writing of
code is needed.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#command-patterns">Command Patterns</a></p>
</li>
<li>
<p><a href="#resolvers">Resolvers</a></p>
</li>
<li>
<p><a href="#the-create-annotation">The <code>@Create</code> Annotation</a></p>
</li>
<li>
<p><a href="#the-delete-annotation">The <code>@Delete</code> Annotation</a></p>
</li>
<li>
<p><a href="#the-listing-annotation">The <code>@Listing</code> Annotation</a></p>
</li>
<li>
<p><a href="#create-command-decorators">Create Command Decorators</a></p>
</li>
<li>
<p><a href="#delete-command-decorators">Delete Command Decorators</a></p>
</li>
<li>
<p><a href="#specifying-command-execution">Specifying Command Execution</a></p>
</li>
<li>
<p><a href="#using-multiple-command-annotations">Using Multiple Command Annotations</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="command-patterns"><a class="anchor" href="#command-patterns"></a>Command Patterns</h4>
<div class="paragraph">
<p>Create command pattern. The most basic create commands are implemented
in the following pattern:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the parent configuration object instance to which the child
will be added. For example, the parent could be a <code>Clusters</code> object and
the child a <code>Cluster</code> object.</p>
</li>
<li>
<p>Start a transaction on the parent instance.</p>
</li>
<li>
<p>Create the child configuration object instance.</p>
</li>
<li>
<p>Set the attributes and properties of the newly created child instance.</p>
</li>
<li>
<p>Add the child to the parent using one of the following accessor
methods:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">void</span> setChild(ChildType child)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Used when there can be zero or one children of a single type associated
with one parent instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;ChildType&gt; getChildren()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Used when there can be zero or more children of a single type associated
with one parent instance.
You cannot retrieve a set of children of the same type from the same
parent using two different accessor methods.</p>
</div>
</li>
<li>
<p>Commit the transaction.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A generic create command implementation can do most of these tasks if
the following information is provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A way to resolve the identity of the parent instance.</p>
</li>
<li>
<p>The type of the child instance.</p>
</li>
<li>
<p>A mapping between command options and child attributes.</p>
</li>
<li>
<p>The accessor method for adding the child to the parent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Delete command pattern. The most basic delete commands are implemented
in the following pattern:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the configuration object instance to be deleted.</p>
</li>
<li>
<p>Start a transaction on the parent instance.</p>
</li>
<li>
<p>Delete the child by removing it from the list or calling <code>setXXX(null)</code>.</p>
</li>
<li>
<p>Commit the transaction.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A generic delete command implementation can do most of these tasks if
the following information is provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A way to resolve the identity of the child instance.</p>
</li>
<li>
<p>The accessor method for deleting the child.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>List command pattern. The most basic list commands simply retrieve all
configuration object instances of a given type.</p>
</div>
</div>
<div class="sect3">
<h4 id="resolvers"><a class="anchor" href="#resolvers"></a>Resolvers</h4>
<div class="paragraph">
<p>A resolver retrieves a configuration object instance of a particular
type. For a create command, it retrieves the parent of the object to be
created. For a delete command, it retrieves the object to be deleted. A
resolver implements the CrudResolver interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.config.support</span>;

<span class="comment">/**
 * A config resolver is responsible for finding the target object of a specified
 * type on which a creation command invocation will be processed.
 *
 * Implementation of these interfaces can be injected with the command invocation
 * parameters in order to determine which object should be returned
 */</span>
<span class="annotation">@Contract</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CrudResolver</span> {

    <span class="comment">/**
     * Retrieves the existing configuration object a command invocation is
     * intented to mutate.
     * @param context the command invocation context
     * @param type the type of the expected instance
     * @return the instance or null if not found
     */</span>
    &lt;T <span class="directive">extends</span> ConfigBeanProxy&gt; T resolve(AdminCommandContext context, <span class="predefined-type">Class</span>&lt;T&gt; type);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given an <code>AdminCommandContext</code>, plus injection with the <code>asadmin</code>
command line parameters (or any other HK2 services if necessary), the
resolver should be able to determine the particular configuration object
on which to act.</p>
</div>
<div class="paragraph">
<p>The following resolvers are provided in the
<code>org.glassfish.config.support</code> package:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TargetBasedResolver</code> — Uses the <code>--target</code> option and the expected
return type to retrieve the configuration object instance.</p>
</li>
<li>
<p><code>TargetAndNameBasedResolver</code> — Uses the <code>--target</code> option to look up a
<code>Config</code> object and a name to retrieve one of the <code>Config</code> object&#8217;s
children.</p>
</li>
<li>
<p><code>TypeAndNameResolver</code> — Uses the requested type and <code>asadmin</code> command
name operand to find the configuration object instance. This is useful
for a configuration that uses the <code>@Index</code> annotation, which registers
instances under names.</p>
</li>
<li>
<p><code>TypeResolver</code> — Uses the requested type to find the configuration
object instance. This is the default resolver.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="the-create-annotation"><a class="anchor" href="#the-create-annotation"></a>The <code>@Create</code> Annotation</h4>
<div class="paragraph">
<p>By placing the <code>org.glassfish.config.support.Create</code> annotation on a
method, you provide the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>value</code> element of the <code>@Create</code> annotation is the name of the
<code>asadmin</code> subcommand that creates the configuration object.</p>
</li>
<li>
<p>The method&#8217;s class is the type of the parent.</p>
</li>
<li>
<p>The method&#8217;s return type or parameter type is the type of the child.</p>
</li>
<li>
<p>The method is the accessor method that adds a child of the specified
type to the parent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The only additional information needed is the resolver to use.</p>
</div>
<div class="paragraph">
<p>The following example specifies a <code>create-cluster</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Clusters</span> <span class="directive">extends</span> ConfigBeanProxy, Injectable {

     <span class="comment">/**
      * Return the list of clusters currently configured
      *
      * @return list of {@link Cluster }
      */</span>
    <span class="annotation">@Element</span>
    <span class="annotation">@Create</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-cluster</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Cluster&gt; getCluster();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because there is only one instance of the parent type, <code>Clusters</code>, in
the configuration, this example uses the default resolver to retrieve
it. Therefore, no resolver needs to be specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-delete-annotation"><a class="anchor" href="#the-delete-annotation"></a>The <code>@Delete</code> Annotation</h4>
<div class="paragraph">
<p>By placing the <code>org.glassfish.config.support.Delete</code> annotation on a
method, you provide the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>value</code> element of the <code>@Delete</code> annotation is the name of the
<code>asadmin</code> subcommand that deletes the configuration object.</p>
</li>
<li>
<p>The method&#8217;s class is the type of the parent.</p>
</li>
<li>
<p>The method&#8217;s return type or parameter type is the type of the child.</p>
</li>
<li>
<p>The method is the accessor method that deletes a child of the
specified type from the parent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The only additional information needed is the resolver to use.</p>
</div>
<div class="paragraph">
<p>The following example specifies a <code>delete-cluster</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Clusters</span> <span class="directive">extends</span> ConfigBeanProxy, Injectable {

     <span class="comment">/**
      * Return the list of clusters currently configured
      *
      * @return list of {@link Cluster }
      */</span>
    <span class="annotation">@Element</span>
    <span class="annotation">@Delete</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">delete-cluster</span><span class="delimiter">&quot;</span></span>, resolver=TypeAndNameResolver.class)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Cluster&gt; getCluster();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>TypeAndNameResolver</code> uses the child type and the name operand
passed through the command line to retrieve the specific cluster
instance to be deleted.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-listing-annotation"><a class="anchor" href="#the-listing-annotation"></a>The <code>@Listing</code> Annotation</h4>
<div class="paragraph">
<p>By placing the <code>org.glassfish.config.support.Listing</code> annotation on a
method, you provide the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>value</code> element of the <code>@Listing</code> annotation is the name of the
<code>asadmin</code> subcommand that lists the configuration objects.</p>
</li>
<li>
<p>The method&#8217;s class is the type of the parent.</p>
</li>
<li>
<p>The method&#8217;s return type is the type of the children to be listed.</p>
</li>
<li>
<p>The method is always the following accessor method:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;ChildType&gt; getChildren()</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default resolver retrieves all of the children of the specified
type. Therefore, no resolver needs to be specified for a list command.</p>
</div>
<div class="paragraph">
<p>The following example specifies a <code>list-clusters</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Clusters</span> <span class="directive">extends</span> ConfigBeanProxy, Injectable {

     <span class="comment">/**
      * Return the list of clusters currently configured
      *
      * @return list of {@link Cluster }
      */</span>
    <span class="annotation">@Element</span>
    <span class="annotation">@Listing</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">list-clusters</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Cluster&gt; getCluster();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-command-decorators"><a class="anchor" href="#create-command-decorators"></a>Create Command Decorators</h4>
<div class="paragraph">
<p>Most create commands must do more than create a single configuration
object instance with default attribute values. For example, most create
commands allow the user to specify non-default attribute values through
command options. For another example, the <code>create-cluster</code> subcommand
creates children of the <code>Cluster</code> object and copies a referenced
<code>Config</code> object. A creation decorator provides the code necessary to
perform such additional operations.</p>
</div>
<div class="paragraph">
<p>The interface that a creation decorator must implement is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CreationDecorator</span>&lt;T <span class="directive">extends</span> ConfigBeanProxy&gt; {

    <span class="comment">/**
     * The element instance has been created and added to the parent, it can be
     * customized. This method is called within a
     * {@link org.jvnet.hk2.config.Transaction}
     * and instance is therefore a writeable view on the configuration component.
     *
     * @param context administration command context
     * @param instance newly created configuration element
     * @throws TransactionFailure if the transaction should be rollbacked
     * @throws PropertyVetoException if one of the listener of &lt;T&gt; is throwing
     * a veto exception
     */</span>
    <span class="directive">public</span> <span class="type">void</span> decorate(AdminCommandContext context, T instance)
        <span class="directive">throws</span> TransactionFailure, <span class="exception">PropertyVetoException</span>;

    <span class="comment">/**
     * Default implementation of a decorator that does nothing.
     */</span>
    <span class="annotation">@Service</span>
    <span class="directive">public</span> <span class="type">class</span> <span class="class">NoDecoration</span> <span class="directive">implements</span> CreationDecorator&lt;ConfigBeanProxy&gt; {
        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> decorate(AdminCommandContext context, ConfigBeanProxy instance)
            <span class="directive">throws</span> TransactionFailure, <span class="exception">PropertyVetoException</span> {
            <span class="comment">// do nothing</span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CreationDecorator interface is in the <code>org.glassfish.config.support</code>
package.</p>
</div>
<div class="paragraph">
<p>A <code>@Create</code> annotation specifies a creation decorator using a
<code>decorator</code> element. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Clusters</span> <span class="directive">extends</span> ConfigBeanProxy, Injectable {

     <span class="comment">/**
      * Return the list of clusters currently configured
      *
      * @return list of {@link Cluster }
      */</span>
    <span class="annotation">@Element</span>
    <span class="annotation">@Create</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-cluster</span><span class="delimiter">&quot;</span></span>, decorator=Cluster.Decorator.class)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Cluster&gt; getCluster();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Create</code> annotation is on a method of the parent class. However,
the referenced creation decorator class is associated with the child
class. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Cluster</span> <span class="directive">extends</span> ConfigBeanProxy, ... {

    ...

    <span class="annotation">@Service</span>
    <span class="annotation">@Scoped</span>(PerLookup.class)
    <span class="type">class</span> <span class="class">Decorator</span> <span class="directive">implements</span> CreationDecorator&lt;Cluster&gt; {

        <span class="annotation">@Param</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">config</span><span class="delimiter">&quot;</span></span>, optional=<span class="predefined-constant">true</span>)
        <span class="predefined-type">String</span> configRef=<span class="predefined-constant">null</span>;

        <span class="annotation">@Inject</span>
        Domain domain;

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> decorate(AdminCommandContext context, <span class="directive">final</span> Cluster instance)
                <span class="directive">throws</span> TransactionFailure, <span class="exception">PropertyVetoException</span> {

        ...

        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The decorator class can optionally be an inner class of the child class.
You can inject command options using the <code>@Param</code> annotation. You can
also inject HK2 services or configuration instances.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-command-decorators"><a class="anchor" href="#delete-command-decorators"></a>Delete Command Decorators</h4>
<div class="paragraph">
<p>Some delete commands must do more than delete a single configuration
object instance. For example, the <code>delete-cluster</code> subcommand deletes
the referenced <code>Config</code> object if no other <code>Cluster</code> or <code>Instance</code>
objects reference it. A deletion decorator provides the code necessary
to perform such additional operations.</p>
</div>
<div class="paragraph">
<p>The interface that a deletion decorator must implement is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * A decorator for acting upon a configuration element deletion.
 *
 * @param &lt;T&gt; the deleted element parent type
 * @param &lt;U&gt; the deleted element
 */</span>
<span class="annotation">@Scoped</span>(PerLookup.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">DeletionDecorator</span>&lt;T <span class="directive">extends</span> ConfigBeanProxy,
    U <span class="directive">extends</span> ConfigBeanProxy&gt; {

    <span class="comment">/**
     * notification of a configuration element of type U deletion.
     *
     * Note that this notification is called within the boundaries of the
     * configuration transaction, therefore the parent instance is a
     * writable copy and further changes to the parent can be made without
     * enrolling it inside a transaction.
     *
     * @param context the command context to lead to the element deletion
     * @param parent the parent instance the element was removed from
     * @param child the deleted instance
     */</span>
    <span class="directive">public</span> <span class="type">void</span> decorate(AdminCommandContext context, T parent, U child);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The DeletionDecorator interface is in the <code>org.glassfish.config.support</code>
package.</p>
</div>
<div class="paragraph">
<p>A <code>@Delete</code> annotation specifies a deletion decorator using a
<code>decorator</code> element. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Clusters</span> <span class="directive">extends</span> ConfigBeanProxy, Injectable {

     <span class="comment">/**
      * Return the list of clusters currently configured
      *
      * @return list of {@link Cluster }
      */</span>
    <span class="annotation">@Element</span>
    <span class="annotation">@Delete</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">delete-cluster</span><span class="delimiter">&quot;</span></span>, resolver= TypeAndNameResolver.class,
        decorator=Cluster.DeleteDecorator.class)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Cluster&gt; getCluster();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Delete</code> annotation is on a method of the parent class. However,
the referenced deletion decorator class is associated with the child
class. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Cluster</span> <span class="directive">extends</span> ConfigBeanProxy, ... {

    ..
    <span class="annotation">@Service</span>
    <span class="annotation">@Scoped</span>(PerLookup.class)
    <span class="type">class</span> <span class="class">DeleteDecorator</span> <span class="directive">implements</span> DeletionDecorator&lt;Clusters, Cluster&gt; {
        ....
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The decorator class can optionally be an inner class of the child class.
You can inject command options using the <code>@Param</code> annotation. You can
also inject HK2 services or configuration instances.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-command-execution"><a class="anchor" href="#specifying-command-execution"></a>Specifying Command Execution</h4>
<div class="paragraph">
<p>Commands specified with the <code>@Create</code>, <code>@Delete</code>, and <code>@Listing</code>
annotations can use the <code>@ExecuteOn</code> annotation. The <code>@ExecuteOn</code>
annotation specifies whether the command runs on the DAS, on server
instances, or both (the default). For more information, see
<a href="#specifying-asadmin-subcommand-execution">Specifying <code>asadmin</code> Subcommand Execution</a>.</p>
</div>
<div class="paragraph">
<p>To add an <code>@ExecuteOn</code> annotation to a <code>@Create</code> or <code>@Delete</code>
annotation, use the <code>cluster</code> element. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Create</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-instance</span><span class="delimiter">&quot;</span></span>, resolver=TypeResolver.class,
        decorator=Server.CreateDecorator.class,
        cluster=<span class="annotation">@org</span>.glassfish.api.admin.ExecuteOn(value=RuntimeType.DAS))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-multiple-command-annotations"><a class="anchor" href="#using-multiple-command-annotations"></a>Using Multiple Command Annotations</h4>
<div class="paragraph">
<p>You can specify multiple command annotations on the same method. The
following example combines create, delete, and list commands for
clusters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Clusters</span> <span class="directive">extends</span> ConfigBeanProxy, Injectable {

     <span class="comment">/**
      * Return the list of clusters currently configured
      *
      * @return list of {@link Cluster }
      */</span>
    <span class="annotation">@Element</span>
    <span class="annotation">@Create</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-cluster</span><span class="delimiter">&quot;</span></span>, decorator=Cluster.Decorator.class)
    <span class="annotation">@Delete</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">delete-cluster</span><span class="delimiter">&quot;</span></span>, resolver= TypeAndNameResolver.class,
        decorator=Cluster.DeleteDecorator.class)
    <span class="annotation">@Listing</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">list-clusters</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Cluster&gt; getCluster();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify multiple create or delete command annotations for
the same configuration object type using the <code>@Creates</code> or <code>@Deletes</code>
annotation (both in the <code>org.glassfish.config.support</code> package). For
example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Element</span>
<span class="annotation">@Creates</span>(
   <span class="annotation">@Create</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-something</span><span class="delimiter">&quot;</span></span>, decorator=CreateSomething.Decorator)
   <span class="annotation">@Create</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-something-else</span><span class="delimiter">&quot;</span></span>, decorator=CreateSomethingElse.Decorator)
   <span class="predefined-type">List</span>&lt;Something&gt; getSomethings();
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>These commands create configuration object instances of the same type.
Differences in the decorators and resolvers can produce differences in
the options each command takes. The <code>@Param</code> annotated attributes of the
created type define a superset of options for both commands.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-monitoring-capabilities-2"><a class="anchor" href="#adding-monitoring-capabilities-2"></a>Adding Monitoring Capabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Monitoring is the process of reviewing the statistics of a system to
improve performance or solve problems. By monitoring the state of
components and services that are deployed in the Eclipse GlassFish,
system administrators can identify performance bottlenecks, predict
failures, perform root cause analysis, and ensure that everything is
functioning as expected. Monitoring data can also be useful in
performance tuning and capacity planning.</p>
</div>
<div class="paragraph">
<p>An add-on component typically generates statistics that the Eclipse GlassFish can gather at run time. Adding monitoring capabilities enables an
add-on component to provide statistics to Eclipse GlassFish in the same
way as components that are supplied in Eclipse GlassFish distributions.
As a result, system administrators can use the same administrative
interfaces to monitor statistics from any installed Eclipse GlassFish
component, regardless of the origin of the component.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#defining-statistics-that-are-to-be-monitored">Defining Statistics That Are to Be Monitored</a></p>
</li>
<li>
<p><a href="#updating-the-monitorable-object-tree">Updating the Monitorable Object Tree</a></p>
</li>
<li>
<p><a href="#dotted-names-and-rest-urls-for-an-add-on-components-statistics">Dotted Names and REST URLs for an Add-On Component&#8217;s Statistics</a></p>
</li>
<li>
<p><a href="#example-of-adding-monitoring-capabilities">Example of Adding Monitoring Capabilities</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="defining-statistics-that-are-to-be-monitored"><a class="anchor" href="#defining-statistics-that-are-to-be-monitored"></a>Defining Statistics That Are to Be Monitored</h3>
<div class="paragraph">
<p>At runtime, your add-on component might perform operations that affect
the behavior and performance of your system. For example, your component
might start a thread of control, receive a request from a service, or
request a connection from a connection pool. Monitoring the statistics
that are related to these operations helps a system administrator
maintain the system.</p>
</div>
<div class="paragraph">
<p>To provide statistics to Eclipse GlassFish, your component must define
events for the operations that generate these statistics. At runtime,
your component must send these events when performing the operations for
which the events are defined. For example, to enable the number of
received requests to be monitored, a component must send a "request
received" event each time that the component receives a request.</p>
</div>
<div class="paragraph">
<p>A statistic can correspond to single event or to multiple events.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Counter statistics typically correspond to a single event. For
example, to calculate the number of received requests, only one event is
required, for example, a "request received" event. Every time that a
"request received" event is sent, the number of received requests is
increased by 1.</p>
</li>
<li>
<p>Timer statistics typically correspond to multiple events. For example,
to calculate the time to process a request, two requests, for example, a
"request received" event and a "request completed" event.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Defining statistics that are to be monitored involves the following
tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#defining-an-event-provider">Defining an Event Provider</a></p>
</li>
<li>
<p><a href="#sending-an-event">Sending an Event</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="defining-an-event-provider"><a class="anchor" href="#defining-an-event-provider"></a>Defining an Event Provider</h4>
<div class="paragraph">
<p>An event provider defines the types of events for the operations that
generate statistics for an add-on component.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish enables you to define an event provider in the
following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>By writing a Java Class. Define an event provider this way if you have
access to the source code of the component for which you are defining an
event provider.</p>
</li>
<li>
<p>By writing an XML fragment. Define an event provider this way if you
do not have access to the source code of the component for which you are
defining and event provider.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="defining-an-event-provider-by-writing-a-java-class"><a class="anchor" href="#defining-an-event-provider-by-writing-a-java-class"></a>Defining an Event Provider by Writing a Java Class</h5>
<div class="paragraph">
<p>To define an event provider, write a Java language class that defines
the types of events for the component. Your class is not required to
extend any specific class or implement any interfaces.</p>
</div>
<div class="paragraph">
<p>To identify your class as an event provider, annotate the declaration of
the class with the
<code>org.glassfish.external.probe.provider.annotations.ProbeProvider</code>
annotation.</p>
</div>
<div class="paragraph">
<p>To create a name space for event providers and to uniquely identify an
event provider to the monitoring infrastructure of Eclipse GlassFish, set
the elements of the <code>@ProbeProvider</code> annotation as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>moduleProviderName</code></dt>
<dd>
<p>Your choice of text to identify the application to which the event
provider belongs. The value of the <code>moduleProviderName</code> element is not
required to be unique.
For example, for event providers from Eclipse GlassFish, <code>moduleProviderName</code> is <code>glassfish</code>.</p>
</dd>
<dt class="hdlist1"><code>moduleName</code></dt>
<dd>
<p>Your choice of name for the module for which the event provider is
defined. A module provides significant functionality of an
application. The value of the <code>moduleName</code> element is not required to
be unique.
In Eclipse GlassFish, examples of module names are <code>web-container</code>,
<code>ejb-container</code>, <code>transaction</code>, and <code>webservices</code>.</p>
</dd>
<dt class="hdlist1"><code>probeProviderName</code></dt>
<dd>
<p>Your choice of name to identify the event provider. To uniquely
identify the event provider, ensure that <code>probeProviderName</code> is unique
for all event providers in the same module.
In Eclipse GlassFish, examples of event-provider names are <code>jsp</code>,
<code>servlet</code>, and <code>web-module</code>.</p>
</dd>
</dl>
</div>
<div id="defining-event-types-in-an-event-provider-class" class="paragraph">
<p>Defining Event Types in an Event Provider Class</p>
</div>
<div class="paragraph">
<p>To define event types in an event provider class, write one method for
each type of event that is related to the component. The requirements
for each method are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The return value of the callback methods must be void.</p>
</li>
<li>
<p>The method body must be empty. You instantiate the event provider
class in the class that invokes the method to send the event.
For more information, see <a href="#sending-an-event">Sending an Event</a>.</p>
</li>
<li>
<p>To enable the event to be used as an Oracle Solaris DTrace probe, each
parameter in the method signature must be a Java language primitive,
such as <code>Integer</code>, <code>boolean</code>, or <code>String</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Annotate the declaration of each method with the
<code>org.glassfish.external.probe.provider.annotations.Probe</code> annotation.</p>
</div>
<div class="paragraph">
<p>By default, the type of the event is the method name. If you overload a
method in your class, you must uniquely identify the event type for each
form of the method. To uniquely identify the event type, set the <code>name</code>
element of the <code>@Probe</code> annotation to the name of the event type.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You are not required to uniquely identify the event type for methods that are not overloaded.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="specifying-event-parameters" class="paragraph">
<p>Specifying Event Parameters</p>
</div>
<div class="paragraph">
<p>To enable methods in an event listener to select a subset of values,
annotate each parameter in the method signature with the
<code>org.glassfish.external.probe.provider.annotations.ProbeParam</code>
annotation. Set the <code>value</code> element of the <code>@ProbeParam</code> annotation to
the name of the parameter.</p>
</div>
<div id="example-of-defining-an-event-provider-by-writing-a-java-class" class="paragraph">
<p>Example of Defining an Event Provider by Writing a Java Class</p>
</div>
<div id="ghprw" class="paragraph">
<p>Example 5-1 Defining an Event Provider by Writing a Java Class</p>
</div>
<div class="paragraph">
<p>This example shows the definition of the <code>TxManager</code> class. This class
defines events for the start and end of transactions that are performed
by a transaction manager.</p>
</div>
<div class="paragraph">
<p>The methods in this class are as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>onTxBegin</code></dt>
<dd>
<p>This method sends an event to indicate the start of a transaction. The
name of the event type that is associated with this method is <code>begin</code>.
A parameter that is named <code>txId</code> is passed to the method.</p>
</dd>
<dt class="hdlist1"><code>onCompletion</code></dt>
<dd>
<p>This method sends an event to indicate the end of a transaction. The
name of the event type that is associated with this method is <code>end</code>. A
parameter that is named <code>outcome</code> is passed to the method.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.Probe</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeParam</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeProvider</span>;
<span class="annotation">@ProbeProvider</span>(moduleProviderName=<span class="string"><span class="delimiter">&quot;</span><span class="content">examplecomponent</span><span class="delimiter">&quot;</span></span>,
moduleName=<span class="string"><span class="delimiter">&quot;</span><span class="content">transaction</span><span class="delimiter">&quot;</span></span>, probeProviderName=<span class="string"><span class="delimiter">&quot;</span><span class="content">manager</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TxManager</span> {

    <span class="annotation">@Probe</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">begin</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> onTxBegin(
        <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{txId}</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> txId
    ){}

    <span class="annotation">@Probe</span> (<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> onCompletion(
        <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{outcome}</span><span class="delimiter">&quot;</span></span>) <span class="type">boolean</span> outcome
    ){}
 }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="defining-an-event-provider-by-writing-an-xml-fragment"><a class="anchor" href="#defining-an-event-provider-by-writing-an-xml-fragment"></a>Defining an Event Provider by Writing an XML Fragment</h5>
<div class="paragraph">
<p>To define an event provider, write an extensible markup language (XML)
fragment that contains a single <code>probe-provider</code> element.</p>
</div>
<div class="paragraph">
<p>To create a name space for event providers and to uniquely identify an
event provider to the monitoring infrastructure of Eclipse GlassFish, set
the attributes of the <code>probe-provider</code> element as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>moduleProviderName</code></dt>
<dd>
<p>Your choice of text to identify the application to which the event
provider belongs. The value of the <code>moduleProviderName</code> attribute is
not required to be unique.
For example, for event providers from Eclipse GlassFish, <code>moduleProviderName</code> is <code>glassfish</code>.</p>
</dd>
<dt class="hdlist1"><code>moduleName</code></dt>
<dd>
<p>Your choice of name for the module for which the event provider is
defined. A module provides significant functionality of an
application. The value of the <code>moduleName</code> attribute is not required
to be unique.
In Eclipse GlassFish, examples of module names are <code>web-container</code>,
<code>ejb-container</code>, <code>transaction</code>, and <code>webservices</code>.</p>
</dd>
<dt class="hdlist1"><code>probeProviderName</code></dt>
<dd>
<p>Your choice of name to identify the event provider. To uniquely
identify the event provider, ensure that <code>probeProviderName</code> is unique
for all event providers in the same module.
In Eclipse GlassFish, examples of event—provider names are <code>jsp</code>,
<code>servlet</code>, and <code>web-module</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Within the <code>probe-provider</code> element, add one <code>probe</code> element for each
event type that you are defining. To identify the event type, set the
name attribute of the <code>probe</code> element to the type.</p>
</div>
<div class="paragraph">
<p>To define the characteristics of each event type, add the following
elements within the <code>probe</code> element:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>class</code></dt>
<dd>
<p>This element contains the fully qualified Java class name of the
component that generates the statistics for which you are defining
events.</p>
</dd>
<dt class="hdlist1"><code>method</code></dt>
<dd>
<p>This element contains the name of the method that is invoked to
generate the statistic.</p>
</dd>
<dt class="hdlist1"><code>signature</code></dt>
<dd>
<p>This element contains the following information about the signature if
the method:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>return-type (paramater-type-list)</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>return-type</code></dt>
<dd>
<p>The return type of the method.</p>
</dd>
<dt class="hdlist1"><code>paramater-type-list</code></dt>
<dd>
<p>A comma-separated list of the types of the parameters in the method
signature.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>probe-param</code></dt>
<dd>
<p>The attributes of this element identify the type and the name of a
parameter in the method signature. One <code>probe-param</code> element is
required for each parameter in the method signature. The <code>probe-param</code>
element does not contain any data.
The attributes of the <code>probe-param</code> element are as follows:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p>Specifies the type of the parameter.</p>
</dd>
<dt class="hdlist1"><code>name</code></dt>
<dd>
<p>Specifies the name of the parameter.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>return-param</code></dt>
<dd>
<p>The <code>type</code> attribute of this element specifies the return type of the
method. The <code>return-param</code> element does not contain any data.</p>
</dd>
</dl>
</div>
<div id="gkajj" class="paragraph">
<p>Example 5-2 Defining an Event Provider by Writing an XML Fragment</p>
</div>
<div class="paragraph">
<p>This example defines an event provider for the <code>glassfish:web:jsp</code>
component. The Java class of this component is
<code>com.sun.enterprise.web.jsp.JspProbeEmitterImpl</code>. The event provider
defines one event of type <code>jspLoadedEvent</code>. The signature of the method
that is associated with this event is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">void</span> jspLoaded(<span class="predefined-type">String</span> jsp, <span class="predefined-type">String</span> hostName)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;probe-provider</span> <span class="attribute-name">moduleProviderName</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">glassfish</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">moduleName</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">web</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">probeProviderName</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jsp</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;probe</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jspLoadedEvent</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
       <span class="tag">&lt;class&gt;</span>com.sun.enterprise.web.jsp.JspProbeEmitterImpl<span class="tag">&lt;/class&gt;</span>
       <span class="tag">&lt;method&gt;</span>jspLoaded<span class="tag">&lt;/method&gt;</span>
       <span class="tag">&lt;signature&gt;</span>void (String,String)<span class="tag">&lt;/signature&gt;</span>
       <span class="tag">&lt;probe-param</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jsp</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;probe-param</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hostName</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
       <span class="tag">&lt;return-param</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">void</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;/probe&gt;</span>
<span class="tag">&lt;/probe-provider&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="packaging-a-components-event-providers"><a class="anchor" href="#packaging-a-components-event-providers"></a>Packaging a Component&#8217;s Event Providers</h5>
<div class="paragraph">
<p>Packaging a component&#8217;s event providers enables the monitoring
infrastructure of Eclipse GlassFish to discover the event providers automatically.</p>
</div>
<div class="paragraph">
<p>To package a component&#8217;s event providers, add an entry to the
component&#8217;s <code>META-INF/MANIFEST.MF</code> file that identifies all of the
component&#8217;s event providers. The format of the entry depends on how the
event providers are defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the event providers are defined as Java classes, the entry is a
list of the event providers' class names as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>probe-provider-class-names : class-list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>class-list</code> is a comma-separated list of the fully qualified Java
class names of the component&#8217;s event providers.</p>
</div>
</li>
<li>
<p>If the event providers are defined as XML fragments, the entry is a
list of the paths to the files that contain the XML fragments as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>probe-provider-xml-file-names : path-list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>path-list</code> is a comma-separated list of the paths to the XML files
relative to the root of the archive in the JAR file.</p>
</div>
</li>
</ul>
</div>
<div id="gkaii" class="paragraph">
<p>Example 5-3 Manifest Entry for Event Providers That Are Defined as Java Classes</p>
</div>
<div class="paragraph">
<p>This example shows the entry in the <code>META-INF/MANIFEST.MF</code> file of a
component whose event provider is the
<code>org.glassfish.pluggability.monitoring.ModuleProbeProvider</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>probe-provider-class-names : org.glassfish.pluggability.monitoring.ModuleProbeProvider</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sending-an-event"><a class="anchor" href="#sending-an-event"></a>Sending an Event</h4>
<div class="paragraph">
<p>At runtime, your add-on component might perform an operation that
generates statistics. To provide statistics about the operation to
Eclipse GlassFish, your component must send an event of the correct type
when performing the operation.</p>
</div>
<div class="paragraph">
<p>To send an event, instantiate your event provider class and invoke the
method of the event provider class for the type of the event.
Instantiate the class and invoke the method in the class that represents
your add-on component. Ensure that the method is invoked when your
component performs the operation for which the event was defined. One
way to meet this requirement is to invoke the method for sending the
event in the body of the method for performing the operation.</p>
</div>
<div id="ghpus" class="paragraph">
<p>Example 5-4 Sending an Event</p>
</div>
<div class="paragraph">
<p>This example shows the code for instantiating the <code>TxManager</code> class and
invoking the <code>onTxBegin</code> method to send an event of type <code>begin</code>. This
event indicates that a component is about to begin a transaction.</p>
</div>
<div class="paragraph">
<p>The <code>TxManager</code> class is instantiated in the constructor of the
<code>TransactionManagerImpl</code> class. To ensure that the event is sent at the
correct time, the <code>onTxBegin</code> method is invoked in the body of the
<code>begin</code> method, which starts a transaction.</p>
</div>
<div class="paragraph">
<p>The declaration of the <code>onTxBegin</code> method in the event provider
interface is shown in <a href="#ghprw">Example 5-1</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
public <span class="type">class</span> <span class="class">TransactionManagerImpl</span> {
...
     public TransactionManagerImpl() {
         TxManager txProvider = <span class="keyword">new</span> TxManager();
         ...
     }
    ...
    public <span class="type">void</span> begin() {
        <span class="predefined-type">String</span> txId = createTransactionId();
        ....
        txProvider.onTxBegin(txId); <span class="comment">//emit</span>
      }
...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="updating-the-monitorable-object-tree"><a class="anchor" href="#updating-the-monitorable-object-tree"></a>Updating the Monitorable Object Tree</h3>
<div class="paragraph">
<p>A monitorable object is a component, subcomponent, or service that can
be monitored. Eclipse GlassFish uses a tree structure to track
monitorable objects.</p>
</div>
<div class="paragraph">
<p>Because the tree is dynamic, the tree changes as components of the
Eclipse GlassFish instance are added, modified, or removed. Objects are
also added to or removed from the tree in response to configuration
changes. For example, if monitoring for a component is turned off, the
component&#8217;s monitorable object is removed from the tree.</p>
</div>
<div class="paragraph">
<p>To enable system administrators to access statistics for all components
in the same way, you must provide statistics for an add-on component by
updating the monitorable object tree. Statistics for the add-on
component are then available through the Eclipse GlassFish administrative
commands <a href="reference-manual.html#get"><code>get</code></a>, <a href="reference-manual.html#list"><code>list</code></a>, and
<a href="reference-manual.html#set"><code>set</code></a>. These commands locate an object in the tree
through the object&#8217;s dotted name.</p>
</div>
<div class="paragraph">
<p>For more information about the tree structure of monitorable objects,
see "<a href="administration-guide.html#how-the-monitoring-tree-structure-works">How the Monitoring Tree Structure Works</a>" in
Eclipse GlassFish Administration Guide.</p>
</div>
<div class="paragraph">
<p>To make an add-on component a monitorable object, you must add the
add-on component to the monitorable object tree.</p>
</div>
<div class="paragraph">
<p>To update the statistics for an add-on component, you must add the
statistics to the monitorable object tree, and create event listeners to
gather statistics from events that represent these statistics. At
runtime, these listeners must update monitorable objects with statistics
that these events contain. The events are sent by event provider
classes. For information about how to create event provider classes and
send events, see <a href="#defining-statistics-that-are-to-be-monitored">Defining Statistics That Are to Be
Monitored</a>.</p>
</div>
<div class="paragraph">
<p>Updating the monitorable object tree involves the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#creating-event-listeners">Creating Event Listeners</a></p>
</li>
<li>
<p><a href="#representing-a-components-statistics-in-an-event-listener-class">Representing a Component&#8217;s Statistics in an Event Listener Class</a></p>
</li>
<li>
<p><a href="#subscribing-to-events-from-event-provider-classes">Subscribing to Events From Event Provider Classes</a></p>
</li>
<li>
<p><a href="#registering-an-event-listener">Registering an Event Listener</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="creating-event-listeners"><a class="anchor" href="#creating-event-listeners"></a>Creating Event Listeners</h4>
<div class="paragraph">
<p>An event listener gathers statistics from events that an event provider
sends. To enable an add-on component to gather statistics from events,
create listeners to receive events from the event provider. The listener
can receive events from the add-on component in which the listener is
created and from other components.</p>
</div>
<div class="paragraph">
<p>To create an event listener, write a Java class to represent the
listener. The listener can be any Java object.</p>
</div>
<div class="paragraph">
<p>An event listener also represents a component&#8217;s statistics. To enable
the Application Server Management Extensions (AMX) to expose the
statistics to client applications, annotate the declaration of the class
with the <code>org.glassfish.gmbal.ManagedObject</code> annotation.</p>
</div>
<div class="paragraph">
<p>Ensure that the class that you write meets these requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The return value of all callback methods in the listener must be void.</p>
</li>
<li>
<p>Because the methods of your event provider class may be entered by
multiple threads, the listener must be thread safe. However,Eclipse GlassFish provides utility classes to perform some common operations such
as <code>count</code>, <code>avg</code>, and <code>sum</code>.</p>
</li>
<li>
<p>The listener must have the same restrictions as a Jakarta EE application. For example, the listener
cannot open server sockets, or create threads.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A listener is called in the same thread as the event method. As a
result, the listener can use thread locals. If the monitored system
allows access to thread locals, the listener can access thread locals of
the monitored system.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A listener that is not registered to listen for events is never called
by the framework. Therefore, unregistered listeners do not consume any
computing resources, such as memory or processor cycles.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="representing-a-components-statistics-in-an-event-listener-class"><a class="anchor" href="#representing-a-components-statistics-in-an-event-listener-class"></a>Representing a Component&#8217;s Statistics in an Event Listener Class</h4>
<div class="paragraph">
<p>Represent each statistic as the property of a JavaBeans specification
getter method of your listener class. Methods in the listener class for
processing events can then access the property through the getter
method. For more information, see <a href="#subscribing-to-events-from-event-provider-classes">Subscribing to Events From
Event Provider Classes</a>.</p>
</div>
<div class="paragraph">
<p>To enable AMX to expose the statistic to client applications, annotate
the declaration of the getter method with the
<code>org.glassfish.gmbal.ManagedAttribute</code> annotation. Set the <code>id</code> element
of the <code>@ManagedAttribute</code> annotation to the property name all in
lowercase.</p>
</div>
<div class="paragraph">
<p>The data type of the property that represents a statistic must be a
class that provides methods for computing the statistic from event data.</p>
</div>
<div class="paragraph">
<p>The <code>org.glassfish.external.statistics.impl</code> package provides the
following classes to gather and compute statistics data:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>AverageRangeStatisticImpl</code></dt>
<dd>
<p>Provides standard measurements of the lowest and highest values that
an attribute has held and the current value of the attribute.</p>
</dd>
<dt class="hdlist1"><code>BoundaryStatisticImpl</code></dt>
<dd>
<p>Provides standard measurements of the upper and lower limits of the
value of an attribute.</p>
</dd>
<dt class="hdlist1"><code>BoundedRangeStatisticImpl</code></dt>
<dd>
<p>Aggregates the attributes of <code>RangeStatisticImpl</code> and
<code>BoundaryStatisticImpl</code> and provides standard measurements of a range
that has fixed limits.</p>
</dd>
<dt class="hdlist1"><code>CountStatisticImpl</code></dt>
<dd>
<p>Provides standard count measurements.</p>
</dd>
<dt class="hdlist1"><code>RangeStatisticImpl</code></dt>
<dd>
<p>Provides standard measurements of the lowest and highest values that
an attribute has held and the current value of the attribute.</p>
</dd>
<dt class="hdlist1"><code>StatisticImpl</code></dt>
<dd>
<p>Provides performance data.</p>
</dd>
<dt class="hdlist1"><code>StringStatisticImpl</code></dt>
<dd>
<p>Provides a string equivalent of a counter statistic.</p>
</dd>
<dt class="hdlist1"><code>TimeStatisticImpl</code></dt>
<dd>
<p>Provides standard timing measurements.</p>
</dd>
</dl>
</div>
<div id="ghpsc" class="paragraph">
<p>Example 5-5 Representing a Component&#8217;s Statistics in an Event Listener
Class</p>
</div>
<div class="paragraph">
<p>This example shows the code for representing the <code>txcount</code> statistic in
the <code>TxListener</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.glassfish.external.statistics.CountStatistic;
<span class="keyword">import</span> <span class="include">org.glassfish.external.statistics.impl.CountStatisticImpl</span>;
...
import org.glassfish.gmbal.ManagedAttribute;
<span class="keyword">import</span> <span class="include">org.glassfish.gmbal.ManagedObject</span>;

...
<span class="annotation">@ManagedObject</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TxListener</span> {

    <span class="directive">private</span> CountStatisticImpl txCount = <span class="keyword">new</span> CountStatisticImpl(<span class="string"><span class="delimiter">&quot;</span><span class="content">TxCount</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Number of completed transactions</span><span class="delimiter">&quot;</span></span>);
...
    <span class="annotation">@ManagedAttribute</span>(id=<span class="string"><span class="delimiter">&quot;</span><span class="content">txcount</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> CountStatistic  getTxCount(){
         <span class="keyword">return</span> txCount;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="subscribing-to-events-from-event-provider-classes"><a class="anchor" href="#subscribing-to-events-from-event-provider-classes"></a>Subscribing to Events From Event Provider Classes</h4>
<div class="paragraph">
<p>To receive events from event provider classes, a listener must subscribe
to the events. Subscribing to events also specifies the provider and the
type of events that the listener will receive.</p>
</div>
<div class="paragraph">
<p>To subscribe to events from event provider classes, write one method in
your listener class to process each type of event. To specify the
provider and the type of event, annotate the method with the
<code>org.glassfish.external.probe.provider.annotations.ProbeListener</code>
annotation. In the <code>@ProbeListener</code> annotation, specify the provider and
the type as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&quot;module-providername:module-name:probe-provider-name:event-type&quot;</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">module-providername</dt>
<dd>
<p>The application to which the event provider belongs. This parameter
must be the value of the <code>moduleProviderName</code> element or attribute in
the definition of the event provider. See <a href="#defining-an-event-provider-by-writing-a-java-class">Defining an
Event Provider by Writing a Java Class</a> and <a href="#defining-an-event-provider-by-writing-an-xml-fragment">Defining an
Event Provider by Writing an XML Fragment</a>.</p>
</dd>
<dt class="hdlist1">module-name</dt>
<dd>
<p>The module for which the event provider is defined. This parameter
must match be the value of the <code>moduleName</code> element or attribute in
the definition of the event provider. See <a href="#defining-an-event-provider-by-writing-a-java-class">Defining an
Event Provider by Writing a Java Class</a> and <a href="#defining-an-event-provider-by-writing-an-xml-fragment">Defining an
Event Provider by Writing an XML Fragment</a>.</p>
</dd>
<dt class="hdlist1">probe-provider-name</dt>
<dd>
<p>The name of the event provider. This parameter must match be the value
of the <code>probeProviderName</code> element or attribute in the definition of
the event provider. See <a href="#defining-an-event-provider-by-writing-a-java-class">Defining an Event Provider by
Writing a Java Class</a> and <a href="#defining-an-event-provider-by-writing-an-xml-fragment">Defining an Event Provider by
Writing an XML Fragment</a>.</p>
</dd>
<dt class="hdlist1">event-type</dt>
<dd>
<p>The type of the event. This type is defined in the event provider
class. For more information, see <a href="#defining-event-types-in-an-event-provider-class">Defining Event Types in
an Event Provider Class</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Annotate each parameter in the method signature with the <code>@ProbeParam</code>
annotation. Set the <code>value</code> element of the <code>@ProbeParam</code> annotation to
the name of the parameter.</p>
</div>
<div class="paragraph">
<p>In the method body, provide the code to update monitoring statistics in
response to the event.</p>
</div>
<div id="ghpwu" class="paragraph">
<p>Example 5-6 Subscribing to Events From Event Provider Classes</p>
</div>
<div class="paragraph">
<p>This example shows the code for subscribing to events of type <code>begin</code>
from the <code>tx</code> component. The provider of the component is <code>TxManager</code>.
The body of the <code>begin</code> method contains code to increase the transaction
count txcount by 1 each time that an event is received.</p>
</div>
<div class="paragraph">
<p>The definition of the <code>begin</code> event type is shown in <a href="#ghprw">Example 5-1</a>.</p>
</div>
<div class="paragraph">
<p>The code for sending <code>begin</code> events is shown in <a href="#ghpus">Example 5-4</a>.</p>
</div>
<div class="paragraph">
<p>The instantiation of the <code>txCount</code> object is shown in
<a href="#ghpsc">Example 5-5</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.glassfish.external.probe.provider.annotations.ProbeListener;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeParam</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.gmbal.ManagedObject</span>;
...
<span class="annotation">@ManagedObject</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TxListener</span> {
    ...;    <span class="annotation">@ProbeListner</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">examplecomponent:transaction:manager:begin</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> begin(
    <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{txId}</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> txId) {
      txCount.increment();
    }
  }</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="listening-for-changes-to-values-that-are-not-part-of-the-target-method-definition"><a class="anchor" href="#listening-for-changes-to-values-that-are-not-part-of-the-target-method-definition"></a>Listening for Changes to Values That are Not Part of the Target Method Definition</h5>
<div class="paragraph">
<p>Event listeners can express their interest in certain predefined values
that are not part of the target method definition. For example,
$\{gf.appname}, $\{gf.modulename} etc. are some of the computed params
that are available to the clients, these values are computed/evaluated
only on demand and provided by the event infrastructure.</p>
</div>
</div>
<div class="sect4">
<h5 id="getting-information-about-a-event-provider"><a class="anchor" href="#getting-information-about-a-event-provider"></a>Getting Information About a Event Provider</h5>
<div class="paragraph">
<p><code>ProbeProviderInfo</code> contains details about individual event types in an
event provider class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ProbeProviderInfo</span> {

      <span class="directive">public</span> <span class="predefined-type">String</span> getModuleName();

      <span class="directive">public</span> <span class="predefined-type">String</span> getProviderName();

      <span class="directive">public</span> <span class="predefined-type">String</span> getApplicationName();

      <span class="directive">public</span> <span class="predefined-type">String</span> getProbeName();

      <span class="directive">public</span> <span class="predefined-type">String</span><span class="type">[]</span> getParamterNames();

      <span class="directive">public</span> <span class="predefined-type">Class</span> getParamterTypes();

 }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="listening-for-events-from-classes-that-are-not-event-providers"><a class="anchor" href="#listening-for-events-from-classes-that-are-not-event-providers"></a>Listening for Events From Classes That Are Not Event Providers</h4>
<div class="paragraph">
<p>gfProbes infrastructure allows clients to monitor glassfish even in the
absence of provider classes. This is done by allowing clients to receive
callbacks when a java methods are entered / exited. Note that while this
approach allows a client to monitor legacy code, it may not always be
possible to receive "high-level" events.</p>
</div>
<div class="paragraph">
<p>For example, while it is easy to monitor (through gfProbes) when
TransactionManagerImpl.begin() entered / exited, the client cannot
determine the transaction ID in this case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TxMonitor</span> {
     <span class="annotation">@MethodEntry</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">tx:com.sun.tx.TxMgrImpl::onTxBegin</span><span class="delimiter">&quot;</span></span>)
     <span class="directive">public</span> <span class="type">void</span> onTx(<span class="predefined-type">String</span> tId) {
       count++;
     }
  }</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="monitoring-method-entry"><a class="anchor" href="#monitoring-method-entry"></a>Monitoring Method Entry</h5>
<div class="paragraph">
<p>The @MethodEntry annotation must be used by the client to receive
callback when the target method is entered. The client method argument
types and count must match the target methods parameter types/count.</p>
</div>
</div>
<div class="sect4">
<h5 id="monitoring-method-exit"><a class="anchor" href="#monitoring-method-exit"></a>Monitoring Method Exit</h5>
<div class="paragraph">
<p>The @MethodExit annotation must be used by the client to receive
callback when the target method is exited. The client method argument
types and count must match the target methods parameter types/count. The
first parameter in the client method should match the return type of the
target method (only if the target method has a non void return type)</p>
</div>
</div>
<div class="sect4">
<h5 id="monitoring-exceptions"><a class="anchor" href="#monitoring-exceptions"></a>Monitoring Exceptions</h5>
<div class="paragraph">
<p>The @OnException annotation must be used by the client to receive
callback when the target method exits because of an exception. The
client method argument types and count must match the target methods
parameter types/count. (This restriction might be removed later). The
first parameter in the client method should be of type Throwable</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="registering-an-event-listener"><a class="anchor" href="#registering-an-event-listener"></a>Registering an Event Listener</h4>
<div class="paragraph">
<p>Registering an event listener enables the listener to receive callbacks
from the Eclipse GlassFish event infrastructure. The listener can then
collect data from events and update monitorable objects in the object
tree. These monitorable objects form the basis for monitoring
statistics.</p>
</div>
<div class="paragraph">
<p>Registering an event listener also makes a component and its statistics
monitorable objects by adding statistics for the component to the
monitorable object tree.</p>
</div>
<div class="paragraph">
<p>At runtime, the Eclipse GlassFish event infrastructure registers
listeners for an event provider when the event provider is started and
unregisters them when the event provider is shut down. As a result,
listeners have no dependencies on other components.</p>
</div>
<div class="paragraph">
<p>To register a listener, invoke the static
<code>org.glassfish.external.probe.provider.StatsProviderManager.register</code>
method in the class that represents your add-on component. In the method
invocation, pass the following information as parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The name of the configuration element with which all statistics in the
event listener are to be associated. System administrators use this
element for enabling or disabling monitoring for the event listener.</p>
</li>
<li>
<p>The node in the monitorable object tree under which the event listener
is to be registered. To specify the node, pass one of the following
constants of the
<code>org.glassfish.external.probe.provider.PluginPointPluginPoint</code>
enumeration:</p>
<div class="ulist">
<ul>
<li>
<p>To register the listener under the <code>server/applications</code> node, pass
the <code>APPLICATIONS</code> constant.</p>
</li>
<li>
<p>To register the listener under the <code>server</code> node, pass the <code>SERVER</code>
constant.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The path through the monitorable object tree from the node under which
the event listener is registered down to the statistics in the event
listener. The nodes in this path are separated by the slash (<code>/</code>)
character.</p>
</li>
<li>
<p>The listener object that you are registering.</p>
</li>
</ul>
</div>
<div id="ghpuu" class="paragraph">
<p>Example 5-7 Registering an Event Listener</p>
</div>
<div class="paragraph">
<p>This example shows the code for registering the event listener
<code>TxListener</code> for the add-on component that is represented by the class
<code>TransactionManagerImpl</code>. The statistics that are defined in this
listener are associated with the <code>web-container</code> configuration element.
The listener is registered under the <code>server/applications</code> node. The
path from this node to the statistics in the event listener is
<code>tx/txapp</code>.</p>
</div>
<div class="paragraph">
<p>Code for the constructor of the <code>TxListener</code> class is beyond the scope
of this example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.glassfish.external.probe.provider.StatsProviderManager;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.PluginPoint</span>
...
<span class="include">public</span> <span class="include">class</span> <span class="include">TransactionManagerImpl</span> {
...
    <span class="include">StatsProviderManager.register</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">web-container</span><span class="delimiter">&quot;</span></span>, <span class="include">PluginPoint.APPLICATIONS</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">tx/txapp</span><span class="delimiter">&quot;</span></span>, <span class="include">new</span> <span class="include">TxListener</span>());
...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotted-names-and-rest-urls-for-an-add-on-components-statistics"><a class="anchor" href="#dotted-names-and-rest-urls-for-an-add-on-components-statistics"></a>Dotted Names and REST URLs for an Add-On Component&#8217;s Statistics</h3>
<div class="paragraph">
<p>The Eclipse GlassFish administrative subcommands <a href="reference-manual.html#get"><code>get</code></a>,
<a href="reference-manual.html#list"><code>list</code></a>, and <a href="reference-manual.html#set"><code>set</code></a> locate a statistic
through the dotted name of the statistic. The dotted name of a statistic
for an add-on component is determined from the registration of the event
listener that defines the statistic as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>listener-parent-node.path-to-statistic.statistic-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">listener-parent-node</dt>
<dd>
<p>The node in the monitorable object tree under which the event listener
that defines the statistic is registered. This node is passed in the
invocation of the <code>register</code> method that registers the event listener.
For more information, see <a href="#registering-an-event-listener">Registering an Event Listener</a>.</p>
</dd>
<dt class="hdlist1">path-to-statistic</dt>
<dd>
<p>The path through the monitorable object tree from the node under which
the event listener is registered down to the statistic in the event
listener in which each slash is replaced with a period. This path is
passed in the invocation of the <code>register</code> method that registers the
event listener. For more information, see <a href="#registering-an-event-listener">Registering an
Event Listener</a>.</p>
</dd>
<dt class="hdlist1">statistic-name</dt>
<dd>
<p>The name of the statistic. This name is the value of the <code>id</code> element
of the <code>@ManagedAttribute</code> annotation on the property that represents
the statistic. For more information, see <a href="#representing-a-components-statistics-in-an-event-listener-class">Representing a
Component&#8217;s Statistics in an Event Listener Class</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For example, the dotted name of the <code>txcount</code> statistic that is defined
in <a href="#ghpsc">Example 5-5</a> and registered in <a href="#ghpuu">Example 5-7</a>
is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>server.applications.tx.txapp.txcount</code></pre>
</div>
</div>
<div class="paragraph">
<p>The formats of the URL to a REST resource that represents a statistic is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://host:port/monitoring/domain/path</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">host</dt>
<dd>
<p>The host where the DAS is running.</p>
</dd>
<dt class="hdlist1">port</dt>
<dd>
<p>The HTTP port or HTTPS port for administration.</p>
</dd>
<dt class="hdlist1">path</dt>
<dd>
<p>The path to the statistic. The path is the dotted name of the
attribute in which each dot (<code>.</code>) is replaced with a slash (<code>/</code>).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For example, the URL the REST resource for the <code>txcount</code> statistic that
is defined in <a href="#ghpsc">Example 5-5</a> and registered in
<a href="#ghpuu">Example 5-7</a> is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhost:4848/monitoring/domain/server/applications/tx/txapp/txcount</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the DAS is running on the local host and the HTTP port
for administration is 4848.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-a-type-to-the-monitor-command"><a class="anchor" href="#adding-a-type-to-the-monitor-command"></a>Adding a Type to the <code>monitor</code> Command</h3>
<div class="paragraph">
<p>To add a type to the <code>monitor</code> command, implement the <code>MonitorContract</code> interface.</p>
</div>
<div class="paragraph">
<p>An implementation of the <code>MonitorContract</code> interface is an HK2 service
that provides monitoring data to the <code>monitor</code> command.</p>
</div>
</div>
<div class="sect2">
<h3 id="example-of-adding-monitoring-capabilities"><a class="anchor" href="#example-of-adding-monitoring-capabilities"></a>Example of Adding Monitoring Capabilities</h3>
<div class="paragraph">
<p>This example shows a component that monitors the number of requests that
a container receives. The following table provides a cross-reference to
the listing of each class or interface in the example.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Interface</th>
<th class="tableblock halign-left valign-top">Listing</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ModuleProbeProvider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ghpna">Example 5-8</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ModuleBootStrap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ghpmu">Example 5-9</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ModuleStatsTelemetry</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ghpvw">Example 5-10</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Module</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ghpuc">Example 5-11</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ModuleMBean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ghpwx">Example 5-12</a></p></td>
</tr>
</tbody>
</table>
<div id="ghpna" class="paragraph">
<p>Example 5-8 Event Provider Class</p>
</div>
<div class="paragraph">
<p>This example illustrates how to define an event provider as explained in
<a href="#defining-an-event-provider-by-writing-a-java-class">Defining an Event Provider by Writing a Java Class</a>.</p>
</div>
<div class="paragraph">
<p>The example shows the definition of the <code>ModuleProbeProvider</code> class.
The event provider sends events when the request count is increased by 1 or
decreased by 1.</p>
</div>
<div class="paragraph">
<p>This class defines the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>moduleCountIncrementEvent</code></p>
</li>
<li>
<p><code>moduleCountDecrementEvent</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The name of each method is also the name of the event type that is
associated with the method.</p>
</div>
<div class="paragraph">
<p>A parameter that is named <code>count</code> is passed to each method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.pluggability.monitoring</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.Probe</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeParam</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeProvider</span>;

<span class="comment">/**
 * Monitoring count events
 * Provider interface for module specific probe events.
 */</span>
<span class="annotation">@ProbeProvider</span>(moduleProviderName = <span class="string"><span class="delimiter">&quot;</span><span class="content">glassfish</span><span class="delimiter">&quot;</span></span>, moduleName = <span class="string"><span class="delimiter">&quot;</span><span class="content">mybeanmodule</span><span class="delimiter">&quot;</span></span>,
probeProviderName = <span class="string"><span class="delimiter">&quot;</span><span class="content">mybean</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ModuleProbeProvider</span> {

    <span class="comment">/**
     * Emits probe event whenever the count is incremented
     */</span>
    <span class="annotation">@Probe</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">moduleCountIncrementEvent</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> moduleCountIncrementEvent(
            <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Integer</span> count) {
    }

    <span class="comment">/**
     * Emits probe event whenever the count is decremented
     */</span>
    <span class="annotation">@Probe</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">moduleCountDecrementEvent</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> moduleCountDecrementEvent(
            <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Integer</span> count) {
    }
}</code></pre>
</div>
</div>
<div id="ghpmu" class="paragraph">
<p>Example 5-9 Bootstrap Class</p>
</div>
<div class="paragraph">
<p>This example illustrates how to register an event listener as explained
in <a href="#registering-an-event-listener">Registering an Event Listener</a>. The example shows the
code for registering an instance of the listener class
<code>ModuleStatsTelemetry</code>. This instance is added as a child of the
<code>server/applications</code> node of the tree.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.pluggability.monitoring</span>;

<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.PostConstruct</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Scoped</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.Singleton</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.StatsProviderManager</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.PluginPoint</span>;

<span class="comment">/**
 * Monitoring Count Example
 * Bootstrap object for registering probe provider and listener
 */</span>
<span class="annotation">@Service</span>
<span class="annotation">@Scoped</span>(Singleton.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ModuleBootStrap</span> <span class="directive">implements</span> PostConstruct {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> postConstruct() {
        <span class="keyword">try</span> {
            StatsProviderManager.register(<span class="string"><span class="delimiter">&quot;</span><span class="content">web-container</span><span class="delimiter">&quot;</span></span>,
                    PluginPoint.APPLICATIONS, <span class="string"><span class="delimiter">&quot;</span><span class="content">myapp</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> ModuleStatsTelemetry());
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Caught exception in postconstruct</span><span class="delimiter">&quot;</span></span>);
            e.printStackTrace();
        }
    }
}</code></pre>
</div>
</div>
<div id="ghpvw" class="paragraph">
<p>Example 5-10 Listener Class</p>
</div>
<div class="paragraph">
<p>This example shows how to perform the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#creating-event-listeners">Creating Event Listeners</a>. The example shows the code of
the <code>ModuleStatsTelemetry</code> listener class.</p>
</li>
<li>
<p><a href="#representing-a-components-statistics-in-an-event-listener-class">Representing a Component&#8217;s Statistics in an Event Listener
Class</a>. The example shows the code for representing the
<code>countmbeancount</code> statistic.</p>
</li>
<li>
<p><a href="#subscribing-to-events-from-event-provider-classes">Subscribing to Events From Event Provider Classes</a>. The
example shows the code for subscribing to the following types of events
from the <code>count</code> component:</p>
<div class="ulist">
<ul>
<li>
<p><code>moduleCountIncrementEvent</code></p>
</li>
<li>
<p><code>moduleCountDecrementEvent</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.pluggability.monitoring</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.external.statistics.CountStatistic</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.statistics.impl.CountStatisticImpl</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeListener</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.external.probe.provider.annotations.ProbeParam</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.gmbal.ManagedAttribute</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.gmbal.ManagedObject</span>;

<span class="comment">/**
 * Monitoring counter example
 * Telemtry object which listens to probe events and updates
 * the monitoring stats
 */</span>
<span class="annotation">@ManagedObject</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ModuleStatsTelemetry</span> {

    <span class="directive">private</span> CountStatisticImpl countMBeanCount = <span class="keyword">new</span> CountStatisticImpl(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">CountMBeanCount</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Number of MBeans</span><span class="delimiter">&quot;</span></span>);

    <span class="annotation">@ManagedAttribute</span>(id = <span class="string"><span class="delimiter">&quot;</span><span class="content">countmbeancount</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> CountStatistic getCountMBeanCount() {
        <span class="keyword">return</span> countMBeanCount;
    }

    <span class="annotation">@ProbeListener</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">count:example:countapp:moduleCountIncrementEvent</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> moduleCountIncrementEvent(
            <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Integer</span> count) {
        countMBeanCount.increment();
    }

    <span class="annotation">@ProbeListener</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">count:example:countapp:moduleCountDecrementEvent</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> moduleCountDecrementEvent(
            <span class="annotation">@ProbeParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">count</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Integer</span> count) {
        countMBeanCount.decrement();
    }
}</code></pre>
</div>
</div>
<div id="ghpuc" class="paragraph">
<p>Example 5-11 MBean Interface</p>
</div>
<div class="paragraph">
<p>This example defines the interface for a simple standard MBean that has
methods to increase and decrease a counter by 1.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.count.monitoring</span>;

<span class="comment">/**
 * Monitoring counter example
 * ModuleMBean interface
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ModuleMBean</span> {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getCount() ;
    <span class="directive">public</span> <span class="type">void</span> incrementCount() ;
    <span class="directive">public</span> <span class="type">void</span> decrementCount() ;
}</code></pre>
</div>
</div>
<div id="ghpwx" class="paragraph">
<p>Example 5-12 MBean Implementation</p>
</div>
<div class="paragraph">
<p>This example illustrates how to send an event as explained in <a href="#sending-an-event">Sending an Event</a>.
The example shows code for sending events as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>moduleCountIncrementEvent</code> method is invoked in the body of the <code>incrementCount</code> method.</p>
</li>
<li>
<p>The <code>moduleCountDecrementEvent</code> method is invoked in the body of the <code>decrementCount</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The methods <code>incrementCount</code> and <code>decrementCount</code> are invoked by an
entity that is beyond the scope of this example, for example, JConsole.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.pluggability.monitoring</span>;

<span class="comment">/**
 * Monitoring counter example
 * ModuleMBean implementation
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Module</span> <span class="directive">implements</span> ModuleMBean {

    <span class="directive">private</span> <span class="type">int</span> k = <span class="integer">0</span>;
    <span class="directive">private</span> ModuleProbeProvider mpp = <span class="predefined-constant">null</span>;

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getCount() {
        <span class="keyword">return</span> k;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> incrementCount() {
        k++;
        <span class="keyword">if</span> (mpp != <span class="predefined-constant">null</span>) {
            mpp.moduleCountIncrementEvent(k);
        }
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> decrementCount() {
        k--;
        <span class="keyword">if</span> (mpp != <span class="predefined-constant">null</span>) {
            mpp.moduleCountDecrementEvent(k);
        }
    }

    <span class="type">void</span> setProbeProvider(ModuleProbeProvider mpp) {
        <span class="local-variable">this</span>.mpp = mpp;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-configuration-data-for-a-component-2"><a class="anchor" href="#adding-configuration-data-for-a-component-2"></a>Adding Configuration Data for a Component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The configuration data of a component determines the characteristics and
runtime behavior of a component. Eclipse GlassFish provides interfaces to
enable an add-on component to store its configuration data in the same
way as other Eclipse GlassFish components. These interfaces are similar
to interfaces that are defined in
[Jakarta XML Binding](<code><a href="https://jakarta.ee/specifications/xml-binding/" class="bare">https://jakarta.ee/specifications/xml-binding/</a></code>). By using these interfaces to
store configuration data, you ensure that the add-on component is fully
integrated with Eclipse GlassFish. As a result, administrators can
configure an add-on component in the same way as they can configure
other Eclipse GlassFish components.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#how-glassfish-server-stores-configuration-data">How Eclipse GlassFish Stores Configuration Data</a></p>
</li>
<li>
<p><a href="#defining-an-element">Defining an Element</a></p>
</li>
<li>
<p><a href="#defining-an-attribute-of-an-element">Defining an Attribute of an Element</a></p>
</li>
<li>
<p><a href="#defining-a-subelement">Defining a Subelement</a></p>
</li>
<li>
<p><a href="#validating-configuration-data">Validating Configuration Data</a></p>
</li>
<li>
<p><a href="#initializing-a-components-configuration-data">Initializing a Component&#8217;s Configuration Data</a></p>
</li>
<li>
<p><a href="#creating-a-transaction-to-update-configuration-data">Creating a Transaction to Update Configuration Data</a></p>
</li>
<li>
<p><a href="#dotted-names-and-rest-urls-of-configuration-attributes">Dotted Names and REST URLs of Configuration Attributes</a></p>
</li>
<li>
<p><a href="#examples-of-adding-configuration-data-for-a-component">Examples of Adding Configuration Data for a Component</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="how-glassfish-server-stores-configuration-data"><a class="anchor" href="#how-glassfish-server-stores-configuration-data"></a>How Eclipse GlassFish Stores Configuration Data</h3>
<div class="paragraph">
<p>Eclipse GlassFish stores the configuration data for a domain in a single
configuration file that is named <code>domain.xml</code>. This file is an
extensible markup language (XML) instance that contains a hierarchy of
elements to represent a domain&#8217;s configuration. The content model of
this XML instance is not defined in a document type definition (DTD) or
an XML schema. Instead, the content model is derived from Java language
interfaces with appropriate annotations. You use these annotations to
add configuration data for a component as explained in the sections that
follow.</p>
</div>
</div>
<div class="sect2">
<h3 id="defining-an-element"><a class="anchor" href="#defining-an-element"></a>Defining an Element</h3>
<div class="paragraph">
<p>An element represents an item of configuration data. For example, to
represent the configuration data for a network listener, Eclipse GlassFish defines the <code>network-listener</code> element.</p>
</div>
<div class="paragraph">
<p>Define an element for each item of configuration data that you are
adding.</p>
</div>
<div class="sect3">
<h4 id="to-define-an-element"><a class="anchor" href="#to-define-an-element"></a>To Define an Element</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define a Java language interface to represent the element.
Define one interface for each element. Do not represent multiple
elements in a single interface.
The name that you give to the interface determines name of the element
as follows:</p>
<div class="ulist">
<ul>
<li>
<p>A change from lowercase to uppercase in the interface name is
transformed to the hyphen (<code>-</code>) separator character.</p>
</li>
<li>
<p>The element name is all lowercase.
For example, to define an interface to represent the
<code>wombat-container-config</code> element, give the name <code>WombatContainerConfig</code>
to the interface.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Specify the parent of the element.
To specify the parent, extend the interface that identifies the parent
as shown in the following table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parent Element</th>
<th class="tableblock halign-left valign-top">Interface to Extend</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.glassfish.api.admin.config.Container</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>applications</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.glassfish.api.admin.config.ApplicationName</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Another element that you are defining</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.jvnet.hk2.config.ConfigBeanProxy</code></p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Annotate the declaration of the interface with the
<code>org.jvnet.hk2.config.Configured</code> annotation.</p>
</li>
</ol>
</div>
<div id="gjcne" class="paragraph">
<p>Example 6-1 Declaration of an Interface That Defines an Element</p>
</div>
<div class="paragraph">
<p>This example shows the declaration of the <code>WombatContainerConfig</code>
interface that represents the <code>wombat-container-config</code> element.
The parent of this element is the <code>config</code> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.jvnet.hk2.config.Configured;
...
import org.glassfish.api.admin.config.Container;
...
<span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">WombatContainerConfig</span> <span class="directive">extends</span> <span class="predefined-type">Container</span> {
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>How Interfaces That Are Annotated With @Configured Are Implemented</p>
</div>
<div class="paragraph">
<p>You are not required to implement any interfaces that you annotate with
the <code>@Configured</code> annotation. Eclipse GlassFish implements these
interfaces by using the <code>Dom</code> class. Eclipse GlassFish creates a proxy
for each <code>Dom</code> object to implement the interface.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="defining-an-attribute-of-an-element"><a class="anchor" href="#defining-an-attribute-of-an-element"></a>Defining an Attribute of an Element</h3>
<div class="paragraph">
<p>The attributes of an element describe the characteristics of the
element.
For example, the <code>port</code> attribute of the <code>network-listener</code>
element identifies the port number on which the listener listens.</p>
</div>
<div class="sect3">
<h4 id="representing-an-attribute-of-an-element"><a class="anchor" href="#representing-an-attribute-of-an-element"></a>Representing an Attribute of an Element</h4>
<div class="paragraph">
<p>Represent each attribute of an element as the property of a pair of
JavaBeans specification getter and setter methods of the interface that
defines the element. The component for which the configuration data is
being defined can then access the attribute through the getter method.
The setter method enables the attribute to be updated.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-data-type-of-an-attribute"><a class="anchor" href="#specifying-the-data-type-of-an-attribute"></a>Specifying the Data Type of an Attribute</h4>
<div class="paragraph">
<p>The data type of an attribute is the return type of the getter method
that is associated with the attribute. To enable the attribute take
properties in the form <code>${`property-name</code>}` as values, specify the data
type as <code>String</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="identifying-an-attribute-of-an-element"><a class="anchor" href="#identifying-an-attribute-of-an-element"></a>Identifying an Attribute of an Element</h4>
<div class="paragraph">
<p>To identify an attribute of an element, annotate the declaration of the
getter method that is associated with the attribute with the
<code>org.jvnet.hk2.config.Attribute</code> annotation.</p>
</div>
<div class="paragraph">
<p>To specify the properties of the attribute, use the elements of the
<code>@Attribute</code> annotation as explained in the sections that follow.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-name-of-an-attribute"><a class="anchor" href="#specifying-the-name-of-an-attribute"></a>Specifying the Name of an Attribute</h4>
<div class="paragraph">
<p>To specify the name of an attribute, set the <code>value</code> element of the
<code>@Attribute</code> annotation to a string that specifies the name. If you do
not set this element, the name is derived from the name of the property
as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A change from lowercase to uppercase in the interface name is
transformed to the hyphen (<code>-</code>) separator character.</p>
</li>
<li>
<p>The element name is all lowercase.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if the getter method <code>getNumberOfInstances</code> is defined for
the property <code>NumberOfInstances</code> to represent an attribute, the name of
the attribute is <code>number-of-instances</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-the-default-value-of-an-attribute"><a class="anchor" href="#specifying-the-default-value-of-an-attribute"></a>Specifying the Default Value of an Attribute</h4>
<div class="paragraph">
<p>The default value of an attribute is the value that is applied if the
attribute is omitted when the element is written to the domain
configuration file.</p>
</div>
<div class="paragraph">
<p>To specify the default value of an attribute, set the <code>defaultValue</code>
element of the <code>@Attribute</code> annotation to a string that contains the
default value. If you do not set this element, the parameter has no
default value.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-whether-an-attribute-is-required-or-optional"><a class="anchor" href="#specifying-whether-an-attribute-is-required-or-optional"></a>Specifying Whether an Attribute Is Required or Optional</h4>
<div class="paragraph">
<p>Whether an attribute is required or optional determines how Eclipse GlassFish responds if the parameter is omitted when the element is written
to the domain configuration file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the attribute is required, an error occurs.</p>
</li>
<li>
<p>If the attribute is optional, the element is written successfully to
the domain configuration file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To specify whether an attribute is required or optional, set the
<code>required</code> element of the <code>@Attribute</code> annotation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the attribute is required, set the <code>required</code> element to <code>true</code>.</p>
</li>
<li>
<p>If the attribute is optional, set the <code>required</code> element to <code>false</code>.
This value is the default.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-of-defining-an-attribute-of-an-element"><a class="anchor" href="#example-of-defining-an-attribute-of-an-element"></a>Example of Defining an Attribute of an Element</h4>
<div id="addon-example-6-2" class="paragraph">
<p>Example 6-2 Defining an Attribute of an Element</p>
</div>
<div class="paragraph">
<p>This example defines the attribute <code>number-of-instances</code>. To enable the
attribute take properties in the form <code>${`property-name</code>}` as values,
the data type of this attribute is <code>String</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Attribute</span>;
...
    <span class="annotation">@Attribute</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getNumberOfInstances();
    <span class="directive">public</span> <span class="type">void</span> setNumberOfInstances(<span class="predefined-type">String</span> instances) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="defining-a-subelement"><a class="anchor" href="#defining-a-subelement"></a>Defining a Subelement</h3>
<div class="paragraph">
<p>A subelement represents a containment or ownership relationship. For
example, Eclipse GlassFish defines the <code>network-listeners</code> element to
contain the configuration data for individual network listeners. The
configuration data for an individual network listener is represented by
the <code>network-listener</code> element, which is a subelement of
<code>network-listeners</code> element.</p>
</div>
<div class="sect3">
<h4 id="to-define-a-subelement"><a class="anchor" href="#to-define-a-subelement"></a>To Define a Subelement</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define an interface to represent the subelement.
For more information, see <a href="#defining-an-element">Defining an Element</a>.
The interface that represents the subelement must extend the
<code>org.jvnet.hk2.config.ConfigBeanProxy</code> interface.</p>
</li>
<li>
<p>In the interface that defines the parent element, identify the
subelement to its parent element.</p>
</li>
<li>
<p>Represent the subelement as the property of a JavaBeans
specification getter or setter method.</p>
</li>
<li>
<p>Annotate the declaration of the getter or setter method that is
associated with the subelement with the <code>org.jvnet.hk2.config.Element</code>
annotation.</p>
</li>
</ol>
</div>
<div id="gjzjt" class="paragraph">
<p>Example 6-3 Declaring an Interface to Represent a Subelement</p>
</div>
<div class="paragraph">
<p>This example shows the declaration of the <code>WombatElement</code> interface to
represent the <code>wombat-element</code> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.jvnet.hk2.config.ConfigBeanProxy;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Configured</span>;
...
<span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">WombatElement</span> <span class="directive">extends</span> ConfigBeanProxy {
...
}
...</code></pre>
</div>
</div>
<div id="gjzkh" class="paragraph">
<p>Example 6-4 Identifying a Subelement to its Parent Element</p>
</div>
<div class="paragraph">
<p>This example identifies the <code>wombat-element</code> element as a subelement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.jvnet.hk2.config.Element;
...
import java.beans.PropertyVetoException;
...
<span class="annotation">@Element</span>
    <span class="directive">public</span> WombatElement getElement();
    <span class="directive">public</span> <span class="type">void</span> setElement(WombatElement element) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validating-configuration-data"><a class="anchor" href="#validating-configuration-data"></a>Validating Configuration Data</h3>
<div class="paragraph">
<p>Validating configuration data ensures that attribute values that are
being set or updated do not violate any constraints that you impose on
the data. For example, you might require that an attribute that
represents a name is not null, or an integer that represents a port
number is within the range of available port numbers. Any attempt to set
or update an attribute value that fails validation fails. Any
validations that you specify for an attribute are performed when the
attribute is initialized and every time the attribute is changed.</p>
</div>
<div class="paragraph">
<p>To standardize the validation of configuration data, Eclipse GlassFish
uses <a href="https://jakarta.ee/specifications/bean-validation/">Jakarta Bean Validation</a>
(<code><a href="https://jakarta.ee/specifications/bean-validation/" class="bare">https://jakarta.ee/specifications/bean-validation/</a></code>) for validating configuration
data.
Jakarta Bean Validation defines a metadata model and API for the validation of
JavaBeans components.</p>
</div>
<div class="paragraph">
<p>To validate an attribute of an element, annotate the attribute&#8217;s getter
method with the annotation in the <code>jakarta.validation.constraints</code> package
that performs the validation that you require. The following table lists
commonly used annotations for validating Eclipse GlassFish configuration
data.
For the complete list of annotations, see the
<a href="https://jakarta.ee/specifications/bean-validation/3.0/apidocs/jakarta/validation/constraints/package-summary.html"><code>jakarta.validation.constraints</code>
package summary</a>
(<code><a href="https://jakarta.ee/specifications/bean-validation/3.0/apidocs/jakarta/validation/constraints/package-summary.html" class="bare">https://jakarta.ee/specifications/bean-validation/3.0/apidocs/jakarta/validation/constraints/package-summary.html</a></code>).</p>
</div>
<div id="gjrlg" class="paragraph">
<p>Table 6-1 Commonly Used Annotations for Validating Eclipse GlassFish
Configuration Data</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 37%;">
<col style="width: 63%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Validation</th>
<th class="tableblock halign-left valign-top">Annotation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.validation.constraints.NotNull</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.validation.constraints.Null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum value</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>jakarta.validation.constraints.Min</code></p>
</div>
<div class="paragraph">
<p>Set the <code>value</code> element of this annotation to the minimum allowed value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum value</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>jakarta.validation.constraints.Max</code></p>
</div>
<div class="paragraph">
<p>Set the <code>value</code> element of this annotation to the maximum allowed value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression matching</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>jakarta.validation.constraints.Pattern</code></p>
</div>
<div class="paragraph">
<p>Set the <code>regexp</code> element of this annotation to the regular expression
that is to be matched.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div id="gjrmp" class="paragraph">
<p>Example 6-5 Specifying a Range of Valid Values for an Integer</p>
</div>
<div class="paragraph">
<p>This example specifies that the attribute <code>rotation-interval-in-minutes</code>
must be a positive integer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import jakarta.validation.constraints.Max;
<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Min</span>;
...
<span class="annotation">@Min</span>(value=<span class="integer">1</span>)
<span class="annotation">@Max</span>(value=<span class="predefined-type">Integer</span>.MAX_VALUE)
<span class="predefined-type">String</span> getRotationIntervalInMinutes();
...</code></pre>
</div>
</div>
<div id="gjzkq" class="paragraph">
<p>Example 6-6 Specifying Regular Expression Matching</p>
</div>
<div class="paragraph">
<p>This example specifies that the attribute <code>classname</code> must contain only
non-whitespace characters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Pattern</span>;
...
<span class="annotation">@Pattern</span>(regexp=<span class="string"><span class="delimiter">&quot;</span><span class="content">^[</span><span class="char">\\</span><span class="content">S]*$</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">String</span> getClassname();
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="initializing-a-components-configuration-data"><a class="anchor" href="#initializing-a-components-configuration-data"></a>Initializing a Component&#8217;s Configuration Data</h3>
<div class="paragraph">
<p>To ensure that a component&#8217;s configuration data is added to the
<code>domain.xml</code> file when the component is first instantiated, you must
initialize the component&#8217;s configuration data.</p>
</div>
<div class="paragraph">
<p>Initializing a component&#8217;s configuration data involves the following
tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-define-a-components-initial-configuration-data">To Define a Component&#8217;s Initial Configuration Data</a></p>
</li>
<li>
<p><a href="#GSACG00077">To Write a Component&#8217;s Initial Configuration Data to the
<code>domain.xml</code> File</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-define-a-components-initial-configuration-data"><a class="anchor" href="#to-define-a-components-initial-configuration-data"></a>To Define a Component&#8217;s Initial Configuration Data</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a plain-text file that contains an XML fragment to represent
the configuration data.</p>
<div class="ulist">
<ul>
<li>
<p>Ensure that each XML element accurately represents the interface that
is defined for the element.</p>
</li>
<li>
<p>Ensure that any subelements that you are initializing are correctly nested.</p>
</li>
<li>
<p>Set attributes of the elements to their required initial values.</p>
</li>
</ul>
</div>
</li>
<li>
<p>When you package the component, include the file that contains the
XML fragment in the component&#8217;s JAR file.</p>
</li>
</ol>
</div>
<div id="gkaba" class="paragraph">
<p>Example 6-7 XML Data Fragment</p>
</div>
<div class="paragraph">
<p>This example shows the XML data fragment for adding the
<code>wombat-container-config</code> element to the <code>domain.xml</code> file. The
<code>wombat-container-config</code> element contains the subelement
<code>wombat-element</code>. The attributes of <code>wombat-element</code> are initialized as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>foo</code> attribute is set to <code>something</code>.</p>
</li>
<li>
<p>The <code>bar</code> attribute is set to <code>anything</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;wombat-container-config&gt;</span>
    <span class="tag">&lt;wombat-element</span> <span class="attribute-name">foo</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">something</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">bar</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">anything</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/wombat-container-config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GSACG00077"></a><a id="to-write-a-components-initial-configuration-data-to-the-domain.xml-file"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="to-write-a-components-initial-configuration-data-to-the-domain-xml-file"><a class="anchor" href="#to-write-a-components-initial-configuration-data-to-the-domain-xml-file"></a>To Write a Component&#8217;s Initial Configuration Data to the <code>domain.xml</code> File</h4>
<div class="paragraph">
<p>Add code to write the component&#8217;s initial configuration data in the
class that represents your add-on component. If your add-on component is
a container, add this code to the sniffer class. For more information
about adding a container, see
<a href="#adding-container-capabilities">Adding Container
Capabilities</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set an optional dependency on an instance of the class that
represents the XML element that you are adding.</p>
</li>
<li>
<p>Initialize the instance variable to <code>null</code>.</p>
<div class="paragraph">
<p>If the element is not present in the <code>domain.xml</code> file when the add-on
component is initialized, the instance variable remains <code>null</code>.</p>
</div>
</li>
<li>
<p>Annotate the declaration of the instance variable with the
<code>org.jvnet.hk2.annotations.Inject</code> annotation.</p>
</li>
<li>
<p>Set the <code>optional</code> element of the <code>@Inject</code> annotation to <code>true</code>.</p>
</li>
<li>
<p>Set a dependency on an instance of the following classes:</p>
<div class="ulist">
<ul>
<li>
<p><code>org.glassfish.api.admin.config.ConfigParser</code></p>
<div class="paragraph">
<p>The <code>ConfigParser</code> class provides methods to parse an XML fragment and
to write the fragment to the correct location in the <code>domain.xml</code> file.</p>
</div>
</li>
<li>
<p><code>org.jvnet.hk2.component.Habitat</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Invoke the <code>parseContainerConfig</code> method of the <code>ConfigParser</code>
object only if the instance is <code>null</code>.
If your add-on component is a container, invoke this method within the
implementation of the <code>setup</code> method the sniffer class.
When the container is first instantiated, Eclipse GlassFish invokes the <code>setup</code> method.
The test that the instance is <code>null</code> is required to ensure that the
configuration data is added only if the data is not already present in
the <code>domain.xml</code> file.
In the invocation of the <code>parseContainerConfig</code> method, pass the
following items as parameters:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>Habitat</code> object on which you set a dependency</p>
</li>
<li>
<p>The URL to the file that contains the XML fragment that represents the configuration data</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="gkabo" class="paragraph">
<p>Example 6-8 Writing a Component&#8217;s Initial Configuration Data to the
<code>domain.xml</code> File</p>
</div>
<div class="paragraph">
<p>This example writes the XML fragment in the file <code>init.xml</code> to the
<code>domain.xml</code> file. The fragment is written only if the <code>domain.xml</code> file
does not contain the <code>wombat-container-config-element</code>.</p>
</div>
<div class="paragraph">
<p>The <code>wombat-container-config</code> element is represented by the
<code>WombatContainerConfig</code> interface. An optional dependency is set on an
instance of a class that implements <code>WombatContainerConfig</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.glassfish.api.admin.config.ConfigParser;
<span class="keyword">import</span> <span class="include">org.glassfish.examples.extension.config.WombatContainerConfig</span>;
...
import org.jvnet.hk2.annotations.Inject;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.Habitat</span>;
<span class="keyword">import</span> <span class="include">com.sun.enterprise.module.Module</span>;

<span class="keyword">import</span> <span class="include">java.util.logging.Logger</span>;
...
import java.io.IOException;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Annotation</span>;
<span class="keyword">import</span> <span class="include">java.lang.reflect.Array</span>;
<span class="keyword">import</span> <span class="include">java.net.URL</span>;
...
    <span class="annotation">@Inject</span>(optional=<span class="predefined-constant">true</span>)
    WombatContainerConfig config=<span class="predefined-constant">null</span>;
...
    <span class="annotation">@Inject</span>
    ConfigParser configParser;

    <span class="annotation">@Inject</span>
    Habitat habitat;

    <span class="directive">public</span> Module<span class="type">[]</span> setup(<span class="predefined-type">String</span> containerHome, <span class="predefined-type">Logger</span> logger) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="keyword">if</span> (config==<span class="predefined-constant">null</span>) {
            <span class="predefined-type">URL</span> url = <span class="local-variable">this</span>.getClass().getClassLoader().getResource(<span class="string"><span class="delimiter">&quot;</span><span class="content">init.xml</span><span class="delimiter">&quot;</span></span>);
            <span class="keyword">if</span> (url!=<span class="predefined-constant">null</span>) {
               configParser.parseContainerConfig(habitat, url,
                   WombatContainerConfig.class);
            }
        }
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }
...</code></pre>
</div>
</div>
<div id="gjski" class="paragraph">
<p>Example 6-9 <code>domain.xml</code> File After Initialization</p>
</div>
<div class="paragraph">
<p>This example shows the <code>domain.xml</code> file after the <code>setup</code> method was
invoked to add the <code>wombat-container-config</code> element under the <code>config</code>
element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;domain&gt;</span>
...
  <span class="tag">&lt;configs&gt;</span>
    <span class="tag">&lt;config</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">server-config</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;wombat-container-config</span> <span class="attribute-name">number-of-instances</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;wombat-element</span> <span class="attribute-name">foo</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">something</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">bar</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">anything</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;/wombat-container-config&gt;</span>
      <span class="tag">&lt;http-service&gt;</span>
...
<span class="tag">&lt;/domain&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-transaction-to-update-configuration-data"><a class="anchor" href="#creating-a-transaction-to-update-configuration-data"></a>Creating a Transaction to Update Configuration Data</h3>
<div class="paragraph">
<p>Creating a transaction to update configuration data enables the data to
be updated without the need to specify a dotted name in the
<a href="reference-manual.html#set"><code>set</code></a> subcommand. You can make the transaction
available to system administrators in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>By adding an <a href="reference-manual.html#asadmin"><code>asadmin</code></a> subcommand. If you are adding
an <code>asadmin</code> subcommand, include the code for the transaction in the
body of the subcommand&#8217;s <code>execute</code> method. For more information, see
<a href="#extending-the-asadmin-utility">Extending the <code>asadmin</code> Utility</a>.</p>
</li>
<li>
<p>By extending the Administration Console. For more information, see
<a href="#extending-the-administration-console">Extending the Administration
Console</a>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-create-a-transaction-to-update-configuration-data"><a class="anchor" href="#to-create-a-transaction-to-update-configuration-data"></a>To Create a Transaction to Update Configuration Data</h4>
<div class="paragraph">
<p>Any transaction that you create to modify configuration data must use a
configuration change transaction to ensure that the change is atomic,
consistent, isolated, and durable (ACID).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="gkakq"></a>
Set a dependency on the configuration object to update.</p>
</li>
<li>
<p><a id="gkalq"></a>
Define a method to invoke to perform the transaction.</p>
</li>
<li>
<p>Use the generic <code>SimpleConfigCode</code> interface to define the method
that is to be invoked on a single configuration object, namely:
<code>SingleConfigCode&lt;T extends ConfigBeanProxy&gt;()</code>.</p>
</li>
<li>
<p>In the body of this method, implement the <code>run</code> method of the
<code>SingleConfigCode&lt;T extends ConfigBeanProxy&gt;</code> interface.</p>
</li>
<li>
<p>In the body of the <code>run</code> method, invoke the setter methods that are
defined for the attributes that you are setting.</p>
<div class="paragraph">
<p>These setter methods are defined in the interface that represents the
element whose elements you are setting.</p>
</div>
</li>
<li>
<p>Invoke the static method
<code>org.jvnet.hk2.config.ConfigSupport.ConfigSupport.apply</code>.
In the invocation, pass the following information as parameters to the method:</p>
<div class="ulist">
<ul>
<li>
<p>The code of the method that you defined in Step  <a href="#gkalq">2</a>.</p>
</li>
<li>
<p>The configuration object to update, on which you set the dependency in Step <a href="#gkakq">1</a>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="gkama" class="paragraph">
<p>Example 6-10 Creating a Transaction to Update Configuration Data</p>
</div>
<div class="paragraph">
<p>This example shows code in the <code>execute</code> method of an <code>asadmin</code>
subcommand for updating the <code>number-of-instances</code> element of
<code>wombat-container-config</code> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
import org.glassfish.api.Param;
...
import org.jvnet.hk2.annotations.Inject;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Transactions</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.ConfigSupport</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.SingleConfigCode</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.TransactionFailure</span>;
...
    <span class="annotation">@Param</span>
    <span class="predefined-type">String</span> instances;

    <span class="annotation">@Inject</span>
    WombatContainerConfig config;

    <span class="directive">public</span> <span class="type">void</span> execute(AdminCommandContext adminCommandContext) {
        <span class="keyword">try</span> {
            ConfigSupport.apply(<span class="keyword">new</span> SingleConfigCode&lt;WombatContainerConfig&gt;() {
                <span class="directive">public</span> <span class="predefined-type">Object</span> run(WombatContainerConfig wombatContainerConfig)
                        <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>, TransactionFailure {
                    wombatContainerConfig.setNumberOfInstances(instances);
                    <span class="keyword">return</span> <span class="predefined-constant">null</span>;
                }
            }, config);
        } <span class="keyword">catch</span>(TransactionFailure e) {
        }
    }
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dotted-names-and-rest-urls-of-configuration-attributes"><a class="anchor" href="#dotted-names-and-rest-urls-of-configuration-attributes"></a>Dotted Names and REST URLs of Configuration Attributes</h3>
<div class="paragraph">
<p>The Eclipse GlassFish administrative subcommands <a href="reference-manual.html#get"><code>get</code></a>,
<a href="reference-manual.html#list"><code>list</code></a>, and <a href="reference-manual.html#set"><code>set</code></a> locate a
configuration attribute through the dotted name of the attribute. The
dotted name of an attribute of a configuration element is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>configs.config.server-config.element-name[.subelement-name...].attribute-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">element-name</dt>
<dd>
<p>The name of an element that contains a subelement or the attribute.</p>
</dd>
<dt class="hdlist1">subelement-name</dt>
<dd>
<p>The name of a subelement, if any.</p>
</dd>
<dt class="hdlist1">attribute-name</dt>
<dd>
<p>The name of the attribute.</p>
<div class="paragraph">
<p>For example, the dotted name of the <code>foo</code> attribute of the
<code>wombat-element</code> element is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>configs.config.server-config.wombat-container-config.wombat-element.foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>The formats of the URL to a REST resource that represent an attribute of
a configuration element is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://host:port/management/domain/path</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">host</dt>
<dd>
<p>The host where the DAS is running.</p>
</dd>
<dt class="hdlist1">port</dt>
<dd>
<p>The HTTP port or HTTPS port for administration.</p>
</dd>
<dt class="hdlist1">path</dt>
<dd>
<p>The path to the attribute. The path is the dotted name of the
attribute in which each dot (<code>.</code>) is replaced with a slash (<code>/</code>).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For example, the URL to the REST resource for the <code>foo</code> attribute of the
<code>wombat-element</code> element is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhost:4848/management/domain/configs/config/server-config/wombat-container-config/wombat-element/foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the DAS is running on the local host and the HTTP port
for administration is 4848.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-of-adding-configuration-data-for-a-component"><a class="anchor" href="#examples-of-adding-configuration-data-for-a-component"></a>Examples of Adding Configuration Data for a Component</h3>
<div class="paragraph">
<p>This example shows the interfaces that define the configuration data for
the Greeter Container component. The data is comprised of the following
elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A parent element, which is shown in <a href="#gkamy">Example 6-11</a></p>
</li>
<li>
<p>A subelement that is contained by the parent element, which is shown
in <a href="#gkamb">Example 6-12</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example also shows an XML data fragment for initializing an
element. See <a href="#gkamk">Example 6-13</a>.</p>
</div>
<div class="paragraph">
<p>Code for the Greeter Container component is shown in
<a href="#example-of-adding-container-capabilities">Example of Adding Container
Capabilities</a>.</p>
</div>
<div class="paragraph">
<p>Code for an <code>asadmin</code> subcommand that updates the configuration data in
this example is shown in <a href="#gkbdf">Example 4-7</a>.</p>
</div>
<div id="gkamy" class="paragraph">
<p>Example 6-11 Parent Element Definition</p>
</div>
<div class="paragraph">
<p>This example shows the definition of the <code>greeter-container-config</code> element.
The attributes of the <code>greeter-container-config</code> element are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>number-of-instances</code>, which must be in the range 1-10.</p>
</li>
<li>
<p><code>language</code>, which must contain only non-whitespace characters.</p>
</li>
<li>
<p><code>style</code>, which must contain only non-whitespace characters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>greeter-element</code> element is identified as a subelement of the
<code>greeter-container-config</code> element. The definition of the
<code>greeter-element</code> element is shown in <a href="#gkamb">Example 6-12</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter.config</span>;

<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Configured</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Attribute</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Element</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.config.Container</span>;

<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Pattern</span>;
<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Min</span>;
<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Max</span>;

<span class="keyword">import</span> <span class="include">java.beans.PropertyVetoException</span>;

<span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">GreeterContainerConfig</span> <span class="directive">extends</span> <span class="predefined-type">Container</span> {

    <span class="annotation">@Attribute</span>
    <span class="annotation">@Min</span>(value=<span class="integer">1</span>)
    <span class="annotation">@Max</span> (value=<span class="integer">10</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getNumberOfInstances();
    <span class="directive">public</span> <span class="type">void</span> setNumberOfInstances(<span class="predefined-type">String</span> instances) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;

    <span class="annotation">@Attribute</span>
    <span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">&quot;</span><span class="content">^[</span><span class="char">\\</span><span class="content">S]*$</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getLanguage();
    <span class="directive">public</span> <span class="type">void</span> setLanguage(<span class="predefined-type">String</span> language) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;

    <span class="annotation">@Attribute</span>
    <span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">&quot;</span><span class="content">^[</span><span class="char">\\</span><span class="content">S]*$</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getStyle();
    <span class="directive">public</span> <span class="type">void</span> setStyle(<span class="predefined-type">String</span> style) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;

    <span class="annotation">@Element</span>
    <span class="directive">public</span> GreeterElement getElement();
    <span class="directive">public</span> <span class="type">void</span> setElement(GreeterElement element) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;


}</code></pre>
</div>
</div>
<div id="gkamb" class="paragraph">
<p>Example 6-12 Subelement Definition</p>
</div>
<div class="paragraph">
<p>This example shows the definition of the <code>greeter-element</code> element,
which is identified as a subelement of the <code>greeter-container-config</code>
element in <a href="#gkamy">Example 6-11</a>. The only attribute of the
<code>greeter-element</code> element is <code>greeter-port</code>, which must be in the range 1030-1050.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter.config</span>;

<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.ConfigBeanProxy</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Configured</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.config.Attribute</span>;

<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Min</span>;
<span class="keyword">import</span> <span class="include">jakarta.validation.constraints.Max</span>;

<span class="keyword">import</span> <span class="include">java.beans.PropertyVetoException</span>;

<span class="annotation">@Configured</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">GreeterElement</span> <span class="directive">extends</span> ConfigBeanProxy {

    <span class="annotation">@Attribute</span>
    <span class="annotation">@Min</span>(value=<span class="integer">1030</span>)
    <span class="annotation">@Max</span> (value=<span class="integer">1050</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getGreeterPort();
    <span class="directive">public</span> <span class="type">void</span> setGreeterPort(<span class="predefined-type">String</span> greeterport) <span class="directive">throws</span> <span class="exception">PropertyVetoException</span>;

}</code></pre>
</div>
</div>
<div id="gkamk" class="paragraph">
<p>Example 6-13 XML Data Fragment for Initializing the <code>greeter-container-config</code> Element</p>
</div>
<div class="paragraph">
<p>This example shows the XML data fragment for adding the
<code>greeter-container-config</code> element to the <code>domain.xml</code> file.
The <code>greeter-container-config</code> element contains the subelement <code>greeter-element</code>.</p>
</div>
<div class="paragraph">
<p>The attributes of <code>greeter-container-config</code> are initialized as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>number-of-instances</code> attribute is set to <code>5</code>.</p>
</li>
<li>
<p>The <code>language</code> attribute is set to <code>norsk</code>.</p>
</li>
<li>
<p>The <code>style</code> element is set to <code>formal</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>greeter-port</code> attribute of the <code>greeter-element</code> element is set to <code>1040</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;greeter-container-config</span> <span class="attribute-name">number-of-instances</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">language</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">norsk</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">formal</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;greeter-element</span> <span class="attribute-name">greeter-port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1040</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/greeter-container-config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The definition of the <code>greeter-container-config</code> element is shown in
<a href="#gkamy">Example 6-11</a>. The definition of the <code>greeter-element</code>
element is shown in <a href="#gkamb">Example 6-12</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-container-capabilities-2"><a class="anchor" href="#adding-container-capabilities-2"></a>Adding Container Capabilities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Applications run on Eclipse GlassFish in containers. Eclipse GlassFish
enables you to create containers that extend or replace the existing
containers of Eclipse GlassFish. Adding container capabilities enables
you to run new types of applications and to deploy new archive types in
Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#creating-a-container-implementation">Creating a <code>Container</code> Implementation</a></p>
</li>
<li>
<p><a href="#adding-an-archive-type">Adding an Archive Type</a></p>
</li>
<li>
<p><a href="#creating-connector-modules">Creating Connector Modules</a></p>
</li>
<li>
<p><a href="#example-of-adding-container-capabilities">Example of Adding Container Capabilities</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="creating-a-container-implementation"><a class="anchor" href="#creating-a-container-implementation"></a>Creating a <code>Container</code> Implementation</h3>
<div class="paragraph">
<p>To implement a container that extends or replaces a service in Eclipse GlassFish, you must create a Java programming language class that includes
the following characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is annotated with the <code>org.jvnet.hk2.annotations.Service</code>
annotation.</p>
</li>
<li>
<p>It implements the <code>org.glassfish.api.container.Container</code> interface.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You should also run the HK2 Inhabitants Generator utility on your class
files, which adds classes marked with the <code>@Service</code> annotation to the
<code>META-INF/hk2-locator/default</code> file in your JAR file. For more
information about the HK2 Inhabitants Generator, see the
<a href="https://hk2.java.net/inhabitant-generator.html">HK2 Inhabitants Generator
page</a>.</p>
</div>
<div class="sect3">
<h4 id="marking-the-class-with-the-service-annotation"><a class="anchor" href="#marking-the-class-with-the-service-annotation"></a>Marking the Class With the <code>@Service</code> Annotation</h4>
<div class="paragraph">
<p>Add a <code>com.jvnet.hk2.annotations.Service</code> annotation at the class
definition level to identify your class as a service implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyContainer</span> <span class="directive">implements</span> <span class="predefined-type">Container</span> {
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To avoid potential name collisions with other containers, use the fully
qualified class name of your container class in the <code>@Service</code>
annotation&#8217;s <code>name</code> element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.containers</span>;
...

<span class="annotation">@Service</span> <span class="annotation">@jakarta</span>.inject.Named(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.example.containers.MyContainer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyContainer</span> <span class="directive">implements</span> <span class="predefined-type">Container</span> {
...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="implementing-the-container-interface"><a class="anchor" href="#implementing-the-container-interface"></a>Implementing the <code>Container</code> Interface</h4>
<div class="paragraph">
<p>The <code>org.glassfish.api.container.Container</code> interface is the contract
that defines a container implementation. Classes that implement
<code>Container</code> can extend or replace the functionality in Eclipse GlassFish
by allowing applications to be deployed and run within the Eclipse GlassFish runtime.</p>
</div>
<div class="paragraph">
<p>The <code>Container</code> interface consists of two methods, <code>getDeployer</code> and
<code>getName</code>. The <code>getDeployer</code> method returns an implementation class of
the <code>org.glassfish.api.deployment.Deployer</code> interface capable of
managing applications that run within this container. The <code>getName</code>
method returns a human-readable name for the container, and is typically
used to display messages belonging to the container.</p>
</div>
<div class="paragraph">
<p>The <code>Deployer</code> interface defines the contract for managing a particular
application that runs in the container. It consists of the following
methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>getMetaData</code></dt>
<dd>
<p>Retrieves the metadata used by the <code>Deployer</code> instance, and returns an
<code>org.glassfish.api.deployment.MetaData</code> object.</p>
</dd>
<dt class="hdlist1"><code>loadMetaData</code></dt>
<dd>
<p>Loads the metadata associated with an application.</p>
</dd>
<dt class="hdlist1"><code>prepare</code></dt>
<dd>
<p>Prepares the application to run in Eclipse GlassFish.</p>
</dd>
<dt class="hdlist1"><code>load</code></dt>
<dd>
<p>Loads a previously prepared application to the container.</p>
</dd>
<dt class="hdlist1"><code>unload</code></dt>
<dd>
<p>Unloads or stops a previously loaded application.</p>
</dd>
<dt class="hdlist1"><code>clean</code></dt>
<dd>
<p>Removes any artifacts generated by an application during the <code>prepare</code>
phase.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>DeploymentContext</code> is the usual context object passed around
deployer instances during deployment.</p>
</div>
<div id="ghojg" class="paragraph">
<p>Example 7-1 Example Implementation of <code>Container</code></p>
</div>
<div class="paragraph">
<p>This example shows a Java programming language class that implements the
<code>Container</code> interface and is capable of extending the functionality of
Eclipse GlassFish.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.containers</span>;

<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.example.containers.MyContainer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyContainer</span> <span class="directive">implements</span> <span class="predefined-type">Container</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">MyContainer</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="directive">public</span> <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> org.glassfish.api.deployment.Deployer&gt; getDeployer() {
        <span class="keyword">return</span> MyDeployer.class;
    }
}</code></pre>
</div>
</div>
<div id="ghoiv" class="paragraph">
<p>Example 7-2 Example Implementation of <code>Deployer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.containers</span>;

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyDeployer</span> {

    <span class="directive">public</span> MetaData getMetaData() {
        <span class="keyword">return</span> <span class="keyword">new</span> MetaData(...);
    }

    <span class="directive">public</span> &lt;V&gt; v loadMetaData(<span class="predefined-type">Class</span>&lt;V&gt; type, DeploymentContext dc) {
        ...
    }

    <span class="directive">public</span> <span class="type">boolean</span> prepare(DeploymentContext dc) {
        <span class="comment">// performs any actions needed to allow the application to run,</span>
        <span class="comment">// such as generating artifacts</span>
        ...
    }

    <span class="directive">public</span> MyApplication load(MyContainer container, DeploymentContext dc) {
        <span class="comment">// creates a new instance of an application</span>
        MyApplication myApp = <span class="keyword">new</span> MyApplication (...);
        ...
        <span class="comment">// returns the application instance</span>
        return myApp;
    }

    <span class="directive">public</span> <span class="type">void</span> unload(MyApplication myApp, DeploymentContext dc) {
        <span class="comment">// stops and removes the application</span>
        ...
    }

    <span class="directive">public</span> <span class="type">void</span> clean (DeploymentContext dc) {
        <span class="comment">// cleans up any artifacts generated during prepare()</span>
        ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-an-archive-type"><a class="anchor" href="#adding-an-archive-type"></a>Adding an Archive Type</h3>
<div class="paragraph">
<p>An archive type is an abstraction of the archive file format. An archive
type can be implemented as a plain JAR file, as a directory layout, or a
custom type. By default, Eclipse GlassFish recognizes JAR based and
directory based archive types. A new container might require a new
archive type.</p>
</div>
<div class="paragraph">
<p>There are two sub-interfaces of the
<code>org.glassfish.api.deployment.archive.Archive</code> interface,
<code>org.glassfish.api.deployment.archive.ReadableArchive</code> and
<code>org.glassfish.api.deployment.archive.WritableArchive</code>. Typically
developers of new archive types will provide separate implementations of
<code>ReadableArchive</code> and <code>WritableArchive</code>, or a single implementation that
implements both <code>ReadableArchive</code> and <code>WritableArchive</code>.</p>
</div>
<div class="paragraph">
<p>Implementations of the <code>ReadableArchive</code> interface provide read access
to an archive type. <code>ReadableArchive</code> defines the following methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>getEntry(String name)</code></dt>
<dd>
<p>Returns a <code>java.io.InputStream</code> for the specified entry name, or null
if the entry doesn&#8217;t exist.</p>
</dd>
<dt class="hdlist1"><code>exists(String name)</code></dt>
<dd>
<p>Returns a <code>boolean</code> value indicating whether the specified entry name
exists.</p>
</dd>
<dt class="hdlist1"><code>getEntrySize(String name)</code></dt>
<dd>
<p>Returns the size of the specified entry as a <code>long</code> value.</p>
</dd>
<dt class="hdlist1"><code>open(URI uri)</code></dt>
<dd>
<p>Returns an archive for the given <code>java.net.URI</code>.</p>
</dd>
<dt class="hdlist1"><code>getSubArchive(String name)</code></dt>
<dd>
<p>Returns an instance of <code>ReadableArchive</code> for the specified sub-archive
contained within the parent archive, or null if no such archive
exists.</p>
</dd>
<dt class="hdlist1"><code>exists()</code></dt>
<dd>
<p>Returns a <code>boolean</code> value indicating whether this archive exists.</p>
</dd>
<dt class="hdlist1"><code>delete()</code></dt>
<dd>
<p>Deletes the archive, and returns a <code>boolean</code> value indicating whether
the archive has been successfully deleted.</p>
</dd>
<dt class="hdlist1"><code>renameTo(String name)</code></dt>
<dd>
<p>Renames the archive to the specified name, and returns a <code>boolean</code>
value indicating whether the archive has been successfully renamed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Implementations of the <code>WritableArchive</code> interface provide write access
to the archive type. <code>WritableArchive</code> defines the following methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>create(URI uri)</code></dt>
<dd>
<p>Creates a new archive with the given path, specified as a
<code>java.net.URI</code>.</p>
</dd>
<dt class="hdlist1"><code>closeEntry(WritableArchive subArchive)</code></dt>
<dd>
<p>Closes the specified sub-archive contained within the parent archive.</p>
</dd>
<dt class="hdlist1"><code>closeEntry()</code></dt>
<dd>
<p>Closes the current entry.</p>
</dd>
<dt class="hdlist1"><code>createSubArchive(String name)</code></dt>
<dd>
<p>Creates a new sub-archive in the parent archive with the specified
name, and returns it as a <code>WritableArchive</code> instance.</p>
</dd>
<dt class="hdlist1"><code>putNextEntry(String name)</code></dt>
<dd>
<p>Creates a new entry in the archive with the specified name, and
returns it as a <code>java.io.OutputStream</code>.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="implementing-the-archivehandler-interface"><a class="anchor" href="#implementing-the-archivehandler-interface"></a>Implementing the <code>ArchiveHandler</code> Interface</h4>
<div class="paragraph">
<p>An archive handler is responsible for handling the particular layout of
an archive. Jakarta EE defines a set of archives (WAR, JAR, and RAR, for
example), and each of these archives has an <code>ArchiveHandler</code> instance
associated with the archive type.</p>
</div>
<div class="paragraph">
<p>Each layout should have one handler associated with it. There is no
extension point support at this level; the archive handler&#8217;s
responsibility is to give access to the classes and resources packaged
in the archive, and it should not contain any container-specific code.
The <code>java.lang.ClassLoader</code> returned by the handler is used by all the
containers in which the application will be deployed.</p>
</div>
<div class="paragraph">
<p><code>ArchiveHandler</code> defines the following methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>getArchiveType()</code></dt>
<dd>
<p>Returns the name of the archive type as a <code>String</code>. Typically, this is
the archive extension, such as <code>jar</code> or <code>war</code>.</p>
</dd>
<dt class="hdlist1"><code>getDefaultApplicationName(ReadableArchive archive)</code></dt>
<dd>
<p>Returns the default name of the specified archive as a <code>String</code>.
Typically this default name is the name part of the <code>URI</code> location of
the archive.</p>
</dd>
<dt class="hdlist1"><code>handles(ReadableArchive archive)</code></dt>
<dd>
<p>Returns a <code>boolean</code> value indicating whether this implementation of
<code>ArchiveHandler</code> can work with the specified archive.</p>
</dd>
<dt class="hdlist1"><code>getClassLoader(DeploymentContext dc)</code></dt>
<dd>
<p>Returns a <code>java.lang.ClassLoader</code> capable of loading all classes from
the archive passed in by the <code>DeploymentContext</code> instance. Typically
the <code>ClassLoader</code> will load classes in the scratch directory area,
returned by <code>DeploymentContext.getScratchDir()</code>, as stubs and other
artifacts are generated in the scratch directory.</p>
</dd>
<dt class="hdlist1"><code>expand(ReadableArchive source, WritableArchive target)</code></dt>
<dd>
<p>Prepares the <code>ReadableArchive</code>'s source archive for loading into the
container in a format the container accepts. Such preparation could be
to expand a compressed archive, or possibly nothing at all if the
source archive format is already in a state that the container can
handle. This method returns the archive as an instance of
<code>WritableArchive</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-connector-modules"><a class="anchor" href="#creating-connector-modules"></a>Creating Connector Modules</h3>
<div class="paragraph">
<p>Connector modules are small add-on modules that consist of application
"sniffers" that associate application types with containers that can run
the application type. Eclipse GlassFish connector modules are separate
from the associated add-on module that delivers the container
implementation to allow Eclipse GlassFish to dynamically install and
configure containers on demand.</p>
</div>
<div class="paragraph">
<p>When a deployment request is received by the Eclipse GlassFish runtime:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The current <code>Sniffer</code> implementations are used to determine the application type.</p>
</li>
<li>
<p>Once an application type is found, the runtime looks for a running
container associated with that application type. If no running container
is found, the runtime attempts to install and configure the container
associated with the application type as defined by the <code>Sniffer</code> implementation.</p>
</li>
<li>
<p>The <code>Deployer</code> interface is used to prepare and load the implementation.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="associating-file-types-with-containers-by-using-the-sniffer-interface"><a class="anchor" href="#associating-file-types-with-containers-by-using-the-sniffer-interface"></a>Associating File Types With Containers by Using the <code>Sniffer</code> Interface</h4>
<div class="paragraph">
<p>Containers do not necessarily need to be installed on the local machine
for Eclipse GlassFish to recognize the container&#8217;s application type.
Eclipse GlassFish uses a "sniffer" concept to study the artifacts in a
deployment request and to choose the associated container that handles
the application type that the user is trying to deploy. To create this
association, create a Java programming language class that implements
the <code>org.glassfish.api.container.Sniffer</code> interface. This implementation
can be as simple as looking for a specific file in the application&#8217;s
archive (such as the presence of <code>WEB-INF/web.xml</code>), or as complicated
as running an annotation scanner to determine an XML-less archive (such
as enterprise bean annotations in a JAR file). A <code>Sniffer</code>
implementation must be as small as possible and must not load any of the
container&#8217;s runtime classes.</p>
</div>
<div class="paragraph">
<p>A simple version of a <code>Sniffer</code> implementation uses the <code>handles</code> method
to check the existence of a file in the archive that denotes the
application type (as <code>WEB-INF/web.xml</code> denotes a web application).
Once a <code>Sniffer</code> implementation has detected that it can handle the
deployment request artifact, Eclipse GlassFish calls the <code>setUp</code> method.
The <code>setUp</code> method is responsible for setting up the container, which
can involve one or more of the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Downloading the container&#8217;s runtime (the first time that a container is used)</p>
</li>
<li>
<p>Installing the container&#8217;s runtime (the first time that a container is used)</p>
</li>
<li>
<p>Setting up one or more repositories to access the runtime&#8217;s classes
(these are implementations of the HK2 <code>com.sun.enterprise.module.Repository</code> interface,
such as the <code>com.sun.enterprise.module.impl.DirectoryBasedRepository</code> class)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>setUp</code> method returns an array of the
<code>com.sun.enterprise.module.Module</code> objects required by the container.</p>
</div>
<div class="paragraph">
<p>The <code>Sniffer</code> interface defines the following methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>handles(ReadableArchive source, ClassLoader loader)</code></dt>
<dd>
<p>Returns a <code>boolean</code> value indicating whether this <code>Sniffer</code>
implementation can handle the specified archive.</p>
</dd>
<dt class="hdlist1"><code>getURLPatterns()</code></dt>
<dd>
<p>Returns a <code>String</code> array containing all URL patterns to apply against
the request URL. If a pattern matches, the service method of the
associated container is invoked.</p>
</dd>
<dt class="hdlist1"><code>getAnnotationTypes()</code></dt>
<dd>
<p>Returns a list of annotation types recognized by this <code>Sniffer</code>
implementation. If an application archive contains one of the returned
annotation types, the deployment process invokes the container&#8217;s
deployers as if the <code>handles</code> method had returned true.</p>
</dd>
<dt class="hdlist1"><code>getModuleType()</code></dt>
<dd>
<p>Returns the module type associated with this <code>Sniffer</code> implementation
as a <code>String</code>.</p>
</dd>
<dt class="hdlist1"><code>setup(String containerHome, Logger logger)</code></dt>
<dd>
<p>Sets up the container libraries so that any dependent bundles from the
connector JAR file will be made available to the HK2 runtime. The
<code>setup</code> method returns an array of <code>com.sun.enterprise.module.Module</code>
classes, which are definitions of container implementations. Eclipse GlassFish can then load these modules so that it can create an instance
of the container&#8217;s <code>Deployer</code> or <code>Container</code> implementations when it
needs to. The module is locked as long as at least one module is
loaded in the associated container.</p>
</dd>
<dt class="hdlist1"><code>teardown()</code></dt>
<dd>
<p>Removes a container and all associated modules in the HK2 modules
subsystem.</p>
</dd>
<dt class="hdlist1"><code>getContainerNames()</code></dt>
<dd>
<p>Returns a <code>String</code> array containing the <code>Container</code> implementations
that this <code>Sniffer</code> implementation enables.</p>
</dd>
<dt class="hdlist1"><code>isUserVisible()</code></dt>
<dd>
<p>Returns a <code>boolean</code> value indicating whether this <code>Sniffer</code>
implementation should be visible to end-users.</p>
</dd>
<dt class="hdlist1"><code>getDeploymentConfigurations(final ReadableArchive source)</code></dt>
<dd>
<p>Returns a <code>Map&lt;String, String&gt;</code> of deployment configuration names to
configurations from this <code>Sniffer</code> implementation for the specified
application (the archive source). The names are created by Eclipse GlassFish; the configurations are the names of the files that contain
configuration information (for example, <code>WEB-INF/web.xml</code> and possibly
<code>WEB-INF/sun-web.xml</code> for a web application). If the
<code>getDeploymentConfigurations</code> method encounters errors while searching
or reading the specified archive source, it throws a
<code>java.io.IOException</code>.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="making-sniffer-implementations-available-to-the-glassfish-server"><a class="anchor" href="#making-sniffer-implementations-available-to-the-glassfish-server"></a>Making <code>Sniffer</code> Implementations Available to the Eclipse GlassFish</h5>
<div class="paragraph">
<p>Package <code>Sniffer</code> implementation code into modules and install the
modules in the as-install<code>/modules</code> directory. Eclipse GlassFish will
automatically discover these modules. If an administrator installs
connector modules that contain`Sniffer` implementations while Eclipse GlassFish is running, Eclipse GlassFish will pick them up at the next
deployment request.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-of-adding-container-capabilities"><a class="anchor" href="#example-of-adding-container-capabilities"></a>Example of Adding Container Capabilities</h3>
<div class="paragraph">
<p>This example shows a custom container and a web client of the container.
The example is comprised of the following code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code for the container, which is shown in <a href="#container-component-code">Container
Component Code</a></p>
</li>
<li>
<p>Code for a web client of the container, which is shown in
<a href="#web-client-code">Web Client Code</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Code that defines the configuration data for the container component is
shown in <a href="#examples-of-adding-configuration-data-for-a-component">Examples of Adding
Configuration Data for a Component</a>.</p>
</div>
<div class="paragraph">
<p>Code for an <code>asadmin</code> subcommand that updates the configuration data in
this example is shown in <a href="#gkbdf">Example 4-7</a>.</p>
</div>
<div class="sect3">
<h4 id="container-component-code"><a class="anchor" href="#container-component-code"></a>Container Component Code</h4>
<div class="paragraph">
<p>The container component code is comprised of the classes and interfaces
that are listed in the following table. The table also provides a
cross-reference to the listing of each class or interface.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Interface</th>
<th class="tableblock halign-left valign-top">Listing</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Greeter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkamr">Example 7-3</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GreeterContainer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkand">Example 7-4</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GreeterContainer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkamm">Example 7-5</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GreeterDeployer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkalo">Example 7-6</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GreeterSniffer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkaks">Example 7-7</a></p></td>
</tr>
</tbody>
</table>
<div id="gkamr" class="paragraph">
<p>Example 7-3 Annotation to Denote a Container&#8217;s Component</p>
</div>
<div class="paragraph">
<p>This example shows the code for defining a component of the <code>Greeter</code>
container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter</span>;

<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.RetentionPolicy</span>;

<span class="comment">/**
 * Simple annotation to denote Greeter's component
 */</span>
<span class="annotation">@Retention</span>(java.lang.annotation.RetentionPolicy.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Greeter {

    <span class="comment">/**
     * Name to uniquely identify different greeters
     *
     * @return a good greeter name
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> name();
}</code></pre>
</div>
</div>
<div id="gkand" class="paragraph">
<p>Example 7-4 Application Container Class</p>
</div>
<div class="paragraph">
<p>This example shows the Java language class <code>GreeterAppContainer</code>, which
implements the <code>ApplicationContainer</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.ApplicationContainer</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.ApplicationContext</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.archive.ReadableArchive</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">GreeterAppContainer</span> <span class="directive">implements</span> ApplicationContainer {

    <span class="directive">final</span> GreeterContainer ctr;
    <span class="directive">final</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&gt; componentClasses = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">Class</span>&gt;();

    <span class="directive">public</span> GreeterAppContainer(GreeterContainer ctr) {
        <span class="local-variable">this</span>.ctr = ctr;
    }

    <span class="type">void</span> addComponent(<span class="predefined-type">Class</span> componentClass) {
        componentClasses.add(componentClass);
    }

    <span class="directive">public</span> <span class="predefined-type">Object</span> getDescriptor() {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="directive">public</span> <span class="type">boolean</span> start(ApplicationContext startupContext) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="keyword">for</span> (<span class="predefined-type">Class</span> componentClass : componentClasses) {
            <span class="keyword">try</span> {
                <span class="predefined-type">Object</span> component = componentClass.newInstance();
                Greeter greeter = (Greeter)
                     componentClass.getAnnotation(Greeter.class);
                ctr.habitat.addComponent(greeter.name(), component);
            } <span class="keyword">catch</span>(<span class="exception">Exception</span> e) {
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(e);
            }
        }
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }

    <span class="directive">public</span> <span class="type">boolean</span> stop(ApplicationContext stopContext) {
        <span class="keyword">for</span> (<span class="predefined-type">Class</span> componentClass : componentClasses) {
            ctr.habitat.removeAllByType(componentClass);
        }
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }

    <span class="directive">public</span> <span class="type">boolean</span> suspend() {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="directive">public</span> <span class="type">boolean</span> resume() <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="directive">public</span> <span class="predefined-type">ClassLoader</span> getClassLoader() {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }
}</code></pre>
</div>
</div>
<div id="gkamm" class="paragraph">
<p>Example 7-5 Container Class</p>
</div>
<div class="paragraph">
<p>This example shows the Java language class <code>GreeterContainer</code>, which
implements the <code>Container</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.container.Container</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.Deployer</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Inject</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.Habitat</span>;

<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.glassfish.examples.extension.GreeterContainer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">GreeterContainer</span> <span class="directive">implements</span> <span class="predefined-type">Container</span> {

    <span class="annotation">@Inject</span>
    Habitat habitat;

    <span class="directive">public</span> <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Deployer&gt; getDeployer() {
        <span class="keyword">return</span> GreeterDeployer.class;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">greeter</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div id="gkalo" class="paragraph">
<p>Example 7-6 Deployer Class</p>
</div>
<div class="paragraph">
<p>This example shows the Java language class <code>GreeterDeployer</code>, which
implements the <code>Deployer</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.Deployer</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.MetaData</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.DeploymentContext</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.ApplicationContainer</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.archive.ReadableArchive</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.container.Container</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;

<span class="keyword">import</span> <span class="include">java.util.Enumeration</span>;

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">GreeterDeployer</span>
    <span class="directive">implements</span> Deployer&lt;GreeterContainer, GreeterAppContainer&gt; {

    <span class="directive">public</span> MetaData getMetaData() {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="directive">public</span> &lt;V&gt; V loadMetaData(<span class="predefined-type">Class</span>&lt;V&gt; type, DeploymentContext context) {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="directive">public</span> <span class="type">boolean</span> prepare(DeploymentContext context) {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="directive">public</span> GreeterAppContainer load(
        GreeterContainer container, DeploymentContext context) {

        GreeterAppContainer appCtr = <span class="keyword">new</span> GreeterAppContainer(container);
        <span class="predefined-type">ClassLoader</span> cl = context.getClassLoader();

        ReadableArchive ra = context.getOriginalSource();
        <span class="predefined-type">Enumeration</span>&lt;<span class="predefined-type">String</span>&gt; entries = ra.entries();
        <span class="keyword">while</span> (entries.hasMoreElements()) {
            <span class="predefined-type">String</span> entry = entries.nextElement();
            <span class="keyword">if</span> (entry.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">.class</span><span class="delimiter">&quot;</span></span>)) {
                <span class="predefined-type">String</span> className = entryToClass(entry);
                <span class="keyword">try</span> {
                    <span class="predefined-type">Class</span> componentClass = cl.loadClass(className);
                    <span class="comment">// ensure it is one of our component</span>
                    <span class="keyword">if</span> (componentClass.isAnnotationPresent(Greeter.class)) {
                        appCtr.addComponent(componentClass);
                    }
                } <span class="keyword">catch</span>(<span class="exception">Exception</span> e) {
                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(e);
                }

            }
        }
        <span class="keyword">return</span> appCtr;
    }

    <span class="directive">public</span> <span class="type">void</span> unload(GreeterAppContainer appContainer, DeploymentContext context) {

    }

    <span class="directive">public</span> <span class="type">void</span> clean(DeploymentContext context) {

    }

    <span class="directive">private</span> <span class="predefined-type">String</span> entryToClass(<span class="predefined-type">String</span> entry) {
        <span class="predefined-type">String</span> str = entry.substring(<span class="string"><span class="delimiter">&quot;</span><span class="content">WEB-INF/classes/</span><span class="delimiter">&quot;</span></span>.length(), entry.length()-<span class="integer">6</span>);
        <span class="keyword">return</span> str.replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">.</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div id="gkaks" class="paragraph">
<p>Example 7-7 Sniffer Class</p>
</div>
<div class="paragraph">
<p>This example shows the Java language class <code>GreeterSniffer</code>, which
implements the <code>Sniffer</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.glassfish.examples.extension.greeter</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.api.container.Sniffer</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.deployment.archive.ReadableArchive</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.api.admin.config.ConfigParser</span>;
<span class="keyword">import</span> <span class="include">org.glassfish.examples.extension.greeter.config.GreeterContainerConfig</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Service</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Inject</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.component.Habitat</span>;
<span class="keyword">import</span> <span class="include">com.sun.enterprise.module.Module</span>;

<span class="keyword">import</span> <span class="include">java.util.logging.Logger</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Annotation</span>;
<span class="keyword">import</span> <span class="include">java.lang.reflect.Array</span>;
<span class="keyword">import</span> <span class="include">java.net.URL</span>;

<span class="comment">/**
 * @author Jerome Dochez
 */</span>
<span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">greeter</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">GreeterSniffer</span> <span class="directive">implements</span> Sniffer {

    <span class="annotation">@Inject</span>(optional=<span class="predefined-constant">true</span>)
    GreeterContainerConfig config=<span class="predefined-constant">null</span>;

    <span class="annotation">@Inject</span>
    ConfigParser configParser;

    <span class="annotation">@Inject</span>
    Habitat habitat;

    <span class="directive">public</span> <span class="type">boolean</span> handles(ReadableArchive source, <span class="predefined-type">ClassLoader</span> loader) {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span><span class="type">[]</span> getURLPatterns() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">String</span>[<span class="integer">0</span>];
    }

    <span class="directive">public</span> <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Annotation</span>&gt;<span class="type">[]</span> getAnnotationTypes() {
        <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Annotation</span>&gt;<span class="type">[]</span> a = (<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Annotation</span>&gt;<span class="type">[]</span>) <span class="predefined-type">Array</span>.newInstance(<span class="predefined-type">Class</span>.class, <span class="integer">1</span>);
        a[<span class="integer">0</span>] = Greeter.class;
        <span class="keyword">return</span> a;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getModuleType() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">greeter</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="directive">public</span> Module<span class="type">[]</span> setup(<span class="predefined-type">String</span> containerHome, <span class="predefined-type">Logger</span> logger) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="keyword">if</span> (config==<span class="predefined-constant">null</span>) {
            <span class="predefined-type">URL</span> url = <span class="local-variable">this</span>.getClass().getClassLoader().getResource(<span class="string"><span class="delimiter">&quot;</span><span class="content">init.xml</span><span class="delimiter">&quot;</span></span>);
            <span class="keyword">if</span> (url!=<span class="predefined-constant">null</span>) {
                configParser.parseContainerConfig(
                    habitat, url, GreeterContainerConfig.class);
            }
        }
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="directive">public</span> <span class="type">void</span> tearDown() {

    }

    <span class="directive">public</span> <span class="predefined-type">String</span><span class="type">[]</span> getContainersNames() {
        <span class="predefined-type">String</span><span class="type">[]</span> c = { GreeterContainer.class.getName() };
        <span class="keyword">return</span> c;
    }

    <span class="directive">public</span> <span class="type">boolean</span> isUserVisible() {
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }

    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getDeploymentConfigurations
        (ReadableArchive source) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span><span class="type">[]</span> getIncompatibleSnifferTypes() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">String</span>[<span class="integer">0</span>];
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="web-client-code"><a class="anchor" href="#web-client-code"></a>Web Client Code</h4>
<div class="paragraph">
<p>The web client code is comprised of the classes and resources that are
listed in the following table. The table also provides a cross-reference
to the listing of each class or resource.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class or Resource</th>
<th class="tableblock halign-left valign-top">Listing</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HelloWorld</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkaki">Example 7-8</a>
+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SimpleGreeter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkalf">Example 7-9</a>
+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deployment descriptor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#gkaly">Example 7-10</a>
+</p></td>
</tr>
</tbody>
</table>
<div id="gkaki" class="paragraph">
<p>Example 7-8 Container Client Class</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">components.SimpleGreeter</span>;

<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.io.PrintWriter</span>;
<span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.WebServlet</span>;
<span class="keyword">import</span> <span class="include">jakarta.servlet</span>.*;
<span class="keyword">import</span> <span class="include">jakarta.servlet.http</span>.*;
<span class="keyword">import</span> <span class="include">jakarta.annotation.Resource</span>;


<span class="annotation">@WebServlet</span>(urlPatterns={<span class="string"><span class="delimiter">&quot;</span><span class="content">/hello</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloWorld</span> <span class="directive">extends</span> HttpServlet {

    <span class="annotation">@Resource</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Simple</span><span class="delimiter">&quot;</span></span>)
    SimpleGreeter greeter;

    <span class="directive">public</span> <span class="type">void</span> doGet(HttpServletRequest req, HttpServletResponse res)
            <span class="directive">throws</span> <span class="exception">IOException</span>, ServletException {


        <span class="predefined-type">PrintWriter</span> pw = res.getWriter();
        <span class="keyword">try</span> {
            pw.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Injected service is </span><span class="delimiter">&quot;</span></span> + greeter);
            <span class="keyword">if</span> (greeter!=<span class="predefined-constant">null</span>) {
                pw.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">SimpleService says </span><span class="delimiter">&quot;</span></span> + greeter.saySomething());
                pw.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;br&gt;</span><span class="delimiter">&quot;</span></span>);
            }
        } <span class="keyword">catch</span>(<span class="exception">Exception</span> e) {
            e.printStackTrace();
        }
    }
}</code></pre>
</div>
</div>
<div id="gkalf" class="paragraph">
<p>Example 7-9 Component for Container Client</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">components</span>;

<span class="keyword">import</span> <span class="include">org.glassfish.examples.extension.greeter.Greeter</span>;

<span class="annotation">@Greeter</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">simple</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleGreeter</span> {

    <span class="directive">public</span> <span class="predefined-type">String</span> saySomething() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Bonjour</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div id="gkaly" class="paragraph">
<p>Example 7-10 Deployment Descriptor for Container Client</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;web-app</span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.1</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/xml/ns/javaee</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=
    <span class="string"><span class="delimiter">&quot;</span><span class="content">http://xmlns.jcp.org/xml/ns/javaee</span>
    <span class="content">http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-session-persistence-module-2"><a class="anchor" href="#creating-a-session-persistence-module-2"></a>Creating a Session Persistence Module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Eclipse GlassFish enables you to create a session persistence module in
the web container for high availability-related functionality by
implementing the <code>PersistenceStrategyBuilder</code> interface . Using the
<code>PersistenceStrategyBuilder</code> interface in an HK2 service makes the
session manager extensible because you can implement a new persistence
type without having to modify the web container code.</p>
</div>
<div class="paragraph">
<p>For information about other high-availability, session persistence
solutions, see "<a href="ha-administration-guide.html#configuring-high-availability-session-persistence-and-failover">Configuring High Availability Session
Persistence and Failover</a>" in Eclipse GlassFish High
Availability Administration Guide.</p>
</div>
<div class="sect2">
<h3 id="implementing-the-persistencestrategybuilder-interface"><a class="anchor" href="#implementing-the-persistencestrategybuilder-interface"></a>Implementing the <code>PersistenceStrategyBuilder</code> Interface</h3>
<div class="paragraph">
<p>You can implement the <code>PersistenceStrategyBuilder</code> interface by creating
a new web session manager type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.sun.enterprise.web</span>;

<span class="keyword">import</span> <span class="include">com.sun.enterprise.deployment.runtime.web.SessionManager</span>;
<span class="keyword">import</span> <span class="include">org.apache.catalina.Context</span>;
<span class="keyword">import</span> <span class="include">org.jvnet.hk2.annotations.Contract</span>;

<span class="annotation">@Contract</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceStrategyBuilder</span> {

    <span class="directive">public</span> <span class="type">void</span> initializePersistenceStrategy(
            <span class="predefined-type">Context</span> ctx,
            SessionManager smBean,
            ServerConfigLookup serverConfigLookup);

    <span class="directive">public</span> <span class="type">void</span> setPersistenceFrequency(<span class="predefined-type">String</span> persistenceFrequency);

    <span class="directive">public</span> <span class="type">void</span> setPersistenceScope(<span class="predefined-type">String</span> persistenceScope);

    <span class="directive">public</span> <span class="type">void</span> setPassedInPersistenceType(<span class="predefined-type">String</span> persistenceType);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example of how to implement the <code>PersistenceStrategyBuilder</code>
interface by creating a new web session manager and setting a store for
it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">xyz</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">XYZStrategyBuilder</span> <span class="directive">implements</span> PersistenceStrategyBuilder {

    <span class="directive">private</span> <span class="predefined-type">String</span> persistenceFrequency = <span class="predefined-constant">null</span>;
    <span class="directive">private</span> <span class="predefined-type">String</span> persistenceScope = <span class="predefined-constant">null</span>;
    <span class="directive">private</span> <span class="predefined-type">String</span> persistenceType = <span class="predefined-constant">null</span>;

    <span class="directive">public</span> <span class="type">void</span> init(StandardContext ctx, SessionManager sessionManager,
      ServerConfigLookup serverConfigLookup) {
        <span class="comment">// add listeners, valves, etc. to the ctx</span>
        <span class="comment">// Set the manager and store</span>
    }

    <span class="directive">public</span> <span class="type">void</span> setPersistenceFrequency(<span class="predefined-type">String</span> persistenceFrequency) {
        <span class="local-variable">this</span>.persistenceFrequency = persistenceFrequency;
    }

    <span class="directive">public</span> <span class="type">void</span> setPersistenceScope(<span class="predefined-type">String</span> persistenceScope) {
        <span class="local-variable">this</span>.persistenceScope = persistenceScope;
    }

    <span class="directive">public</span> <span class="type">void</span> setPassedInPersistenceType(<span class="predefined-type">String</span> persistenceType) {
        <span class="local-variable">this</span>.passedInPersistenceType = persistenceType;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>Manager</code> is provided, then it will be used in Eclipse GlassFish.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a backing store is required, it is the responsibility of the
<code>Manager</code> to make sure that the <code>findSession</code> method correctly uses the
<code>Store</code> that the <code>Manager</code> provides.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="gkcws" class="paragraph">
<p>Example 8-1 Implementing <code>PersistenceStrategyBuilder</code> With a Custom Web
Session Manager</p>
</div>
<div class="paragraph">
<p>This example defines a session manager type that is named
<code>MyHASolution</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">MyHASolution</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyHASolutionStrategyBuilder</span> <span class="directive">implements</span> PersistenceStrategyBuilder {

    <span class="directive">private</span> <span class="predefined-type">String</span> persistenceFrequency = <span class="predefined-constant">null</span>;
    <span class="directive">private</span> <span class="predefined-type">String</span> persistenceScope = <span class="predefined-constant">null</span>;
    <span class="directive">private</span> <span class="predefined-type">String</span> persistenceType = <span class="predefined-constant">null</span>;

    <span class="directive">public</span> <span class="type">void</span> init(StandardContext ctx, SessionManager sessionManager,
      ServerConfigLookup serverConfigLookup) {
        <span class="comment">// add listeners, valves, etc. to the ctx</span>
        <span class="comment">// Set the manager and store</span>
        MyManager myManager = <span class="keyword">new</span> MyManager(persistenceType, persistenceFrequency);
        <span class="comment">// (You could also make this a service and look it up in the habitat.</span>
        <span class="comment">// For simplicity we are just doing a new implementation of the class here.)</span>
        MyStore store = <span class="keyword">new</span> MyStore();
        myManager.setStore(store);
        ctx.setManager(myManager);
    }

    <span class="directive">public</span> <span class="type">void</span> setPersistenceFrequency(<span class="predefined-type">String</span> persistenceFrequency) {
        <span class="local-variable">this</span>.persistenceFrequency = persistenceFrequency;
    }

    <span class="directive">public</span> <span class="type">void</span> setPersistenceScope(<span class="predefined-type">String</span> persistenceScope) {
        <span class="local-variable">this</span>.persistenceScope = persistenceScope;
    }

    <span class="directive">public</span> <span class="type">void</span> setPassedInPersistenceType(<span class="predefined-type">String</span> persistenceType) {
        <span class="local-variable">this</span>.passedInPersistenceType = persistenceType;

    }

}</code></pre>
</div>
</div>
<div id="gksmc" class="paragraph">
<p>Example 8-2 Session Manager Configuration in the <code>glassfish-web.xml</code>
File</p>
</div>
<div class="paragraph">
<p>This example sets the <code>persistence-type</code> attribute of the
<code>session-manager</code> element of <code>glassfish-web.xml</code> to <code>myHASolution</code></p>
</div>
<div class="paragraph">
<p>Based on the <code>domain.xml</code> and <code>glassfish-web.xml</code> settings, the web
container looks up the appropriate <code>PersistenceStrategyBuilder</code>
interface in the Habitat and uses it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">       <span class="tag">&lt;glassfish-web-app&gt;</span>
         <span class="tag">&lt;session-config&gt;</span>
           <span class="tag">&lt;session-manager</span> <span class="attribute-name">persistence-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">myHASolution</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
         <span class="tag">&lt;session-config&gt;</span>
       <span class="tag">&lt;glassfish-web-app&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="packaging-integrating-and-delivering-an-add-on-component"><a class="anchor" href="#packaging-integrating-and-delivering-an-add-on-component"></a>Packaging, Integrating, and Delivering an Add-On Component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Packaging an add-on component enables the component to interact with the
Eclipse GlassFish kernel in the same way as other components. Integrating
a component with Eclipse GlassFish enables Eclipse GlassFish to discover
the component at runtime. If an add-on component is an extension or
update to existing installations of Eclipse GlassFish, deliver the
component through Update Tool.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#packaging-an-add-on-component">Packaging an Add-On Component</a></p>
</li>
<li>
<p><a href="#integrating-an-add-on-component-with-glassfish-server">Integrating an Add-On Component With Eclipse GlassFish</a></p>
</li>
<li>
<p><a href="#delivering-an-add-on-component-through-update-tool">Delivering an Add-On Component Through Update Tool</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="packaging-an-add-on-component"><a class="anchor" href="#packaging-an-add-on-component"></a>Packaging an Add-On Component</h3>
<div class="paragraph">
<p>To enable an add-on component to plug in to the Eclipse GlassFish kernel
in the same way as other components, package the component as an OSGi
bundle.</p>
</div>
<div class="paragraph">
<p>A bundle is the unit of deployment in the OSGi module management
subsystem. To package a component as an OSGi bundle, package the
component&#8217;s constituent files in a Java archive (JAR) file with
appropriate manifest entries. The manifest entries provide information
about the component that is required to enable the component to be
plugged into the Eclipse GlassFish kernel, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Name</p>
</li>
<li>
<p>Version</p>
</li>
<li>
<p>Dependencies</p>
</li>
<li>
<p>Capabilities</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="integrating-an-add-on-component-with-glassfish-server"><a class="anchor" href="#integrating-an-add-on-component-with-glassfish-server"></a>Integrating an Add-On Component With Eclipse GlassFish</h3>
<div class="paragraph">
<p>Integrating an add-on component with Eclipse GlassFish enables Eclipse GlassFish to
discover the component at runtime. To integrate an add-on
component with Eclipse GlassFish, ensure that the JAR file that contains
the component is copied to or installed in the as-install<code>/modules/</code> directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="delivering-an-add-on-component-through-update-tool"><a class="anchor" href="#delivering-an-add-on-component-through-update-tool"></a>Delivering an Add-On Component Through Update Tool</h3>
<div class="paragraph">
<p>If an add-on component is an extension or update to existing
installations of Eclipse GlassFish, deliver the component through Update
Tool. To deliver an add-on component through Update Tool, create an
Image Packaging System (IPS) package to contain the component and add
the package to a suitable IPS package repository.</p>
</div>
<div class="paragraph">
<p>For information about how to create IPS packages, see the
<a href="http://wikis.oracle.com/display/IpsBestPractices/">IPS best practices
document</a> (<code><a href="http://wikis.oracle.com/display/IpsBestPractices/" class="bare">http://wikis.oracle.com/display/IpsBestPractices/</a></code>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a-integration-point-reference"><a class="anchor" href="#a-integration-point-reference"></a>Integration Point Reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix provides reference information about integration points,
which are described in
<a href="#extending-the-administration-console">Extending the Administration Console</a>.
Define an integration point for each user interface feature in the
<code>console-config.xml</code> file for your add-on component.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#integration-point-attributes">Integration Point Attributes</a></p>
</li>
<li>
<p><a href="#GSACG00146"><code>org.glassfish.admingui:navNode</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00147"><code>org.glassfish.admingui:rightPanel</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00148"><code>org.glassfish.admingui:rightPanelTitle</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00149"><code>org.glassfish.admingui:serverInstTab</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00150"><code>org.glassfish.admingui:commonTask</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00151"><code>org.glassfish.admingui:configuration</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00152"><code>org.glassfish.admingui:resources</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00153"><code>org.glassfish.admingui:customtheme</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00154"><code>org.glassfish.admingui:masthead</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00155"><code>org.glassfish.admingui:loginimage</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00156"><code>org.glassfish.admingui:loginform</code> Integration Point</a></p>
</li>
<li>
<p><a href="#GSACG00157"><code>org.glassfish.admingui:versioninfo</code> Integration Point</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="integration-point-attributes"><a class="anchor" href="#integration-point-attributes"></a>Integration Point Attributes</h3>
<div class="paragraph">
<p>For each <code>integration-point</code> element, specify the following attributes.
Each attribute takes a string value.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>An identifier for the integration point. The remaining sections of
this appendix do not provide details about specifying this attribute.</p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>The ID of the integration point&#8217;s parent.</p>
</dd>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p>The type of the integration point.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of integration
points with the same <code>parentId</code>. A lower number specifies a higher
priority (for example, 100 represents a higher priority than 400). You
may need to experiment in order to place the integration point where
you want it. This attribute is optional.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A relative path to the Jakarta Server Faces page that contains the content
to be integrated. Typically, the file contains a Jakarta Server Faces code
fragment that is incorporated into a page. The code fragment often
specifies a link to another Jakarta Server Faces page that appears when a
user clicks the link.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="GSACG00146"></a><a id="org.glassfish.adminguinavnode-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguinavnode-integration-point"><a class="anchor" href="#org-glassfish-adminguinavnode-integration-point"></a><code>org.glassfish.admingui:navNode</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:navNode</code> integration point to insert a
node in the Administration Console navigation tree. Specify the
attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:navNode</code>, the left-hand navigation tree</p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>The <code>id</code> value of the <code>navNode</code> that is the parent for this node.
The <code>parentId</code> can be any of the following:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>tree</code></dt>
<dd>
<p>The root node of the entire navigation tree. Use this value to place
your node at the top level of the tree. You can then use the <code>id</code> of
this node to create additional nodes beneath it.</p>
</dd>
<dt class="hdlist1"><code>registration</code></dt>
<dd>
<p>The Registration node</p>
</dd>
<dt class="hdlist1"><code>applicationServer</code></dt>
<dd>
<p>The Eclipse GlassFish node</p>
</dd>
<dt class="hdlist1"><code>applications</code></dt>
<dd>
<p>The Applications node</p>
</dd>
<dt class="hdlist1"><code>resources</code></dt>
<dd>
<p>The Resources node</p>
</dd>
<dt class="hdlist1"><code>configuration</code></dt>
<dd>
<p>The Configuration node</p>
</dd>
<dt class="hdlist1"><code>webContainer</code></dt>
<dd>
<p>The Web Container node under the Configuration node</p>
</dd>
<dt class="hdlist1"><code>httpService</code></dt>
<dd>
<p>The HTTP Service node under the Configuration node</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>webContainer</code> and <code>httpService</code> nodes are available only if you
installed the web container module for the Administration Console (the
<code>console-web-gui.jar</code> OSGi bundle).</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the node on
the tree, whether at the top level or under another node.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A relative path to the Jakarta Server Faces page that contains the content
to be integrated, or a URL to an external resource that returns the
appropriate data structure for inclusion.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpmb">Example 3-2</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00147"></a><a id="org.glassfish.adminguirightpanel-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguirightpanel-integration-point"><a class="anchor" href="#org-glassfish-adminguirightpanel-integration-point"></a><code>org.glassfish.admingui:rightPanel</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:rightPanel</code> integration point to specify
content for the right frame of the Administration Console. Specify the
attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:rightPanel</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>None.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering. If multiple
plug-ins specify content for the right frame, the one with greater
priority will take precedence.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A path relative to the root of the plug-in JAR file to a file
containing the content for the right panel. Alternatively, it may
contain a full URL which will deliver the content for the right panel.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="GSACG00148"></a><a id="org.glassfish.adminguirightpaneltitle-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguirightpaneltitle-integration-point"><a class="anchor" href="#org-glassfish-adminguirightpaneltitle-integration-point"></a><code>org.glassfish.admingui:rightPanelTitle</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:rightPanel</code> integration point to specify
the title for the right frame of the Administration Console. Specify the
attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:rightPanelTitle</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>None.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering. If multiple
plug-ins specify content for the right frame, the one with greater
priority will take precedence.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>Specifies the title to display at the top of the right panel.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="GSACG00149"></a><a id="org.glassfish.adminguiserverinsttab-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguiserverinsttab-integration-point"><a class="anchor" href="#org-glassfish-adminguiserverinsttab-integration-point"></a><code>org.glassfish.admingui:serverInstTab</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:serverInstTab</code> integration point to place
an additional tab on the Eclipse GlassFish page of the Administration
Console. Specify the attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:serverInstTab</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>The <code>id</code> value of the tab set that is the parent for this tab. For a
top-level tab on this page, this value is <code>serverInstTabs</code>, the tab
set that contains the general information property pages for Eclipse GlassFish.
For a sub-tab, the value is the <code>id</code> value for the parent tab.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the tab on the
page, whether at the top level or under another tab.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A relative path to the Jakarta Server Faces page that contains the content
to be integrated.
When you use this integration point, your Jakarta Server Faces page must
call the <code>setSessionAttribute</code> handler for the <code>command</code> event to set
the session variable of the <code>serverInstTabs</code> tab set to the <code>id</code> value
of your tab. For example, the file may have the following content:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun:tab</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sampletab</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">immediate</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample First Tab</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="doctype">&lt;!command
        setSessionAttribute(key=&quot;serverInstTabs&quot; value=&quot;sampleTab&quot;);
        gf.redirect(page=&quot;#{request.contextPath}/page/tabPage.jsf?name=Sample%20First%20Tab&quot;);
    /&gt;</span>
<span class="tag">&lt;/sun:tab&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>id</code> of the <code>sun:tab</code> custom tag must be the same as the <code>value</code>
argument of the <code>setSessionAttribute</code> handler.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For examples, see <a href="#ghplc">Example
3-4</a> and <a href="#ghplu">Example 3-5</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00150"></a><a id="org.glassfish.adminguicommontask-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguicommontask-integration-point"><a class="anchor" href="#org-glassfish-adminguicommontask-integration-point"></a><code>org.glassfish.admingui:commonTask</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:commonTask</code> integration point to place a
new task or task group on the Common Tasks page of the Administration
Console. Specify the attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:commonTask</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>If you are adding a task group, the <code>id</code> value of the Common Tasks
page, which is <code>commonTasksSection</code>.
If you are adding a single task, the <code>id</code> value of the task group that
is the parent for this tab, such as <code>deployment</code> (for the Deployment
group).</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the tab on the
page, whether at the top level or under another tab.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A relative path to the Jakarta Server Faces page that contains the content
to be integrated.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For examples, see <a href="#ghpox">Example
3-7</a> and <a href="#ghplk">Example 3-9</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00151"></a><a id="org.glassfish.adminguiconfiguration-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguiconfiguration-integration-point"><a class="anchor" href="#org-glassfish-adminguiconfiguration-integration-point"></a><code>org.glassfish.admingui:configuration</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:configuration</code> integration point to add a
component to the Configuration page of the Administration Console.
Typically, you add a link to the property sheet section of this page.
Specify the attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:configuration</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>The <code>id</code> value of the property sheet for the Configuration page. This
value is <code>propSheetSection</code>, the section that contains the property
definitions for the Configuration page.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item on
the Configuration page.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A relative path to the Jakarta Server Faces page that contains the content
to be integrated.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="GSACG00152"></a><a id="org.glassfish.adminguiresources-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguiresources-integration-point"><a class="anchor" href="#org-glassfish-adminguiresources-integration-point"></a><code>org.glassfish.admingui:resources</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:resources</code> integration point to add a
component to the Resources page of the Administration Console.
Typically, you add a link to the property sheet section of this page.
Specify the attributes and their content as follows.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:resources</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>The <code>id</code> value of the property sheet for the Resources page. This
value is <code>propSheetSection</code>, the section that contains the property
definitions for the Resources page.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item on
the Resources page.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A relative path to the Jakarta Server Faces page that contains the content
to be integrated.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpnu">Example
3-11</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00153"></a><a id="org.glassfish.adminguicustomtheme-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguicustomtheme-integration-point"><a class="anchor" href="#org-glassfish-adminguicustomtheme-integration-point"></a><code>org.glassfish.admingui:customtheme</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:customtheme</code> integration point to add
your own branding to the Administration Console. Specify the attributes
and their content as follows. Do not specify a <code>parentId</code> attribute for
this integration point.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:customtheme</code></p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item in
comparison to other themes. This value must be between 1 and 100. The
theme with the smallest number is used first.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>The name of the properties file that contains the key/value pairs that
will be used to access your theme JAR file. You must specify the
following keys:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>com.sun.webui.theme.DEFAULT_THEME</code></dt>
<dd>
<p>Specifies the theme name for the theme that this application may
depend on.</p>
</dd>
<dt class="hdlist1"><code>com.sun.webui.theme.DEFAULT_THEME_VERSION</code></dt>
<dd>
<p>Specifies the theme version this application may depend on.</p>
<div class="paragraph">
<p>For example, the properties file for the default Administration Console brand contains the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>com.sun.webui.theme.DEFAULT_THEME=suntheme
com.sun.webui.theme.DEFAULT_THEME_VERSION=4.3</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpls">Example
3-14</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00154"></a><a id="org.glassfish.adminguimasthead-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguimasthead-integration-point"><a class="anchor" href="#org-glassfish-adminguimasthead-integration-point"></a><code>org.glassfish.admingui:masthead</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:masthead</code> integration point to specify
the name and location of the include masthead file, which can be
customized with a branding image. This include file will be integrated
on the masthead of the Administration Console. Specify the attributes
and their content as follows. Do not specify a <code>parentId</code> attribute for
this integration point.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:masthead</code></p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item in
comparison to other items of this type. This value must be between 1
and 100. The theme with the smallest number is used first.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A file that contains the content, typically a file that is included in
a Jakarta Server Faces page.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpla">Example
3-15</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00155"></a><a id="org.glassfish.adminguiloginimage-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguiloginimage-integration-point"><a class="anchor" href="#org-glassfish-adminguiloginimage-integration-point"></a><code>org.glassfish.admingui:loginimage</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:loginimage</code> integration point to specify
the name and location of the include file containing the branding login
image code that will be integrated with the login page of the
Administration Console. Specify the attributes and their content as
follows. Do not specify a <code>parentId</code> attribute for this integration
point.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:loginimage</code></p>
</dd>
<dt class="hdlist1"><code>parentId</code></dt>
<dd>
<p>None; a login image does not have a parent ID.</p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item in
comparison to other items of this type. This value must be between 1
and 100. The theme with the smallest number is used first.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A file that contains the content, typically a file that is included in
a Jakarta Server Faces page.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpla">Example
3-15</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00156"></a><a id="org.glassfish.adminguiloginform-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguiloginform-integration-point"><a class="anchor" href="#org-glassfish-adminguiloginform-integration-point"></a><code>org.glassfish.admingui:loginform</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:loginform</code> integration point to specify
the name and location of the include file containing the customized
login form code. This code also contains the login background image used
for the login page for the Administration Console. Specify the
attributes and their content as follows. Do not specify a <code>parentId</code>
attribute for this integration point.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:loginform</code></p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item in
comparison to other items of this type. This value must be between 1
and 100. The theme with the smallest number is used first.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A file that contains the content, typically a file that is included in
a Jakarta Server Faces page.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpla">Example
3-15</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSACG00157"></a><a id="org.glassfish.adminguiversioninfo-integration-point"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="org-glassfish-adminguiversioninfo-integration-point"><a class="anchor" href="#org-glassfish-adminguiversioninfo-integration-point"></a><code>org.glassfish.admingui:versioninfo</code> Integration Point</h3>
<div class="paragraph">
<p>Use an <code>org.glassfish.admingui:versioninfo</code> integration point to specify
the name and location of the include file containing the branding image
that will be integrated with the content of the version popup window.
Specify the attributes and their content as follows. Do not specify a
<code>parentId</code> attribute for this integration point.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p><code>org.glassfish.admingui:versioninfo</code></p>
</dd>
<dt class="hdlist1"><code>priority</code></dt>
<dd>
<p>A numeric value that specifies the relative ordering of the item in
comparison to other items of this type. This value must be between 1
and 100. The theme with the smallest number is used first.</p>
</dd>
<dt class="hdlist1"><code>content</code></dt>
<dd>
<p>A file that contains the content, typically a file that is included in
a Jakarta Server Faces page.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For an example, see <a href="#ghpla">Example
3-15</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-03-20 17:42:09 UTC
</div>
</div>
</body>
</html>