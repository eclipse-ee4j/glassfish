
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Managing Administrative Security</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
<table id="doc-title" cellspacing="0" cellpadding="0">
  <tr>
  <td align="left" valign="top">
  <b>Managing Administrative Security</b><br />
      <p class="beta">DRAFT</p>
  </td>
  </tr>
</table>
<hr />

<table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
	<colgroup>
		<col width="12%"/>
		<col width="12%"/>
		<col width="*"/>
	</colgroup>
	<tr>
		<td align="left">
		<a href="security-in-cluster-mode.html">
			<span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Previous</span>
		</a>
		</td>

		<td align="left">
		<a href="running-in-secure-environment.html">
			<span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Next</span>
		</a>
		</td>

		<td align="right">
		<a href="toc.html">
			<span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Contents</span>
		</a>
		</td>
	</tr>
</table>


<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a id="GSSCG00039"></a><a id="gknqh"></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing-administrative-security">5 Managing Administrative Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to manage administrative security by using
the secure administration feature.</p>
</div>
<div class="paragraph">
<p>This chapter assumes that you are familiar with security features such
as authentication, authorization, and certificates. If you are not,
first see <a href="system-security.html#ablnk">Administering System Security</a>.</p>
</div>
<div class="paragraph">
<p>Instructions for accomplishing the tasks specific to GlassFish Server by
using the Administration Console are contained in the Administration
Console online help.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#gkocp">Secure Administration Overview</a></p>
</li>
<li>
<p><a href="#gkofl">How Secure Admin Works: The Big Picture</a></p>
</li>
<li>
<p><a href="#gkofe">Considerations When Running GlassFish Server With Default
Security</a></p>
</li>
<li>
<p><a href="#gkomz">Running Secure Admin</a></p>
</li>
<li>
<p><a href="#gkolu">Additional Considerations When Creating Local Instances</a></p>
</li>
<li>
<p><a href="#gkqah">Secure Admin Use Case</a></p>
</li>
<li>
<p><a href="#gkodn">Upgrading an SSL-Enabled Secure GlassFish Installation to
Secure Admin</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="gkocp"></a><a id="GSSCG00162"></a><a id="secure-administration-overview"></a></p>
</div>
<div class="sect2">
<h3 id="_secure_administration_overview">Secure Administration Overview</h3>
<div class="paragraph">
<p>The secure administration feature allows an administrator to secure all
administrative communication between the domain administration server
(DAS), any remote instances, and administration clients such as the
<code>asadmin</code> utility, the administration console, and REST clients.</p>
</div>
<div class="paragraph">
<p>In addition, secure administration helps to prevent DAS-to-DAS and
instance-to-instance traffic, and carefully restricts
administration-client-to-instance traffic.</p>
</div>
<div class="paragraph">
<p>The secure administration feature, which is henceforth referred to as
secure admin, provides a secure environment, in which you can be
confident that rogue users or processes cannot intercept or corrupt
administration traffic or impersonate legitimate GlassFish Server
components.</p>
</div>
<div class="paragraph">
<p>When you install GlassFish Server or create a new domain, secure admin
is disabled by default. When secure admin is disabled, GlassFish Server
does not encrypt administrative communication among the system
components and does not accept administrative connections from remote
hosts.</p>
</div>
<div class="paragraph">
<p>The following subcommands enable and disable secure admin:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>enable-secure-admin-The <code>enable-secure-admin</code> subcommand turns on
secure admin. GlassFish Server uses SSL encryption to protect subsequent
administrative traffic and will accept remote administrative
connections. Enabling secure admin affects the entire domain, including
the DAS and all instances. The DAS must be running, and not any
instances, when you run <code>enable-secure-admin</code>. You must restart the DAS
immediately after enabling secure admin, and then start any instances
you want to run.<br></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>enable-secure-admin</code> subcommand fails if any administrative user
has a blank password.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>disable-secure-admin-The <code>disable-secure-admin</code> subcommand turns off
secure admin. GlassFish Server no longer encrypts administrative
messages and will no longer accept remote administration connections.
Disabling secure admin affects the entire domain, including the DAS and
all instances. The DAS must be running , and not any instances, when you
run <code>disable-secure-admin</code>. You must restart the DAS immediately after
disabling secure admin, and then start any instances you want to run.<br>
If secure admin is not enabled, this subcommand has no effect.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section describes how to use these commands to run secure admin,
and the implications of doing so.</p>
</div>
<div class="paragraph">
<p><a id="gkofl"></a><a id="GSSCG00163"></a><a id="how-secure-admin-works-the-big-picture"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_how_secure_admin_works_the_big_picture">How Secure Admin Works: The Big Picture</h3>
<div class="paragraph">
<p>Secure admin is a domain-wide setting. It affects the DAS and all
instances and all administration clients. This section describes the
following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#gkqce">Functions Performed by Secure Admin</a></p>
</li>
<li>
<p><a href="#gkocv">Which Administration Account is Used?</a></p>
</li>
<li>
<p><a href="#gkodi">What Authentication Methods Are Used for Secure
Administration?</a></p>
</li>
<li>
<p><a href="#gkpex">Understanding How Certificate Authentication is Performed</a></p>
</li>
<li>
<p><a href="#gkoey">What Certificates Are Used?</a></p>
</li>
<li>
<p><a href="#glgmy">An Alternate Approach: Using Distinguished Names to
Specify Certificates</a></p>
</li>
<li>
<p><a href="#gkqjj">Guarding Against Unwanted Connections</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="gkqce"></a><a id="GSSCG00227"></a><a id="functions-performed-by-secure-admin"></a></p>
</div>
<div class="sect3">
<h4 id="_functions_performed_by_secure_admin">Functions Performed by Secure Admin</h4>
<div class="paragraph">
<p>The <code>enable-secure-admin</code> subcommand performs the following functions.
Subsequent sections describe these functions in more detail.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enables the secure admin behavior, optionally setting which aliases
are to be used for identifying the DAS and instance certificates.</p>
</li>
<li>
<p>Adjusts all configurations in the domain, including default-config.</p>
</li>
<li>
<p>Adjusts Grizzly settings:</p>
<div class="ulist">
<ul>
<li>
<p>SSL/TLS is enabled in the DAS&#8217;s admin listener and the instances'
admin listeners.</p>
</li>
<li>
<p>Port unification (that is, HTTP and HTTPS are handled by the same
port), http—to—https redirection, and client authentication
(client-auth=want) are enabled.</p>
</li>
<li>
<p>Configures SSL to use the administration truststore.</p>
</li>
<li>
<p>Configures SSL to use the administration keystore and the correct
alias (for the self-signed cert) for authenticating itself. (You can use
your own certificate instead, as described in <a href="#gkped">Using Your Own
Certificates</a>.<br>
The Grizzly configuration on the DAS and each instance is identical,
with the exception that the DAS uses the <code>s1as</code> alias for SSL/TLS
authentication and the instances use the <code>glassfish-instance</code> alias.
(These alias names are the default, and you can change them.)<br>
A server restart is required to change the Grizzly adapter behavior.<br>
The restart also synchronizes the restarted instances. When you start
the instances, the DAS delivers the updated configuration to the
instances.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="gkocv"></a><a id="GSSCG00228"></a><a id="which-administration-account-is-used"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_which_administration_account_is_used">Which Administration Account is Used?</h4>
<div class="paragraph">
<p>If only one administration account exists in the realm, GlassFish Server
treats that account as the current default administration account. In
this case, when you run an <code>asadmin</code> command, you do not need to specify
the username. If a password for that username is required, you need to
specify it, typically by using the <code>--passwordfile</code> option or by letting
<code>asadmin</code> prompt you for it.</p>
</div>
<div class="paragraph">
<p>By default, GlassFish Server includes a single account for user "admin"
and an empty password. Therefore, if you make no other changes before
you enable secure admin, "admin" is the initial default username and no
password is required. You need to decide whether enabling secure admin
without also requiring a password makes sense in your environment.</p>
</div>
<div class="paragraph">
<p>If multiple admin accounts exist, then GlassFish Server does not
recognize any admin username as the default. You must then specify a
valid username via the <code>-—user</code> option when you use the <code>asadmin</code>
command (or by or defining the <code>AS_ASDMIN_USER</code> environment variable),
and its associated password (if the associated password is not empty).</p>
</div>
<div class="paragraph">
<p>The username and password used for a login attempt must match the
username and password (if required) for an account defined in the realm,
and you must have set up the account as a member of the admin group.</p>
</div>
<div class="paragraph">
<p><a id="gkodi"></a><a id="GSSCG00229"></a><a id="what-authentication-methods-are-used-for-secure-administration"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_what_authentication_methods_are_used_for_secure_administration">What Authentication Methods Are Used for Secure Administration?</h4>
<div class="paragraph">
<p>The secure admin feature enforces security via the following
authentication methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The DAS and instances authenticate to each other via mutual (two-way)
SSL/TLS certificate authentication. The DAS authenticates to clients via
one-way SSL/TLS certificate authentication.<br>
The domain creation process creates a default keystore and truststore,
plus a default private key for the DAS. Secure admin uses this initial
configuration to set up the truststore so that the DAS and instances
always trust each other.</p>
</li>
<li>
<p>Remote administration clients (<code>asadmin</code>, administration console,
browsers, and IDEs) must accept the public certificate presented by the
DAS. If accepted, remote administration clients then send a user name
and password (HTTP Basic authentication) in the HTTP Authorization
header. The receiving DAS or instance makes sure those credentials are
valid in its realm, and authenticates and authorizes the user.</p>
</li>
<li>
<p>A locally-running <code>asadmin</code> (that is, connecting to an instance on the
same host) authenticates and authorizes to the co-located instance using
a locally-provisioned password.</p>
</li>
<li>
<p>Credentials or other sensitive information sent over the network are
always encrypted if secure admin is enabled. No credentials are sent in
the clear if secure admin is enabled. (If secure admin is disabled,
credentials are sent in the clear.) Messages between administration
clients and the DAS, between the DAS and remote instances, and between
local administration clients and instances are encrypted using SSL/TLS.
This is true even if you explicitly set the <code>asadmin</code> <code>-—secure</code> option
to false.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#gkobl">Table 5-1</a> shows which authentication methods are employed
when secure admin is enabled or disabled.</p>
</div>
<div class="paragraph">
<p><a id="sthref35"></a><a id="gkobl"></a></p>
</div>
<div class="paragraph">
<p>Table 5-1 Authentication Methods Employed</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access Method</th>
<th class="tableblock halign-left valign-top">When Secure Admin is Disabled</th>
<th class="tableblock halign-left valign-top">When Secure Admin is
Enabled</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote administration access to the DAS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rejected.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username/password
authentication. (Client must also accept server certificate.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Communication between DAS and instances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleartext messages. No mutual
authentication.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSL-encrypted messages. SSL mutual authentication using
certificates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Communication between administration clients and DAS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleartext
messages. No DAS authentication.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSL-encrypted messages. DAS uses SSL
certificate server authentication.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local asadmin client to instance on same node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleartext messages.
Locally-provisioned password mechanism is used.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSL-encrypted messages.
Locally-provisioned password mechanism is used.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="gkpex"></a><a id="GSSCG00230"></a><a id="understanding-how-certificate-authentication-is-performed"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_understanding_how_certificate_authentication_is_performed">Understanding How Certificate Authentication is Performed</h4>
<div class="paragraph">
<p>The domain creation process creates a primary (private) key and a
self-signed certificate for the DAS, and a separate private key and
self-signed certificate for remote instances.</p>
</div>
<div class="paragraph">
<p>Then, when you enable secure admin, the following actions are performed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Both private keys are stored in the domain-wide DAS keystore file,
keystore.jks.</p>
</li>
<li>
<p>Both public certificates are stored in the domain-wide DAS truststore
file, cacerts.jks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the DAS sends a message to an instance:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>SSL on the instance asks the DAS to provide an SSL/TLS certificate.</p>
</li>
<li>
<p>The DAS sends the certificate with the alias you specified using the
<code>--adminalias</code> option when you ran the <code>enable-secure-admin</code> subcommand.</p>
</li>
<li>
<p>SSL on the instance makes sure the certificate is valid and
GlassFish Server makes sure that the security Principal associated with
the incoming request (provided automatically by Grizzly and the SSL/TLS
Java implementation) matches the Principal associated with the
adminalias from the instance&#8217;s truststore.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="gkoey"></a><a id="GSSCG00231"></a><a id="what-certificates-are-used"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_what_certificates_are_used">What Certificates Are Used?</h4>
<div class="paragraph">
<p>When you enable secure admin, you can optionally set the <code>--adminalias</code>
and <code>--instancealias</code> options that tell secure admin which aliases to
use for the DAS and instance certificates.</p>
</div>
<div class="paragraph">
<p>The DAS uses the alias associated with the <code>--instancealias</code> option to
check incoming requests that use SSL/TLS cert authentication.
Conversely, instances use the alias associated with the <code>--adminalias</code>
option to check incoming requests with certificate authentication.</p>
</div>
<div class="paragraph">
<p>By default, <code>--adminalias</code> of the <code>enable-secure-admin</code> subcommand uses
the <code>s1as</code> alias, and the <code>--instancealias</code> option uses the
<code>glassfish-instance</code> alias, both of which identify the default
self-signed certificates.</p>
</div>
<div class="paragraph">
<p>You can use your tool of choice, such as keytool, to list the default
self-signed certificates in the keystore, similar to the following:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can list the contents of the keystore without supplying a password.
However, for a request that affects the private key, such as the
keytool.exe <code>--certreq</code> option, the keystore password is required. This
is the master password and has a default value of changeit unless you
change it with the <code>change-master-password</code> subcommand.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>keytool.exe -list -keystore keystore.jks</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">Enter keystore password:

*****************  WARNING WARNING WARNING  *****************
* The integrity of the information stored in your keystore  *
* has NOT been verified!  In order to verify its integrity, *
* you must provide your keystore password.                  *
*****************  WARNING WARNING WARNING  *****************

Keystore type: JKS
Keystore provider: SUN

Your keystore contains 2 entries

glassfish-instance, Jan 3, 2011, PrivateKeyEntry,
Certificate fingerprint (MD5): 06:A4:83:84:57:52:9C:2F:E1:FD:08:68:BB:2D:ED:E8
s1as, Jan 3, 2011, PrivateKeyEntry,
Certificate fingerprint (MD5): 8B:7D:5A:4A:32:36:1B:5D:6A:29:66:01:B0:A3:CB:85</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--adminalias</code> and <code>--instancealias</code> values are maintained. Because
of this design, normal instance creation operations (create-instance
over SSH and create-local-instance) apply the up-to-date keystore,
truststore, and configuration to each instance.</p>
</div>
<div class="paragraph">
<p><a id="gkpfi"></a><a id="GSSCG00201"></a><a id="self-signed-certificates-and-trust"></a></p>
</div>
<div class="sect4">
<h5 id="_self_signed_certificates_and_trust">Self-Signed Certificates and Trust</h5>
<div class="paragraph">
<p>The self-signed certificates that GlassFish Server uses might not be
trusted by clients by default because a certificate authority does not
vouch for the authenticity of the certificate. If you enable secure
admin and then contact the DAS using an administration client, that
client will detect whether the certificate is automatically trusted.</p>
</div>
<div class="paragraph">
<p>Browsers will warn you, let you view the certificate, and ask you to
reject the certificate, accept it once, or accept it indefinitely, as
shown in <a href="#gkqpv">Figure 5-1</a>.</p>
</div>
<div class="paragraph">
<p><a id="GSSCG00002"></a><a id="gkqpv"></a></p>
</div>
<div class="paragraph">
<div class="title"><strong>Figure 5-1 Sample Browser Response to Untrusted Certificate</strong></div>
<p><span class="image"><img src="img/accept-certif.png" alt="This screen shot shows how a browser might respond to an untrusted certificate."></span></p>
</div>
<div class="paragraph">
<p>Similarly, the first time <code>asadmin</code> receives an untrusted certificate,
it displays the certificate and lets you accept it or reject it, as
follows: (If you accept it, <code>asadmin</code> also accepts that certificate in
the future. )</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">D:\glassfish6\glassfish\bin&gt;asadmin enable-secure-admin
Command enable-secure-admin executed successfully.


D:\glassfish6\glassfish\bin&gt;asadmin stop-domain domain1
Waiting for the domain to stop .......
Command stop-domain executed successfully.

D:\glassfish6\glassfish\bin&gt;asadmin start-domain domain1
Waiting for domain1 to start ..............................
Successfully started the domain : domain1
domain  Location: D:\glassfish6\glassfish\domains\domain1
Log File: D:\glassfish6\glassfish\domains\domain1\logs\server.log
Admin Port: 4848
Command start-domain executed successfully.

D:\glassfish6\glassfish\bin&gt;asadmin list-domains
[
[
  Version: V3
  Subject: CN=machine.oracle.com, OU=GlassFish, O=Oracle Corporation, L=San
ta Clara, ST=California, C=US
  Signature Algorithm: SHA1withRSA, OID = 1.2.840.113549.1.1.5

  Key:  Sun RSA public key, 1024 bits
  modulus: 916043595073784449632358756374297330881618062298549101072702252458856
74079656358328568800001548507219262910864311924824938195045822088563459253216383
21100660819657204757523896415606833471499564071226722478056407102318862796797465
6245090519956376357288295037519504394674686082145398885236913866246525691704749
  public exponent: 65537
  Validity: [From: Tue Jan 04 14:30:08 EST 2011,
               To: Fri Jan 01 14:30:08 EST 2021]
  Issuer: CN=machine.oracle.com, OU=GlassFish, O=Oracle Corporation, L=Sant
a Clara, ST=California, C=US
  SerialNumber: [    4d237540]

Certificate Extensions: 1
[1]: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: AF 8B 90 1E 51 9A 80 1B   EB A4 D9 C6 01 8A A0 FD  ....Q...........
0010: DE EC 83 8A                                        ....
]
]

]
  Algorithm: [SHA1withRSA]
  Signature:
0000: 3F 2B 30 CE 97 0B 5E F3   72 0E 60 18 8D 3B 04 DC  ?+0...^.r.`..;..
0010: 26 E6 7A 6F D0 19 CC 26   1D 90 C0 DE 33 4E 53 FB  &amp;.zo...&amp;....3NS.
0020: DC E7 AE 78 9E BA EF 14   86 57 36 D4 3E 9B C9 FB  ...x.....W6.&gt;...
0030: C0 B4 EF 72 27 D9 4F 79   1F 89 91 B8 96 26 33 64  ...r'.Oy.....&amp;3d
0040: 9F 4B 04 4B 83 B9 BF 4D   54 B4 8F 75 17 1A 51 BD  .K.K...MT..u..Q.
0050: F3 69 94 CE 90 95 08 55   2C 07 D2 23 AC AE EC 6D  .i.....U,..#...m
0060: 84 B6 3D 00 FB FE 92 50   37 1A 2D 00 F1 21 5C E6  ..=....P7.-..!\.
0070: 1F 39 26 B2 5D C1 FD C8   B1 4F CC EE 26 84 B8 B5  .9&amp;.]....O..&amp;...

]
Do you trust the above certificate [y|N] --&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>asadmin</code> saves certificates you accept in the file <code>.asadmintruststore</code>
in your log-in default directory. You do not generally need to work with
the file directly, but if you delete or move the file, <code>asadmin</code> will
prompt you again when it receives untrusted certificates.</p>
</div>
<div class="paragraph">
<p>Some <code>asadmin</code> commands such as run-script can contact an instance
directly to retrieve information (but not to make configuration
changes). The instances do not use the same certificate as the DAS, so
in these cases <code>asadmin</code> then prompts you to accept or reject the
instance certificate.</p>
</div>
<div class="paragraph">
<p><a id="gkped"></a><a id="GSSCG00202"></a><a id="using-your-own-certificates"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_using_your_own_certificates">Using Your Own Certificates</h5>
<div class="paragraph">
<p>By default, <code>--adminalias</code> of the <code>enable-secure-admin</code> subcommand uses
the <code>s1as</code> alias, and the <code>--instancealias</code> option uses the
<code>glassfish-instance</code> alias, both of which identify the default
self-signed certificates.</p>
</div>
<div class="paragraph">
<p>You can instead have GlassFish Server use your own certificates for this
purpose by first adding your certificates to the keystore and
truststore, and then running <code>enable-secure-admin</code> and specifying the
aliases for your certificates.</p>
</div>
<div class="paragraph">
<p>It is also possible to use <code>s1as</code> and <code>glassfish-instance</code> as the alias
names for your own certificates. A benefit of doing so is that you would
not have to specify alias names with the <code>enable-secure-admin</code>
subcommand.</p>
</div>
<div class="paragraph">
<p>In addition, your own certificate identified by the <code>s1as</code> alias would
be used in all other cases within the domain where the <code>s1as</code> alias is
used (by default), such as in the SSL configuration of the IIOP and
http-listener-2 listeners, and as the <code>encryption.key.alias</code> and
<code>signature.key.alias</code> used for provider configuration in the SOAP
authentication layer for Message Security configuration.</p>
</div>
<div class="paragraph">
<p>You may find the wide-reaching effect of using the <code>s1as</code> alias with
your own certificate to be either a useful feature or an unintended
consequence. Therefore, you should understand the implications of using
the <code>s1as</code> alias before doing so.</p>
</div>
<div class="paragraph">
<p>If you decide to use the <code>s1as</code> and <code>glassfish-instance</code> aliases with
your own certificates, you will first need to disable secure admin (if
enabled) and then change or delete the exiting <code>s1as</code> alias from both
the <code>keystore.jks</code> keystore and <code>cacerts.jks</code> truststore for the DAS.
You can use the <code>--changealias</code> or`--delete` option of <code>keytool</code> to
accomplish this. Then, import your own certificates.</p>
</div>
<div class="paragraph">
<p>When you enable secure admin, the DAS and the instances then have copies
of the same keystore and truststore</p>
</div>
<div class="paragraph">
<p><a id="glgmy"></a><a id="GSSCG00232"></a><a id="an-alternate-approach-using-distinguished-names-to-specify-certificates"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_an_alternate_approach_using_distinguished_names_to_specify_certificates">An Alternate Approach: Using Distinguished Names to Specify Certificates</h4>
<div class="paragraph">
<p>By default, the DAS uses the alias associated with the <code>--instancealias</code>
option to check incoming requests that use SSL/TLS cert authentication.
Conversely, instances use the alias associated with the <code>--adminalias</code>
option to check incoming requests with certificate authentication.</p>
</div>
<div class="paragraph">
<p>The <a href="../reference-manual/enable-secure-admin-principal.html#GSRFM00131"><code>enable-secure-admin-principal</code></a> subcommand
provides an alternate approach. <code>enable-secure-admin-principal</code>
instructs GlassFish Server to accept admin requests when accompanied by
an SSL certificate with the specified distinguished name (DN).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Any certificate you specify with <code>enable-secure-admin-principal</code> must
either be issued by a trusted certificate authority or, if it is
self-signed, must already be in the GlassFish Server truststore.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, assume that you write your own admin client that uses the
REST interface. When your client establishes the connection, it can
choose which certificate to use for its client cert. You would then
specify the DN of this certificate to <code>enable-secure-admin-principal</code>.</p>
</div>
<div class="paragraph">
<p>You must specify either the DN or the <code>--alias</code> option of the
<code>enable-secure-admin-principal</code> subcommand.</p>
</div>
<div class="paragraph">
<p>If you specify the DN, GlassFish Server records the value you specify as
the DN. You specify the DN as a comma-separated list in quotes. For
example,
<code>"CN=system.amer.oracle.com,OU=GlassFish,O=Oracle Corporation,L=Santa Clara,ST=California,C=US"</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>enable-secure-admin-principal</code> subcommand accepts the string you
enter and does not immediately validate it. However, secure admin must
be able to match the DN you specify in order to use it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have sufficient privileges to view the content of the keystore,
you can use keytool to display the DN of a certificate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">keytool.exe -v -list -keystore keystore.jks
Enter keystore password:

Keystore type: JKS
Keystore provider: SUN

Your keystore contains 2 entries

Alias name: glassfish-instance
Creation date: Jul 7, 2011
Entry type: PrivateKeyEntry
Certificate chain length: 1
Certificate[1]:
Owner: CN=systemname.amer.oracle.com-instance, OU=GlassFish,
O=Oracle Corporation, L=Santa Clara, ST=California, C=US
Issuer: CN=systemname.amer.oracle.com-instance, OU=GlassFish, O=Oracle Corporation,
 L=Santa Clara, ST=California, C=US
Serial number: 4e15d6e7
Valid from: Thu Jul 07 11:55:19 EDT 2011 until: Sun Jul 04 11:55:19 EDT 2021
Certificate fingerprints:
         MD5:  05:6E:01:D6:CE:9D:29:DA:55:D9:10:5E:BE:CC:55:05
         SHA1: 2A:6D:A2:52:A5:2B:ED:DE:CD:B4:76:4A:65:9D:B5:79:A6:EA:3C:10
         Signature algorithm name: SHA1withRSA
         Version: 3

Extensions:

#1: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 96 99 36 B6 CF 60 1E 8A   AE 25 75 4E C8 34 AA AB  ..6..`...%uN.4..
0010: E1 3B CF 03                                        .;..
]
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use the "<code>--alias</code> aliasname" form, then GlassFish Server looks
in its truststore for a certificate with the specified alias and uses
the DN associated with that certificate. alias-name must be an alias
associated with a certificate currently in the truststore. Therefore,
you may find it most useful for self-signed certificates for which you
know the alias.</p>
</div>
<div class="paragraph">
<p>If you have sufficient privileges to view the contents of the
truststore, you can use keytool to display the alias of a certificate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">keytool.exe -v -list -keystore cacerts.jks
Enter keystore password:
:
:
Alias name: glassfish-instance
Creation date: Jul 7, 2011
Entry type: trustedCertEntry

Owner: CN=systemname.amer.oracle.com-instance, OU=GlassFish, O=Oracle Corporation,
L=Santa Clara, ST=California, C=US
Issuer: CN=systemname.amer.oracle.com-instance, OU=GlassFish, O=Oracle Corporation,
 L=Santa Clara, ST=California, C=US
Serial number: 4e15d6e7
Valid from: Thu Jul 07 11:55:19 EDT 2011 until: Sun Jul 04 11:55:19 EDT 2021
Certificate fingerprints:
         MD5:  05:6E:01:D6:CE:9D:29:DA:55:D9:10:5E:BE:CC:55:05
         SHA1: 2A:6D:A2:52:A5:2B:ED:DE:CD:B4:76:4A:65:9D:B5:79:A6:EA:3C:10
         Signature algorithm name: SHA1withRSA
         Version: 3

Extensions:

#1: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 96 99 36 B6 CF 60 1E 8A   AE 25 75 4E C8 34 AA AB  ..6..`...%uN.4..
0010: E1 3B CF 03                                        .;..
]
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run <code>enable-secure-admin</code>, GlassFish Server automatically
records the DNs for the admin alias and the instance alias, whether you
specify those values or use the defaults. You do not need to run
<code>enable-secure-admin-principal</code> yourself for those certificates.</p>
</div>
<div class="paragraph">
<p>Other than these certificates, you must run
<code>enable-secure-admin-principal</code> for any other DN that GlassFish Server
should authorize to send admin requests. This includes DNs corresponding
to trusted certificates (those with a certificate chain to a trusted
authority.)</p>
</div>
<div class="paragraph">
<p>You can run <code>enable-secure-admin-principal</code> multiple times so that
GlassFish Server accepts admin requests from a client sending a
certificate with any of the DNs you specify.</p>
</div>
<div class="paragraph">
<p>The following example shows how to specify a DN for authorizing access
in secure administration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asadmin&gt; enable-secure-admin-principal
"CN=system.amer.oracle.com,OU=GlassFish,
O=Oracle Corporation,L=Santa Clara,ST=California,C=US"

Command enable-secure-admin-principal executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the <a href="../reference-manual/disable-secure-admin-principal.html#GSRFM00123"><code>disable-secure-admin-principal</code></a>
subcommand to disable a specific certificate for authenticating and
authorizing access in secure admin. You must specify either the DN or
the <code>--alias</code> option of the <code>disable-secure-admin-principal</code> subcommand.
To disable multiple certificates for authenticating and authorizing
access in secure admin, run the <code>disable-secure-admin-principal</code>
subcommand multiple times.</p>
</div>
<div class="paragraph">
<p>You can use the <a href="../reference-manual/list-secure-admin-principals.html#GSRFM00200"><code>list-secure-admin-principals</code></a>
subcommand to list the certificates for which GlassFish Server accepts
admin requests from clients.</p>
</div>
<div class="paragraph">
<p><a id="gkqjj"></a><a id="GSSCG00233"></a><a id="guarding-against-unwanted-connections"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_guarding_against_unwanted_connections">Guarding Against Unwanted Connections</h4>
<div class="paragraph">
<p>Secure admin guards against unwanted connections in several ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DAS-to-DAS, instance-to-instance:</p>
<div class="ulist">
<ul>
<li>
<p>The DAS and the instances have copies of the same truststore, which
contains the public certificate of the DAS and the separate public
certificate that is used by all instances. In addition, GlassFish Server
includes a unique, generated "domain ID" that servers use to ensure that
admin requests from other GlassFish Servers originate from the correct
domain.</p>
</li>
<li>
<p>DAS-to-other-DAS communication is not authenticated because each
different DAS will have its own self-signed certificate that is not in
the truststore of the other DAS.</p>
</li>
<li>
<p>DAS-to-itself communication is unlikely unless you were to
misconfigure the admin listener port for an instance on the same host so
it is the same as for the DAS. Similarly, instance-to-instance traffic
is unlikely unless you were to misconfigure listener ports for instances
on the same host.<br>
To prevent both of these situations, both cases are handled by making
sure that the connecting Principal (alias) is not the running Principal.
secure admin ensures that if the client has authenticated using SSL/TLS
client authentication that the Principal associated with the remote
client is not the same as the current process. That is, the DAS makes
sure that the Principal is not itself. Similarly, each instance ensures
that the client is not an instance. (The instances share the same
self-signed certificate and therefore are mapped to the same Principal.)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Remote client-to-instance:<br>
Remote <code>asadmin</code> clients are unable to connect directly to instances. If
the user on host "test1" runs a local command but specifies a remote
instance on host "test2," <code>asadmin</code> on test1 will read and send that
locally-provisioned password. The instance on "test2" will have a
different locally-provisioned password and so the authentication attempt
will fail.<br>
Therefore, a user on "test1" will not be able to run a remote command
targeting an instance on "test2."</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="gkofe"></a><a id="GSSCG00164"></a><a id="considerations-when-running-glassfish-server-with-default-security"></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_considerations_when_running_glassfish_server_with_default_security">Considerations When Running GlassFish Server With Default Security</h3>
<div class="paragraph">
<p>In GlassFish Server, the default admin account is username "admin" with
an empty password. Admin clients provide empty credentials or none at
all, and all are authenticated and authorized as that default admin
user. None of the participants (clients, DAS, or instances) encrypts
network messages.</p>
</div>
<div class="paragraph">
<p>If this level of security is acceptable in your environment, no changes
are needed and you do not need to enable secure administration. Imposing
a heightened level of security is optional.</p>
</div>
<div class="paragraph">
<p>However, consider <a href="#gkode">Table 5-2</a>, which shows which operations
are accepted and rejected when secure admin is disabled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When secure admin is disabled, GlassFish Server does allow remote
monitoring (read-only) access via the REST interface.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="sthref37"></a><a id="gkode"></a></p>
</div>
<div class="paragraph">
<p>Table 5-2 Accepted and Rejected Operations if Secure Admin is Disabled</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 25%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operation</th>
<th class="tableblock halign-left valign-top">Run From Same System as DAS</th>
<th class="tableblock halign-left valign-top">Run From Remote System</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>start-local-instance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Functions as expected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cannot sync with DAS.
The instance starts but cannot communicate with the DAS. DAS will not
see the instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any other <code>asadmin</code> subcommand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Functions as expected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rejected. A user
sees the username/password prompt, but even correct entries are
rejected.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commands that use SSH. For example, <code>create-instance</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Functions as
expected; requires prior SSH configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Functions as expected;
requires prior SSH configuration.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="gkomz"></a><a id="GSSCG00165"></a><a id="running-secure-admin"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_running_secure_admin">Running Secure Admin</h3>
<div class="paragraph">
<p>This section describes how to run secure admin. The section begins with
prerequisites for running secure admin.</p>
</div>
<div class="paragraph">
<p><a id="gkokc"></a><a id="GSSCG00234"></a><a id="prerequisites-for-running-secure-admin"></a></p>
</div>
<div class="sect3">
<h4 id="_prerequisites_for_running_secure_admin">Prerequisites for Running Secure Admin</h4>
<div class="paragraph">
<p>Before running GlassFish Server with secure admin enabled, you must make
sure that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The DAS is installed, initialized, and running.</p>
</li>
<li>
<p>If one or more remote instances are installed and initialized, they
must not be running.</p>
</li>
<li>
<p>Any administration clients you require are installed.</p>
</li>
<li>
<p>The DAS communicates on the <code>-—adminport</code> you configure when you
create the domain, and defaults to 4848. An instance communicates on the
<code>ASADMIN_LISTENER_PORT</code> system property you specify for the instance.</p>
</li>
<li>
<p>The user name and password sent by remote administration clients
(<code>asadmin</code>, administration console, browsers, and IDEs) must exist in
the realm and be in the admin group.</p>
</li>
<li>
<p>The keystore and truststore for the domain exist. (They are created
by default when you create the domain or install GlassFish Server.)<br>
If you are not using the default self-signed certificates, you must add
your own valid certificates and CA root in the keystore and truststore,
respectively.</p>
</li>
<li>
<p>If you are not using the default self-signed certificates, create
two aliases corresponding to certificates in the keystore and
truststore: one that the DAS will use for authenticating itself in
administration traffic, and one that the instances will use for
authenticating itself in administration traffic.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="glgmh"></a><a id="GSSCG00235"></a><a id="an-alternate-approach-using-a-user-name-and-password-for-internal-authentication-and-authorization"></a></p>
</div>
<div class="paragraph">
<p>An Alternate Approach: Using A User Name and Password for Internal
Authentication and Authorization
<sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup><sup>^</sup></p>
</div>
<div class="paragraph">
<p>By default, secure admin uses the GlassFish Server self-signed
certificates, via the aliases corresponding to these certificates, to
authenticate the DAS and instances with each other and to authorize
secure admin operations. Specifically, the DAS uses the (<code>s1as</code>) alias
for authenticating itself and authorizing access in administration
traffic, and instances use the (<code>glassfish-instance</code>) alias for
authenticating themselves and authorizing access in secure admin
traffic.</p>
</div>
<div class="paragraph">
<p>As described in <a href="#gkped">Using Your Own Certificates</a>, you can
instead use your own certificates and their associated aliases for
authenticating and authorizing the DAS and instances in administration
traffic.</p>
</div>
<div class="paragraph">
<p>As an alternative to this certificate-based authentication and
authorization, you can instead use the
<a href="../reference-manual/enable-secure-admin-internal-user.html#GSRFM00130"><code>enable-secure-admin-internal-user</code></a> subcommand to
instruct all servers in the domain to authenticate to each other, and to
authorize admin operations submitted to each other, using an existing
admin user name and password rather than SSL certificates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If secure admin is enabled, all GlassFish Server processes continue to
use SSL encryption to secure the content of the admin messages,
regardless of how they authenticate to each other.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You might want to use the
<a href="../reference-manual/enable-secure-admin-internal-user.html#GSRFM00130"><code>enable-secure-admin-internal-user</code></a> subcommand if your
use case favors the use of a user name and password combination over the
use of SSL certificates and aliases.</p>
</div>
<div class="paragraph">
<p>This generally means that you must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a valid admin user.<br></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>asadmin&gt; create-file-user --authrealmname admin-realm --groups
asadmin newAdminUsername</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a password alias for the just-created password.<br></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>asadmin&gt; create-password-alias passwordAliasName</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use that user name and password for inter-process authentication and
admin authorization.<br></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>asadmin&gt; enable-secure-admin-internal-user
--passwordalias passwordAliasName
newAdminUsername</pre>
</div>
</div>
<div class="paragraph">
<p>The following example allows secure admin to use a user name and
password alias for authentication and authorization between the DAS and
instances, instead of certificates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asadmin&gt; enable-secure-admin-internal-user
--passwordalias passwordAliasName
newAdminUsername</code></pre>
</div>
</div>
<div class="paragraph">
<p>If GlassFish Server finds at least one secure admin internal user, then
if secure admin is enabled GlassFish Server processes will not use SSL
authentication and authorization with each other and will instead use
user name password pairs.</p>
</div>
<div class="paragraph">
<p>Most users who use this subcommand will need to set up only one secure
admin internal user. If you set up more than one secure admin internal
user, you should not make any assumptions about which user name and
password pair GlassFish Server will choose to use for any given admin
request.</p>
</div>
<div class="paragraph">
<p>As a general practice, you should not use the same user name and
password pair for internal admin communication and for admin user login.
That is, create at least one admin account specifically for internal
admin communication.</p>
</div>
<div class="paragraph">
<p>You can use the <a href="../reference-manual/disable-secure-admin-internal-user.html#GSRFM00122"><code>disable-secure-admin-internal-user</code></a>
subcommand to disable secure admin from using the user name (instead of
SSL certificates) to authenticate the DAS and instances with each other
and to authorize admin operations. To disable multiple user names for
authenticating and authorizing access in secure admin, run the
<code>disable-secure-admin-internal-user</code> subcommand multiple times.</p>
</div>
<div class="paragraph">
<p>You can use the <a href="../reference-manual/list-secure-admin-internal-users.html#GSRFM00199"><code>list-secure-admin-internal-users</code></a>
subcommand to list the user names for which GlassFish Server
authenticate the DAS and instances with each other and authorizes admin
operations.</p>
</div>
<div class="paragraph">
<p><a id="gkqby"></a><a id="GSSCG00236"></a><a id="example-of-running-enable-secure-admin"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_example_of_running_enable_secure_admin">Example of Running enable-secure-admin</h4>
<div class="paragraph">
<p>The following example shows how to enable secure admin for a domain
using the default admin alias and the default instance alias. You must
restart the DAS immediately after enabling secure admin.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The only indicator that secure admin is enabled is the successful status
from the <code>enable-secure-admin</code> subcommand. When secure admin is running,
the DAS and instances do not report the secure admin status.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>asadmin&gt;</code> <code>enable-secure-admin</code></p>
</div>
<div class="paragraph">
<p><code>Command enable-secure-admin executed successfully.</code></p>
</div>
<div class="paragraph">
<p>The following example shows how to enable secure admin for a domain
using an admin alias adtest and an instance alias intest. You can also
use this command to modify an existing secure admin configuration to use
different aliases.</p>
</div>
<div class="paragraph">
<p><code>asadmin&gt;</code>
<code>enable-secure-admin --adminalias adtest --instancealias intest</code></p>
</div>
<div class="paragraph">
<p>The following example shows how to disable secure admin:</p>
</div>
<div class="paragraph">
<p><code>asadmin&gt;</code> <code>disable-secure-admin</code></p>
</div>
<div class="paragraph">
<p><code>Command disable-secure-admin executed successfully.</code></p>
</div>
<div class="paragraph">
<p>You can use the following command to see the current state of secure
admin in a domain:</p>
</div>
<div class="paragraph">
<p><code>asadmin&gt;</code> <code>get secure-admin.enabled</code></p>
</div>
<div class="paragraph">
<p><code>secure-admin.enabled=false</code></p>
</div>
<div class="paragraph">
<p><code>Command get executed successfully.</code></p>
</div>
<div class="paragraph">
<p><a id="gkolu"></a><a id="GSSCG00166"></a><a id="additional-considerations-when-creating-local-instances"></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_considerations_when_creating_local_instances">Additional Considerations When Creating Local Instances</h3>
<div class="paragraph">
<p>If you use <code>xxx-local-instance</code> commands to set up local instances,
either leave secure admin disabled, or enable it before you create or
start the instances and leave it that way.</p>
</div>
<div class="paragraph">
<p>However, if you use <code>xxx-instance</code> commands over SSH to manage remote
instances, you can enable and disable secure admin, although this is not
recommended because it can result in an inconsistent security model.</p>
</div>
<div class="paragraph">
<p><a id="gkqah"></a><a id="GSSCG00167"></a><a id="secure-admin-use-case"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_secure_admin_use_case">Secure Admin Use Case</h3>
<div class="paragraph">
<p>This section describes a simple secure admin use case.</p>
</div>
<div class="paragraph">
<p>In the
<code>asadmin --secure=false --user me --passwordfile myFile.txt cmd ...</code> use
case, the user submits a command with <code>--secure</code> set to false, and
supplies password credentials.</p>
</div>
<div class="paragraph">
<p>The important concept to note is that <code>asadmin</code> uses HTTPS because of
the DAS redirection, even though the command sets <code>--secure</code> to false.
<code>asadmin</code> sends the HTTP Authorization header along with the redirected
request.</p>
</div>
<div class="paragraph">
<p>In addition to the flow described here, certificate authentication is
also performed as described in <a href="#gkqax">Table 5-3</a>. Also, the
credentials that the user supplies are assumed to be valid administrator
credentials for the DAS.</p>
</div>
<div class="paragraph">
<p><a id="sthref38"></a><a id="gkqax"></a></p>
</div>
<div class="paragraph">
<p>Table 5-3 asadmin --secure=false, With Username and Password</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">asadmin</th>
<th class="tableblock halign-left valign-top">Grizzly</th>
<th class="tableblock halign-left valign-top">AdminAdapter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sends HTTP request, no authorization header (because the transport is
not secure).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 3xx status and redirects HTTP to HTTPS.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Follows redirection, this time adding the Authorization header (because
transport is now HTTPS).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authenticates admin user and password from HTTP Authorization
header in the realm Executes command, and responds with success status.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="gkodn"></a><a id="GSSCG00168"></a><a id="upgrading-an-ssl-enabled-secure-glassfish-installation-to-secure-admin"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_upgrading_an_ssl_enabled_secure_glassfish_installation_to_secure_admin">Upgrading an SSL-Enabled Secure GlassFish Installation to Secure Admin</h3>
<div class="paragraph">
<p>If you enable secure admin on an SSL-enabled GlassFish Server
installation, secure admin uses the existing &lt;ssl cert-nickname&gt; value
as the DAS adminalias for secure admin.</p>
</div>
</div>
</div>
</div>

<hr />

<table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
	<colgroup>
		<col width="12%"/>
		<col width="12%"/>
		<col width="*"/>
	</colgroup>
	<tr>		
		<td align="left">
		<a href="security-in-cluster-mode.html">
			<span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Previous</span>
		</a>
		</td>

		<td align="left">
		<a href="running-in-secure-environment.html">
			<span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Next</span>
		</a>
		</td>

		<td align="right">
		<a href="toc.html">
			<span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Contents</span>
		</a>
		</td>
	</tr>
</table>

<span id="copyright">
        <img src="img/eclipse_foundation_logo_tiny.png" height="20px" alt="Eclipse Foundation Logo" align="top"/>&nbsp;            
        <span >Copyright&nbsp;&copy;&nbsp;2019,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.</span>
</span>

<p align="center" class="beta">DRAFT</p>

</body>
</html>