<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Eclipse GlassFish Performance Tuning Guide, Release 7</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Eclipse GlassFish Performance Tuning Guide, Release 7</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#eclipse-glassfish-server">Eclipse GlassFish</a></li>
<li><a href="#preface">Preface</a>
<ul class="sectlevel2">
<li><a href="#oracle-glassfish-server-documentation-set">Eclipse GlassFish Documentation Set</a></li>
<li><a href="#typographic-conventions">Typographic Conventions</a></li>
<li><a href="#symbol-conventions">Symbol Conventions</a></li>
<li><a href="#default-paths-and-file-names">Default Paths and File Names</a></li>
</ul>
</li>
<li><a href="#overview-of-glassfish-server-performance-tuning">1 Overview of Eclipse GlassFish Performance Tuning</a>
<ul class="sectlevel2">
<li><a href="#process-overview">Process Overview</a>
<ul class="sectlevel3">
<li><a href="#performance-tuning-sequence">Performance Tuning Sequence</a></li>
</ul>
</li>
<li><a href="#understanding-operational-requirements">Understanding Operational Requirements</a>
<ul class="sectlevel3">
<li><a href="#application-architecture">Application Architecture</a></li>
<li><a href="#security-requirements">Security Requirements</a></li>
<li><a href="#high-availability-clustering-load-balancing-and-failover">High Availability Clustering, Load Balancing, and Failover</a></li>
<li><a href="#hardware-resources">Hardware Resources</a></li>
<li><a href="#administration">Administration</a></li>
</ul>
</li>
<li><a href="#general-tuning-concepts">General Tuning Concepts</a>
<ul class="sectlevel3">
<li><a href="#capacity-planning">Capacity Planning</a></li>
<li><a href="#user-expectations">User Expectations</a></li>
</ul>
</li>
<li><a href="#overview-further-information">Further Information</a></li>
</ul>
</li>
<li><a href="#tuning-your-application">2 Tuning Your Application</a>
<ul class="sectlevel2">
<li><a href="#java-programming-guidelines">Java Programming Guidelines</a>
<ul class="sectlevel3">
<li><a href="#avoid-serialization-and-deserialization">Avoid Serialization and Deserialization</a></li>
<li><a href="#use-stringbuilder-to-concatenate-strings">Use <code>StringBuilder</code> to Concatenate Strings</a></li>
<li><a href="#assign-null-to-variables-that-are-no-longer-needed">Assign null to Variables That Are No Longer Needed</a></li>
<li><a href="#declare-methods-as-final-only-if-necessary">Declare Methods as final Only If Necessary</a></li>
<li><a href="#declare-constants-as-static-final">Declare Constants as static final</a></li>
<li><a href="#avoid-finalizers">Avoid Finalizers</a></li>
<li><a href="#declare-method-arguments-final">Declare Method Arguments final</a></li>
<li><a href="#synchronize-only-when-necessary">Synchronize Only When Necessary</a></li>
<li><a href="#use-datahandlers-for-soap-attachments">Use DataHandlers for SOAP Attachments</a></li>
</ul>
</li>
<li><a href="#java-server-page-and-servlet-tuning">Java Server Page and Servlet Tuning</a>
<ul class="sectlevel3">
<li><a href="#suggested-coding-practices">Suggested Coding Practices</a></li>
</ul>
</li>
<li><a href="#ejb-performance-tuning">EJB Performance Tuning</a>
<ul class="sectlevel3">
<li><a href="#goals">Goals</a></li>
<li><a href="#monitoring-ejb-components">Monitoring EJB Components</a></li>
<li><a href="#general-guidelines-1">General Guidelines</a></li>
<li><a href="#using-local-and-remote-interfaces">Using Local and Remote Interfaces</a></li>
<li><a href="#improving-performance-of-ejb-transactions">Improving Performance of EJB Transactions</a></li>
<li><a href="#using-special-techniques">Using Special Techniques</a></li>
<li><a href="#tuning-tips-for-specific-types-of-ejb-components">Tuning Tips for Specific Types of EJB Components</a></li>
<li><a href="#jdbc-and-database-access">JDBC and Database Access</a></li>
<li><a href="#tuning-message-driven-beans">Tuning Message-Driven Beans</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#tuning-the-glassfish-server">3 Tuning the Eclipse GlassFish</a>
<ul class="sectlevel2">
<li><a href="#using-the-glassfish-server-performance-tuner">Using the Eclipse GlassFish Performance Tuner</a></li>
<li><a href="#deployment-settings">Deployment Settings</a>
<ul class="sectlevel3">
<li><a href="#disable-auto-deployment">Disable Auto-Deployment</a></li>
<li><a href="#use-pre-compiled-javaserver-pages">Use Pre-compiled JavaServer Pages</a></li>
<li><a href="#disable-dynamic-application-reloading">Disable Dynamic Application Reloading</a></li>
</ul>
</li>
<li><a href="#logger-settings">Logger Settings</a>
<ul class="sectlevel3">
<li><a href="#general-settings">General Settings</a></li>
<li><a href="#log-levels">Log Levels</a></li>
</ul>
</li>
<li><a href="#web-container-settings">Web Container Settings</a>
<ul class="sectlevel3">
<li><a href="#session-properties-session-timeout">Session Properties: Session Timeout</a></li>
<li><a href="#manager-properties-reap-interval">Manager Properties: Reap Interval</a></li>
<li><a href="#disable-dynamic-jsp-reloading">Disable Dynamic JSP Reloading</a></li>
</ul>
</li>
<li><a href="#ejb-container-settings">EJB Container Settings</a>
<ul class="sectlevel3">
<li><a href="#monitoring-the-ejb-container">Monitoring the EJB Container</a></li>
<li><a href="#tuning-the-ejb-container">Tuning the EJB Container</a></li>
</ul>
</li>
<li><a href="#java-message-service-settings">Java Message Service Settings</a></li>
<li><a href="#transaction-service-settings">Transaction Service Settings</a>
<ul class="sectlevel3">
<li><a href="#monitoring-the-transaction-service">Monitoring the Transaction Service</a></li>
<li><a href="#tuning-the-transaction-service">Tuning the Transaction Service</a></li>
</ul>
</li>
<li><a href="#http-service-settings">HTTP Service Settings</a>
<ul class="sectlevel3">
<li><a href="#monitoring-the-http-service">Monitoring the HTTP Service</a></li>
<li><a href="#http-service-access-logging">HTTP Service Access Logging</a></li>
</ul>
</li>
<li><a href="#network-listener-settings">Network Listener Settings</a>
<ul class="sectlevel3">
<li><a href="#general-settings-1">General Settings</a></li>
<li><a href="#http-settings">HTTP Settings</a></li>
<li><a href="#file-cache-settings">File Cache Settings</a></li>
</ul>
</li>
<li><a href="#transport-settings">Transport Settings</a></li>
<li><a href="#thread-pool-settings">Thread Pool Settings</a>
<ul class="sectlevel3">
<li><a href="#max-thread-pool-size">Max Thread Pool Size</a></li>
<li><a href="#min-thread-pool-size">Min Thread Pool Size</a></li>
</ul>
</li>
<li><a href="#orb-settings">ORB Settings</a>
<ul class="sectlevel3">
<li><a href="#overview">Overview</a></li>
<li><a href="#how-a-client-connects-to-the-orb">How a Client Connects to the ORB</a></li>
<li><a href="#monitoring-the-orb">Monitoring the ORB</a></li>
<li><a href="#tuning-the-orb">Tuning the ORB</a></li>
</ul>
</li>
<li><a href="#resource-settings">Resource Settings</a>
<ul class="sectlevel3">
<li><a href="#jdbc-connection-pool-settings">JDBC Connection Pool Settings</a></li>
<li><a href="#connector-connection-pool-settings">Connector Connection Pool Settings</a></li>
</ul>
</li>
<li><a href="#load-balancer-settings">Load Balancer Settings</a></li>
</ul>
</li>
<li><a href="#tuning-the-java-runtime-system">4 Tuning the Java Runtime System</a>
<ul class="sectlevel2">
<li><a href="#java-virtual-machine-settings">Java Virtual Machine Settings</a></li>
<li><a href="#tuning-high-availability-persistence">Tuning High Availability Persistence</a></li>
<li><a href="#managing-memory-and-garbage-collection">Managing Memory and Garbage Collection</a>
<ul class="sectlevel3">
<li><a href="#tuning-the-garbage-collector">Tuning the Garbage Collector</a></li>
<li><a href="#tracing-garbage-collection">Tracing Garbage Collection</a></li>
<li><a href="#other-garbage-collector-settings">Other Garbage Collector Settings</a></li>
<li><a href="#tuning-the-java-heap">Tuning the Java Heap</a></li>
<li><a href="#rebasing-dlls-on-windows">Rebasing DLLs on Windows</a></li>
</ul>
</li>
<li><a href="#further-information">Further Information</a></li>
</ul>
</li>
<li><a href="#tuning-the-operating-system-and-platform">5 Tuning the Operating System and Platform</a>
<ul class="sectlevel2">
<li><a href="#server-scaling">Server Scaling</a>
<ul class="sectlevel3">
<li><a href="#processors">Processors</a></li>
<li><a href="#memory">Memory</a></li>
<li><a href="#disk-space">Disk Space</a></li>
<li><a href="#networking">Networking</a></li>
<li><a href="#udp-buffer-sizes">UDP Buffer Sizes</a></li>
</ul>
</li>
<li><a href="#solaris-10-platform-specific-tuning-information">Solaris 10 Platform-Specific Tuning Information</a></li>
<li><a href="#tuning-for-the-solaris-os">Tuning for the Solaris OS</a>
<ul class="sectlevel3">
<li><a href="#tuning-parameters">Tuning Parameters</a></li>
<li><a href="#file-descriptor-setting">File Descriptor Setting</a></li>
</ul>
</li>
<li><a href="#tuning-for-solaris-on-x86">Tuning for Solaris on x86</a>
<ul class="sectlevel3">
<li><a href="#file-descriptors">File Descriptors</a></li>
<li><a href="#ip-stack-settings">IP Stack Settings</a></li>
</ul>
</li>
<li><a href="#tuning-for-linux-platforms">Tuning for Linux platforms</a>
<ul class="sectlevel3">
<li><a href="#startup-files">Startup Files</a></li>
<li><a href="#file-descriptors-1">File Descriptors</a></li>
<li><a href="#virtual-memory">Virtual Memory</a></li>
<li><a href="#network-interface">Network Interface</a></li>
<li><a href="#disk-io-settings">Disk I/O Settings</a></li>
<li><a href="#tcpip-settings">TCP/IP Settings</a></li>
</ul>
</li>
<li><a href="#tuning-ultrasparc-cmt-based-systems">Tuning UltraSPARC CMT-Based Systems</a>
<ul class="sectlevel3">
<li><a href="#tuning-operating-system-and-tcp-settings">Tuning Operating System and TCP Settings</a></li>
<li><a href="#disk-configuration">Disk Configuration</a></li>
<li><a href="#network-configuration">Network Configuration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="eclipse-glassfish-server"><a class="anchor" href="#eclipse-glassfish-server"></a>Eclipse GlassFish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Performance Tuning Guide</p>
</div>
<div class="paragraph">
<p>Release 7</p>
</div>
<div class="paragraph">
<p>Contributed 2018 - 2024</p>
</div>
<div class="paragraph">
<p>This book describes how to get the best performance with Eclipse GlassFish 7.</p>
</div>
<hr>
<div class="paragraph">
<p>Eclipse GlassFish Performance Tuning Guide, Release 7</p>
</div>
<div class="paragraph">
<p>Copyright Â© 2013, 2019 Oracle and/or its affiliates. All rights reserved.</p>
</div>
<div class="paragraph">
<p>This program and the accompanying materials are made available under the
terms of the Eclipse Public License v. 2.0, which is available at
<a href="http://www.eclipse.org/legal/epl-2.0" class="bare">http://www.eclipse.org/legal/epl-2.0</a>.</p>
</div>
<div class="paragraph">
<p>SPDX-License-Identifier: EPL-2.0</p>
</div>
<div class="paragraph">
<p>Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.</p>
</div>
<div class="paragraph">
<p>Intel and Intel Xeon are trademarks or registered trademarks of Intel
Corporation. All SPARC trademarks are used under license and are
trademarks or registered trademarks of SPARC International, Inc. AMD,
Opteron, the AMD logo, and the AMD Opteron logo are trademarks or
registered trademarks of Advanced Micro Devices. UNIX is a registered
trademark of The Open Group.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="data:image/png;base64,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" alt="Eclipse Logo"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preface"><a class="anchor" href="#preface"></a>Preface</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This documentation is part of the Java Enterprise Edition contribution
to the Eclipse Foundation and is not intended for use in relation to
Java Enterprise Edition or Orace GlassFish. The documentation is in the
process of being revised to reflect the new Jakarta EE branding.
Additional changes will be made as requirements and procedures evolve
for Jakarta EE. Where applicable, references to Jakarta EE or Java
Enterprise Edition should be considered references to Jakarta EE.</p>
</div>
<div class="paragraph">
<p>Please see the Title page for additional license information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Performance Tuning Guide describes how to get the best performance
with Eclipse GlassFish 7.</p>
</div>
<div class="paragraph">
<p>This preface contains information about and conventions for the entire
Eclipse GlassFish (Eclipse GlassFish) documentation set.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish 7 is developed through the GlassFish project
open-source community at <code><a href="http://glassfish.java.net/" class="bare">http://glassfish.java.net/</a></code>. The GlassFish
project provides a structured process for developing the Eclipse GlassFish platform that makes the new features of the Jakarta EE platform
available faster, while maintaining the most important feature of Java
EE: compatibility. It enables Java developers to access the Eclipse GlassFish source code and to contribute to the development of the Eclipse GlassFish. The GlassFish project is designed to encourage communication
between Oracle engineers and the community.</p>
</div>
<div class="sect2">
<h3 id="oracle-glassfish-server-documentation-set"><a class="anchor" href="#oracle-glassfish-server-documentation-set"></a>Eclipse GlassFish Documentation Set</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Book Title</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="release-notes.html#GSRLN">Release Notes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides late-breaking information about
the software and the documentation and includes a comprehensive,
table-based summary of the supported hardware, operating system, Java
Development Kit (JDK), and database drivers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="quick-start-guide.html#GSQSG">Quick Start Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to get started with the
Eclipse GlassFish product.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="installation-guide.html#GSING">Installation Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to install the software
and its components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="upgrade-guide.html#GSUPG">Upgrade Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to upgrade to the latest
version of Eclipse GlassFish. This guide also describes differences
between adjacent product releases and configuration options that can
result in incompatibility with the product specifications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="deployment-planning-guide.html#GSPLG">Deployment Planning Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to build a
production deployment of Eclipse GlassFish that meets the requirements of
your system and enterprise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="administration-guide.html#GSADG">Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to configure, monitor,
and manage Eclipse GlassFish subsystems and components from the command
line by using the <a href="reference-manual.html#asadmin"><code>asadmin</code></a> utility. Instructions for
performing these tasks from the Administration Console are provided in
the Administration Console online help.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="security-guide.html#GSSCG">Security Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides instructions for configuring and
administering Eclipse GlassFish security.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="application-deployment-guide.html#GSDPG">Application Deployment Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to assemble and
deploy applications to the Eclipse GlassFish and provides information
about deployment descriptors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="application-development-guide.html#GSDVG">Application Development Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to create and
implement Java Platform, Enterprise Edition (Jakarta EE platform)
applications that are intended to run on the Eclipse GlassFish. These
applications follow the open Java standards model for Jakarta EE components
and application programmer interfaces (APIs). This guide provides
information about developer tools, security, and debugging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="embedded-server-guide.html#GSESG">Embedded Server Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to run applications in
embedded Eclipse GlassFish and to develop applications in which Eclipse GlassFish is embedded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="ha-administration-guide.html#GSHAG">High Availability Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to
configure Eclipse GlassFish to provide higher availability and
scalability through failover and load balancing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="performance-tuning-guide.html#GSPTG">Performance Tuning Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to optimize the
performance of Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="troubleshooting-guide.html#GSTSG">Troubleshooting Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes common problems that you
might encounter when using Eclipse GlassFish and explains how to solve
them.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="error-messages-reference.html#GSEMR">Error Message Reference</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes error messages that you
might encounter when using Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="reference-manual.html#GSRFM">Reference Manual</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides reference information in man
page format for Eclipse GlassFish administration commands, utility
commands, and related concepts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-release-notes/toc.html">Message Queue Release Notes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes new features,
compatibility issues, and existing bugs for Open Message Queue.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-tech-over/toc.html">Message Queue Technical Overview</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides an introduction
to the technology, concepts, architecture, capabilities, and features of
the Message Queue messaging service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html">Message Queue Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to set up
and manage a Message Queue messaging system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-jmx/toc.html">Message Queue Developer&#8217;s Guide for JMX Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes
the application programming interface in Message Queue for
programmatically configuring and monitoring Message Queue resources in
conformance with the Java Management Extensions (JMX).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-java/toc.html">Message Queue Developer&#8217;s Guide for Java Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides
information about concepts and procedures for developing Java messaging
applications (Java clients) that work with Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-c/toc.html">Message Queue Developer&#8217;s Guide for C Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides
programming and reference information for developers working with
Message Queue who want to use the C language binding to the Message
Queue messaging service to send, receive, and process Message Queue
messages.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="typographic-conventions"><a class="anchor" href="#typographic-conventions"></a>Typographic Conventions</h3>
<div class="paragraph">
<p>The following table describes the typographic changes that are used in
this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 37%;">
<col style="width: 49%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Typeface</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AaBbCc123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The names of commands, files, and directories, and onscreen computer output</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Edit your <code>.login</code> file.</p>
</div>
<div class="paragraph">
<p>Use <code>ls</code> <code>a</code> to list all files.</p>
</div>
<div class="paragraph">
<p><code>machine_name% you have mail.</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AaBbCc123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What you type, contrasted with onscreen computer output</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>machine_name%</code> <code>su</code></p>
</div>
<div class="paragraph">
<p><code>Password:</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AaBbCc123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A placeholder to be replaced with a real name or value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The command to remove a file is <code>rm</code> filename.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AaBbCc123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Book titles, new terms, and terms to be emphasized
(note that some emphasized items appear bold online)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Read Chapter 6 in the User&#8217;s Guide.</p>
</div>
<div class="paragraph">
<p>A cache is a copy that is stored locally.</p>
</div>
<div class="paragraph">
<p>Do not save the file.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="symbol-conventions"><a class="anchor" href="#symbol-conventions"></a>Symbol Conventions</h3>
<div class="paragraph">
<p>The following table explains symbols that might be used in this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 26%;">
<col style="width: 28%;">
<col style="width: 36%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbol</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains optional arguments and command options.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ls [-l]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>-l</code> option is not required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{ | }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains a set of choices for a required command option.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-d {y|n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>-d</code> option requires that you use either the <code>y</code>
argument or the <code>n</code> argument.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${ }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a variable reference.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${com.sun.javaRoot}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the value of the <code>com.sun.javaRoot</code> variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joins simultaneous multiple keystrokes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control-A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Press the Control key while you press the A key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joins consecutive multiple keystrokes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ctrl+A+N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Press the Control key, release it, and then press the subsequent keys.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates menu item selection in a graphical user interface.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File &gt; New &gt; Templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">From the File menu, choose New. From the New submenu, choose Templates.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="default-paths-and-file-names"><a class="anchor" href="#default-paths-and-file-names"></a>Default Paths and File Names</h3>
<div class="paragraph">
<p>The following table describes the default paths and file names that are
used in this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 34%;">
<col style="width: 52%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Placeholder</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Represents the base installation directory for Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>In configuration files, as-install is represented as follows:</p>
</div>
<div class="paragraph">
<p><code>${com.sun.aas.installRoot}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Installations on the Oracle Solaris operating system, Linux operating
system, and Mac OS operating system:</p>
</div>
<div class="paragraph">
<p>user&#8217;s-home-directory<code>/glassfish7/glassfish</code></p>
</div>
<div class="paragraph">
<p>Installations on the Windows operating system:</p>
</div>
<div class="paragraph">
<p>SystemDrive<code>:\glassfish7\glassfish</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install-parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the parent of the base installation directory for Eclipse GlassFish.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Installations on the Oracle Solaris operating system, Linux operating
system, and Mac operating system:</p>
</div>
<div class="paragraph">
<p>user&#8217;s-home-directory<code>/glassfish7</code></p>
</div>
<div class="paragraph">
<p>Installations on the Windows operating system:</p>
</div>
<div class="paragraph">
<p>SystemDrive<code>:\glassfish7</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-root-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory in which a domain is created by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install<code>/domains/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Represents the directory in which a domain&#8217;s configuration is stored.</p>
</div>
<div class="paragraph">
<p>In configuration files, domain-dir is represented as follows:</p>
</div>
<div class="paragraph">
<p><code>${com.sun.aas.instanceRoot}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-root-dir<code>/</code>domain-name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory for a server instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/</code>instance-name</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview-of-glassfish-server-performance-tuning"><a class="anchor" href="#overview-of-glassfish-server-performance-tuning"></a>1 Overview of Eclipse GlassFish Performance Tuning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can significantly improve performance of the Eclipse GlassFish
and of applications deployed to it by adjusting a few deployment and
server configuration settings. However, it is important to understand
the environment and performance goals. An optimal configuration for a
production environment might not be optimal for a development
environment.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#process-overview">Process Overview</a></p>
</li>
<li>
<p><a href="#understanding-operational-requirements">Understanding Operational Requirements</a></p>
</li>
<li>
<p><a href="#general-tuning-concepts">General Tuning Concepts</a></p>
</li>
<li>
<p><a href="#overview-further-information">Further Information</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="process-overview"><a class="anchor" href="#process-overview"></a>Process Overview</h3>
<div class="paragraph">
<p>The following table outlines the overall Eclipse GlassFish 7
administration process, and shows where performance tuning fits in the
sequence.</p>
</div>
<div id="gacmh" class="paragraph">
<p>Table 1-1 Performance Tuning Roadmap</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Description of Task</th>
<th class="tableblock halign-left valign-top">Location of Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design: Decide on the high-availability topology and set up Eclipse GlassFish.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="deployment-planning-guide.html#GSPLG">
Eclipse GlassFish Deployment Planning Guide</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capacity Planning: Make sure the systems have sufficient resources to perform well.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="deployment-planning-guide.html#GSPLG">
Eclipse GlassFish Deployment Planning Guide</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installation: Configure your DAS, clusters, and clustered server instances.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="installation-guide.html#GSING">
Eclipse GlassFish Installation Guide</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deployment: Install and run your applications.
Familiarize yourself with how to configure and administer the Eclipse GlassFish.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The following books:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="application-deployment-guide.html#GSDPG">
Eclipse GlassFish Application Deployment Guide</a></p>
</li>
<li>
<p><a href="administration-guide.html#GSADG">
Eclipse GlassFish Administration Guide</a></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High Availability Configuration: Configuring your DAS, clusters, and
clustered server instances for high availability and failover</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="ha-administration-guide.html#GSHAG">
Eclipse GlassFish High Availability Administration Guide</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Performance Tuning: Tune the following items:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Applications</p>
</li>
<li>
<p>Eclipse GlassFish</p>
</li>
<li>
<p>Java Runtime System</p>
</li>
<li>
<p>Operating system and platform</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#tuning-your-application">Tuning Your Application</a></p>
</li>
<li>
<p><a href="#tuning-the-glassfish-server">Tuning the Eclipse GlassFish</a></p>
</li>
<li>
<p><a href="#tuning-the-java-runtime-system">Tuning the Java Runtime System</a></p>
</li>
<li>
<p><a href="#tuning-the-operating-system-and-platform">Tuning the Operating System and Platform</a></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="performance-tuning-sequence"><a class="anchor" href="#performance-tuning-sequence"></a>Performance Tuning Sequence</h4>
<div class="paragraph">
<p>Application developers should tune applications prior to production use.
Tuning applications often produces dramatic performance improvements.
System administrators perform the remaining steps in the following list
after tuning the application, or when application tuning has to wait and
you want to improve performance as much as possible in the meantime.</p>
</div>
<div class="paragraph">
<p>Ideally, follow this sequence of steps when you are tuning performance:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Tune your application, described in
<a href="#tuning-your-application">Tuning Your Application</a>.</p>
</li>
<li>
<p>Tune the server, described in <a href="#tuning-the-glassfish-server">Tuning
the Eclipse GlassFish</a>.</p>
</li>
<li>
<p>Tune the Java runtime system, described in
<a href="#tuning-the-java-runtime-system">Tuning the Java Runtime System</a>.</p>
</li>
<li>
<p>Tune the operating system, described in
<a href="#tuning-the-operating-system-and-platform">Tuning the Operating System and Platform</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="understanding-operational-requirements"><a class="anchor" href="#understanding-operational-requirements"></a>Understanding Operational Requirements</h3>
<div class="paragraph">
<p>Before you begin to deploy and tune your application on the Eclipse GlassFish, it is important to clearly define the operational environment.
The operational environment is determined by high-level constraints and
requirements such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#application-architecture">Application Architecture</a></p>
</li>
<li>
<p><a href="#security-requirements">Security Requirements</a></p>
</li>
<li>
<p><a href="#high-availability-clustering-load-balancing-and-failover">High Availability Clustering, Load Balancing, and Failover</a></p>
</li>
<li>
<p><a href="#hardware-resources">Hardware Resources</a></p>
</li>
<li>
<p><a href="#administration">Administration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="application-architecture"><a class="anchor" href="#application-architecture"></a>Application Architecture</h4>
<div class="paragraph">
<p>The Jakarta EE Application model, as shown in the following figure, is very
flexible; allowing the application architect to split application logic
functionally into many tiers. The presentation layer is typically
implemented using servlets and JSP technology and executes in the web
container.</p>
</div>
<div id="gacmj" class="paragraph">
<div class="title"><strong>Figure 1-1 Jakarta EE Application Model</strong></div>
<p><span class="image"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAa8AAAFSCAYAAABFZ1DGAAAKOmlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHicnZZ3VFTXFofPvXd6oc0wFClD770NIL03qdJEYZgZYCgDDjM0sSGiAhFFRAQVQYIiBoyGIrEiioWAYMEekCCgxGAUUVF5M7JWdOXlvZeX3x9nfWufvfc9Z+991roAkLz9ubx0WAqANJ6AH+LlSo+MiqZj+wEM8AADzABgsjIzAkI9w4BIPh5u9EyRE/giCIA3d8QrADeNvIPodPD/SZqVwReI0gSJ2ILNyWSJuFDEqdmCDLF9RsTU+BQxwygx80UHFLG8mBMX2fCzzyI7i5mdxmOLWHzmDHYaW8w9It6aJeSIGPEXcVEWl5Mt4lsi1kwVpnFF/FYcm8ZhZgKAIontAg4rScSmIibxw0LcRLwUABwp8SuO/4oFnByB+FJu6Rm5fG5ikoCuy9Kjm9naMujenOxUjkBgFMRkpTD5bLpbeloGk5cLwOKdP0tGXFu6qMjWZrbW1kbmxmZfFeq/bv5NiXu7SK+CP/cMovV9sf2VX3o9AIxZUW12fLHF7wWgYzMA8ve/2DQPAiAp6lv7wFf3oYnnJUkgyLAzMcnOzjbmcljG4oL+of/p8Df01feMxen+KA/dnZPAFKYK6OK6sdJT04V8emYGk8WhG/15iP9x4F+fwzCEk8Dhc3iiiHDRlHF5iaJ289hcATedR+fy/lMT/2HYn7Q41yJRGj4BaqwxkBqgAuTXPoCiEAESc0C0A/3RN398OBC/vAjVicW5/yzo37PCZeIlk5v4Oc4tJIzOEvKzFvfEzxKgAQFIAipQACpAA+gCI2AObIA9cAYewBcEgjAQBVYBFkgCaYAPskE+2AiKQAnYAXaDalALGkATaAEnQAc4DS6Ay+A6uAFugwdgBIyD52AGvAHzEARhITJEgRQgVUgLMoDMIQbkCHlA/lAIFAXFQYkQDxJC+dAmqAQqh6qhOqgJ+h46BV2ArkKD0D1oFJqCfofewwhMgqmwMqwNm8AM2AX2g8PglXAivBrOgwvh7XAVXA8fg9vhC/B1+DY8Aj+HZxGAEBEaooYYIQzEDQlEopEEhI+sQ4qRSqQeaUG6kF7kJjKCTCPvUBgUBUVHGaHsUd6o5SgWajVqHaoUVY06gmpH9aBuokZRM6hPaDJaCW2AtkP7oCPRiehsdBG6Et2IbkNfQt9Gj6PfYDAYGkYHY4PxxkRhkjFrMKWY/ZhWzHnMIGYMM4vFYhWwBlgHbCCWiRVgi7B7scew57BD2HHsWxwRp4ozx3nionE8XAGuEncUdxY3hJvAzeOl8Fp4O3wgno3PxZfhG/Bd+AH8OH6eIE3QITgQwgjJhI2EKkIL4RLhIeEVkUhUJ9oSg4lc4gZiFfE48QpxlPiOJEPSJ7mRYkhC0nbSYdJ50j3SKzKZrE12JkeTBeTt5CbyRfJj8lsJioSxhI8EW2K9RI1Eu8SQxAtJvKSWpIvkKsk8yUrJk5IDktNSeCltKTcpptQ6qRqpU1LDUrPSFGkz6UDpNOlS6aPSV6UnZbAy2jIeMmyZQplDMhdlxigIRYPiRmFRNlEaKJco41QMVYfqQ02mllC/o/ZTZ2RlZC1lw2VzZGtkz8iO0BCaNs2Hlkoro52g3aG9l1OWc5HjyG2Ta5EbkpuTXyLvLM+RL5Zvlb8t/16BruChkKKwU6FD4ZEiSlFfMVgxW/GA4iXF6SXUJfZLWEuKl5xYcl8JVtJXClFao3RIqU9pVllF2Us5Q3mv8kXlaRWairNKskqFylmVKVWKqqMqV7VC9ZzqM7os3YWeSq+i99Bn1JTUvNWEanVq/Wrz6jrqy9UL1FvVH2kQNBgaCRoVGt0aM5qqmgGa+ZrNmve18FoMrSStPVq9WnPaOtoR2lu0O7QndeR1fHTydJp1HuqSdZ10V+vW697Sw+gx9FL09uvd0If1rfST9Gv0BwxgA2sDrsF+g0FDtKGtIc+w3nDYiGTkYpRl1Gw0akwz9jcuMO4wfmGiaRJtstOk1+STqZVpqmmD6QMzGTNfswKzLrPfzfXNWeY15rcsyBaeFustOi1eWhpYciwPWN61olgFWG2x6rb6aG1jzbdusZ6y0bSJs9lnM8ygMoIYpYwrtmhbV9v1tqdt39lZ2wnsTtj9Zm9kn2J/1H5yqc5SztKGpWMO6g5MhzqHEUe6Y5zjQccRJzUnplO90xNnDWe2c6PzhIueS7LLMZcXrqaufNc21zk3O7e1bufdEXcv92L3fg8Zj+Ue1R6PPdU9Ez2bPWe8rLzWeJ33Rnv7ee/0HvZR9mH5NPnM+Nr4rvXt8SP5hfpV+z3x1/fn+3cFwAG+AbsCHi7TWsZb1hEIAn0CdwU+CtIJWh30YzAmOCi4JvhpiFlIfkhvKCU0NvRo6Jsw17CysAfLdZcLl3eHS4bHhDeFz0W4R5RHjESaRK6NvB6lGMWN6ozGRodHN0bPrvBYsXvFeIxVTFHMnZU6K3NWXl2luCp11ZlYyVhm7Mk4dFxE3NG4D8xAZj1zNt4nfl/8DMuNtYf1nO3MrmBPcRw45ZyJBIeE8oTJRIfEXYlTSU5JlUnTXDduNfdlsndybfJcSmDK4ZSF1IjU1jRcWlzaKZ4ML4XXk66SnpM+mGGQUZQxstpu9e7VM3w/fmMmlLkys1NAFf1M9Ql1hZuFo1mOWTVZb7PDs0/mSOfwcvpy9XO35U7keeZ9uwa1hrWmO18tf2P+6FqXtXXroHXx67rXa6wvXD++wWvDkY2EjSkbfyowLSgveL0pYlNXoXLhhsKxzV6bm4skivhFw1vst9RuRW3lbu3fZrFt77ZPxeziayWmJZUlH0pZpde+Mfum6puF7Qnb+8usyw7swOzg7biz02nnkXLp8rzysV0Bu9or6BXFFa93x+6+WmlZWbuHsEe4Z6TKv6pzr+beHXs/VCdV365xrWndp7Rv2765/ez9QwecD7TUKteW1L4/yD14t86rrr1eu77yEOZQ1qGnDeENvd8yvm1qVGwsafx4mHd45EjIkZ4mm6amo0pHy5rhZmHz1LGYYze+c/+us8Wopa6V1lpyHBwXHn/2fdz3d074neg+yTjZ8oPWD/vaKG3F7VB7bvtMR1LHSGdU5+Ap31PdXfZdbT8a/3j4tNrpmjOyZ8rOEs4Wnl04l3du9nzG+ekLiRfGumO7H1yMvHirJ7in/5LfpSuXPS9f7HXpPXfF4crpq3ZXT11jXOu4bn29vc+qr+0nq5/a+q372wdsBjpv2N7oGlw6eHbIaejCTfebl2/53Lp+e9ntwTvL79wdjhkeucu+O3kv9d7L+1n35x9seIh+WPxI6lHlY6XH9T/r/dw6Yj1yZtR9tO9J6JMHY6yx579k/vJhvPAp+WnlhOpE06T55Okpz6kbz1Y8G3+e8Xx+uuhX6V/3vdB98cNvzr/1zUTOjL/kv1z4vfSVwqvDry1fd88GzT5+k/Zmfq74rcLbI+8Y73rfR7yfmM/+gP1Q9VHvY9cnv08PF9IWFv4FA5jz/DYcD9IAAAAEZ0FNQQAAsY58+1GTAAAAIGNIUk0AAHolAACAgwAA+f8AAIDoAAB1MAAA6mAAADqXAAAXb5epmdQAAG11SURBVHicYmQYBQMOaqdvagBS9UDc2Jzp1zCwrhkF1ADAOHUAUvuB+AAwTh0H2DmjgApgNJ8OLgAQQEwD7YBRMApGwSgYBaOAVAAQQCzEKDI3NXUAUvlAHADEH4B4AxA3njx9+gGS/H6oWAOQD2I7ANmMNHAzzE0CQKoAiP2B2AAqfACIJwLt3QBVg9cdQPn/ID1A+RHRMiYmzAYLALo1AUjFA7EDVOgCEG8EpS+o/GjcQgGhsBosAKkcAdGgtPiAAZL+CoFu/QCUb2CA9GwcgfwDWPTTvFwZjACpfMUAgzEs6BVPAAFEsPICOgRUyIEcA6q0GoGYnwFSADoA5QxBiQ6LtoVAfJASh0Ht7QeZBbRjARYl6xkgmQAktxEqBsrA64F6A6GFMcXuGGaAmDAbcIBUiB1ggKQ5ELAHiQHl+IHuLGQYjVswIDKsBhwgFcAPgHgiVFgeiBMYIA0pQwaIHxigakYBJjjAQEaaB4Y9qBw1oGNDji55EyCAiOl51UNpUGsI1KIDBcZHqDioJ7YAXQOOyoZUAGqZOTDgDgSQHKhlnQgTALoLZO98Bkhm2EAldwwn4MBAIMwGxlkYAFT4MqBnNqBbQZWvAlRuAd1dNTgBwbAaJMABSici96qA7nwIpOyBtAJU/ACGzlEAAwfJ7E2D8rYDdZ2CG9ArbwIEYM+KrhCEYeCNoBvoBozACmyAm+AEygToBmwiblA3kTNXiDwQ+FX7nvYVkhgTrmmOJcUrhW14TbygABZTCr5tFKXBQreD0RlHR+sVupfBuiwWrFqba2yTeYLESNICrPsjSO+y3XgQD/xI0Bdc6pbemE4nefRBfjb4rhEwH7PJOIiK47UE/ek4bT9b0T6VdPfSr5zs1VF+nJmLM6yLH9JEQXI3WIcY5Gfm/Pzn1kbg10ysckxjkHFkXMigpLDiwXltTqlDWxdYHsoBZoPmqpXlbz/kZyfjaUP5eZItyO5myX/6teFizy6brwS4rrXOtX7hV3j5hPG350HyxD2xmjjbhwHV22FZ67H9P75yijSxv7c6h08BmDUXGwRhIAzfCLqBTkDcADZwA2UDnQBGYARHYQRHYARHsJ+9g4aUlxJiE1Kl9ij/f9fewzmH1276J/GmoKLslsJLxKeoTr3No9BxvMirGyfaAnhAfkgkupPuwDtLp+A8s2EssjmZJ4osDOcSzCnFAw8BRJUoACTul73xd03/uVRu8KhRzPTeFA6pu+CvUeVLpYvA6eEaJWUzRa6lmnFCXm5eFS5oIC9uqS7kW22OdSL3HvHs/o5bx2ntui3qEaNYiedgygaZh81kK3B6cNexX06AM6Ir8TWvW7BOuiqS3rQNthaffUns/RbsK6u2De10qIF3EXzv13TBFkwa8dhZqcdq3NlMe2j1Ibhnc576Gdl5MN7asq1RnUrjKVe5n8NV9fMnDt8CkGu1RwiDMDQjOELdwA3sKHUDV2MDnEDdoE7gCMqDlzYgold/qdz16FEa0ny8hNB3ghcWWRrAevYZWPLeMghA8jRKXJ3M5YMLgfJm5mumHoXL9yAYCGCQBGZrnUwhgubkJGEMirhyypb95FRKt3Zw/K2NRtGS2cipLTmc9EcdSYYHkEHZB7RhJ450V+w3hhQM1wKdI/2abmHsO+rO8onMXXn5e90ySDyVlcyJX9MHTcb7qU4PzKrjzphj8UcurdgwiCkdJBr7MHYuPi3yV1QFjpKXwF7hyq81L/kxylg8tzvhIXQdsTMmEsRYDX5Nf6jsgLzxr16Sfdng5eSxgT/oQ/Wk/Huz/mId3gUQMZUXyKIAUMZA6lo2MECH+wh082CtL0dowMES/wNiHIcGGpHYsMzxADTEiDxWDs0YDkSa+QGZRmo5gMwAYbpkhNrpm2D2PQC27h7Qwg5o2IMrKDxhBvYvseEALaRA8Q9KcKAw/ABtYcMKt0a0YaUP2MxhQI3bB9ChKpC9sB40LN3B5loViPDygMYtME5haf0DME5pZhcRYQVreBKVB6kYp8iT9iB7QYWVP1T/Aaj9G6ANkf0MZMQpsX6iFqBHPiUAyJ3zQgbk5gf0eMYV7+igEGo+CIMW6NRDaVhjhew4BAjAvLXdIAzDwNuAEQob8McnHaEjZAMYgQ0QG4QN2IAR6ApsQi69kFSgkj4i4a82kuvI9jnnJM1ZvHh+wES+OwMXxBtCbcb+5E2TPTtdrsyhfd0MavWl0mHuKR3UdoOR8wNIyDhr9Jmg7zi0NXaUHoFNRh6ATaA1yVkQ22+Cdsw854iBfn5EoW0JFSVva8BnHBvrB/rOoGNSVrZasfaDbNIGc4hM7QMkX2L71Dcf7vmq4QqRjb8Z5B/Hlnnuf1KGut1CMugrdMWjxjgMLhFTm75Lx99623WXhBinFeIiaWUzCGuHSeJWIZLSJerKFDEojNMfslfjkIrNVRbZmIqHRmdllG2mXWKQGAh5uEaM8ewYvgQQwU3K0FZSINQB9UgOJ5ghocNLIL0PGBCrFgORhp3wgQsMiLHbBCzyIHNBiUgAajasRV6IY3kwyL2gAANlSNBQBbz7Da2EE6H6YcuOAzFMGPoAb5iREw5IrWgQQF4oAdIHMg+UOUBpppHYVUjQyiyRAZFuwBPADLjT3YiNW0JhRU4epFGcgswExROIToC6JQHKd8TiHlAengD1Sz5UDDYyQLKfhglwYEDEMXL+JQRgQ3r7KcgPoLAHxTkoj4HMILgFAymewHYzQBovYL3UiEOAAKLHhPIoIABGj50ZfmD0eKjhB0ZqPjUfpBv+AQJo9HioUTAKRsEoGAVDDgAEEFHHQ42CUTAKRsEoGJkAx3aWAQcAATTa8xoFo2AUjIJRMOQAQACNolEwCkbBKBgFQw4ABBBKd9Ac++nFDxggRzYNigM+KQHmBE6tHq4AbRMwCICWJh9ggB7xQn8XUQ+Yo91oMLCuoR5A2+QLAw8YSFjhR8jswTAcRKvFAIPJj+QAUtwP3YMHPmVmMPmX1gs9AAII15zXAQbEcmPQnhnwDnhKMw01gDni+odCQseIYFF7ACr1gHYuJB3QafMjyFzkfUAJDFiOeBkIYE74BgF8ah8wQJb/H6CpI0kEVNykjLyBG7RkHHzCCIXLwpE3EA9XQHU/DoJNyrgAbMl8IwF1NAXQCvcCUkcH5J4HtLIPIIBwVV7wndzQnc+go3ZAm8gW0MohJAAFBsR9QCSpPTl4T61OYKD95scHJ1EPQQUVrLBNpgMNQPHjwEBcYYOiFlqIN9DGWRQBqmxSRoszEAUrqB5QYOYCcvUOFUAjPyYwDOwmZVwAVr41DLA7HJA5tHYPQADuzuAKQRgGw/8IjuAGcutR2MARdAQnkA0cwVE8c2MERnAE3w+JSQsteuOZGzSUQpoW+vg/Vr82dGSG8QaFOVmcs2yONO3pxaUy1peSjWkcoEYFOCaxpAqlaSR+NFKmRHHABHT7Bd8abtlQlhGPMJq2n7Rb5In3/2C8bxrTlCxOSCdjqvQDFRamJOhSGWOV0stpUUy7CeqqZTcFtcIAwjup6yoPH6mv7tMfoZ5gItrBHfsKBfr21gWu8hB5kM1B9kXLMiEm7Zdyz/vVyBPJGaNcP6hgeQ+4HC71kR+vuYKBEWjap/ow/5MA37RGjmU3AYb9NbIdd++7gYH+a1uJ0QNzanyL9XGNOUbBcQMbJ31uXuRc9OlhQvjFvHT5TejuU2Lw6Z+lWGrbpU2s94w45xftLQB1V3DDIAwDPUI3KCP0x7OwASOwQdUJGKEwATABI7QjMAojVIfOsoEo0F+xFEEV24md2KQBjt2nDTkRtTGljEYjsWunsRqZIT+AY0YsM5RGDAFh/m5PasjGHeUS2d5rg5F3sTf84bRJ7N/fk33SDyxCD4wvyDsGeL1d4KnEkJcn9v0lSwJPT/nS+eO0lBqAq/cJfjfcM/c+VXiw1iUsyOViY5elhvQ9im0XDA4TT9tYjCkTi24zdCyaeDvXxkCeNa+3qyDfhW18qGc9tx5i8wMylfwpIagZ2Nj9QF93L7Sx2IuIhXwSnAfk1wWP5gGcF7E5ctBktSFhG5DrWXD+Zt0ghnyPOtweuG0UWV/VjnkBfNI4Do2Rz235D3ltfgTeXRzguyt1J2J4kzXrMKZH4nKUFfrGgbFUKnmsqbuVCH0FoO7arhCGQSgjdARH8M9P4wZuoG7QURxBJ3AFN9ARdIOM4LmV2yAl9fFV+ekjpKEEUsjpudQyLw+9z8yH1CGL64LVSIw0zcgNz6HSj9pvqXyte0mLbNyYiFKkgIzejQyIAHdSouy56ZsVI8/y2uG2Mqx7dNH7VvkR4v0/Ugp+3HjZIzdYlUmP1gbgLMSxW8tvKNHRnM5MOysIwNZYbwyyZCl697y8D9roccUoX8dp3Ud0gL4t0yU7R3g/+ObhTRZzlorvjfSJdJK0zdsBCLYCPmLXcVHNUreRb4jRfQ/+rdiKJyl2U6sk0NOiVB1gZs7A5valPFOgCDUeWWhnC7pOQT+frGseBb7hrpLqLPEZvJan/4d+qXLgNAf/IozNJdr2ynf1Mowp4yGAiFmwAbLkAI7MAhPDdtI0rOspAPUgqMKaD/Mg1MOMUD0KDOSf9A1rUWyEunvQtqIHGDxgQCzYALHxTfqDCyCkigaUkASgcjQ7JRoJgArpBAbEULE/GWYMC4BjzgsUrgfwaMOZ90icC8KXDmALIkB82AIgByA2ZMCdRgZiyF2AsJJRQCQYVPkSIAB3V3DDMAgDb4N2hG7Q/PjSjTJKR2CEjsC3v4zAKNWVs0oqSIiqSG3vEwUlxgmHwRiZ1Q0bS7gvZ5om6PYFZKIzg7RXOe8/zfQ9FAaSo3lEe6QepGcJ6jUWOpwl64r/ROppUyEg/xubGIwqS9gxSzR0goDqY10RLyPYerbEk1fIyxHU4SBZk7jqN+jyFXDzLOIWjzAuJ2RuWzv54trqe1vA92s8iJLP/mexEPPIWNbiSAsnV8+WTj7ZcjVh309v1GN+kkDVkGoiRf3MRlks6ILf9L7WELCfXevpl0dXHJ8lmG2oteXtXUAvHgIwdy02CMJA9LmBI7CJMoIT6CaEDdzEFRyBERhFHryzBzYN1Rq45BKSXnrtfUp7hbsSGTaimaa1wzMjozGPx0O1kZ5GXyE/0zdpOWm7A7urb4u9dghC9bQ+bASFGzi+I0JIst3ifzYm+RzwsKNkn62Qcr1hcgifCZpQMkt0h3kFATs1kMdJPOyEvqR9g+yKY6DOaY9nrKyAUBpYSVk6/ZV347CHC4kivDi4qFBe4wKV8r1M3lE7UBvl/MTkdw+N45KykQSfajHPRv3U4nEV8rl2bRa6pK5jxRANfFUM8rJ6dlmwQz/9gD+vaym/BMKHfLP7tRW6/ApeAoiRXI2jYBSMglEwUAC6ug1UicPm4h0YIIX1gmG0IngU4AEAATR6MO8gAIN48+MoIBPQ6yblEQxAlRaosoKtJH3AgNozpDoYzaeDCwAE0GjlNThAAsPg3Pw4CsgHoIoLVLAeYBiAYcvhDqBDxGTPl5AJEhhG8+mgAQABNHqq/CgYBaNgFIyCIQcAAmi08hoFo2AUjIJRMOQAQACNDhuOglEwCkbBEAfmiEPIHaBCoHnWjUPpGCxSAUAAjfa8RsEoGAWjYAgD6B452FFKsO0NoJWYWI+FItHs/ZSaQSsAEECjPa9RMApGwSgY2gB+IDGyIHSjsgKFZjtQqJ9mACCAGJ2drPdz87APtDuGJPj4/vuFg4ePD7pLOu1tLfv5BTkNCKscBejg65efDHv3HR10qwNBw0KGKizxhFWOAnTw5ft/httP/xK8/2+oAmDaAPW6EhigQ4UM0NsUkE5sb2CA3pABWqUJHWIE6QHth9vAgLg5gIEB6TYIc9QLUQ8wQDZ747plAKQO/eT7BQyQLQ2ww7IXUPMQCIAAYhGX5HVQUhWmlnkjClw693ygnYAVgCouPSNJh4F2x1AE926/HWgn4AIKSe4cDgPtiKEIgBUXEH8fzmccwiqEBAakk4SgB/aC5BYwQCovUKWyAUqDjuNbAO2dgSoj5JNp4hkQp6KADvWFHfW1Hmo+7LBokFoBBtTTkUB6NzIgrjYBmT0Raifo2KqDSAeAUwQAAmh02HAQgNHNj8MPjG5SHn5gsOZT6HFhoF5UItJ1R6AzDRMYID0l0PmioAoDdu4s+LgwqPaNDIjj9R4wQCqqiVBzUU6KRzobFNstAzCwEXp6/wEGSE9sIhofdhYtxQAggEYXbAwOkMAAidiEgXXGKKAigG1SHpST3aOALJDAMAjzKWjYELqwAnStyQXo+bGgnhLs6CwFKFsAOsTIgCQHqqwSoRh0iDM43eK4+w1USR6A3gMGOloQdIPAgA2xAwTQaM9rFIyCUTAKhjYA3VuYAMTngZUO7Noj0BU0oF7RBdghxNDT9UHqkK9DymdA3PUFUgda/KGAZr4AtEe3gAH3LQN0BwABNFp5jYJRMApGwRAG0GG5BwzQy0qhwiD+AgbUy0wXMiBuhocB2HwZ7AR6cE8MqXKDDTeCKizQ3NZHqD0CDDQ+S5IQAAig0cprFIyCUTAKhjiAXnezAJc8dIUhfKEGkj74fBkOc9GvqmpgwHKuI7R3x0gsnxoAIIBG57xGwSgYBaNg+ANQb0mBYQB7StQGAAE02vMaBaNgFIyCYQ7QNzAPBwAQQKOV1yAA0JtZGwbYGRQBAQFRBkEBEYb7D66D+ZIS8gwcHFxwvqKCJsOPH98Ynr94iFU/SD0I4JIfagB0kzIDlYdJBgqw80gwsAExMvj76wvDt3d34HxmNh4GLiEVsBhIjlcCsUf+15cXDD+BeKiD4ZBPhxMACKDRymsUUAVISsgxRIUXMsxb2AqusEBsAWBlVtsYA67EkuKrGbbtXIKzcvJ0jwHTIP2jYHABERV3Bil91MM9Pr+4yHBjJ2IEClRxabj3AcWKgHIXwGxk8PLaWoZHp6fSxb2jYGQAgAAarbwGARismx9JAddvnAXToB7W+w9vwBXXByAN4oMqL2Q1+HpZoB4cCHz48JoezqYZGI6blE8vdCJJ/bOLCxmeXljIIGeazSCuFTzkK6/hkE+HEwAIoNHKa3CABIZhcEMrqHJSkNcEV0ogDBomlABWVIL8kIrsx4+vDFnprfDKC9RDW7ayH6wOBASBFVdxPmQLyfkLhxnWbZw5YH6hAhh2NymTOhTIxi0B1gMackQeYhzCIIFhGOTT4QIAAmi08hoFVAP3H15n8HKPYXgApF+8eMTw4eNrBkV5SM/r+o0zDIYGduCKa93GWeCKDDS0qKlhAqyoDoH1fweKTe2sAqsDmXP85I5hMwc2HADyUCCsV4UPgIYbQRgEhnqvaxQMPgAQQKOV1yigGgD1vECVjqG+HcO+g+vAFRSIDRpCBFVEsB6Xob4tmIYt5oABUIUH6oW9gFZYsOHGUTA4APqwoYY7pJeMPPeFDJCHDaX148HzXqNgFFALAAQQ1Ssv2KozGEAvoEbB8AWgeaoP0PkuUAX0HsgHsUEVEqhiew6snBztg+CVE2hI8QVSz0pTw5jB60cMg4KCJtic0bQzuIC0AeqiDdBQIKhnBRLnFFQBi/1CGkrkFTcAyoGGG/WHxWrDUTC4AEAAUb3yMjKwBRdQMAAquKbOrB7yE/CjgDhwDNjD0lQ3hg/3gSotWNyDaNBqQlBvDNSrQh4WBFVioAoLou4Nw/qDswbGA6MAA4AqHtDqQlBlhAxu769l+Pn1BYOgrA3Dn19fwCsNYZUUSD0IgPR8e3cX3AsbBaOAmgAggGg2bAhbIl1dPgtcoe07sA7MBw0dgVrUIBpWcMFWqIEKN5gamBw2NqhCRN9HBAPYVrKBzAfxQQsCRudQaAuOn9gBxjAAWpCBDEDxha1HBVpGPwoGJ3hzZycYYwOgoUBsw4G4hhJHwSigFgAIIJpVXshLpJErH9B+H1DhBWppg4aNQHMkMHWw1WegiXzQnAmoMgOxQQUbjN07sRBsBicHN3iCH1QhgVrzoCEqkDi2lWwgcVilNxj3EY1ufhx+YDhtUh4FEDCaTwcXAAggmlVeoAoDBLDNXUCGix6Bl0XvB1ZSoF4ZaK4sGajHyz0WrB60Su0FsFIDVTqS4pDl1iBx0HwaqIICte6v3zwLrgBBlR+hlWwPgHpHW/ejYBSMglEwPABAANFl2BBUsSAPJYF6QLBFHbCKDdSzgk3wn794GN4jA7GtzD3AcqDKCqQeVOGB9hNZWniAzQJVSpzQ3huulWw/fn6jlVcpBqObH4cfGI6blEc6GM2ngwsABBDNTpV3cghicIIu3MC2WANUuYB6VUH+6WC1IBo01AjqlYH2BMHmvkCVHogNkgNN/oN6aKCKC1SRgYYAQZUXaIHAuQuHweaChiNfIC0CGCIggWEQ3tBKDEAeHh4FKGBQ36QM2jzMjnZeIS0AyA7kzc1DHCQwDNF8OhwBQAB27hgHQBCKwfD9r+WF2Jz1AzqqIWFweP9kQmBhaKh93f7yatMmJDBg46UWiNBYS6NCT57drzLiw15MLx40LLD/xvfRRSsiSOAk1uwjdGOm6HxMsjmzzSRbsYf8v4xwuedYtMV/EW03d6VIF1KBUoPKdFdxDt4GkNOLuFotVRRfXAKI6pUXqADDVYiBKhPkBROgCgd9dRoMIB8NhD5XBaoMYRUiMsC1km0wLtIY6gC0HQI0lDttZjW45wwa5oXFO/KKUVhDBXmlKai3BgIwefQT6ZFXn8LA6IpRygGoF6RoXQ4/JBfE1/adBa6E7h/tBKsB9ZLQj34CiYH2dLEjHfME6VHpw9kg9bDT52Eny4MAaJXiJ+iyedDhvSBxUMWJflwUSA4EkMVh6kEAtBSfnAp2FAxfABBAoydsjAKyAGTeUhRSaV08DF50AwKgnnSQfxpcDajhAarU0FeagtSBxEHyXtAT5WErQ2G9OVCjBtZwGewrRocCEJCzBtOwnhKowjm33A/MxtcjAx0LBd7nBaysQJURqKIDsWHDjiC2lHg8/CgoEACpAalF7nnBemog9aBKCrQvDARA5sMqL2R7Ie7hhprXNVzORxwFVAIAAdg7YxMAYSAANi4gCA7gJlbO4AAuZp1KEFxDEBsLSxewsTIX/oOoVeo/CFqYpDzy+X/tT8pGEuPUh3At3TBotqvSQUQISkPA9aNgHQjnqtDIBgU6a3CHqcXtzCUph4Qc7TIPu6xrpJGJmN7EE9nqgmRm1/oTVBllA4iDQmMVFGKi+JjB+3UeQUbIECkWVfO7FzLiO2TFYD2eyG7z0kJsuUhWWYbOxGV8uAXQaM9rFJAFQBXPB+iwIajyAW1NgG0cB/XIYBXRe7TFOrBhxGMnd4IrJ9CQI0gMVJnBVorC9IIqP9Aq0g8wvYN4xehQALChQNgwHwiAKi1YDwo2vAeS+/XlJcqCjr+/cQ/ZgXproOOhBGSt4Sdr4AJ/f31F4cMqVFhlh64fXf0oGAUwABBAo5XXIABDcfMjaB8eqNI6LrGDQUJcHn5LMmihjYSEHPhkeZA4rmPBQOIg9ZbmHvD5S9DwI6gCBOkV4BcFV4Told9QAYNxkzKohySuGQye5wL1skAVDqiXA+oJybFlASuyMoa3d3dCrzLRB/eECAFQTwpkBgiDemagik8AredEyE2gYUVYzwpyG/Ndsv1ISzAU8+lwBgAB2DtjFABhGIpu3v8Orh7AC3gMF8FNcC442JfmhyJO4pi/VGsibo8kH5ttw9QnRduwQkxzqDbjGg1C7AMoYtDTaYpoDQIwWolIMzCgp+eKT8foPwJUe4UM4MKYoZOPWQGa/l/I/bktdk01VNzE0VdGxzpHZQS4yKVa4z2Xmyv6HAAlMwd7rMW/geptsNwpQKb4VOpNtwBijIr2+K+kKjzQ7hiS4NK55wc2bdpH8UWD1N786OfntF/PSNKBUnNGIrh3+y3DsqU7KO4xUXuTsrmpacPkbJ56Ss0ZieD2078MkzZ8dzx5+vQBSswZ3aQ8uABAAI32vAYHSGAY3fw43MCg3qQ8CsgCCQyj+XTQAIAAGq28RsEoGAWjYBQMOQAQQKOV1ygYBaNgFIyCIQcAAmi08hoFo2AUjIJRMOQAQACNVl6jYBSMglEwCoYcAAig0cprFIyCUTAKRsGQAwABNLpJeRCA0c2Pww8Mxk3Ko4AyMJpPBxcACCCCldf3778Znj/5RA+3DDownPe/gfYzjUQgKcPHwMnJOtDOoAk4eeMPw7vP/wbaGXQHKlLMDKrSzAPtjFFAZwAQQAQrrx/f/jB8ePuHwcJSjx7uGTRg65bDdKu8BmLz491bbxm8fWzpYdWgASeOX2IQFPpDl8prIG5SPnnjN4OwnBaDsLAAPawbFOD2LdD1OC/oUnmNblIeXAAggIgaNhQW5mfw9rahtVsGFQBVXnQECUAMOj2hkYGOwxIjLU4hBd1/elkH26R8AIgpPoWFWGBpocegqiZHL+sGHGwF4v+vXhBURyWQwDAA+XQUYAcAATS6YGMUjIJRMApGwZADAAE0WnmNglEwCkbBKBhyACCARiuvUTAKRsEoGAVDDgAE0GjlNQpGwSgYBaNgyAGAABqwfV5Zme0MatCJ5W/ffjI4OZkyWFjqDpRzRsEoGAWjgG7A3NQUtKBn9MYBCgBAAA3oJuWCwmgw/f37D4biov4RW3mNbn4cfmB0k/LwA1TOpwK8QuIOGhbuVDJuZIHT2xYxAATQoDhh4+3bj+Dl+DAA6pVNm16Jwt669QgDJyc7w9YtRxgKi6IY9u07zfAOqA8EQkJdGGRkxAfE7aNgFIyCUUAOYGXnYBCUkB9oZwxZABBAA1p5TehfCqY5OTkY0jOCCaq/fesRQ29fIUNb6zyGuHhvcIUF6rWB+M0tWbR2Ls3A6ObH4QcGYpPyKKAtGM2ngwsABNCgGDYkFsjIQnpXT568ZFizeg9cHLnXNkRBAsPo5sfhBgZkk/IooClIYBjNp4MGAATQoBg2xAVAvSpsAFRZxcb5gGmQmtVIFdkoGAWjYBSMguEPAAJoUFZeoJWHoKFAGVkx+IpEZAAaYly8aAuYDVqpCBpCHAWjYBSMglFAGXj/4iFWcV4hcQYWNg46uwY/AAigAau8YAsysAHQAgx0gHwOH2iui9Qhx1FAXwCan9y69TA8ni5evAVebMPFxQ7mwxbZgNTNmLGWQRbYUAEBWGNkdAHO4ALIW1tgAHmhFHp8j26FGXzg+5cPDD++fGR49/whlP2B4ffPHwyf370kyRxQRQZabMIrJAGu0IQk5QekcgMIoEHZ8xoFww8sWriVoaU1E7w4B1zQASsy2CIdUMWFXMmB5jNHGyeDD5AaJ6NbYQYWgCqoVw9vgntToArrzy/s0zAwAMqbsEYkOrgFzLMwAKvsQGaCwN3zEHFQBcYrLMEgJqcOrtBoXZkBBNBo5TUK6AZAGUBfXw186jmuk89B2yaEhv4CnFGABEBxOtqTpg8AVVBPb19keAbE2HpUoN4wKC5AeUwWSHNysZMcN6AFc9+Bvelbtx8B6R9gPihvg+wDYZDdICClqg+uyMTk1aniN3QAEECjldcgACNhkzJsbx6oVwVq4YWGusArsMePX8G3TYAyVSiWYeOhBobjJmVYHIEAqMDDNryPTT2o8iKkdiiAwZxPQZXW3fOHwBUXcg8LVFnpARuMsEqLGgBmDnoDFDSiAqrQLl64Ba7QnkErUU4eAQZlQztwZUZNABBAo5XXKKAaAA0P4Wplg1pqcXE+YDZsngu0Zw8EkIcNR8HgBehxhC++kdWD1NVUTwfGtxrN3TgSwcOrJ8EVF6zSAq3CdnQyZbC01AU3FOkFYCMqoPUJoHRx4sRl8AWwb99+YLhyeBPYnTp2/uDhRWoAgACia+WFfHIGOh/UIgfV1m+hp2bA9m6pqsmDL4YEFXSwiICNoYNuAgYFFLq5Qw0Ml82PT4A9KORJe+SMs2jRFrA4KF5lcIyrDycwEjYp44vv4QgGYz4FVQqwYTpQIwJ5RGMgAewCYxA+cfwyOJ28ffuS4fiGWQw6tn5U6YUBBNCg6XnBhhVAx0CBAGx1IeRYKA5gV/Q2fMIXxB5mGSWBYRhsfgRlGqET/ODhIvQtDCNwe8Ow26SMPGwIAqA8CxrmxRbf6OqHw1AwwyDLp8gVFyguQCs6ByMAldv6BqrgRVqgqQOQu0GA0goMIIAGTeWFD4A8fuLEJUTldfEWWGwUDD4AGxpEB7i2N4AqvAK10SHDwQ5wjWzgiu+hPBIyFAB8PgnYiAfNJw/2BTEgd8K2VoBGYUAVGGhlIiVDiAABRPfKC731RgwQFhYAD1HAhhRBw4awo6JGwSgYBaNgpAHQHBcIDLU9kaAOyDdg+Q2aJrp7/iCDgXMY2WYBBBDdKy/k1jdoropYAOoSg3pcIGBhocfw9t1HqrttFIyCUTAKBjsA7dsC7eECrSAEbT0ZagBUlu/fdxq8B40SABBAQ+YmZfDQ4fHLYDw6ZDgKRsEoGKkAtjkYtJhtqAJqHKYOEEBDYs4LBEBjpjAPY1usgTwcCeqZje7mHwWjYBQMZwBagj5UAWiBD6UAIIDoWnmhT+Jim9RFPsMQnY985xey+FCfHB7Mmx9HAXlgOG5SHulgsOVT0CiUt7ftkLsSCrTPE7QtilIAEEBDZthwFIyCUTAKRgECgPa5zpyxFufVUYMRgCot0AEF1FjWDxBAQ2bYcDiDwbj5cRRQBkbCJuWRBgZbPoWcZPGBob9v2ZBYdQg7WQe05w/UWwTt+aIEAATQaM9rgMDDbscAJG4CA2RDawKSvAN9XTQKqAxgm5T7B9oho4B8gJYPExgw82kAwwAC0D47fQM18P2HoAMdBmMvDLTFCbS3C1ZxUWs9AkAAjfa86AyAiR1UqM0HYtBs6wY8SuuBakG7+RPlS/c/oIfbRsEoGAUQAMx7CgyQfAoCB/AozUfKpwPSwwb1wCwsdMEn2Ozbexp8piHobMOBngsDDRGCeleguTlQhVVVnURVNwEE0GjlRUcATOQNQKqeU+Qfw/c3TAcIqWcX+Ofw8wPTeaC+RmDGmEBzB46CUTAKQPm0AEjVA/OfADD/HSCkHpifDYD5GZZPG2juQCwAVCmA9tDCKgxQTwwkBqo0qHmiPCEAsh9UWYH25IJWFIIq0uaWLJpUpAABNFp50QHAelusPP8NhDV/M/z7wwCsvNgI6uNX/AOiBN5dZ+0HmuHPMNoLGwWjgGYA1tti4fjvIATMpyDw6jzhfMor+weYVxkY3l5nrUfKpwPSCwNVUqChxO+hP8BnwN66/RB8piAIgCsxWXEGNVU58JmUlFYosIPUnzx5xXD71kPw1Uagm9JBR76BjoKi9QZqgAAiqvICORB2YO4oIA3AelugiohPAVwZMQBbc0TrB7b+GMRNfzF8us/i8PkJM1V7YSMtTkHpmE+Ib6CdQVNw/MQl8J1KIwWACk0VAcrNgfW2eGX+CvAB8yoTy3+S8ikrzz8GCdOfDJ8esBh8vM8yoL0wEADthQX1usDzS3GQigZ0xB6IBp3wDqpoQPNjwkiVGKRCwx6YoIUh76DH86HrBW2WBg1TgipOeg5VAgQQwcqLg4uFQUCYheHGrWv0cM+gAcpqwhTpR+9tgRI3uQCUkQRUfzNwiv6lWi8M5L+RFqegdAxKz8MVmGuwMrz7fJPh/6uBdgn9AKjiUpFiJls/em8L1FikBIAaqKBpgcHQC0MGoIoFMnSIulgCdisyCDwGsb9j3zyspirPIGyBXMkN/N4ygAAimJM5OVkZlFQpK8hHGsDW28ICDIDq9oNZX8AL0g4AsX0KTAyyWg0FULMXNhqntAUDsUnZXGP4Vsy0ANh6W1gAyfl0sPXC8AHkubDBcA8YKQAggEZTOxUBsb0toDyDmOEvUP/cAZ95IHXoAEsvzJ4B0robumfFjIJRQEdAbG+LknwKAoO1FzZcAEAAje7zohKA9rbOA3tbBqBWF75hQlAFBMowhDCOliAYwHphwFYjaJ/J/YHebzIKUAFokzIQOwAxRst8FAwcgPa2zgPzjQMo/+AbJqRGPoX1wkDlAsheaDkxCqgAAAJotPKiAgANKzCxMNQDW2n4hgmpDmC9MBHd36DW4XqgO0Y3xA4eMLpJeZABaP7oB/a2BED5Bl+lQ20AKhckgJUlqJx4iBhyHAUUAIAAGq28qAMC//1h2PDuOitJK5SoAUD2fbgNHv0FbXhupKvlo2AUDC0Ayh8TPtxmZfj+hvxFHuSA31+YQMOHoG0yoGHDRLpaPkwBQACNznlRAUDnmwJBQ3evzrPNJzABTBXw7w8jaOEGw+cnzCC7QWPp+E7rGAWjYMQDaD4tBObTjW8us87nFGFWAM150boH9ukBC8PH++CiFr5ww9zUVIGmlo4AABBAo5UXFQGoAgFmjAvACmX+9zdMOCeDQb0lYjY/goYhcekH9fL+/GAEVVijizVGwSggAQDzywFgPjUE5tH658fZC0D5lFPkL4Y6SvMprLf1+wsjuLc1uliDugAggAhWXt+//2Z4/uQTPdwy6AA5y8mhe68cQRPDwISPbxnuAaBaRxCjdvqmBiAFOh+tEXpnEAN0XNwBWQNab4uizcr3br8lV+uQBpIyfODtH8MRnLzxh+HdZ8r2KQ1FANrnpSpN2jAgCb0wkvMpCGDrbY0C6gKAACJYef349ofhw9s/DBaWevRwz6ABW7ccpmgvFKhiASbsDYR6YcQCpN7WAQYqHBN199Zb8H1AIwmcOH6JQVDozzCuvH4zCMtp4TwlYTgC0AkbDAwvSK68YACpF9YP7IUl4OqFEQtGe1v0AwABRNSwIWg3NfoNx8MdgCovSgGuXhg6wHdDKzV7W+hgpMUppKCjzwqzgbpJ2dJCb8htNqUEbAXi/69eUGQGtBeWiNQLE4CdbYgMCN2kPNrboi8ACKDR1YZ0ANAKxxBYAR14eZqN6BWJIHUg9SB9IP2jJ8uPglFAOwBd9KQI7IVtAPbCGL6/Jq439wvY23pxmh1UcYF6WYajFRd9AEAAjS7YoBNA7oUBE3k9shyuG1qB6qje2xoF9AGjNykPTYC8chg05I8shyufQreqjPa26AwAAmi050VnAOuFAfFBJOEEBrQbWqHyo72toQtGNykPYQDrhQHxRiThBAbc+bSBXm4bBRAAEECjPa8BANBeWAMBNXjlR8EoGAW0BdBeGN7G42g+HTgAEEAD3vOa0L90oJ0wCkbBKBgFo2CIAYAAGvDK69atkXNx3igYBaNgFIwC6gCAABo0w4agmzlB11WDLkcD3QLq5GQKFgfdCgtb0r1o0RYg25bh4sVbDJeAGAQsLPQgt4WOglEwCkbBKBgxACCABrznBQP79p0B708pKIxmCAl1YejvXwrmgzaWggDoCnfYNdag2z5B6tIzgoH6TjPcHu29jYJRMApGwYgCAAE0aHpe+vqqwB7VbWBldRnlimlQBQbqaYEqL1BvTA3If/LkFbgXBgKgHttQB4Q2P46CoQcGapPyKKAdGCz5VEhSnuHueUjZBxqlGorgGxXKbYAAGpCeV1ZmO4ZYf98yBgsLXXBvCtTzggFQhQUbJtQ3UGVYtHArg7AQP0NcnA8YI1d0o2AUjIJRMNwBr5A4AwsbB8PFC7cH2ilkg/37TjOIyatTZAZAAA1Iz0tfX41hzeo94NoXNrcFqoRAHuLk4mB48vglmA8aDgT1vEDDhTKyYuBWBkgc3BN79xGsDgRA82JD+UgcXJsfR8HQBaOblIcfGCz5FFRxyWubM6wGlqGgcm+oNeBBo2ughXqmXnEUmQMQQANSeYF6V6C5KxCQkREH01XVSeDKipOLHbxAAzRMiKweBkC9MvC817efYHWgrjOy2iEKEhigp1UzDIJhCWoAUByBEimsFw2Ko61bDzO8A9KqavLARosJuDECUgdqyMCAEDAjhgL1DNXhECQA26R8AIgdB9YplANsW1pAcQvLv+jxjaweFJfePjZwtUMYJDAMknyqbGjH8OrhDYaZM9YyxMV7D5mwBaUR0JQPqPIVlJCnyCyAABqwOS9sgY3ce0JuTaC3LJD1gjKGjMyQL+iGHQA1LmANFBAAFWagYV5QHG/degTcagTxQepAALQABwRAC3BAQ8PIDZZRMPAA1FKeNr0Spzx6fCOrB4mDpgV6+wpp7s6RBEA9l9PbFoHDFtQ4gI1iDUYAW00Oyt9SqvoM6uZuFJsJEECDZsHGKBjeANTzAg39ggCox4xc0CED8HAxPR02CmgOhtqw1lABoOFDUAV29/wh8OgFaF0AaCvRYJpCAVVaoJXk+/aeZvj9l4FBx9YPXHlRAwAE0GjlNQroAkC9rLbWeeCCDNRzBrUUYeDx41fwYaZvwBY8aBhkFAw+gDwUCIpD5IVV+NSDGi4Zoz1pmgBQBQbqxYAWP9w9fxC8xQiUxxyBvTDQ2oKBajiAGqegXhZoUQmoAgNVWKChTk4e6t01BxBAo5XXKKALAG0kB2FQQXbixGVwRdbckgWWkwX2yGDDhqNg8AJS4wimHlSQgeZmYPE9CqgPQPNHJp5xDO9fPGR4evsiuCcGwqBGBmh7Eagigy16owUA5WvQmoVbtx+CaRAfVLFKAystOW0zqlZaMAAQQHSvvECJGFSIgQKTHACa8AMBXKdqwBZvjA5V0B+AEi1oUQa2Qq64qJ+hpTUTfrEpNS77HAUDC/DFNzIAFaDDYFHVkACgSgyENYC9sVcPbzK8A1Zmx0/dBveCQAA28iEjKw7ecgQrJ4kZagTF4TtoPIJWeH//9gPcMAGNnMD224KW8QtJajAomatTvCCDEAAIILpWXrDNxqAl8eRWXqAl8vgAqFUPAkPpluDBsvmRUgBq2YGG/UALMkC3FjsiTSCDVhCCGi6glYYgOW8f2wF0Ke3BcNykDIpXZAA6WABXfCOrB21pGcyLCYgFQymfgno9oKE62PzS9y8fGD6/fcnw+R2wsnnxgOHe41tgNiXm8wmLM3DwCDJIaSiCN07D9p/RCwAEEN0rL9B8BqgQA1VisFof1r0FyYMSOXhvF7BGB61YArXuQK0E2NJqGIBVgiB1esCKEKQPslwXcpwUKGMNleWjwwWA4ge25QG04Ry59wvubRuogvfsIcuBKjxCcyejYOBBIZbeFSgOccU3snp0uVFAfwAatgNhyMZgOxQ50FAjDPz++QOlUmNhYwdWUhJIfA5wJTUYAEAA0a3yAnUrQYkcNHEPaqGBekiw3hGo0gHt7wFVbKBln4VFUeClt6DKCZQ5jh+/DF6xAlMP6q4i9je4gFt4IAySt7DUA6sZShXXYNn8SC2AawgCVLmhyw3XrQ7DbZMyvmElbHKDacUbtcBwy6cwgD68R+nJF/QCAAFEt+OhjkPnqkArkEDzVrAeEgyAJhVBBRkXFzu4dQ4CoAoIJCYLpEHDEjAAquxAPS9Qjw1k3sULt1DkhyBIYMC8oXUUDG0wepPy8AMJDKP5dNAAgACiW88L1ouCDf2Bek6w459AALZZFTSGDuqFgSYGYZOAoGOkhJCGHWDHRMEmisEnzuPYNzQKRsEoGAWjYPgBgACiS+UFqlhgvSgYAC3YOH7iErzyAq1akrkoDp4DEYZWXqBVLKDeFUg/8rwIaA4MdIwU6JgRYWEBcM8LtjeIk5MdvFnv7eg4+ygYBaNgFAxbABCAfTs2AQCGYSC4/9bmCoPIACmMvnf9IMlf5EVabymvvE+5+AwnpOyq/P/ox0SJKz7lL9zudDPHHIYbYkY3pZRSbjICiC6VF7YeELbJe2yLLND1op95iM3s4ThZPApGwSgYXuDd84cMu+Y1D7QzhiwACKBBccIGqFeGcfju6BLqUTAKRsEwBSdPnz7AMMz2AdIbAATQoKi8sPW4husSamxgKG1+HAXEgeG4SXmkg9F8OrgAQAANyE3Ko2AUjIJRMApGASUAIIAGRc9rpIPhuvlxJIPhtkl5FIzm08EGAAJotOc1OEACw+jmx+EGRjcpDz+QwDCaTwcNAAggonpeoI3DoA3Fo2B4gZEWp6B0zCfENtDOoCl4PMI26799+4FBaKAdMQoGBAAEEMHKi4WVieHr988MCxatp4d7Bg0QFOYaaCfQFID8N9LiFARYWEUH2gk0A9IiTAwXj+1nuDjQDqEzUNFgHWgnjIIBAAABRLDy4uVjZzCxkKGHW0YBHcFonA4/EGwzujF/FIwcABBAo3Neo2AUjIJRMAqGHAAIoNHKaxSMglEwCkbBkAMAATS6VH4QgNHNj8MPjG5SHn5gNJ8OLgAQQKM9r1EwCkbBKBgFQw4ABNBoz2sQgNHNj8MPjG5SHn5gNJ8OLgAQQKM9r8EBEhhGNz8ONzC6SXn4gQSG0Xw6aABAAI1WXqNgFIyCUTAKhhwACCCWu7feNgLxQLtjqIIHA+2AUTAKRsEoGIkAIIBYTp4+3TDQjhgFo2AUjIJRMApIAQABNDpsOApGwSgYBaNgyAGAABqtvEbBKBgFo2AUDDkAEECjS+UHARjd/Dj8wOgm5eEHRvPp4AIAATTa8xoFo2AUjIJRMOQAQACN9rwGARjd/Dj8wOgm5eEHRvPp4AIAATTa8xocIIFhdPPjcAOjm5SHH0hgGM2ngwYABNBo5TUKRsEoGAWjYMgBgABi8fCw/y8kzDnQ7hiS4OXzzwf27jvqONDuGAWjYBSMgpEGAAKIBVRxKakKD7Q7hiT48vnXQDthFIyCUTAKRiQACKDRYcNRMApGwSgYBUMOAATQaOU1CkbBKBgFo2DIAYAAGl0qPwjA6ObH4QdGNykPPzCaTwcXAAig0Z7XKBgFo2AUjIIhBwACaLTnNQjA6ObH4QdGNykPPzCaTwcXAAig0Z7X4AAJDKObH4cbGN2kPPxAAsNoPh00ACCARiuvUTAKRsEoGAVDDgAE0Oiw4SgYBaNgFNAZmJuawoaVRwGZACCARiuvUTAKRsEooD8wYGHj2M8nLD7Q7hiS4N3zhwwAATRaeY2CUTAKRsEAAFDFZeIZN9DOGJJg17xmBoAAGp3zGgWjYBSMglEw5ABAAI32vAYBGN38OPzA6Cbl4QdG8+ngAgABRPXKS0BAlMHIwBbO//7jG8P5C4cYfgBpUoGigiYY7zuwjppOHAWjYBSMglEwxAFAAFG98hIUEGFwtA9ieP7iIbjCEgRWZk5A/tSZ1QwfPrwmySxQxQUyC73yaq5fwrD/4LphU6mNbn4cfmB0k/LwA6P5dHABgACi2bDh9p1LGO4/uM7AwcHFUJw/gcHK3J1hG1BMUkKeQVPDmOH9hzfgHhkIgHprIDFOoNrrN86CKz50AJIH6f0O7cEpyGuC9YEqRJgcSB9IP8xMUA/w3IXDYBqXuYMEJABxPRA3MowOSwwXANukfACIR+98Gx4ggWEY5dP30PLw09sXDH9+/YSLf//ygeEHEIMAB48AAyePAFyOhY2dgU9YAswWBJa5AwkAAojmc16g3heo0pCAVlpR4YXgSs1QX5TBElihLVs5gSE7vRUsBqqIsoDsZSv74ZUQCIB6YCB96zbOQjEbVNlFAdWDencgOyzNPRje279mmLewFd4D1FA3BqsFsdHNHQWjYBSMguEOQJXR++cPGT6/ewnEL4CV1UtgZfWDSN34G/ygio2Tlx9YkSkwCEnKM/AKiQMrOA7KHU0EAAggui7YAFUuoMrswUNQRfWGwRDYIwJVTKDeGQj/+PkNXEE9f/EIRR+o4gJVOrCeWpB/GtgMBaBeUI+rtTMNbC7IjOryWUBz7RheQFsV68HmPQRXiiD7RyuvUTAKRsFwB6Be1auHN8H4O7QXhQ5kZMQZuLjYwTQnFweSuBgDFyeE/+37D4YnT17B5d6+/cDw7u1Hhm/ffgLFX4LNBmHQvqu75yFqQJWYqJw6g5i8OkqvjdoAIIBoXnmBKhRQBbPv4DoGRXlN+MKNDx9fg+etQJUMqKcEqsRAQ4GO9poMx0/sAA8xwgCoV4Y8NEguIGfRyCgYBaNgFAwFAOpNPbx6iuHZ7YsYFZaamhyDqpo8uGICVVbCwvxEm6uvr4ZTDlSBvQVWZrdvPWK4BcQgPqgiA+GbJ3eBKzJlQ3uaDDECBBDNKi9P9xhwZQGqcN5/eA3uNYEqqqT4anAlBRrq+/7jK3hOCiQGqqBAvSmQODoADfeBek6BwB7XtJnVYDGQGaB5NVBlBppTA9Gwyg1klyQ0sEBmg+wH8bcjVYijYBSMglEwXMDd84eAFddJ+HAgJ7DnpG+gCq548FU+lAJQRQjCMDu+A3tqFy/cZrh48RYYQyqyReDhRA0Ld6pWYgABRPXKC7QQA9SjgoHzFw8zXL9xBlyRgSqo3omF4F4UiA8TB61EhC3Y2LZzMXxoD6SegQFiFmj4D9b7AlVmsMUb06B6QfzjJ3dgDAuCenCg+S/YApJRMApGwSgYLgA0j3Xl0EYwDQKgHpW3ty244uLkpM/cEzIA2WlhqQvGoIrs+PHLDPv3nQb2zl4ynN62iEFe2xzYE7OjyrwYQABRvfICLbrAt4QdJA8aFiQkBgKgygZW4YB6VLAhQ+RVhSAAYuOay/oA7fUNZjC6+XH4gdFNysMPDLZ8CqqwQBUCqLcFqjRCQ13AlcZgASA3OTmZgvHWrUcY9u09De4dvnv+gMHUK47iCgwggIbt8VCwHiCIHgWjYBSMguEEQBUWrOICzWe1tGYOqooLHXh72zAUFkWBhxhhlS6lACCAhu3xUIR6gIMJjG5+HH5gdJPy8AODKZ/eOLkLXnEVFEYPpFOIBqCKC1SB9fctAy/sAPXCQMOI5AKAABq2Pa8hBhIYRm9oHW5g9Cbl4QcSGAZBPgWtJAStKAQNy6VnBA+kU0gGIDfHxXuD2Y+unqLILIAAGq28RsEoGAWjYAgB0IZjEBioRRmUAlAPDNRjxLX/jFgAEECjldcoGAWjYBQMIfD9y0cwLSxMuw3AQwEABNBo5TUKRsEoGAVDEFy8cGugnUAWAC2hf/z4FWGFBABAAI1WXqNgFIyCUTAEAagS2Lfv9EA7g2SwevUeqpgDEECjldcoGAWjYBQMQQBarLF1yxGGE8cvD7RTiAag/V6gEzhgizYoAQABNGyXyg8lMNg2P44CysHoJuXhBwZbPkVfeu7tYzNoF3CAzj9cA+xxgWiQm79/+0lYEwEAEECjPa9RMApGwSgYogBUgVVVJ4Err5rq6eCeDWg4cbAAkFtAbmprnQc+ugq2UZkaACCARntegwAMps2Po4A6YHST8vADgzWfgioF0EZl0MnuW7ceBh/DBFpGDzqWiVoVBakAdjAvaEgTdPIHNSstGAAIoNHKa3CABIZhdEPrKACD0ZuUhx9IYBjE+VQVdNqGWjS4FwaqNGbOWAsXV1OVB9OkXIVCCgDZ+eTxK3CFBboaBXRPmIWlHkNzSxbN7AQIoNHKaxSMglEwCoYRAPVwQkJB2AVcqVy8eJvhxIlL8FV+srJi8Aso1VTlwGJCwAqGUCUDvnzy20/4BZXfv/0Ai4EqK9BcG+TOMDmwvbSqsJABQACNVl6jYBSMglEwTAHsvi0GbxswH7RgAnQT8q3bj8CVD2iYEQRA+64IzZUJI1VwoIstQZUf6PqV2DjCFR8tAEAAEay8Pn/6yXDz2mt6uGXQARMLmYF2As3AmRNPBtoJAwLUtUQZePnYB9oZNAFrj/xkePrm30A7g+7AXIMViEfb4cQAWAUE6iENdQAQQARj/M/vfwzcnLzgu2JGEujvXzrQTqApeP/2G0PhEDmNmloANGwCSs/DFYAqLn0rRwbZAZqkHwhw/MQlhnefbw60M0bBAACAACKquQKafBsONfUoQAUjLU5B6ZiB4f9AO4OmAFRxjaR4BQ1//af8pKFRMAQBQACN9rUHARhsmx9HAeVgdJPy8AOj+XRwAYAAGt2kPApGwSgYBaNgyAGAABrteQ0CMFg3P44C8sHoJuXhB0bz6eACAAE04D0v0K7wUTA4bmilFgDvBxlER9QMEBi9SXn4gQSGYZRPhzoACKABr7yG+6q+kQhAB3A+ocJ9PaNgFIyCUYALAATQgFdeyADUWgf1xEAtdxAAbagDYRhAbtGD1A3VXtvDbkcDIG4goKYBiBXo4iAaA+S4+v79Bzx+QQA5jkHiIHVDsdcGjCsBIJ5PQE0CKO7p5aZRQBkA5T8i8+lonA4AAAigQVN5wc7iAi19BV2wNgHaI4OdzwVjg1r0oBOKQepA52iB2MgV3GAH0MxwHojtCSgFyZ8Hqi+guaNoBECVEXpcffv2ExyPsAoK3EsDqgPFNygNgNSCrngAqR8qABhHAUDqPgPh4SQFBkicNtDYSaOAQgDNd6Tk0waaO2oUoACAABo0CzZkZMUY0g2CwRUR6Pws0HAi7MgRkBiogAPtXwGdwQW6hA0EwMecAFvqIHogjichBUBbZ/NZef4bcEv+Zfhwm3DQ8yv+Efj6nLkfqNcfyE2UL93/gNbupCYAnXeGLa709dXAF9KBTr4Gxauamjd85z+ocfL27Qfw2WkgdYMZgHpbQGo+EwtDgJDmb4Y3l1kJ6uGW+Mvw5wdjPVKcji7mGEQAOtoxn4XjvwMon368TzifCqj+YQDm09E4pTMACKAB6XmB7ndBB6DeFugEBNAhkt+Qho1Ax/rDjtcHsUHDSosXbWE4ceLykOlxwXpbwMrIQML0JwMbD3GnPLAL/GMQN/3FwCvz14EB0roLoKEzKQKgXhN6fOCKK0dYnAIrMBAbJLdo4VZgGjjD8BhpSHEwA1hvi1PkX4Ck5U8GTpG/ROlj4fzPIGb4C1TgGQArvdEW+yACsN4WKL+B8h0o/xEDQPkZlK9B+ZthtBdGNwAQQAPS8wLdN+PkZAIeQoL1mECFX29fIbi1jnytNah1DhpGAp2OADpgEjTMBCrwQK3ywT4/gtzbEga2zFlxVFr4Nj8ysfwHFnS/GThF/wq8u866HmjmBgZI6+4DrdxNDgBVRpzAOALFEyheQT1k0KGf2OIKFOegCgt00jWoZwaqtEAnUnt724DFLwHNEhYWGGAfYQfovS1clRahTcq8Mn/AeoFxOtpiH2CA3NsCxSmi0kKNPkKblPkUQHH6j+HtaJzSBQAE0ID0vDKABRaopQ2qiGDDSiAaNBcCwqBC0NvHFlyJgSozfQM1BgsLPbA60HH7IHHQHAmolQ7iD8b5EfTeFq6Ki1iA1AsDt/gHWy8MFg+g+ANdRw6qoPDFFUgN+FoGYPyCGzLAig2kbj+wBw5Sd/vWwwH2ESYgt7eFCwALS3AvbLTFPnCA3N4WLsA62gujGwAIoAHpealC731BBqDWOfIcBzLbG3qcPwiACjxYhYdN7UADYntbQOAAVEvSQXuDuRcGqqzi4nxQxPDFFXJ8gyowdL0Fg+jQYGJ7W1C1JB+eOBRa7FmZ7eDeMTIANTJgt+PCbvGFxRuyelBPHDTkD7pRd7AA3L0tDEByPgUBtDgFLeoYcnPWgx0ABNCgWbAxHAC0lVUPbHWBEy8uAMooso7kD3fCemEfbrMEfH3BDMpcoIyxgWwDRwFOAO1tzQcWRAKgQg7UgMAFKIlTWIv90wMWg4/3WUAt9kZgnDaQbSANAKkNCph60HBxcVH/oKm8oL2temBvS4APmFdxxSml+RQpTh2Q4nQC2QaOAhQAEECjlRcVAAm9LaoBUIYD9wJE/w26XthwAKT0tqgJhkIvjFQAmseUGQTXtMDiFNjbCiDQ26IqgMapADBO4SuHw1Z9oYvdwxkABNBo5UUdADoCyEBQlT4VFzIAFapCmgygZdqgHgKo4kqkqwOGLwC1zgN4Zf/QreKCAVAaEtH9xfDyNLvBvz8MoI3PhnR1AA4wAek0HMhV8/jv+IOpB1VehNTSCYDjFNTbolfFBQOgOAU1bF+dZ3OAxmkjXR0wDAFAAFFlwQb6SRjkANgJDJSeizcQ5+oBW8aOQKoQmDA/fLjNyvDvD31uwgDZA7IPWHGBKq1CoDvoWnHBTkSh1pYFaqQjagHokJ3jx/ssD4DxCtqbRTe7Pz9hAVVcwPhlAA0zDYqKCwRAw4AwDKqM0E9LwaW+qjoJvEBroAEsTt9dZ/3w5jIb3fIpCHx6wMLw4jQbLE4dKTGLhW143gROKgAIIKpUXqAWFvJJGOQA2BmH2PYLEQIgPbDl9eTopwaAjmUbfn7CfOAlMJH+/IA7aEGZBiRPCOPLXCB5kD0g+0D20nssHbRqELSFAXQiBmgvF7a9e6QC0H4wEMYpjxTP9ADAMD0ApAyBYT0BVJmAKhV8gJg4xVcJguRAFeWH2ywPgIWc4WCb80IHoA3loBXDMABaeDPYATROFb+/Ydrw/Dg7w/c3zDjVUiOf/v7CBKy02EGbnUFDv1SJUyFJBTA9WBp65ADQ6mNOHsq2wwAEEMXDhrCTL0AJGcSGjW2DWmWgVUYgGrQSDZawQWpg+3ywjYODJnWRT9YAAeTTM0BioFMahKAnMoDMv3UbsqwatCcMWT+sVYhsD8yNoB4D6FQPamY46GoiR9CEMLAQwjkh/PsLuJAC9ZbwzWUYiBn+EmAXQNULyiif7rOAKi2Q/gGbAAYtaQ8Ftr7Bq0a9bTAaL+jhC0sPIACKP2Q5kFr01afgVj0wTcHE0eOZXgUldA6xEBinG4GVyvzvr5kUQPMloGXu6ABU8QDBATzGKfAr/lHAtpgHVDGC4hVYaYHis3Ewzl1OQDtEG9T7AuVDkDgobuPivXGqDx0cw4ZgAA3bQNBinDeXWedzijBjXYxDST4FAVBvC3pCB1UX3/AKiYMx8lajoQRAeRlUfkipUnYkJEAA5s5dh4AgCsOj0Cg1KtmKSER0so1Ep9iW99CqeApKiXeg3kKn0Sk0hHaUROd8s7sxcRfrcppNZs8O2f/MuUz+M/t28OJkDCjP+ZxjsuJGMwgUOB5OzIAuS8DwvKpxRLxwDD4lzkfrycXL5z660G4JMjo8+omFMpQMH6GBdTFayXyOct2ScYYIC8h+Ph0GMe5HzKfo95mD+djSiNsRElAgUEiAGUiGd4uKO7u3fSDP8+mFmj1GlredJ8nQffVj6i3YgD39WTYlnooMwwQbMKA/j4QCe0B/H+qjB6bYhqFY509MNqq4zVqSjGzG2BBOEYxsnL+d5ZOxCyZUYR2pwlokJTQaX9G7h2lXLh17jGoLTGXepQow9eP95/FIr9++On7e4vBI/58Ehq5g4ssaHUgVdouY8/I6pdrSgqkEP4LeRwg3BbeupuOh8bn/wuJ8VthC3h0SqlysvDXPUQBRNGwIm/MAVUSgjcXH0YZ0QKctgAooUGUCKrhgwBJYoOEbMwephU0IgwpFWCUE0gfKLGqqcgx64FMbHoIrNlBBCcKwHhdMP0gtCIPYyMNNIHNAe8dgZ+nRAoAqFlCiBxZOFM+Fwea2QOaAzAOZO9B7RkBxA8o0oPhHHjYGJUzQqRqgOALF+2qkYaW30EYEaIMybLMyOPNBN6CDAKjSOnH8EnhfEMgMkB1btxzBGs/0BqAWOxAXAntHjqChPUrnwmBzW6BhSQbIkNIBqjl2FBAFoHEaCIzTQNDcMaVzYbC5LWDFBZ6vpNVKUUEJeQYdWz9wA5waQ/b0AN+hBxFcvf6IwcAljIGFjbIGKEAAUdTzAp1NB6oYQPMeICArKwYulJA3n8IA8iIKUEUHF4cOJSEDkFpOLsRQH6ggA4mBe2MXxYFywMqSE/ekJbp+kPq37wZmfBhbLwwd1E7f5MAAab0dgB4rBAeDqbeFDECVDqgnDYprUEUGOjEedgQU6FBdGHByNoWzuaDxDkoXqtAeOeiwXuSVaLB0AktTIDCYNqGDADG9MOituwkMkFt3FyDLDZXe1kgC2Hph6MOI+PIpPXpb6EBKVR9Mb92yCVgW30IM4w9CACovwA1ZZg4GU6848LAnpQAggCiqvEA9HFDPCNYSvigjBnYkrLCBrfwDFUR6SAUQqMCCzXthC2xQ6xoUGaBjg0BqYEOBoOEiWI8N1BrHBUB2QVr0kO40yKyBHBtGnwtjF/iHPlPpwIAYTjoAEwSNlwMLuAGd28IFQI2BJ9CjnMA3AQDjBNRDBg0TywDTAew8Q1CDgwHphBQYAMmvgQ4rIwPYUDEo7oTB5yMeGbCGBz6AbS4MTQmID4rTA0C8ACb47TUzw+fHg3tua6QC9LkwVp7/ROVTUHwCKz0Qk+4by0EVGK+wBMOVQxvBi95A+Ql2nuhAA1CZAOrggMoAUJ4GuVXD3I3iHhcMAAQQ2ZUXeO4C2NNCHsIBBdh+6LwGCIBa2KDaFjS/BOo9wcA76CniyBUKrBADFV76+qrgAhCkBtRLi43zAdsDOuMQ1O0EFZIg87ZugVyVAlIPvhcKrE8cbJYs9BBfEAC1SGDuBJ+nB+0BILPpAWC9MGCFhPfSQhgAqjvAMIh6W8gANOwKu3cNdryTMPS6GlDDApQOkK+v4YQerAwD+rAGBtJ4vbAQMI6AGDxUCEzw78CNG3n48WDo8TwYAHIvjAGyjwgvALbMHzCM9rYGNYD1woBxBcqnBJfEASsuuvW2sAFQL8YyII3h2e2LDA+vngQP4YPLS+gRbPTsjcEqLNDiKthUDajSsrQ1p0pvCxkABBDZlRe28+hAAPkIGdAwETY12AIUpg82hASpxFBbD+BCDKkVj1z5IfQjAghbpCEPUQ3ExkmkXpgDAaWNg72AAzUgkBslIABKF9jCFTKHiZp40XvDyBUZtnQDMmMwnXkIA8i9MAJKQaegTBjtbQ1+gNQLI7QkbuJgOZoNVEmA8Od3L8GV2PFTt8ENTFCeBE3pgBqCoHlk2EptagBQ5wG20hw0ogZbwwCqqNSBvSwxeXWKl8TjAgABRLMTNtBb2jBA797OYAWEKqbBXnGNAkxARJwO6WOeRiIgFGeDpeJCBqCKA7SYAwRAFdm75w8Y3r94yLDvwGWGrVsOw9WBymJQBwO2+poYAFpQBepdoR8oAF6+LywBtNecQVBSnmYVFjIACCCaVV7YWtogMEiOiRkFo2AUjIJhD2B7wuS1zcH8P79+gCu0T29fANk/Gb58+cDw5gGwk/ngE8PvnxA5bEAIWCEhzJRkEJBTZJA1EGdgZecAr3wcCAAQQKNnGw4O8IABMgH8YEBdMQqoCUDDTgcY8G9wHQVDCzxgGOL5FLRYAlTZDFSFQ00AEECjldcgANCl1AsG2BmjgIoAGKegSouiM+xGweACo/l0cAGAABqQm5RHwSgYBaNgFIwCSgBAAI32vAYBwLf5cRQMTYBvk/IoGJpgNJ8OLgAQQERVXqBVJUPlCJIhChwYsGx+pDUYaXEKSsd8Qnz0sk6BAcsmZVqD4ycuoZxOMtwB6Ig4FdovbIMBB4YByKejADsACCCClRcHFwuDgDALw41b1+jhnkEDlNWEB9oJNAUg/420OAWlY1B6Hq7AXIOV4d3nmwz/aXNc56AEoIpLRQr3tSaDGXz//JHh7vlDA+2MIQsAAohgTubkZGVQUh3eBflIBKNxOvyAucbwrZiHIXjw/cuHxrvnDw60O4YsAAig0dQ+CkbBKBgFdAYnT59+AKQaBtgZQxoABNDoasNRMApGwSgYBUMOAATQaOU1OMADhiG++XEUYIDRTcrDDzxgGM2ngwYABNDosOEgAKObH4cfGN2kPPzAaD4dXAAggEZ7XqNgFIyCUTAKhhwACKDRntcgAKObH4cfGN2kPPzAaD4dXAAggFi+f/vN8P7t94F2x5AEv379pZZRDgyjmx+HG1BgGIBNyqOApsCBYTSfDhoAEEAsz558cgTigXbHUAWjlwqOglEwCkbBAACAAGI5efr0gYF2xCgYBaNgFIyCUUAKAAig0QUbo2AUjIJRMAqGHAAIoNHKaxSMglEwCkbBkAMAATRaeQ0O8IBhdPPjcAOjm5SHH3jAMJpPBw0ACKDRpfKDAIxufhx+YHST8vADo/l0cAGAABrteY2CUTAKRsEoGHIAIIBGe16DAIxufhx+YHST8vADo/l0cAGAAGIxNzV1GGhHDGHw4eTp09SY03BgGN38ONyAAsPoJuXhBhwYRvPpoAEAAcQiJcO3X0qGf6DdMSTB3dtvDzCMzmuMglEwCkYB3QFAALFwcrEyCApzDrQ7hiRgezg0rx8fBaNgFIyCoQ4AAmh0wcYoGAWjYBSMgiEHAAJotPIaBaNgFIyCUTDkAEAAjVZegwM8YBjd/DjcwOgm5eEHHjCM5tNBAwACaHSp/CAAo5sfhx8Y3aQ8/MBoPh1cACCARnteo2AUjIJRMAqGHAAIoNGe1yAAo5sfhx8Y3aQ8/MBoPh1cACCARntegwM4MEA2PzoMrDNGARWBAgMkTuMH2B2jgHrAgWE0nw4aABBAdO15aWoYM1iaezAoKmgyfPjwhuH+g+sM23YuZvjx4xtY3tDADkyfv3CIwckhiMHRPoihtjGGnk4cBaNgFIyCUTAEAEAA0a3nBaqwosILwRXVvIWtDPsOrgNXZiAxGDDUtwXjUTAKRsEoGAWjAB8ACCC69bwM9e0Ynr94yLBsZT9U5DqwIvsKrrwEBEQZjAxswRUcCIB6XTCQld4KrvBA+kA0qHfmBOyRCQiIAHtoh+E9N5AeDXVjMPvBw+sM+w6so5fXRsEoGAWjYBTQGQAEEN16XqDKBjY8CAMwviBQDlTZgIYRQRi54tkP7KGBKjUrCw9wJRfkn8Zw/cYZcO8NJA6qyGBAUkKeYfvOJaMV1ygYBaNgFAxzABBAdOt5gea4JCTkUMQ4OLjA9HugHC5w/cZZOBtUyYGAJbAiA2EQkABWWMgA1LsbguABw+jmx+EGRjcpDz/wgGE0nw4aABBAdKu8zl88xJBkUA0eJjx+cge4F+XlHgPuaX348JooM0AVE6i3BtIP0gfqeQ3RygoFjG5+HH5gdJPy8AOj+XRwAYAAotuwIaiyAc1bgXpbSfHV4OE+UK8KMQfGwPACWBGBhwKR5ryQAajiWrdxJnhuC2SGhLg82NxRMApGwSgYBSMLAAQQXZfKgyor5GFAdLBt5xIwhgHY3BXycnlcZoDUDtW5rtHNj8MPjG5SHn5gNJ8OLgAQQKMnbAwO4MAwekPrcAMKDKM3KQ834MBApXxqbmqqwABp3IwCMgFAAI1WXqNgFIyCUUB/oMDJI1Avpao/0O4YkuDu+YMMAAE0WnmNglEwCkbBAABOXn4GZUO7gXbGkASgygsggEbPNhwFo2AUjIJRMOQAQADRvOcFO6MQBkD7vUCnYuBbuIELNNcvAW9aHqoLM0bBKBgFo2AUUAcABBDdhg1BJ2KAAOiYKNBer96JhUTv70I2A9+G5iEMHjCMbn4cbmB0k/LwAw8YRvPpoAEAAUS3ygu2Hwu0qdjQwBZ8KC/4TEK0cwpBfND5ha2daeCNzMX5/eC9YKCeGmhvF6jnBTID1JsDHQcFEgft/QKZBdr0DDuZHrSReaj00EY3Pw4/MLpJefiB0Xw6uABAANF9wQbsPENJcXlwJXb8xA6G6zfPMgT5p4MrrmMnd4KPfgJVbqDKC6QeeYiRg50LrBYkBqrIQGzQuYegHhlI37qNs+AH/oIqOXKGJ0fBKBgFo2A4gvfAMvH75w8M3798ZPj87gXDn18/GH7//AFkvyRKPyePAHihCQsbBwOvkASQz8/AKywBZIvT2OWYACCA6F55wc4zhAH0cwpBQ4mgXpqmuglYLehuL2QAUgMWv3gIrK71RhpYHHYqB+jgXhiA9cwGOxjd/Dj8wOgm5eEHhlo+BVVM754/ZHj16CbD57cviK6g8IHvXz6AMQi8engTRU5IUp5BUEKBQUxenS6VGUAA0a3ygl13ArqMEtSbgt3nhe2cwvMXD8OHE6fNrEYx5wN0zktT3RhciYF6XiCzQGY42jPAj5saKhUXFDgwjG5SHm5AgWF0k/JwAw4MQyCfPrt9EVxhoVcuICAjI84gLMzPICMLpIX4wWwhYQhNDHjy5CXD928/Gd6+/cjw9t1Hhtu3HkLYQAyqKEEYvAcL2DOTVtVnAO1jo1VFBhBAdKu8QPNVIACqoEALL0A9LNBcFWjuyhF6zuGxEzvAakBXnoDmr0Bq0Q/e/fDxNXhoEFS5gXpsoGFHUO8MVCGChhG93GPhPbbhcGjvKBgFo2AUEAKgXtbDq6eA+CSYDQOgykpNTY5BFYhBNCcnB0X2gMwDAVWYgLcNmPr+/QfDrVuPgJXZI4aLF2+BKzOQW0AY1CNTNrQH9srksRtKJgAIIJpXXvjOHMR1TiGoIgIt2EAHyGccog8nErJrFIyCUTAKhiMA9bBuntwFH84D9aIsLPUYLCx0ie5RUQpAlaK+vhoYh4S6gHtoJ45fZjgOxJAe2SJwJaZt6weeN6MGAAig0RM2RsEoGAWjYIgCUKUF6t2AAKii8va2BVZcugPsKkgPLSRUnMHbx4Zh374zDPv2ngZXYsc3zGbQAVZgoHkxSgFAAI1WXqNgFIyCUTAEwZXDm8DzWyDg7WMLrLhsBthFmADUIwO5y8nJhGHRwq3gIcULe1eBKzBKz3UECKDR46EGB3jAMLr5cbiB0U3Kww88YBgk+RQ0VAiruOLifAZlxYUMQJVYekYw2K0gcANpmJNcABBAoz2vQQBGNz8OPzC6SXn4gcGUT0HDhSAAqgwGwzAhsQDkVtAqxa1bDjPcPX8I3AMjFwAE0GjPaxSMglEwCoYQAO3XAvVaQPNKQ6niggFQLxHUE4P1HMkFAAE02vMaBGCobX4cBYTB6Cbl4QcGSz599/wBmNY3UBsoJ1AMZGXFwEvrKQEAATTa8xocwIEBsvnRYWCdMQqoCBQYIHEaP8DuGAXUAw4MgyCf/vn1E0y/fUvZnNFAgm/fflJsBkAAEex5/fn9j+HzJ8otGopAUJhzoJ1AM/D+7feBdsKAAF4+dgYW1uHZZnvy5h/D95//B9oZdAfCfEwMQryMA+0MuoOLF24zvPX+SLe9XNQCoI3MoH1glAKAACJYeYEqrqsXX4O7eSMJgLq0rt5Dt1tOCJw58ZjBQGV4FuK4wJ2n/xk09GWGbaNk3ZGfDP+BkGd4eg8rePHuP4ORCiuDpynbQDuF7sDSUpdh5oy1DIVFURSfnEEvADqJY9GiLeDNzKBl85QAgAAias4LVHEVFEZTZNFQA1mZ7QPtBJqDCdkjK8MXTP010E6gOcgJYBlRjZIFO/8wvHo30K4YGAA6yQJUEfT3LQMvQx/sPTBQbwtU2YKOqrK00KO48gIIoJGTykfBKBgFo2CYAdBSedCZhW2t8xi2bj0y0M7BCkC9LZDbQG50dDKF7/WiFAAE0Ohqw8EBHjAMks2Po4BqYHST8vADDxgGYT4F9cBAw3Bbtx5mqD1+CXyuIehEi4EeSgQdznvixGXw0VCg0bvmliyq9g4BAmi08hoEYDBtfhwF1AGjm5SHHxjM+RQ0FFegFg1eDLFv32mG4qJ++EG5+gaqdKvIQBUWaDgQdCgvaJgQtA8tIyMY7D5qA4AAGq28RsEoGAWjYJgAVej1J7BKBIRB82KgDc0ywN6Pmqo8uPdDjcoENBz45PErhsfASgpUUYEqTtASeNAwppOTKc0rTYAAGrDKCxS4IM+CamZQIICXfb77CAxcOXjAguRv3UbdyAa6QA2kB1Szg9QjA2S9QwkMls2P1ACgCfQEd0iyOnL5H8OdZ/8YJAQZGTzMmMFioNVhO07/xdAH0nPhzj+GC3f/oYgj6x1KYDhtUt5x6i94EYiEECN4xeaRK38ZeDgg8QJb2QiKd3TgYQqJN1zxPdTAUMqnoAoKVIGAMAjAylLYXVugygZUscBWkYMqN04u/BXN928/4EvcYRuMQRUV6DJLkH6QXbD7vugBAAJowFLQO/B46CVwRQRaLQOiQZUPaNxW74kaOCBAgQ3aiAdamQIDnFzsYBqkVw/YJZZFCiyhQb7aBhk87HZUkC/d/wDKdWBAu6EVKC8AlB9yuxAX7IBUXlM2/GH48v0/uAA7cuUfQ8283wwtSazgygtUqYFWxaEDUMUFkocVeiDAwzlk9+8oMAyTm5RBlQ+s4gJVUqC4A8VTSs9Phjkl7OAKDBTv6KtXQXF35+k/nPE9FABaPnRgwMynyPl40AJYjwwZgG8/fgvpAKB3ErABUPkKGoYEgfQMsQGfUwMIoAFPUaAWARewQoK1ELwZbMEVGIwvLCyAszcFqriGWk8LlBkYIBnAgAH/nMh8oNqDwIwxgT4uoy5Yc/APw4F+SOIGtdodCkG3u7KC+aDCDtdyblAhOZKWeg8lsObQH5Sl+KBKDVQ5wfi44g1ffA9mAMx/DUDKnoFwPgXNbzYOtcYmqHcGW0Ax1MpREAAIoAGvvGATjTBwHNijQu563r71kGErknrk20FBapFbDIP9WgBgIncAUvNZOP4r/PnBeICAcgEmFoZ+oB5/IDtxKLTukAGs4gIB0LCTijSi8AK12pGHmQyUmeCFG2jocAEDQg7UCwNVaKNg4AFyzwrUCwPFI3LcIMcp+lAxrvgejACY50ANy/nA/Gfw7w+kh4UPAPNzATA/BwD1BQLz6ejqUjoBgAAa8MoLBkBjsWtW74FfIw0DoK4qaDgRBrigw4YgAKrkZOk4xkougPW2gJmhgE/xDwMbzz+GV+cJbxAW0f3F8PMDk8PH+yzngWY0DrVeGKiAm7LhN5iNXPCBhpNABRgMIBeA4J4XktwQHjYcluDLdwZwnIIaGS1JbChxhyve8MX3YAPQ3lY9PzCfsgsQl0+FNH8z/PrCpPAJkU8baO3OUcDAABBAdK28QJN9oIUWyJUTCIAqLdD4K+gUD/R9AEN92BDW2wJmBAVQIge20kAVEtH6+RT+MHCK/BN4c5l10PbCQCdXoM93gOY5YPMj6K3s0WHDwQ9Ac5agXq+KNKKiAfWgQHENmtOsiGTF0DOUhw1hvS1Wnv8GwsB8ygpsYJKST3llQPn0L8O766z1SPl0tBdGQwAQQHStvEATfKAeFuxcK1U1efiSTtCu63fQCUTQogzY0CFowcZtpKPzkeUeox3uKIQ0hjvQAL23BUrceMADBjybH0EZSdz0FwOwZefw+QnzoOuFwRZhgBZowAopUOs8JwBSwIFa6SAAkwO13mFiMACTA5mFLAdqtSMXoEMIDOlNyqC4BK0qfPGOCRxfoGFfUJyChgJBDQxYHIHEYSsO0eMUNlSML74HAwDmpwIg1Q/qbYEai3jAAwY8+RTUMBUz/MXw+QmLwWgvjPYAIIDoWnmBKhZQ7wq06xp2kRqo8gLtCEeeuwIthwfJg4YLQadfYZOzsNADL5VHllNjkBsUlRe23hYWoAAdogDm7n4QeRAklgITg6xWgwMmlv8MAqq/GThF/woAW3eDqhcGWnEGmtcCAdBQEgiACjnQMnlkAFtubaPLhLEkHiQHGlq6wIC6XB40d6IiPfSWyg/1TcqgnhUoTkFxCFolCu49AePnxfv/qPEDjE9QAyPBgwVzmwNQDl98DzQArRRkgPS2HGC9LSyApHwKAqO9MPoAgACi+5wXqHJBXliBzkcG2JZ3wsBgvUEUmFj7CfW2mIGVGbCVp8CAWHaLUx06AI3DD7ZeGKhgC7FHrWBw7eMBFWa45MAV2CAo1EYBBKDvr8O33w7fvq3BuKcL2tsCzW0J4OptUZJPYb2wTw9YDD6O9sJoAgACaPClqiEKYGPmwMrFAE9vCwxAcgSGJ/CCwdwLGwUQMJw2KQ8nQGRvCwwozacgAJ2zZng72gujOgAIoNFmLhUAaFgB2Ns6L6D6xwDU2sJXcVETwHphvDJ/HYBcUOsugS4WjwJigALD6E3KgwpA88d5UH6RMP2Jt+KiJgDZA7IP2IsDNXDPP0QMOY4CCgBAAI1WXtQBF/79Yfjw8z0Tw78/9F9c8OcH3M4htUlyFIwCOoMHQPzh1xdG5DxDFwAqF/79Btv5gWE0n1IFAATQgFReoEUaoPtdQKcfv32LOJ8QfF4h9MxD5BWGgx3Il+7fAKQUv79h2vD8ODvD9zf0WWAAsgdiHxPYfqg7aAZAS99heM3Bv+BVZCAAPq/wFOb5dbgASC366rNRMDAAFBfI8QqKSxjAdl4hLgCKT1LSwEAAYP44AKQMf35gmvDyNDtoVSBd7AUtuX95mg1oHzPY/oGeox4uACCA6F55gSoo0G2aMjJi4MUaIDZIDCx34hL8rC1ywEDefgw6GgaIA4E9sMA3l1k/vLnMhrMX9vsLE3jzIyEMUocNgMwFmQ+yB2QfyF56HE0DOr8OfDoCdMMp7GZiXIftwgCoYIOpBbHXHPo7qDeqjiQAijfQIbugOFWRYgLHE6wCA8U3PgA58gsCQPqQT1EZrACaTwuB+cbxw22WB6B8hqsXRo18+uE2K0jNB6AdhUB7HUfnpakHAAKI7gs2QOcWVlUnwQ91BJ1KvHr1HpyrB0F7wJ48ecWgr68K398F6pWB9nuBTjbmApoDO2UeBED0QK5EBPV+HnY7HgD2huYDe0UBoMUboGWzyACYcUCtMdCkbSGIf4TdJf4jk2AC/7/3C2x+7lkIVdYPVGeAbj6ot/XuOivIDFAvK5He56khzrFjgJ+egQxgp46DAOxoJ1ABCdu/BWKD9hDBCkjwoa9oJ8fDjpMCqQPpB6kFYVBPD6TuyOW/cDZsj9EoIB+A9tHB4nXNIUaMY5/g+/h+/Icf7QTrZSH3tkDnHEoIMcPFkOMHJGajC4k7kP6BjlNQLwyYT0G9sHpgLwzr6mBK8imotwXKp9Bj4EYXU9EAAAQQXZtKoEoH1NtCPo0YxEa/Fhq0dwuEJ/QvBQ8jgk+b33IEXJHB5EGncoBO2IBdfCYDO9ofSg8kILIXBlJzAIRvsOoefM4sA6ZhYgxo4+ID1dtCB7DhJdAp8SH2qG0fUAEHqtCQW/GgygzEBu0FAhWIMDao4AKZAeKD9g7BemYwO0CHwIIATB0IgArPiOaf8OHKjuWYlecgAkNmkzKoAQEKc8hNAKh7sGDhDzu2CzZkDOtlgWgYG6QGdNI8qPIBYRAbFlcgO2CNncESp0T2wkjOp6O9LfoAgAAatEvlQQfygiqu799/gisrUE9r/77T8CP5QadzgPaAga9NefcR3tui530yhAAxvTAQIHRD60D3tpABbMjQRgfz5AvQZlQeTsh1GaAKCQRAvSeQOp4rkMINxgYVZrCjo0D6Cu5AKzppSMUGO34I1FsDiYFa5OD7voAYtqcMUhhiHlM0GMBQ2qQMakDA4hL96hJQnIHiAtxzhm40BlU4MPXIaQAkD4on+IG87yFzobD4AvXEQfE92OKUmF4YCBDKp6O9LfoCgACia+UF6hU9fvwKfPkkrPcFqqBAPazmliwM9SA1sEN5v8mIMXz/9pOezqUKgFY0gcDMEQDsNc3nFGEW4JYkbmIb1tsCVn4gMxJpvSCDGIBvEzGo5Q4CNjpM8EJqFAx+gDxsiA5AvWlQLxi00dhGZ+iddEIsgObTQmA+3Qjshc3//ppJgZR8CuptfX7CDDJjwA8NGCkAIIDofrZhaKgL+PJJbx/IqRqg4UD0g3pBANSzungBcusnaKiR2Lks0OG/g6n3BQPIvTAgDkCWw3VDK7CyA1ED3tsiFoBa57CWOGRuiwE+fwJjwwDswkoQDTtGaoieYYgVDJdNyqA4g50QD5rTAjVIkOfDYL1lEAixYwEPFYLmMEEA1OsCHR02lAByLwyIC5DlcOVT6KgIiD/a26IjAAjA3hmdAAjDQDSjOIQDiBuIQ+iv84p/ziH2tZzEIuKXVDAgFCy2GDTetd69ThtSgEBgspEexv7QI0SvMFqgWEJbbVuHAjZHahBzSklFeYsU3+Zaa0B2JRYvwqMwO/+82ljm0GqJS+9KQFsK9OuugpcZlBAL8nEb/LLFr3QOmRVyXoVM9BGaedqw4VXp/Tjqn7fv5lNIVPYBJ+U7vzTuL3Qe61fkFHoR7UqtR9Imv2hP0pd+XudSLsv5OKXn1KMwe/CchsI1/Wjr/dgF0ICkFFDlgq2CgfWskA/XxdbbQj7vEJkNmw8b7ABaIeGtlEALMujkHKIBvvMKYfMc6Gccwg7VRRaHqcV1ziGyGLLZyGx87hkFxANizitEVwMTB81VoothO+cS3YyhEqfQBRkHCKihez7lFRqcjXNSwLfvPwgrIgAAAmjwb8wYBaNgFIyCUQAHQpLyYBq2PWgoAtAqcTF5dYrMAAig0cprFIyCUTAKhhBgYeNgkNc2B++Z/U6FHgy9AWjLFKjiBfmBEgAQQKOV1ygYBaNgFAwxoGxox/DrPwd48dtQqsBAFdeMGWvBFZeghDxFZgEE0GjlNTjAAwY8N7SOgiEJhswm5VFANHjAMEjyKaj3ZeoVx/DxGwNDTfX0IXEWLOg82/7+pQyCMuoM6uZuFJsHEECDZ3Z0BANCmx9HwdADQ2mT8iggDgy2fAqrwK4c3gSuFEBH7Xl72+K8wHegAGiIEDTECdr2pGxoD+41UgMABNBo5TUKRsEoGAVDFIAqMAPnMIZXD28y3Dy5C16JgbYd6RuoohzFR08AqqhOnLgMrLgugdmgRSa2YXEMnDwCVLMDIICIqrxAe7IG8sT24Q5wbX6kNUA+FXykABMR+tgzUJuUkc+IHCnAy4yNsCIqgIHKp8QA0Mo9EH52+yLDszsXGRYt2sLAsAiyfQjUEwNVaLTe/woaugTtyQUdLgE6LAJUsYLcZGlrTpPl/QABRLDyEhTmZHD1Hhr7p4YwcGDA3PxIUzAapzQHCgx03qScFzB6xD6NgQMDnfMpqUBKVR+Mv3/5AO6NPX50k+HixT1weVglxsmFOHqPlGFGUC8KdG0VaJ8W6LaPt28/gA+GAFVWIACrsHSAFRaIBvFpBQACaHTYcBSMglEwCoYZAA3PgVb0wZajv3/xkOHT2xcMn9+9ZLhw/RWQ/ZJh65bDWPWCKjcuLsixXrCzaHHZwcnLD+xVKTDoKJozCErKU3VYkBAACKDRymsUjIJRMAqGOQAtS8e2NB1Umf35BamcQJXbn1+Qw89hRxJLaSiCaU4efmBFBamYOEBsOlZSuABAAI1WXqNgFIyCUTBCAfJcFKX7rugNAAJodJ/XKBgFo2AUjIIhBwACaLTyGhzgAcMg2fw4CqgGRjcpDz/wgGE0nw4aABBAo8OGgwAMts2Po4ByMLpJefiB0Xw6uABAAI32vEbBKBgFo2AUDDkAEEAsL59/PvDl88jb2EgN8PH9d6oMCVF78yPIXZfOPafUmBEJvn75SRVzaLBJ+cG8nT8OUMGcEQe+fAff4E3xTeTUzqfvnj9k2DWvmVJjRiwACCCWvfuOjg5tDDxwYKDi5seDh48XUmrGKKAYKDBQcZPyydOnF5w8PTpkNcDAgYFK+RQYnyD92K+wHgVEAYAAGh02HAWjYBSMglEw5ABAAI1WXqNgFIyCUTAKhhwACKDRymsUjIJRMApGwZADAAE0WnmNglEwCkbBKBhyACDAAOt5Kbwg2PMvAAAAAElFTkSuQmCC" alt="Jakarta EE Application Mode"></span></p>
</div>
<div class="paragraph">
<p>Moderately complex enterprise applications can be developed entirely
using servlets and JSP technology. More complex business applications
often use Enterprise JavaBeans (EJB) components. The Eclipse GlassFish
integrates the Web and EJB containers in a single process. Local access
to EJB components from servlets is very efficient. However, some
application deployments may require EJB components to execute in a
separate process; and be accessible from standalone client applications
as well as servlets. Based on the application architecture, the server
administrator can employ the Eclipse GlassFish in multiple tiers, or
simply host both the presentation and business logic on a single tier.</p>
</div>
<div class="paragraph">
<p>It is important to understand the application architecture before
designing a new Eclipse GlassFish deployment, and when deploying a new
business application to an existing application server deployment.</p>
</div>
</div>
<div class="sect3">
<h4 id="security-requirements"><a class="anchor" href="#security-requirements"></a>Security Requirements</h4>
<div class="paragraph">
<p>Most business applications require security. This section discusses
security considerations and decisions.</p>
</div>
<div class="sect4">
<h5 id="user-authentication-and-authorization"><a class="anchor" href="#user-authentication-and-authorization"></a>User Authentication and Authorization</h5>
<div class="paragraph">
<p>Application users must be authenticated. The Eclipse GlassFish provides a
number of choices for user authentication, including file-based,
administration, LDAP, certificate, JDBC, digest, PAM, Solaris, and
custom realms.</p>
</div>
<div class="paragraph">
<p>The default file based security realm is suitable for developer
environments, where new applications are developed and tested. At
deployment time, the server administrator can choose between the
Lighweight Directory Access Protocol (LDAP) or Solaris security realms.
Many large enterprises use LDAP-based directory servers to maintain
employee and customer profiles. Small to medium enterprises that do not
already use a directory server may find it advantageous to leverage
investment in Solaris security infrastructure.</p>
</div>
<div class="paragraph">
<p>For more information on security realms, see
"<a href="security-guide.html#administering-authentication-realms">Administering Authentication Realms</a>" in Eclipse GlassFish Security Guide.</p>
</div>
<div class="paragraph">
<p>The type of authentication mechanism chosen may require additional
hardware for the deployment. Typically a directory server executes on a
separate server, and may also require a backup for replication and high
availability. Refer to the
<a href="https://www.oracle.com/us/products/middleware/identity-management/oracle-directory-services/index.html">Oracle
Java System Directory Server</a>
(<code><a href="https://www.oracle.com/us/products/middleware/identity-management/oracle-directory-services/index.html" class="bare">https://www.oracle.com/us/products/middleware/identity-management/oracle-directory-services/index.html</a></code>)
documentation for more information on deployment, sizing, and
availability guidelines.</p>
</div>
<div class="paragraph">
<p>An authenticated user&#8217;s access to application functions may also need
authorization checks. If the application uses the role-based Jakarta EE
authorization checks, the application server performs some additional
checking, which incurs additional overheads. When you perform capacity
planning, you must take this additional overhead into account.</p>
</div>
</div>
<div class="sect4">
<h5 id="encryption"><a class="anchor" href="#encryption"></a>Encryption</h5>
<div class="paragraph">
<p>For security reasons, sensitive user inputs and application output must
be encrypted. Most business-oriented web applications encrypt all or
some of the communication flow between the browser and Eclipse GlassFish.
Online shopping applications encrypt traffic when the user is completing
a purchase or supplying private data. Portal applications such as news
and media typically do not employ encryption. Secure Sockets Layer (SSL)
is the most common security framework, and is supported by many browsers
and application servers.</p>
</div>
<div class="paragraph">
<p>The Eclipse GlassFish supports SSL 2.0 and 3.0 and contains software
support for various cipher suites. It also supports integration of
hardware encryption cards for even higher performance. Security
considerations, particularly when using the integrated software
encryption, will impact hardware sizing and capacity planning.</p>
</div>
<div class="paragraph">
<p>Consider the following when assessing the encryption needs for a deployment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What is the nature of the applications with respect to security? Do
they encrypt all or only a part of the application inputs and output?
What percentage of the information needs to be securely transmitted?</p>
</li>
<li>
<p>Are the applications going to be deployed on an application server
that is directly connected to the Internet? Will a web server exist in a
demilitarized zone (DMZ) separate from the application server tier and
backend enterprise systems?</p>
<div class="paragraph">
<p>A DMZ-style deployment is recommended for high security. It is also
useful when the application has a significant amount of static text and
image content and some business logic that executes on the Eclipse GlassFish, behind the most secure firewall. Eclipse GlassFish provides
secure reverse proxy plugins to enable integration with popular web
servers. The Eclipse GlassFish can also be deployed and used as a web
server in DMZ.</p>
</div>
</li>
<li>
<p>Is encryption required between the web servers in the DMZ and
application servers in the next tier? The reverse proxy plugins supplied
with Eclipse GlassFish support SSL encryption between the web server and
application server tier. If SSL is enabled, hardware capacity planning
must be take into account the encryption policy and mechanisms.</p>
</li>
<li>
<p>If software encryption is to be employed:</p>
<div class="ulist">
<ul>
<li>
<p>What is the expected performance overhead for every tier in the
system, given the security requirements?</p>
</li>
<li>
<p>What are the performance and throughput characteristics of various
choices?</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information on how to encrypt the communication between web servers
and Eclipse GlassFish, see "<a href="security-guide.html#administering-message-security">Administering Message
Security</a>" in Eclipse GlassFish Security Guide.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="high-availability-clustering-load-balancing-and-failover"><a class="anchor" href="#high-availability-clustering-load-balancing-and-failover"></a>High Availability Clustering, Load Balancing, and Failover</h4>
<div class="paragraph">
<p>Eclipse GlassFish 7 enables multiple Eclipse GlassFish instances to be
clustered to provide high availability through failure protection,
scalability, and load balancing.</p>
</div>
<div class="paragraph">
<p>High availability applications and services provide their functionality
continuously, regardless of hardware and software failures. To make such
reliability possible, Eclipse GlassFish 7 provides mechanisms for
maintaining application state data between clustered Eclipse GlassFish
instances. Application state data, such as HTTP session data, stateful
EJB sessions, and dynamic cache information, is replicated in real time
across server instances. If any one server instance goes down, the
session state is available to the next failover server, resulting in
minimum application downtime and enhanced transactional security.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish provides the following high availability features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>High Availability Session Persistence</p>
</li>
<li>
<p>High Availability Java Message Service</p>
</li>
<li>
<p>RMI-IIOP Load Balancing and Failover</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#tuning-high-availability-persistence">Tuning High Availability Persistence</a> for
high availability persistence tuning recommendations.</p>
</div>
<div class="paragraph">
<p>See the <a href="ha-administration-guide.html#GSHAG">Eclipse GlassFish High
Availability Administration Guide</a> for complete information about
configuring high availability clustering, load balancing, and failover
features in Eclipse GlassFish 7.</p>
</div>
</div>
<div class="sect3">
<h4 id="hardware-resources"><a class="anchor" href="#hardware-resources"></a>Hardware Resources</h4>
<div class="paragraph">
<p>The type and quantity of hardware resources available greatly influence
performance tuning and site planning.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish provides excellent vertical scalability. It can scale
to efficiently utilize multiple high-performance CPUs, using just one
application server process. A smaller number of application server
instances makes maintenance easier and administration less expensive.
Also, deploying several related applications on fewer application
servers can improve performance, due to better data locality, and reuse
of cached data between co-located applications. Such servers must also
contain large amounts of memory, disk space, and network capacity to
cope with increased load.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish can also be deployed on large "farms" of relatively
modest hardware units. Business applications can be partitioned across
various server instances. Using one or more external load balancers can
efficiently spread user access across all the application server
instances. A horizontal scaling approach may improve availability, lower
hardware costs and is suitable for some types of applications. However,
this approach requires administration of more application server
instances and hardware nodes.</p>
</div>
</div>
<div class="sect3">
<h4 id="administration"><a class="anchor" href="#administration"></a>Administration</h4>
<div class="paragraph">
<p>A single Eclipse GlassFish installation on a server can encompass
multiple instances. A group of one or more instances that are
administered by a single Administration Server is called a domain.
Grouping server instances into domains permits different people to
independently administer the groups.</p>
</div>
<div class="paragraph">
<p>You can use a single-instance domain to create a "sandbox" for a
particular developer and environment. In this scenario, each developer
administers his or her own application server, without interfering with
other application server domains. A small development group may choose
to create multiple instances in a shared administrative domain for
collaborative development.</p>
</div>
<div class="paragraph">
<p>In a deployment environment, an administrator can create domains based
on application and business function. For example, internal Human
Resources applications may be hosted on one or more servers in one
Administrative domain, while external customer applications are hosted
on several administrative domains in a server farm.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish supports virtual server capability for web
applications. For example, a web application hosting service provider
can host different URL domains on a single Eclipse GlassFish process for
efficient administration.</p>
</div>
<div class="paragraph">
<p>For detailed information on administration, see the
<a href="administration-guide.html#GSADG">Eclipse GlassFish Administration Guide</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="general-tuning-concepts"><a class="anchor" href="#general-tuning-concepts"></a>General Tuning Concepts</h3>
<div class="paragraph">
<p>Some key concepts that affect performance tuning are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User load</p>
</li>
<li>
<p>Application scalability</p>
</li>
<li>
<p>Margins of safety</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table describes these concepts, and how they are measured
in practice. The left most column describes the general concept, the
second column gives the practical ramifications of the concept, the
third column describes the measurements, and the right most column
describes the value sources.</p>
</div>
<div id="gacmp" class="paragraph">
<p>Table 1-2 Factors That Affect Performance</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 13%;">
<col style="width: 26%;">
<col style="width: 47%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Concept</th>
<th class="tableblock halign-left valign-top">In practice</th>
<th class="tableblock halign-left valign-top">Measurement</th>
<th class="tableblock halign-left valign-top">Value sources</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concurrent sessions at peak load</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Transactions Per Minute (TPM)</p>
</div>
<div class="paragraph">
<p>Web Interactions Per Second (WIPS)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Max. number of concurrent users) * (expected response time) / (time
between clicks)</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>(100 users * 2 sec) / 10 sec = 20</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction rate measured on one CPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TPM or WIPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Measured from workload benchmark. Perform at each tier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertical scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Increase in performance from additional CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage gain per additional CPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on curve fitting from benchmark.
Perform tests while gradually increasing the number of CPUs.
Identify the "knee" of the curve, where additional CPUs are providing
uneconomical gains in performance. Requires tuning as described in this
guide. Perform at each tier and iterate if necessary. Stop here if this
meets performance requirements.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Horizontal scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Increase in performance from additional servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage gain per additional server process and/or hardware node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use a well-tuned single application server instance, as in previous step.
Measure how much each additional server instance and hardware node
improves performance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Safety Margins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High availability requirements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the system must cope with failures, size the system to meet
performance requirements assuming that one or more application server
instances are non functional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Different equations used if high availability is required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Excess capacity for unexpected peaks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It is desirable to operate a
server at less than its benchmarked peak, for some safety margin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80% system capacity utilization at peak loads may work for most installations.
Measure your deployment under real and simulated peak loads.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="capacity-planning"><a class="anchor" href="#capacity-planning"></a>Capacity Planning</h4>
<div class="paragraph">
<p>The previous discussion guides you towards defining a deployment
architecture. However, you determine the actual size of the deployment
by a process called capacity planning. Capacity planning enables you to
predict:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The performance capacity of a particular hardware configuration.</p>
</li>
<li>
<p>The hardware resources required to sustain specified application load
and performance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can estimate these values through careful performance benchmarking,
using an application with realistic data sets and workloads.</p>
</div>
<div class="sect4">
<h5 id="to-determine-capacity"><a class="anchor" href="#to-determine-capacity"></a>To Determine Capacity</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine performance on a single CPU.</p>
<div class="paragraph">
<p>First determine the largest load that a single processor can sustain.
You can obtain this figure by measuring the performance of the
application on a single-processor machine. Either leverage the
performance numbers of an existing application with similar processing
characteristics or, ideally, use the actual application and workload in
a testing environment. Make sure that the application and data resources
are tiered exactly as they would be in the final deployment.</p>
</div>
</li>
<li>
<p><a id="CEGHGCGI"></a>
Determine vertical scalability.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Determine how much additional performance you gain when you add
processors. That is, you are indirectly measuring the amount of shared
resource contention that occurs on the server for a specific workload.
Either obtain this information based on additional load testing of the
application on a multiprocessor system, or leverage existing information
from a similar application that has already been load tested.</p>
</div>
<div class="paragraph">
<p>Running a series of performance tests on one to eight CPUs, in
incremental steps, generally provides a sense of the vertical
scalability characteristics of the system. Be sure to properly tune the
application, Eclipse GlassFish, backend database resources, and operating
system so that they do not skew the results.
3. Determine horizontal scalability.</p>
</div>
<div class="paragraph">
<p>+
If sufficiently powerful hardware resources are available, a single
hardware node may meet the performance requirements. However for better
availability, you can cluster two or more systems. Employing external
load balancers and workload simulation, determine the performance
benefits of replicating one well-tuned application server node, as
determined in step <a href="#CEGHGCGI">2</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="user-expectations"><a class="anchor" href="#user-expectations"></a>User Expectations</h4>
<div class="paragraph">
<p>Application end-users generally have some performance expectations.
Often you can numerically quantify them. To ensure that customer needs
are met, you must understand these expectations clearly, and use them in
capacity planning.</p>
</div>
<div class="paragraph">
<p>Consider the following questions regarding performance expectations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What do users expect the average response times to be for various
interactions with the application? What are the most frequent
interactions? Are there any extremely time-critical interactions? What
is the length of each transaction, including think time? In many cases,
you may need to perform empirical user studies to get good estimates.</p>
</li>
<li>
<p>What are the anticipated steady-state and peak user loads? Are there
are any particular times of the day, week, or year when you observe or
expect to observe load peaks? While there may be several million
registered customers for an online business, at any one time only a
fraction of them are logged in and performing business transactions. A
common mistake during capacity planning is to use the total size of
customer population as the basis and not the average and peak numbers
for concurrent users. The number of concurrent users also may exhibit
patterns over time.</p>
</li>
<li>
<p>What is the average and peak amount of data transferred per request?
This value is also application-specific. Good estimates for content
size, combined with other usage patterns, will help you anticipate
network capacity needs.</p>
</li>
<li>
<p>What is the expected growth in user load over the next year? Planning
ahead for the future will help avoid crisis situations and system
downtimes for upgrades.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="overview-further-information"><a class="anchor" href="#overview-further-information"></a>Further Information</h3>
<div class="ulist">
<ul>
<li>
<p>For more information on Java performance, see
<a href="http://java.sun.com/docs/performance">Java Performance Documentation</a>
(<code><a href="http://java.sun.com/docs/performance" class="bare">http://java.sun.com/docs/performance</a></code>) and
<a href="http://java.sun.com/blueprints/performance/index.html">Java Performance
BluePrints</a> (<code><a href="http://java.sun.com/blueprints/performance/index.html" class="bare">http://java.sun.com/blueprints/performance/index.html</a></code>).</p>
</li>
<li>
<p>For more information about performance tuning for high availability
configurations, see the <a href="ha-administration-guide.html#GSHAG">Eclipse GlassFish
High Availability Administration Guide</a>.</p>
</li>
<li>
<p>For complete information about using the Performance Tuning features
available through the Eclipse GlassFish Administration Console, refer to
the Administration Console online help.</p>
</li>
<li>
<p>For details on optimizing EJB components, see
<a href="http://java.sun.com/developer/technicalArticles/ebeans/sevenrules/">Seven
Rules for Optimizing Entity Beans</a>
(<code><a href="http://java.sun.com/developer/technicalArticles/ebeans/sevenrules/" class="bare">http://java.sun.com/developer/technicalArticles/ebeans/sevenrules/</a></code>)</p>
</li>
<li>
<p>For details on profiling,
see "<a href="application-development-guide.html#profiling-tools">
Profiling Tools</a>" in Eclipse GlassFish Application Development Guide.</p>
</li>
<li>
<p>To view a demonstration video showing how to use the Eclipse GlassFish Performance Tuner,
see the <a href="http://www.youtube.com/watch?v=FavsE2pzAjc">
Oracle GlassFish 3.1 - Performance Tuner demo</a>.</p>
</li>
<li>
<p>To find additional Performance Tuning development information, see the
<a href="http://blogs.oracle.com/jenblog/entry/performance_tuner_in_oracle_glassfish">
Performance Tuner in Oracle GlassFish 3.1</a> blog.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tuning-your-application"><a class="anchor" href="#tuning-your-application"></a>2 Tuning Your Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter provides information on tuning applications for maximum
performance. A complete guide to writing high performance Java and Java
EE applications is beyond the scope of this document.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#java-programming-guidelines">Java Programming Guidelines</a></p>
</li>
<li>
<p><a href="#java-server-page-and-servlet-tuning">Java Server Page and Servlet Tuning</a></p>
</li>
<li>
<p><a href="#ejb-performance-tuning">EJB Performance Tuning</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="java-programming-guidelines"><a class="anchor" href="#java-programming-guidelines"></a>Java Programming Guidelines</h3>
<div class="paragraph">
<p>This section covers issues related to Java coding and performance. The
guidelines outlined are not specific to Eclipse GlassFish, but are
general rules that are useful in many situations.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#avoid-serialization-and-deserialization">Avoid Serialization and Deserialization</a></p>
</li>
<li>
<p><a href="#use-stringbuilder-to-concatenate-strings">Use <code>StringBuilder</code> to Concatenate Strings</a></p>
</li>
<li>
<p><a href="#assign-null-to-variables-that-are-no-longer-needed">Assign null to Variables That Are No Longer Needed</a></p>
</li>
<li>
<p><a href="#declare-methods-as-final-only-if-necessary">Declare Methods as final Only If Necessary</a></p>
</li>
<li>
<p><a href="#declare-constants-as-static-final">Declare Constants as static final</a></p>
</li>
<li>
<p><a href="#avoid-finalizers">Avoid Finalizers</a></p>
</li>
<li>
<p><a href="#declare-method-arguments-final">Declare Method Arguments final</a></p>
</li>
<li>
<p><a href="#synchronize-only-when-necessary">Synchronize Only When Necessary</a></p>
</li>
<li>
<p><a href="#use-datahandlers-for-soap-attachments">Use DataHandlers for SOAP Attachments</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="avoid-serialization-and-deserialization"><a class="anchor" href="#avoid-serialization-and-deserialization"></a>Avoid Serialization and Deserialization</h4>
<div class="paragraph">
<p>Serialization and deserialization of objects is a CPU-intensive
procedure and is likely to slow down your application. Use the
<code>transient</code> keyword to reduce the amount of data serialized.
Additionally, customized <code>readObject()</code> and <code>writeObject()</code> methods may
be beneficial in some cases.</p>
</div>
</div>
<div class="sect3">
<h4 id="use-stringbuilder-to-concatenate-strings"><a class="anchor" href="#use-stringbuilder-to-concatenate-strings"></a>Use <code>StringBuilder</code> to Concatenate Strings</h4>
<div class="paragraph">
<p>To improve performance, instead of using string concatenation, use
<code>StringBuilder.append()</code>.</p>
</div>
<div class="paragraph">
<p>String objects are immutable - that is, they never change after
creation. For example, consider the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> str = <span class="string"><span class="delimiter">&quot;</span><span class="content">testing</span><span class="delimiter">&quot;</span></span>;
str = str + <span class="string"><span class="delimiter">&quot;</span><span class="content">abc</span><span class="delimiter">&quot;</span></span>;
str = str + <span class="string"><span class="delimiter">&quot;</span><span class="content">def</span><span class="delimiter">&quot;</span></span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The compiler translates this code as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> str = <span class="string"><span class="delimiter">&quot;</span><span class="content">testing</span><span class="delimiter">&quot;</span></span>;
<span class="predefined-type">StringBuilder</span> tmp = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>(str);
tmp.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">abc</span><span class="delimiter">&quot;</span></span>);
str = tmp.toString();
StringBulder tmp = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>(str);
tmp.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">def</span><span class="delimiter">&quot;</span></span>);
str = tmp.toString();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This copying is inherently expensive and overusing it can reduce
performance significantly. You are far better off writing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">StringBuilder</span> tmp = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>(<span class="integer">16</span>);
tmp.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">testing</span><span class="delimiter">&quot;</span></span>);
tmp.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">abc</span><span class="delimiter">&quot;</span></span>);
tmp.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">def</span><span class="delimiter">&quot;</span></span>);
<span class="predefined-type">String</span> str = tmp.toString();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="assign-null-to-variables-that-are-no-longer-needed"><a class="anchor" href="#assign-null-to-variables-that-are-no-longer-needed"></a>Assign null to Variables That Are No Longer Needed</h4>
<div class="paragraph">
<p>Explicitly assigning a null value to variables that are no longer needed
helps the garbage collector to identify the parts of memory that can be
safely reclaimed. Although Java provides memory management, it does not
prevent memory leaks or using excessive amounts of memory.</p>
</div>
<div class="paragraph">
<p>An application may induce memory leaks by not releasing object
references. Doing so prevents the Java garbage collector from reclaiming
those objects, and results in increasing amounts of memory being used.
Explicitly nullifying references to variables after their use allows the
garbage collector to reclaim memory.</p>
</div>
<div class="paragraph">
<p>One way to detect memory leaks is to employ profiling tools and take
memory snapshots after each transaction. A leak-free application in
steady state will show a steady active heap memory after garbage
collections.</p>
</div>
</div>
<div class="sect3">
<h4 id="declare-methods-as-final-only-if-necessary"><a class="anchor" href="#declare-methods-as-final-only-if-necessary"></a>Declare Methods as final Only If Necessary</h4>
<div class="paragraph">
<p>Modern optimizing dynamic compilers can perform inlining and other
inter-procedural optimizations, even if Java methods are not declared
<code>final</code>. Use the keyword <code>final</code> as it was originally intended: for
program architecture reasons and maintainability.</p>
</div>
<div class="paragraph">
<p>Only if you are absolutely certain that a method must not be overridden,
use the <code>final</code> keyword.</p>
</div>
</div>
<div class="sect3">
<h4 id="declare-constants-as-static-final"><a class="anchor" href="#declare-constants-as-static-final"></a>Declare Constants as static final</h4>
<div class="paragraph">
<p>The dynamic compiler can perform some constant folding optimizations
easily, when you declare constants as <code>static final</code> variables.</p>
</div>
</div>
<div class="sect3">
<h4 id="avoid-finalizers"><a class="anchor" href="#avoid-finalizers"></a>Avoid Finalizers</h4>
<div class="paragraph">
<p>Adding finalizers to code makes the garbage collector more expensive and
unpredictable. The virtual machine does not guarantee the time at which
finalizers are run. Finalizers may not always be executed, before the
program exits. Releasing critical resources in <code>finalize()</code> methods may
lead to unpredictable application behavior.</p>
</div>
</div>
<div class="sect3">
<h4 id="declare-method-arguments-final"><a class="anchor" href="#declare-method-arguments-final"></a>Declare Method Arguments final</h4>
<div class="paragraph">
<p>Declare method arguments <code>final</code> if they are not modified in the method.
In general, declare all variables <code>final</code> if they are not modified after
being initialized or set to some value.</p>
</div>
</div>
<div class="sect3">
<h4 id="synchronize-only-when-necessary"><a class="anchor" href="#synchronize-only-when-necessary"></a>Synchronize Only When Necessary</h4>
<div class="paragraph">
<p>Do not synchronize code blocks or methods unless synchronization is
required. Keep synchronized blocks or methods as short as possible to
avoid scalability bottlenecks. Use the Java Collections Framework for
unsynchronized data structures instead of more expensive alternatives
such as <code>java.util.HashTable</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="use-datahandlers-for-soap-attachments"><a class="anchor" href="#use-datahandlers-for-soap-attachments"></a>Use DataHandlers for SOAP Attachments</h4>
<div class="paragraph">
<p>Using a <code>javax.activation.DataHandler</code> for a SOAP attachment will
improve performance.</p>
</div>
<div class="paragraph">
<p>JAX-RPC specifies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A mapping of certain MIME types to Java types.</p>
</li>
<li>
<p>Any MIME type is mappable to a <code>javax.activation.DataHandler</code> .</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a result, send an attachment (<code>.gif</code> or XML document) as a SOAP
attachment to an RPC style web service by utilizing the Java type
mappings. When passing in any of the mandated Java type mappings
(appropriate for the attachment&#8217;s MIME type) as an argument for the web
service, the JAX-RPC runtime handles these as SOAP attachments.</p>
</div>
<div class="paragraph">
<p>For example, to send out an <code>image/gif</code> attachment, use
<code>java.awt.Image</code>, or create a <code>DataHandler</code> wrapper over your image. The
advantages of using the wrapper are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reduced coding: You can reuse generic attachment code to handle the
attachments because the <code>DataHandler</code> determines the content type of the
contained data automatically. This feature is especially useful when
using a document style service. Since the content is known at runtime,
there is no need to make calls to
<code>attachment.setContent(stringContent, "image/gif")</code>, for example.</p>
</li>
<li>
<p>Improved Performance: Informal tests have shown that using
<code>DataHandler</code> wrappers doubles throughput for <code>image/gif</code> MIME types,
and multiplies throughput by approximately 1.5 for <code>text/xml</code> or
<code>java.awt.Image</code> for <code>image/*</code> types.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java-server-page-and-servlet-tuning"><a class="anchor" href="#java-server-page-and-servlet-tuning"></a>Java Server Page and Servlet Tuning</h3>
<div class="paragraph">
<p>Many applications running on the Eclipse GlassFish use servlets or
JavaServer Pages (JSP) technology in the presentation tier. This section
describes how to improve performance of such applications, both through
coding practices and through deployment and configuration settings.</p>
</div>
<div class="sect3">
<h4 id="suggested-coding-practices"><a class="anchor" href="#suggested-coding-practices"></a>Suggested Coding Practices</h4>
<div class="paragraph">
<p>This section provides some tips on coding practices that improve servlet
and JSP application performance.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#general-guidelines">General Guidelines</a></p>
</li>
<li>
<p><a href="#avoid-shared-modified-class-variables">Avoid Shared Modified Class Variables</a></p>
</li>
<li>
<p><a href="#http-session-handling">HTTP Session Handling</a></p>
</li>
<li>
<p><a href="#configuration-and-deployment-tips">Configuration and Deployment Tips</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="general-guidelines"><a class="anchor" href="#general-guidelines"></a>General Guidelines</h5>
<div class="paragraph">
<p>Follow these general guidelines to increase performance of the
presentation tier:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minimize Java synchronization in servlets.</p>
</li>
<li>
<p>Do not use the single thread model for servlets.</p>
</li>
<li>
<p>Use the servlet&#8217;s <code>init()</code> method to perform expensive one-time
initialization.</p>
</li>
<li>
<p>Avoid using <code>System.out.println()</code> calls.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="avoid-shared-modified-class-variables"><a class="anchor" href="#avoid-shared-modified-class-variables"></a>Avoid Shared Modified Class Variables</h5>
<div class="paragraph">
<p>In the servlet multithread model (the default), a single instance of a
servlet is created for each application server instance. All requests
for a servlet on that application instance share the same servlet
instance. This can lead to thread contention if there are
synchronization blocks in the servlet code. Therefore, avoid using
shared modified class variables because they create the need for synchronization.</p>
</div>
</div>
<div class="sect4">
<h5 id="http-session-handling"><a class="anchor" href="#http-session-handling"></a>HTTP Session Handling</h5>
<div class="paragraph">
<p>Follow these guidelines when using HTTP sessions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create sessions sparingly. Session creation is not free. If a session
is not required, do not create one.</p>
</li>
<li>
<p>Use <code>javax.servlet.http.HttpSession.invalidate()</code> to release sessions
when they are no longer needed.</p>
</li>
<li>
<p>Keep session size small, to reduce response times. If possible, keep
session size below 7 kilobytes.</p>
</li>
<li>
<p>Use the directive <code>&lt;%page session="false"%&gt;</code> in JSP files to prevent
the Eclipse GlassFish from automatically creating sessions when they are
not necessary.</p>
</li>
<li>
<p>Avoid large object graphs in an <code>HttpSession</code>. They force
serialization and add computational overhead. Generally, do not store
large objects as <code>HttpSession</code> variables.</p>
</li>
<li>
<p>Do not cache transaction data in an <code>HttpSession</code>. Access to data in
an <code>HttpSession</code> is not transactional. Do not use it as a cache of
transactional data, which is better kept in the database and accessed
using entity beans. Transactions will rollback upon failures to their
original state. However, stale and inaccurate data may remain in
<code>HttpSession</code> objects. Eclipse GlassFish provides "read-only"
bean-managed persistence entity beans for cached access to read-only data.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="configuration-and-deployment-tips"><a class="anchor" href="#configuration-and-deployment-tips"></a>Configuration and Deployment Tips</h5>
<div class="paragraph">
<p>Follow these configuration tips to improve performance. These tips are
intended for production environments, not development environments.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To improve class loading time, avoid having excessive directories in
the server <code>CLASSPATH</code>. Put application-related classes into JAR files.</p>
</li>
<li>
<p>HTTP response times are dependent on how the keep-alive subsystem and
the HTTP server is tuned in general. For more information, see
<a href="#http-service-settings">HTTP Service Settings</a>.</p>
</li>
<li>
<p>Cache servlet results when possible. For more information, see
"<a href="application-development-guide.html#developing-web-applications">Developing Web Applications</a>" in Eclipse GlassFish Application Development Guide.</p>
</li>
<li>
<p>If an application does not contain any EJB components, deploy the
application as a WAR file, not an EAR file.</p>
</li>
</ul>
</div>
<div id="optimize-ssl" class="paragraph">
<p>Optimize SSL</p>
</div>
<div class="paragraph">
<p>Optimize SSL by using routines in the appropriate operating system
library for concurrent access to heap space. The library to use depends
on the version of the Solaris Operating System (SolarisOS) that you are
using. To ensure that you use the correct library, set the <code>LD_PRELOAD</code>
environment variable to specify the correct library file. For more
information, refer to the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 23%;">
<col style="width: 23%;">
<col style="width: 54%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Solaris OS Version</th>
<th class="tableblock halign-left valign-top">Library</th>
<th class="tableblock halign-left valign-top">Setting of <code>LD_PRELOAD</code> Environment
Variable</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libumem3LIB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/libumem.so</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libmtmalloc3LIB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/libmtmalloc.so</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To set the <code>LD_PRELOAD</code> environment variable, edit the entry for this
environment variable in the <code>startserv</code> script. The <code>startserv</code> script
is located is located in the <code>bin/startserv</code> directory of your domain.</p>
</div>
<div class="paragraph">
<p>The exact syntax to define an environment variable depends on the shell
that you are using.</p>
</div>
<div id="disable-security-manager" class="paragraph">
<p>Disable Security Manager</p>
</div>
<div class="paragraph">
<p>The security manager is expensive because calls to required resources
must call the <code>doPrivileged()</code> method and must also check the resource
with the <code>server.policy</code> file. If you are sure that no malicious code
will be run on the server and you do not use authentication within your
application, then you can disable the security manager.</p>
</div>
<div class="paragraph">
<p>See "<a href="application-development-guide.html#enabling-and-disabling-the-security-manager">Enabling and Disabling the Security Manager</a>" in
Eclipse GlassFish Application Development Guide for
instructions on enabling or disabling the security manager. If using the
Eclipse GlassFish Administration Console, navigate to the
Configurations&gt;configuration-name&gt;Security node and check or uncheck the
Security Manager option as desired. Refer to the Administration Console
online help for more information.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ejb-performance-tuning"><a class="anchor" href="#ejb-performance-tuning"></a>EJB Performance Tuning</h3>
<div class="paragraph">
<p>The Eclipse GlassFish&#8217;s high-performance EJB container has numerous
parameters that affect performance. Individual EJB components also have
parameters that affect performance. The value of individual EJB
component&#8217;s parameter overrides the value of the same parameter for the
EJB container. The default values are designed for a single-processor
computer system. Modify these values as appropriate to optimize for
other system configurations.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#goals">Goals</a></p>
</li>
<li>
<p><a href="#monitoring-ejb-components">Monitoring EJB Components</a></p>
</li>
<li>
<p><a href="#general-guidelines-1">General Guidelines</a></p>
</li>
<li>
<p><a href="#using-local-and-remote-interfaces">Using Local and Remote Interfaces</a></p>
</li>
<li>
<p><a href="#improving-performance-of-ejb-transactions">Improving Performance of EJB Transactions</a></p>
</li>
<li>
<p><a href="#using-special-techniques">Using Special Techniques</a></p>
</li>
<li>
<p><a href="#tuning-tips-for-specific-types-of-ejb-components">Tuning Tips for Specific Types of EJB Components</a></p>
</li>
<li>
<p><a href="#jdbc-and-database-access">JDBC and Database Access</a></p>
</li>
<li>
<p><a href="#tuning-message-driven-beans">Tuning Message-Driven Beans</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="goals"><a class="anchor" href="#goals"></a>Goals</h4>
<div class="paragraph">
<p>The goals of EJB performance tuning are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Increased speed: Cache as many beans in the EJB caches as possible to
increase speed (equivalently, decrease response time). Caching
eliminates CPU-intensive operations. However, since memory is finite, as
the caches become larger, housekeeping for them (including garbage
collection) takes longer.</p>
</li>
<li>
<p>Decreased memory consumption: Beans in the pools or caches consume
memory from the Java virtual machine heap. Very large pools and caches
degrade performance because they require longer and more frequent
garbage collection cycles.</p>
</li>
<li>
<p>Improved functional properties: Functional properties such as user
timeout, commit options, security, and transaction options, are mostly
related to the functionality and configuration of the application.
Generally, they do not compromise functionality for performance. In some
cases, you might be forced to make a "trade-off" decision between
functionality and performance. This section offers suggestions in such
cases.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="monitoring-ejb-components"><a class="anchor" href="#monitoring-ejb-components"></a>Monitoring EJB Components</h4>
<div class="paragraph">
<p>When the EJB container has monitoring enabled, you can examine
statistics for individual beans based on the bean pool and cache
settings.</p>
</div>
<div class="paragraph">
<p>For example, the monitoring command below returns the Bean Cache
statistics for a stateful session bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get --user admin --host e4800-241-a --port 4848
-m specjcmp.application.SPECjAppServer.ejb-module.
   supplier_jar.stateful-session-bean.BuyerSes.bean-cache.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is a sample of the monitoring output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>resize-quantity = -1
 cache-misses = 0
 idle-timeout-in-seconds = 0
 num-passivations = 0
 cache-hits = 59
 num-passivation-errors = 0
 total-beans-in-cache = 59
 num-expired-sessions-removed = 0
 max-beans-in-cache = 4096
 num-passivation-success = 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The monitoring command below gives the bean pool statistics for an
entity bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get --user admin --host e4800-241-a --port 4848
-m specjcmp.application.SPECjAppServer.ejb-module.
   supplier_jar.stateful-entity-bean.ItemEnt.bean-pool.*
idle-timeout-in-seconds = 0
steady-pool-size = 0
total-beans-destroyed = 0
num-threads-waiting = 0
num-beans-in-pool = 54
max-pool-size = 2147483647
pool-resize-quantity = 0
total-beans-created = 255</code></pre>
</div>
</div>
<div class="paragraph">
<p>The monitoring command below gives the bean pool statistics for a
stateless bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get --user admin --host e4800-241-a --port 4848
-m test.application.testEjbMon.ejb-module.slsb.stateless-session-bean.slsb.bean-pool.*
idle-timeout-in-seconds = 200
steady-pool-size = 32
total-beans-destroyed = 12
num-threads-waiting = 0
num-beans-in-pool = 4
max-pool-size = 1024
pool-resize-quantity = 12
total-beans-created = 42</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tuning the bean involves charting the behavior of the cache and pool for
the bean in question over a period of time.</p>
</div>
<div class="paragraph">
<p>If too many passivations are happening and the JVM heap remains fairly
small, then the <code>max-cache-size</code> or the <code>cache-idle-timeout-in-seconds</code>
can be increased. If garbage collection is happening too frequently, and
the pool size is growing, but the cache hit rate is small, then the
<code>pool-idle-timeout-in-seconds</code> can be reduced to destroy the instances.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Specifying a <code>max-pool-size</code> of zero (0) means that the pool is
unbounded. The pooled beans remain in memory unless they are removed by
specifying a small interval for <code>pool-idle-timeout-in-seconds</code>. For
production systems, specifying the pool as unbounded is NOT recommended.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="monitoring-individual-ejb-components"><a class="anchor" href="#monitoring-individual-ejb-components"></a>Monitoring Individual EJB Components</h5>
<div class="paragraph">
<p>To gather method invocation statistics for all methods in a bean, use
the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get -m monitorableObject.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>where monitorableObject is a fully-qualified identifier from the
hierarchy of objects that can be monitored, shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>serverInstance.application.applicationName.ejb-module.moduleName</code></pre>
</div>
</div>
<div class="paragraph">
<p>where moduleName is <code>x_jar</code> for module <code>x.jar</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.stateless-session-bean.beanName .bean-pool .bean-method.methodName</code></p>
</li>
<li>
<p><code>.stateful-session-bean.beanName .bean-cache .bean-method.methodName</code></p>
</li>
<li>
<p><code>.entity-bean.beanName .bean-cache .bean-pool .bean-method.methodName</code></p>
</li>
<li>
<p><code>.message-driven-bean.beanName .bean-pool .bean-method.methodName (methodName = onMessage)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For standalone beans, use this pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>serverInstance.application.applicationName.standalone-ejb-module.moduleName</code></pre>
</div>
</div>
<div class="paragraph">
<p>The possible identifiers are the same as for <code>ejb-module</code>.</p>
</div>
<div class="paragraph">
<p>For example, to get statistics for a method in an entity bean, use this
command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get -m serverInstance.application.appName.ejb-module.moduleName
.entity-bean.beanName.bean-method.methodName.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about administering the monitoring service in
general, see "<a href="administration-guide.html#administering-the-monitoring-service">Administering the Monitoring Service</a>" in
Eclipse GlassFish Administration Guide. For
information about viewing comprehensive EJB monitoring statistics, see
"<a href="administration-guide.html#ejb-statistics">EJB Statistics</a>" in Eclipse GlassFish Administration Guide.</p>
</div>
<div class="paragraph">
<p>To configure EJB monitoring using the Eclipse GlassFish Administration
Console, navigate to the Configurations&gt;configuration-name&gt;Monitoring
node. After configuring monitoring, you can view monitoring statistics
by navigating to the server (Admin Server) node and then selecting the
Monitor tab. Refer to the Administration Console online help for
instructions on each of these procedures.</p>
</div>
<div class="paragraph">
<p>Alternatively, to list EJB statistics, use the <code>asadmin list</code>
subcommand. For more information, see <a href="reference-manual.html#list"><code>list</code>(1)</a>.</p>
</div>
<div class="paragraph">
<p>For statistics on stateful session bean passivations, use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get -m serverInstance.application.appName.ejb-module.moduleName
.stateful-session-bean.beanName.bean-cache.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the attribute values that are returned, use this command:</p>
</div>
<div class="paragraph">
<p><code>num-passivationsnum-passivation-errorsnum-passivation-success</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="general-guidelines-1"><a class="anchor" href="#general-guidelines-1"></a>General Guidelines</h4>
<div class="paragraph">
<p>The following guidelines can improve performance of EJB components. Keep
in mind that decomposing an application into many EJB components creates
overhead and can degrade performance. EJB components are not simply Java
objects. They are components with semantics for remote call interfaces,
security, and transactions, as well as properties and methods.</p>
</div>
<div class="sect4">
<h5 id="use-high-performance-beans"><a class="anchor" href="#use-high-performance-beans"></a>Use High Performance Beans</h5>
<div class="paragraph">
<p>Use high-performance beans as much as possible to improve the overall
performance of your application. For more information, see
<a href="#tuning-tips-for-specific-types-of-ejb-components">Tuning Tips for Specific Types of EJB Components</a>.</p>
</div>
<div class="paragraph">
<p>The types of EJB components are listed below, from the highest
performance to the lowest:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stateless Session Beans and Message Driven Beans</p>
</li>
<li>
<p>Stateful Session Beans</p>
</li>
<li>
<p>Container Managed Persistence (CMP) entity beans configured as
read-only</p>
</li>
<li>
<p>Bean Managed Persistence (BMP) entity beans configured as read-only</p>
</li>
<li>
<p>CMP beans</p>
</li>
<li>
<p>BMP beans</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about configuring high availability session
persistence, see "<a href="ha-administration-guide.html#configuring-high-availability-session-persistence-and-failover">Configuring High Availability Session
Persistence and Failover</a>" in Eclipse GlassFish High
Availability Administration Guide. To configure EJB beans using the
Eclipse GlassFish Administration Console, navigate to the
Configurations&gt;configuration-name&gt;EJB Container node and then refer to
the Administration Console online help for detailed instructions.</p>
</div>
</div>
<div class="sect4">
<h5 id="use-caching"><a class="anchor" href="#use-caching"></a>Use Caching</h5>
<div class="paragraph">
<p>Caching can greatly improve performance when used wisely. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cache EJB references: To avoid a JNDI lookup for every request, cache
EJB references in servlets.</p>
</li>
<li>
<p>Cache home interfaces: Since repeated lookups to a home interface can
be expensive, cache references to <code>EJBHomes</code> in the <code>init()</code> methods of
servlets.</p>
</li>
<li>
<p>Cache EJB resources: Use <code>setSessionContext()</code> or <code>ejbCreate()</code> to
cache bean resources. This is again an example of using bean lifecycle
methods to perform application actions only once where possible.
Remember to release acquired resources in the <code>ejbRemove()</code> method.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="use-the-appropriate-stubs"><a class="anchor" href="#use-the-appropriate-stubs"></a>Use the Appropriate Stubs</h5>
<div class="paragraph">
<p>The stub classes needed by EJB applications are generated dynamically at
runtime when an EJB client needs them. This means that it is not
necessary to generate the stubs or retrieve the client JAR file when
deploying an application with remote EJB components. When deploying an
application, it is no longer necessary to specify the <code>--retrieve</code>
option, which can speed up deployment.</p>
</div>
<div class="paragraph">
<p>If you have a legacy rich-client application that directly uses the
CosNaming service (not a recommended configuration), then you must
generate the stubs for your application explicitly using RMIC. For more
information, see the <a href="troubleshooting-guide.html#GSTSG">Eclipse GlassFish
Troubleshooting Guide</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="remove-unneeded-stateful-session-beans"><a class="anchor" href="#remove-unneeded-stateful-session-beans"></a>Remove Unneeded Stateful Session Beans</h5>
<div class="paragraph">
<p>Removing unneeded stateful session beans avoids passivating them, which
requires disk operations.</p>
</div>
</div>
<div class="sect4">
<h5 id="cache-and-pool-tuning-tips"><a class="anchor" href="#cache-and-pool-tuning-tips"></a>Cache and Pool Tuning Tips</h5>
<div class="paragraph">
<p>Follow these tips when using the EJB cache and pools to improve
performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Explicitly call <code>remove()</code>: Allow stateful session EJB components to
be removed from the container cache by explicitly calling of the
<code>remove()</code> method in the client.</p>
</li>
<li>
<p>Tune the entity EJB component&#8217;s pool size: Entity Beans use both the
EJB pool and cache settings. Tune the entity EJB component&#8217;s pool size
to minimize the creation and destruction of beans. Populating the pool
with a non-zero steady size before hand is useful for getting better
response for initial requests.</p>
</li>
<li>
<p>Cache bean-specific resources: Use the <code>setEntityContext()</code> method to
cache bean specific resources and release them using the
<code>unSetEntityContext()</code> method.</p>
</li>
<li>
<p>Load related data efficiently for container-managed relationships
(CMRs). For more information, see <a href="#pre-fetching-container-managed-relationship-cmr-beans">Pre-Fetching Container
Managed Relationship (CMR) Beans</a>.</p>
</li>
<li>
<p>Identify read-only beans: Configure read-only entity beans for read
only operations. For more information, see <a href="#read-only-entity-beans">Read-Only Entity
Beans</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-local-and-remote-interfaces"><a class="anchor" href="#using-local-and-remote-interfaces"></a>Using Local and Remote Interfaces</h4>
<div class="paragraph">
<p>This section describes some considerations when EJB components are used
by local and remote clients.</p>
</div>
<div class="sect4">
<h5 id="prefer-local-interfaces"><a class="anchor" href="#prefer-local-interfaces"></a>Prefer Local Interfaces</h5>
<div class="paragraph">
<p>An EJB component can have remote and local interfaces. Clients not
located in the same application server instance as the bean (remote
clients) use the remote interface to access the bean. Calls to the
remote interface require marshalling arguments, transportation of the
marshalled data over the network, un-marshaling the arguments, and
dispatch at the receiving end. Thus, using the remote interface entails
significant overhead.</p>
</div>
<div class="paragraph">
<p>If an EJB component has a local interface, then local clients in the
same application server instance can use it instead of the remote
interface. Using the local interface is more efficient, since it does
not require argument marshalling, transportation, and un-marshalling.</p>
</div>
<div class="paragraph">
<p>If a bean is to be used only by local clients then it makes sense to
provide only the local interface. If, on the other hand, the bean is to
be location-independent, then you should provide both the remote and
local interfaces so that remote clients use the remote interface and
local clients can use the local interface for efficiency.</p>
</div>
</div>
<div class="sect4">
<h5 id="using-pass-by-reference-semantics"><a class="anchor" href="#using-pass-by-reference-semantics"></a>Using Pass-By-Reference Semantics</h5>
<div class="paragraph">
<p>By default, the Eclipse GlassFish uses pass-by-value semantics for
calling the remote interface of a bean, even if it is co-located. This
can be expensive, since clients using pass-by-value semantics must copy
arguments before passing them to the EJB component.</p>
</div>
<div class="paragraph">
<p>However, local clients can use pass-by-reference semantics and thus the
local and remote interfaces can share the passed objects. But this means
that the argument objects must be implemented properly, so that they are
shareable. In general, it is more efficient to use pass-by-reference
semantics when possible.</p>
</div>
<div class="paragraph">
<p>Using the remote and local interfaces appropriately means that clients
can access EJB components efficiently. That is, local clients use the
local interface with pass-by-reference semantics, while remote clients
use the remote interface with pass-by-value semantics.</p>
</div>
<div class="paragraph">
<p>However, in some instances it might not be possible to use the local
interface, for example when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application predates the EJB 2.0 specification and was written
without any local interfaces.</p>
</li>
<li>
<p>There are bean-to-bean calls and the client beans are written without
making any co-location assumptions about the called beans.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For these cases, the Eclipse GlassFish provides a pass-by-reference
option that clients can use to pass arguments by reference to the remote
interface of a co-located EJB component.</p>
</div>
<div class="paragraph">
<p>You can specify the pass-by-reference option for an entire application
or a single EJB component. When specified at the application level, all
beans in the application use pass-by-reference semantics when passing
arguments to their remote interfaces. When specified at the bean level,
all calls to the remote interface of the bean use pass-by-reference
semantics. See "<a href="application-development-guide.html#value-added-features">Value Added Features</a>" in Eclipse GlassFish Application Development Guide for more
details about the pass-by-reference flag.</p>
</div>
<div class="paragraph">
<p>To specify that an EJB component will use pass by reference semantics,
use the following tag in the <code>sun-ejb-jar.xml</code> deployment descriptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;pass-by-reference&gt;</span>true<span class="tag">&lt;/pass-by-reference&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This avoids copying arguments when the EJB component&#8217;s methods are
invoked and avoids copying results when methods return. However,
problems will arise if the data is modified by another source during the
invocation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="improving-performance-of-ejb-transactions"><a class="anchor" href="#improving-performance-of-ejb-transactions"></a>Improving Performance of EJB Transactions</h4>
<div class="paragraph">
<p>This section provides some tips to improve performance when using
transactions.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#use-container-managed-transactions">Use Container-Managed Transactions</a></p>
</li>
<li>
<p><a href="#do-not-encompass-user-input-time">Do Not Encompass User Input Time</a></p>
</li>
<li>
<p><a href="#identify-non-transactional-methods">Identify Non-Transactional Methods</a></p>
</li>
<li>
<p><a href="#use-tx_required-for-long-transaction-chains">Use <code>TX_REQUIRED</code> for Long Transaction Chains</a></p>
</li>
<li>
<p><a href="#use-lowest-cost-database-locking">Use Lowest Cost Database Locking</a></p>
</li>
<li>
<p><a href="#use-xa-capable-data-sources-only-when-needed">Use XA-Capable Data Sources Only When Needed</a></p>
</li>
<li>
<p><a href="#configure-jdbc-resources-as-one-phase-commit-resources">Configure JDBC Resources as One-Phase Commit Resources</a></p>
</li>
<li>
<p><a href="#use-the-least-expensive-transaction-attribute">Use the Least Expensive Transaction Attribute</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="use-container-managed-transactions"><a class="anchor" href="#use-container-managed-transactions"></a>Use Container-Managed Transactions</h5>
<div class="paragraph">
<p>Container-managed transactions are preferred for consistency, and
provide better performance.</p>
</div>
</div>
<div class="sect4">
<h5 id="do-not-encompass-user-input-time"><a class="anchor" href="#do-not-encompass-user-input-time"></a>Do Not Encompass User Input Time</h5>
<div class="paragraph">
<p>To avoid resources being held unnecessarily for long periods, a
transaction should not encompass user input or user think time.</p>
</div>
</div>
<div class="sect4">
<h5 id="identify-non-transactional-methods"><a class="anchor" href="#identify-non-transactional-methods"></a>Identify Non-Transactional Methods</h5>
<div class="paragraph">
<p>Declare non-transactional methods of session EJB components with
<code>NotSupported</code> or <code>Never</code> transaction attributes. These attributes can
be found in the <code>ejb-jar.xml</code> deployment descriptor file. Transactions
should span the minimum time possible since they lock database rows.</p>
</div>
</div>
<div class="sect4">
<h5 id="use-tx_required-for-long-transaction-chains"><a class="anchor" href="#use-tx_required-for-long-transaction-chains"></a>Use <code>TX_REQUIRED</code> for Long Transaction Chains</h5>
<div class="paragraph">
<p>For very large transaction chains, use the transaction attribute
<code>TX_REQUIRED.</code> To ensure EJB methods in a call chain, use the same
transaction.</p>
</div>
</div>
<div class="sect4">
<h5 id="use-lowest-cost-database-locking"><a class="anchor" href="#use-lowest-cost-database-locking"></a>Use Lowest Cost Database Locking</h5>
<div class="paragraph">
<p>Use the lowest cost locking available from the database that is
consistent with any transaction. Commit the data after the transaction
completes rather than after each method call.</p>
</div>
</div>
<div class="sect4">
<h5 id="use-xa-capable-data-sources-only-when-needed"><a class="anchor" href="#use-xa-capable-data-sources-only-when-needed"></a>Use XA-Capable Data Sources Only When Needed</h5>
<div class="paragraph">
<p>When multiple database resources, connector resources or JMS resources
are involved in one transaction, a distributed or global transaction
needs to be performed. This requires XA capable resource managers and
data sources. Use XA capable data sources, only when two or more data
source are going to be involved in a transaction. If a database
participates in some distributed transactions, but mostly in local or
single database transactions, it is advisable to register two separate
JDBC resources and use the appropriate resource in the application.</p>
</div>
</div>
<div class="sect4">
<h5 id="configure-jdbc-resources-as-one-phase-commit-resources"><a class="anchor" href="#configure-jdbc-resources-as-one-phase-commit-resources"></a>Configure JDBC Resources as One-Phase Commit Resources</h5>
<div class="paragraph">
<p>To improve performance of transactions involving multiple resources, the
Eclipse GlassFish uses last agent optimization (LAO), which allows the
configuration of one of the resources in a distributed transaction as a
one-phase commit (1PC) resource. Since the overhead of multiple-resource
transactions is much higher for a JDBC resource than a message queue,
LAO substantially improves performance of distributed transactions
involving one JDBC resource and one or more message queues. To take
advantage of LAO, configure a JDBC resource as a 1PC resource. Nothing
special needs to be done to configure JMS resources.</p>
</div>
<div class="paragraph">
<p>In global transactions involving multiple JDBC resources, LAO will still
improve performance, however, not as much as for one JDBC resource. In
this situation, one of the JDBC resources should be configured as 1PC,
and all others should be configured as XA.</p>
</div>
</div>
<div class="sect4">
<h5 id="use-the-least-expensive-transaction-attribute"><a class="anchor" href="#use-the-least-expensive-transaction-attribute"></a>Use the Least Expensive Transaction Attribute</h5>
<div class="paragraph">
<p>Set the following transaction attributes in the EJB deployment
descriptor file (<code>ejb-jar.xml</code>). Options are listed from best
performance to worst. To improve performance, choose the least expensive
attribute that will provide the functionality your application needs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>NEVER</code></p>
</li>
<li>
<p><code>TX_NOTSUPPORTED</code></p>
</li>
<li>
<p><code>TX_MANDATORY</code></p>
</li>
<li>
<p><code>TX_SUPPORTS</code></p>
</li>
<li>
<p><code>TX_REQUIRED</code></p>
</li>
<li>
<p><code>TX_REQUIRESNEW</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-special-techniques"><a class="anchor" href="#using-special-techniques"></a>Using Special Techniques</h4>
<div class="paragraph">
<p>Special performance-enhancing techniques are discussed in the following
sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#version-consistency">Version Consistency</a></p>
</li>
<li>
<p><a href="#request-partitioning">Request Partitioning</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="version-consistency"><a class="anchor" href="#version-consistency"></a>Version Consistency</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The technique in section applies only to the EJB 2.1 architecture. In
the EJB 3.0 architecture, use the Java Persistence API (JPA).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use version consistency to improve performance while protecting the
integrity of data in the database. Since the application server can use
multiple copies of an EJB component simultaneously, an EJB component&#8217;s
state can potentially become corrupted through simultaneous access.</p>
</div>
<div class="paragraph">
<p>The standard way of preventing corruption is to lock the database row
associated with a particular bean. This prevents the bean from being
accessed by two simultaneous transactions and thus protects data.
However, it also decreases performance, since it effectively serializes
all EJB access.</p>
</div>
<div class="paragraph">
<p>Version consistency is another approach to protecting EJB data
integrity. To use version consistency, you specify a column in the
database to use as a version number. The EJB lifecycle then proceeds
like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first time the bean is used, the <code>ejbLoad()</code> method loads the bean
as normal, including loading the version number from the database.</p>
</li>
<li>
<p>The <code>ejbStore()</code> method checks the version number in the database
versus its value when the EJB component was loaded.</p>
<div class="ulist">
<ul>
<li>
<p>If the version number has been modified, it means that there has been
simultaneous access to the EJB component and <code>ejbStore()</code> throws a
<code>ConcurrentModificationException</code>.</p>
</li>
<li>
<p>Otherwise, <code>ejbStore()</code> stores the data and completes as normal.</p>
<div class="paragraph">
<p>The <code>ejbStore()</code> method performs this validation at the end of the
transaction regardless of whether any data in the bean was modified.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Subsequent uses of the bean behave similarly, except that the
<code>ejbLoad()</code> method loads its initial data (including the version number)
from an internal cache. This saves a trip to the database. When the
<code>ejbStore()</code> method is called, the version number is checked to ensure
that the correct data was used in the transaction.</p>
</div>
<div class="paragraph">
<p>Version consistency is advantageous when you have EJB components that
are rarely modified, because it allows two transactions to use the same
EJB component at the same time. Because neither transaction modifies the
data, the version number is unchanged at the end of both transactions,
and both succeed. But now the transactions can run in parallel. If two
transactions occasionally modify the same EJB component, one will
succeed and one will fail and can be retried using the new valuesâwhich
can still be faster than serializing all access to the EJB component if
the retries are infrequent enough (though now your application logic has
to be prepared to perform the retry operation).</p>
</div>
<div class="paragraph">
<p>To use version consistency, the database schema for a particular table
must include a column where the version can be stored. You then specify
that table in the <code>sun-cmp-mapping.xml</code> deployment descriptor for a
particular bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;entity-mapping&gt;</span>
    <span class="tag">&lt;cmp-field-mapping&gt;</span>
        ...
    <span class="tag">&lt;/cmp-field-mapping&gt;</span>
    <span class="tag">&lt;consistency&gt;</span>
        <span class="tag">&lt;check-version-of-accessed-instances&gt;</span>
            <span class="tag">&lt;column-name&gt;</span>OrderTable.VC_VERSION_NUMBER<span class="tag">&lt;/column-name&gt;</span>
        <span class="tag">&lt;/check-version-of-accessed-instances&gt;</span>
    <span class="tag">&lt;/consistency&gt;</span>
<span class="tag">&lt;/entity-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, you must establish a trigger on the database to
automatically update the version column when data in the specified table
is modified. The Eclipse GlassFish requires such a trigger to use version
consistency. Having such a trigger also ensures that external
applications that modify the EJB data will not conflict with EJB
transactions in progress.</p>
</div>
<div class="paragraph">
<p>For example, the following DDL illustrates how to create a trigger for
the <code>Order</code> table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TRIGGER</span> OrderTrigger
  <span class="keyword">BEFORE</span> <span class="class">UPDATE</span> <span class="keyword">ON</span> OrderTable
  <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span>
  <span class="keyword">WHEN</span> (new.VC_VERSION_NUMBER = old.VC_VERSION_NUMBER)
  DECLARE
  <span class="class">BEGIN</span>
    :NEW.VC_VERSION_NUMBER := :OLD.VC_VERSION_NUMBER + <span class="integer">1</span>;
  <span class="keyword">END</span>;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="request-partitioning"><a class="anchor" href="#request-partitioning"></a>Request Partitioning</h5>
<div class="paragraph">
<p>Request partitioning enables you to assign a request priority to an EJB
component. This gives you the flexibility to make certain EJB components
execute with higher priorities than others.</p>
</div>
<div class="paragraph">
<p>An EJB component which has a request priority assigned to it will have
its requests (services) executed within an assigned threadpool. By
assigning a threadpool to its execution, the EJB component can execute
independently of other pending requests. In short, request partitioning
enables you to meet service-level agreements that have differing levels
of priority assigned to different services.</p>
</div>
<div class="paragraph">
<p>Request partitioning applies only to remote EJB components (those that
implement a remote interface). Local EJB components are executed in
their calling thread (for example, when a servlet calls a local bean,
the local bean invocation occurs on the servlet&#8217;s thread).</p>
</div>
<div id="to-enable-request-partitioning" class="paragraph">
<p>To Enable Request Partitioning</p>
</div>
<div class="paragraph">
<p>Follow this procedure.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure additional threadpools for EJB execution.</p>
<div class="paragraph">
<p>Using the Eclipse GlassFish Administration Console, navigate to the
Configurations&gt;configuration-name&gt;Thread Pools node.
Refer to the Administration Console online help for more information.
Alternatively, you can follow the instructions in
"<a href="administration-guide.html#administering-thread-pools">
Administering Thread Pools</a>" in Eclipse GlassFish Administration Guide.</p>
</div>
<div class="paragraph">
<p>Configure the threadpools as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the additional threadpool IDs to the Eclipse GlassFish&#8217;s ORB.</p>
<div class="paragraph">
<p>This can be done on the Configurations&gt;configuration-name&gt;ORB node in
the Administration Console.</p>
</div>
<div class="paragraph">
<p>For example, enable threadpools named <code>priority-1</code> and <code>priority-2</code> to
the <code>&lt;orb&gt;</code> element as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;orb</span> <span class="attribute-name">max-connections</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">message-fragment-size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">use-thread-pool-ids</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">thread-pool-1,priority-1,priority-2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>Include the threadpool ID in the <code>use-thread-pool-id</code> element of the
EJB component&#8217;s <code>sun-ejb-jar.xml</code> deployment descriptor.</p>
<div class="paragraph">
<p>For example, the following <code>sun-ejb-jar.xml</code> deployment descriptor for
an EJB component named &#8220;TheGreeter&#8221; is assigned to a thread pool named <code>priority-2</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;sun-ejb-jar&gt;</span>
  <span class="tag">&lt;enterprise-beans&gt;</span>
    <span class="tag">&lt;unique-id&gt;</span>1<span class="tag">&lt;/unique-id&gt;</span>
    <span class="tag">&lt;ejb&gt;</span>
      <span class="tag">&lt;ejb-name&gt;</span>TheGreeter<span class="tag">&lt;/ejb-name&gt;</span>
      <span class="tag">&lt;jndi-name&gt;</span>greeter<span class="tag">&lt;/jndi-name&gt;</span>
      <span class="tag">&lt;use-thread-pool-id&gt;</span>priority-1<span class="tag">&lt;/use-thread-pool-id&gt;</span>
    <span class="tag">&lt;/ejb&gt;</span>
  <span class="tag">&lt;/enterprise-beans&gt;</span>
<span class="tag">&lt;/sun-ejb-jar&gt;</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Restart the Eclipse GlassFish.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tuning-tips-for-specific-types-of-ejb-components"><a class="anchor" href="#tuning-tips-for-specific-types-of-ejb-components"></a>Tuning Tips for Specific Types of EJB Components</h4>
<div class="paragraph">
<p>This section provides tips for tuning various specific types of EJB components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#entity-beans">Entity Beans</a></p>
</li>
<li>
<p><a href="#stateful-session-beans">Stateful Session Beans</a></p>
</li>
<li>
<p><a href="#stateless-session-beans">Stateless Session Beans</a></p>
</li>
<li>
<p><a href="#read-only-entity-beans">Read-Only Entity Beans</a></p>
</li>
<li>
<p><a href="#pre-fetching-container-managed-relationship-cmr-beans">Pre-Fetching Container Managed Relationship (CMR) Beans</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These components can all be configured in the Eclipse GlassFish
Administration Console from the Configurations&gt;configuration-name&gt;EJB
Container node. Alternatively, you can perform these configurations by
following the instructions in "<a href="ha-administration-guide.html#rmi-iiop-load-balancing-and-failover">
RMI-IIOP Load Balancing and Failover</a>"
in Eclipse GlassFish High Availability Administration Guide.</p>
</div>
<div class="sect4">
<h5 id="entity-beans"><a class="anchor" href="#entity-beans"></a>Entity Beans</h5>
<div class="paragraph">
<p>Depending on the usage of a particular entity bean, one should tune
<code>max-cache-size</code> so that the beans that are used less frequently (for
example, an order that is created and never used after the transaction
is over) are cached less, and beans that are used frequently (for
example, an item in the inventory that gets referenced very often), are
cached more.</p>
</div>
</div>
<div class="sect4">
<h5 id="stateful-session-beans"><a class="anchor" href="#stateful-session-beans"></a>Stateful Session Beans</h5>
<div class="paragraph">
<p>When a stateful bean represents a user, a reasonable <code>max-cache-size</code> of
beans is the expected number of concurrent users on the application
server process. If this value is too low (in relation to the steady load
of users), beans would be frequently passivated and activated, causing a
negative impact on the response times, due to CPU intensive
serialization and deserialization as well as disk I/O.</p>
</div>
<div class="paragraph">
<p>Another important variable for tuning is <code>cache-idle-timeout-in-seconds</code>
where at periodic intervals of <code>cache-idle-timeout-in-seconds</code>, all the
beans in the cache that have not been accessed for more than
<code>cache-idle-timeout-in-seconds</code> time, are passivated. Similar to an HTTP
session timeout, the bean is removed after it has not been accessed for
<code>removal-timeout-in-seconds</code>. Passivated beans are stored on disk in
serialized form. A large number of passivated beans could not only mean
many files on the disk system, but also slower response time as the
session state has to be de-serialized before the invocation.</p>
</div>
<div id="checkpoint-only-when-needed" class="paragraph">
<p>Checkpoint only when needed</p>
</div>
<div class="paragraph">
<p>In high availability mode, when using stateful session beans, consider
checkpointing only those methods that alter the state of the bean
significantly. This reduces the number of times the bean state has to be
checkpointed into the persistent store.</p>
</div>
</div>
<div class="sect4">
<h5 id="stateless-session-beans"><a class="anchor" href="#stateless-session-beans"></a>Stateless Session Beans</h5>
<div class="paragraph">
<p>Stateless session beans are more readily pooled than entity or the
stateful session beans. Valid values for <code>steady-pool-size</code>,
<code>pool-resize-quantity</code> and <code>max-pool-size</code> are the best tunables for
these type of beans. Set the <code>steady-pool-size</code> to greater than zero if
you want to pre-populate the pool. This way, when the container comes
up, it creates a pool with <code>steady-pool-size</code> number of beans. By
pre-populating the pool it is possible to avoid the object creation time
during method invocations.</p>
</div>
<div class="paragraph">
<p>Setting the <code>steady-pool size</code> to a very large value can cause unwanted
memory growth and can result in large garbage collection times.
<code>pool-resize-quantity</code> determines the rate of growth as well as the rate
of decay of the pool. Setting it to a small value is better as the decay
behaves like an exponential decay. Setting a small <code>max-pool-size</code> can
cause excessive object destruction (and as a result excessive object
creation) as instances are destroyed from the pool if the current pool
size exceeds <code>max-pool-size</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="read-only-entity-beans"><a class="anchor" href="#read-only-entity-beans"></a>Read-Only Entity Beans</h5>
<div class="paragraph">
<p>Read-only entity beans cache data from the database. Eclipse GlassFish
supports read-only beans that use both bean-managed persistence (BMP)
and container-managed persistence (CMP). Of the two types, CMP read-only
beans provide significantly better performance. In the EJB lifecycle,
the EJB container calls the <code>ejbLoad()</code> method of a read-only bean once.
The container makes multiple copies of the EJB component from that data,
and since the beans do not update the database, the container never
calls the <code>ejbStore()</code> method. This greatly reduces database traffic for
these beans.</p>
</div>
<div class="paragraph">
<p>If there is a bean that never updates the database, use a read-only bean
in its place to improve performance. A read-only bean is appropriate if
either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Database rows represented by the bean do not change.</p>
</li>
<li>
<p>The application can tolerate using out-of-date values for the bean.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, an application might use a read-only bean to represent a
list of best-seller books. Although the list might change occasionally
in the database (say, from another bean entirely), the change need not
be reflected immediately in an application.</p>
</div>
<div class="paragraph">
<p>The <code>ejbLoad()</code> method of a read-only bean is handled differently for
CMP and BMP beans. For CMP beans, the EJB container calls <code>ejbLoad()</code>
only once to load the data from the database; subsequent uses of the
bean just copy that data. For BMP beans, the EJB container calls
<code>ejbLoad()</code> the first time a bean is used in a transaction. Subsequent
uses of that bean within the transaction use the same values. The
container calls <code>ejbLoad()</code> for a BMP bean that doesn&#8217;t run within a
transaction every time the bean is used. Therefore, read-only BMP beans
still make a number of calls to the database.</p>
</div>
<div class="paragraph">
<p>To create a read-only bean, add the following to the EJB deployment
descriptor <code>sun-ejb-jar.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;is-read-only-bean&gt;</span>true<span class="tag">&lt;/is-read-only-bean&gt;</span>
<span class="tag">&lt;refresh-period-in-seconds&gt;</span>600<span class="tag">&lt;/refresh-period-in-seconds&gt;</span></code></pre>
</div>
</div>
<div id="refresh-period" class="paragraph">
<p>Refresh Period</p>
</div>
<div class="paragraph">
<p>An important parameter for tuning read-only beans is the refresh period,
represented by the deployment descriptor entity
<code>refresh-period-in-seconds</code>. For CMP beans, the first access to a bean
loads the bean&#8217;s state. The first access after the refresh period
reloads the data from the database. All subsequent uses of the bean uses
the newly refreshed data (until another refresh period elapses). For BMP
beans, an <code>ejbLoad()</code> method within an existing transaction uses the
cached data unless the refresh period has expired (in which case, the
container calls <code>ejbLoad()</code> again).</p>
</div>
<div class="paragraph">
<p>This parameter enables the EJB component to periodically refresh its
"snapshot" of the database values it represents. If the refresh period
is less than or equal to 0, the bean is never refreshed from the
database (the default behavior if no refresh period is given).</p>
</div>
</div>
<div class="sect4">
<h5 id="pre-fetching-container-managed-relationship-cmr-beans"><a class="anchor" href="#pre-fetching-container-managed-relationship-cmr-beans"></a>Pre-Fetching Container Managed Relationship (CMR) Beans</h5>
<div class="paragraph">
<p>If a container-managed relationship (CMR) exists in your application,
loading one bean will load all its related beans. The canonical example
of CMR is an order-orderline relationship where you have one <code>Order</code> EJB
component that has related <code>OrderLine</code> EJB components. In previous
releases of the application server, to use all those beans would require
multiple database queries: one for the <code>Order</code> bean and one for each of
the <code>OrderLine</code> beans in the relationship.</p>
</div>
<div class="paragraph">
<p>In general, if a bean has n relationships, using all the data of the
bean would require n+1 database accesses. Use CMR pre-fetching to
retrieve all the data for the bean and all its related beans in one
database access.</p>
</div>
<div class="paragraph">
<p>For example, you have this relationship defined in the <code>ejb-jar.xml</code>
file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;relationships&gt;</span>
    <span class="tag">&lt;ejb-relation&gt;</span>
        <span class="tag">&lt;description&gt;</span>Order-OrderLine<span class="tag">&lt;/description&gt;</span>
        <span class="tag">&lt;ejb-relation-name&gt;</span>Order-OrderLine<span class="tag">&lt;/ejb-relation-name&gt;</span>
        <span class="tag">&lt;ejb-relationship-role&gt;</span>
            <span class="tag">&lt;ejb-relationship-role-name&gt;</span>
                Order-has-N-OrderLines
            <span class="tag">&lt;/ejb-relationship-role-name&gt;</span>
            <span class="tag">&lt;multiplicity&gt;</span>One<span class="tag">&lt;/multiplicity&gt;</span>
            <span class="tag">&lt;relationship-role-source&gt;</span>
                <span class="tag">&lt;ejb-name&gt;</span>OrderEJB<span class="tag">&lt;/ejb-name&gt;</span>
            <span class="tag">&lt;/relationship-role-source&gt;</span>
            <span class="tag">&lt;cmr-field&gt;</span>
                <span class="tag">&lt;cmr-field-name&gt;</span>orderLines<span class="tag">&lt;/cmr-field-name&gt;</span>
                <span class="tag">&lt;cmr-field-type&gt;</span>java.util.Collection<span class="tag">&lt;/cmr-field-type&gt;</span>
            <span class="tag">&lt;/cmr-field&gt;</span>
        <span class="tag">&lt;/ejb-relationship-role&gt;</span>
    <span class="tag">&lt;/ejb-relation&gt;</span>
<span class="tag">&lt;/relationships&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When a particular <code>Order</code> is loaded, you can load its related
<code>OrderLines</code> by adding this to the <code>sun-cmp-mapping.xml</code> file for the
application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;entity-mapping&gt;</span>
    <span class="tag">&lt;ejb-name&gt;</span>Order<span class="tag">&lt;/ejb-name&gt;</span>
    <span class="tag">&lt;table-name&gt;</span>...<span class="tag">&lt;/table-name&gt;</span>
    <span class="tag">&lt;cmp-field-mapping&gt;</span>...<span class="tag">&lt;/cmp-field-mapping&gt;</span>
    <span class="tag">&lt;cmr-field-mapping&gt;</span>
        <span class="tag">&lt;cmr-field-name&gt;</span>orderLines<span class="tag">&lt;/cmr-field-name&gt;</span>
        <span class="tag">&lt;column-pair&gt;</span>
            <span class="tag">&lt;column-name&gt;</span>OrderTable.OrderID<span class="tag">&lt;/column-name&gt;</span>
            <span class="tag">&lt;column-name&gt;</span>OrderLineTable.OrderLine_OrderID<span class="tag">&lt;/column-name&gt;</span>
        <span class="tag">&lt;/column-pair&gt;</span>
        <span class="tag">&lt;fetched-with&gt;</span>
            <span class="tag">&lt;default&gt;</span>
        <span class="tag">&lt;/fetched-with&gt;</span>
    <span class="tag">&lt;/cmr-field-mapping&gt;</span>
<span class="tag">&lt;/entity-mappping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now when an <code>Order</code> is retrieved, the CMP engine issues SQL to retrieve
all related <code>OrderLines</code> with a <code>SELECT</code> statement that has the
following <code>WHERE</code> clause:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql">OrderTable.OrderID = OrderLineTable.OrderLine_OrderID</code></pre>
</div>
</div>
<div class="paragraph">
<p>This clause indicates an outer join. These <code>OrderLines</code> are pre-fetched.</p>
</div>
<div class="paragraph">
<p>Pre-fetching generally improves performance because it reduces the
number of database accesses. However, if the business logic often uses
<code>Orders</code> without referencing their <code>OrderLines</code>, then this can have a
performance penalty, that is, the system has spent the effort to
pre-fetch the <code>OrderLines</code> that are not actually needed.</p>
</div>
<div class="paragraph">
<p>Avoid pre-fetching for specific finder methods; this can often avoid
that penalty. For example, consider an order bean has two finder
methods: a <code>findByPrimaryKey</code> method that uses the <code>Orderlines</code>, and a
<code>findByCustomerId</code> method that returns only order information and
therefore does not use the <code>Orderlines</code>. If you have enabled CMR
pre-fetching for the <code>Orderlines</code>, both finder methods will pre-fetch
the <code>Orderlines</code>. However, you can prevent pre-fetching for the
<code>findByCustomerId</code> method by including this information in the
<code>sun-ejb-jar.xml</code> descriptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;ejb&gt;</span>
    <span class="tag">&lt;ejb-name&gt;</span>OrderBean<span class="tag">&lt;/ejb-name&gt;</span>
    ...
    <span class="tag">&lt;cmp&gt;</span>
        <span class="tag">&lt;prefetch-disabled&gt;</span>
            <span class="tag">&lt;query-method&gt;</span>
                <span class="tag">&lt;method-name&gt;</span>findByCustomerId<span class="tag">&lt;/method-name&gt;</span>
            <span class="tag">&lt;/query-method&gt;</span>
        <span class="tag">&lt;/prefetch-disabled&gt;</span>
     <span class="tag">&lt;/cmp&gt;</span>
<span class="tag">&lt;/ejb&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="jdbc-and-database-access"><a class="anchor" href="#jdbc-and-database-access"></a>JDBC and Database Access</h4>
<div class="paragraph">
<p>The following are some tips to improve the performance of database
access:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#use-jdbc-directly">Use JDBC Directly</a></p>
</li>
<li>
<p><a href="#encapsulate-business-logic-in-entity-ejb-components">Encapsulate Business Logic in Entity EJB Components</a></p>
</li>
<li>
<p><a href="#close-connections">Close Connections</a></p>
</li>
<li>
<p><a href="#minimize-the-database-transaction-isolation-level">Minimize the Database Transaction Isolation Level</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="use-jdbc-directly"><a class="anchor" href="#use-jdbc-directly"></a>Use JDBC Directly</h5>
<div class="paragraph">
<p>When dealing with large amounts of data, such as searching a large
database, use JDBC directly rather than using Entity EJB components.</p>
</div>
</div>
<div class="sect4">
<h5 id="encapsulate-business-logic-in-entity-ejb-components"><a class="anchor" href="#encapsulate-business-logic-in-entity-ejb-components"></a>Encapsulate Business Logic in Entity EJB Components</h5>
<div class="paragraph">
<p>Combine business logic with the Entity EJB component that holds the data
needed for that logic to process.</p>
</div>
</div>
<div class="sect4">
<h5 id="close-connections"><a class="anchor" href="#close-connections"></a>Close Connections</h5>
<div class="paragraph">
<p>To ensure that connections are returned to the pool, always close the
connections after use.</p>
</div>
</div>
<div class="sect4">
<h5 id="minimize-the-database-transaction-isolation-level"><a class="anchor" href="#minimize-the-database-transaction-isolation-level"></a>Minimize the Database Transaction Isolation Level</h5>
<div class="paragraph">
<p>Use the default isolation level provided by the JDBC driver rather than
calling <code>setTransactionIsolationLevel()</code>, unless you are certain that
your application behaves correctly and performs better at a different
isolation level.</p>
</div>
<div class="paragraph">
<p>Reduce the database transaction isolation level when appropriate.
Reduced isolation levels reduce work in the database tier, and could
lead to better application performance. However, this must be done after
carefully analyzing the database table usage patterns.</p>
</div>
<div class="paragraph">
<p>To set the database transaction isolation level using the Eclipse GlassFish Administration Console, navigate to the Resources&gt;JDBC&gt;JDBC
Connection Pools&gt;pool-name node. Refer to the Administration Console
online help for complete instructions. Alternatively, follow the
instructions in "<a href="administration-guide.html#administering-database-connectivity">Administering Database Connectivity</a>"
in Eclipse GlassFish Administration Guide. For more
information on tuning JDBC connection pools, see
<a href="#jdbc-connection-pool-settings">JDBC Connection Pool Settings</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tuning-message-driven-beans"><a class="anchor" href="#tuning-message-driven-beans"></a>Tuning Message-Driven Beans</h4>
<div class="paragraph">
<p>This section provides some tips to improve performance when using JMS
with message-driven beans (MDBs).</p>
</div>
<div class="sect4">
<h5 id="use-getconnection"><a class="anchor" href="#use-getconnection"></a>Use <code>getConnection()</code></h5>
<div class="paragraph">
<p>JMS connections are served from a connection pool. This means that
calling <code>getConnection()</code> on a Queue connection factory is fast.</p>
</div>
</div>
<div class="sect4">
<h5 id="tune-the-message-driven-beans-pool-size"><a class="anchor" href="#tune-the-message-driven-beans-pool-size"></a>Tune the Message-Driven Bean&#8217;s Pool Size</h5>
<div class="paragraph">
<p>The container for message-driven beans (MDB) is different than the
containers for entity and session beans. In the MDB container, sessions
and threads are attached to the beans in the MDB pool. This design makes
it possible to pool the threads for executing message-driven requests in
the container.</p>
</div>
<div class="paragraph">
<p>Tune the Message-Driven bean&#8217;s pool size to optimize the concurrent
processing of messages. Set the size of the MDB pool to, based on all
the parameters of the server (taking other applications into account).
For example, a value greater than 500 is generally too large.</p>
</div>
<div class="paragraph">
<p>To configure MDB pool settings in the Eclipse GlassFish Administration
Console, navigate to the Configurations&gt;configuration-name&gt;EJB Container
node and then select the MDB Settings tab. Refer to the Administration
Console online help for more information. Alternatively, you can set the
MDB pool size by using the following <code>asadmin set</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin set server.mdb-container.max-pool-size = value</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="cache-bean-specific-resources"><a class="anchor" href="#cache-bean-specific-resources"></a>Cache Bean-Specific Resources</h5>
<div class="paragraph">
<p>Use the <code>setMessageDrivenContext()</code> or <code>ejbCreate()</code> method to cache
bean specific resources, and release those resources from the
<code>ejbRemove()</code> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="limit-use-of-jms-connections"><a class="anchor" href="#limit-use-of-jms-connections"></a>Limit Use of JMS Connections</h5>
<div class="paragraph">
<p>When designing an application that uses JMS connections make sure you
use a methodology that sparingly uses connections, by either pooling
them or using the same connection for multiple sessions.</p>
</div>
<div class="paragraph">
<p>The JMS connection uses two threads and the sessions use one thread
each. Since these threads are not taken from a pool and the resultant
objects aren&#8217;t pooled, you could run out of memory during periods of
heavy usage.</p>
</div>
<div class="paragraph">
<p>One workaround is to move <code>createTopicConnection</code> into the <code>init</code> of the
servlet.</p>
</div>
<div class="paragraph">
<p>Make sure to specifically close the session, or it will stay open, which
ties up resources.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tuning-the-glassfish-server"><a class="anchor" href="#tuning-the-glassfish-server"></a>3 Tuning the Eclipse GlassFish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes some ways to tune your Eclipse GlassFish
installation for optimum performance.</p>
</div>
<div class="paragraph">
<p>Note that while this chapter describes numerous interactions with both
the Eclipse GlassFish Administration Console and the command-line
interface, it is not intended to provide exhaustive descriptions of
either. For complete information about using the Administration Console,
refer to the Administration Console online help. For complete
information about using the Eclipse GlassFish command-line interface,
refer to the other titles in the Eclipse GlassFish documentation set at
<code><a href="http://docs.oracle.com/docs/cd/E18930_01/index.html" class="bare">http://docs.oracle.com/docs/cd/E18930_01/index.html</a></code>.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#using-the-glassfish-server-performance-tuner">Using the Eclipse GlassFish Performance Tuner</a></p>
</li>
<li>
<p><a href="#deployment-settings">Deployment Settings</a></p>
</li>
<li>
<p><a href="#logger-settings">Logger Settings</a></p>
</li>
<li>
<p><a href="#web-container-settings">Web Container Settings</a></p>
</li>
<li>
<p><a href="#ejb-container-settings">EJB Container Settings</a></p>
</li>
<li>
<p><a href="#java-message-service-settings">Java Message Service Settings</a></p>
</li>
<li>
<p><a href="#transaction-service-settings">Transaction Service Settings</a></p>
</li>
<li>
<p><a href="#http-service-settings">HTTP Service Settings</a></p>
</li>
<li>
<p><a href="#network-listener-settings">Network Listener Settings</a></p>
</li>
<li>
<p><a href="#transport-settings">Transport Settings</a></p>
</li>
<li>
<p><a href="#thread-pool-settings">Thread Pool Settings</a></p>
</li>
<li>
<p><a href="#orb-settings">ORB Settings</a></p>
</li>
<li>
<p><a href="#resource-settings">Resource Settings</a></p>
</li>
<li>
<p><a href="#load-balancer-settings">Load Balancer Settings</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="using-the-glassfish-server-performance-tuner"><a class="anchor" href="#using-the-glassfish-server-performance-tuner"></a>Using the Eclipse GlassFish Performance Tuner</h3>
<div class="paragraph">
<p>You can significantly improve the performance of Eclipse GlassFish and
the applications deployed on it by adjusting a few deployment and server
configuration settings. These changes can be made manually, as described
in this chapter, or by using the built-in Performance Tuner in the
Eclipse GlassFish Administration Console.</p>
</div>
<div class="paragraph">
<p>The Performance Tuner recommends server settings to suit the needs of
your Eclipse GlassFish deployment. It helps you reach an optimal
configuration, although finer tuning might be needed in case of specific
requirements. You can configure performance tuning for the entire
domain, or for individual Eclipse GlassFish instances or clusters. The
Tuner performs a static analysis of Eclipse GlassFish resources and
throughput requirements. Note that no dynamic inspection of the system
is performed.</p>
</div>
<div class="paragraph">
<p>For complete information about using the Performance Tuning features
available through the Eclipse GlassFish Administration Console, refer to
the Administration Console online help. You may also want to refer to
the following resources for additional information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To view a demonstration video showing how to use the Eclipse GlassFish
Performance Tuner, see the
<a href="http://www.youtube.com/watch?v=FavsE2pzAjc">Eclipse GlassFish 3.1 -
Performance Tuner demo</a> (<code><a href="http://www.youtube.com/watch?v=FavsE2pzAjc" class="bare">http://www.youtube.com/watch?v=FavsE2pzAjc</a></code>).</p>
</li>
<li>
<p>To find additional Performance Tuning development information, see the
<a href="http://blogs.oracle.com/jenblog/entry/performance_tuner_in_oracle_glassfish">Performance
Tuner in Eclipse GlassFish 3.1</a>
(<code><a href="http://blogs.oracle.com/jenblog/entry/performance_tuner_in_oracle_glassfish" class="bare">http://blogs.oracle.com/jenblog/entry/performance_tuner_in_oracle_glassfish</a></code>)
blog.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="deployment-settings"><a class="anchor" href="#deployment-settings"></a>Deployment Settings</h3>
<div class="paragraph">
<p>Deployment settings can have significant impact on performance. Follow
these guidelines when configuring deployment settings for best
performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#disable-auto-deployment">Disable Auto-Deployment</a></p>
</li>
<li>
<p><a href="#use-pre-compiled-javaserver-pages">Use Pre-compiled JavaServer Pages</a></p>
</li>
<li>
<p><a href="#disable-dynamic-application-reloading">Disable Dynamic Application Reloading</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="disable-auto-deployment"><a class="anchor" href="#disable-auto-deployment"></a>Disable Auto-Deployment</h4>
<div class="paragraph">
<p>Enabling auto-deployment will adversely affect deployment, though it is
a convenience in a development environment. For a production system,
disable auto-deploy to optimize performance. If auto-deployment is
enabled, then the Reload Poll Interval setting can have a significant
performance impact.</p>
</div>
<div class="paragraph">
<p>To enable or disable auto-deployment from the Eclipse GlassFish
Administration Console, navigate to the Domain node and then click the
Applications Configuration tab. Refer to the Administration Console for
further instructions. Alternatively, refer to "<a href="application-deployment-guide.html#to-deploy-an-application-or-module-automatically">To
Deploy an Application or Module Automatically</a>" in Eclipse GlassFish Application Deployment Guide for instructions on enabling
or disabling auto-deployment.</p>
</div>
</div>
<div class="sect3">
<h4 id="use-pre-compiled-javaserver-pages"><a class="anchor" href="#use-pre-compiled-javaserver-pages"></a>Use Pre-compiled JavaServer Pages</h4>
<div class="paragraph">
<p>Compiling JSP files is resource intensive and time consuming.
Pre-compiling JSP files before deploying applications on the server will
improve application performance. When you do so, only the resulting
servlet class files will be deployed.</p>
</div>
<div class="paragraph">
<p>You can specify to precompile JSP files when you deploy an application
through the Administration Console or <code>deploy</code> subcommand. You can also
specify to pre-compile JSP files for a deployed application with the
Administration Console. Navigate to the Domain node and then click the
Applications Configuration tab. Refer to the Administration Console for
further instructions.</p>
</div>
</div>
<div class="sect3">
<h4 id="disable-dynamic-application-reloading"><a class="anchor" href="#disable-dynamic-application-reloading"></a>Disable Dynamic Application Reloading</h4>
<div class="paragraph">
<p>If dynamic reloading is enabled, the server periodically checks for
changes in deployed applications and automatically reloads the
application with the changes. Dynamic reloading is intended for
development environments and is also incompatible with session
persistence. To improve performance, disable dynamic class reloading.</p>
</div>
<div class="paragraph">
<p>You can use the Administration Console to disable dynamic class
reloading for an application that is already deployed. Navigate to the
Domain node and then click the Applications Configuration tab. Refer to
the Administration Console for further instructions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logger-settings"><a class="anchor" href="#logger-settings"></a>Logger Settings</h3>
<div class="paragraph">
<p>The Eclipse GlassFish produces writes log messages and exception stack
trace output to the log file in the logs directory of the instance,
domain-dir<code>/logs</code>. The volume of log activity can impact server
performance; particularly in benchmarking situations.</p>
</div>
<div class="sect3">
<h4 id="general-settings"><a class="anchor" href="#general-settings"></a>General Settings</h4>
<div class="paragraph">
<p>In general, writing to the system log slows down performance slightly;
and increased disk access (increasing the log level, decreasing the file
rotation limit or time limit) also slows down the application.</p>
</div>
<div class="paragraph">
<p>Also, make sure that any custom log handler does not log to a slow
device like a network file system since this can adversely affect
performance.</p>
</div>
</div>
<div class="sect3">
<h4 id="log-levels"><a class="anchor" href="#log-levels"></a>Log Levels</h4>
<div class="paragraph">
<p>Set the log level for the server and its subsystems in the Eclipse GlassFish Administration Console. Navigate to the
Configurations&gt;configuration-name&gt;Logger Settings page, and follow the
instructions in the online help. Alternatively, you can configure
logging by following the instructions in
"<a href="administration-guide.html#administering-the-logging-service">Administering the Logging Service</a>"
in Eclipse GlassFish Administration Guide.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="web-container-settings"><a class="anchor" href="#web-container-settings"></a>Web Container Settings</h3>
<div class="paragraph">
<p>Set Web container settings in the Eclipse GlassFish Administration
Console by navigating to the Configurations&gt;configuration-name&gt;Web
Container node. Follow the instructions in the online help for more
information. Alternatively, you can configure Web container settings by
following the instructions in "<a href="administration-guide.html#administering-web-applications">Administering Web
Applications</a>" in Eclipse GlassFish Administration
Guide.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#session-properties-session-timeout">Session Properties: Session Timeout</a></p>
</li>
<li>
<p><a href="#manager-properties-reap-interval">Manager Properties: Reap Interval</a></p>
</li>
<li>
<p><a href="#disable-dynamic-jsp-reloading">Disable Dynamic JSP Reloading</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="session-properties-session-timeout"><a class="anchor" href="#session-properties-session-timeout"></a>Session Properties: Session Timeout</h4>
<div class="paragraph">
<p>Session timeout determines how long the server maintains a session if a
user does not explicitly invalidate the session. The default value is 30
minutes. Tune this value according to your application requirements.
Setting a very large value for session timeout can degrade performance
by causing the server to maintain too many sessions in the session
store. However, setting a very small value can cause the server to
reclaim sessions too soon.</p>
</div>
</div>
<div class="sect3">
<h4 id="manager-properties-reap-interval"><a class="anchor" href="#manager-properties-reap-interval"></a>Manager Properties: Reap Interval</h4>
<div class="paragraph">
<p>Modifying the reap interval can improve performance, but setting it
without considering the nature of your sessions and business logic can
cause data inconsistency, especially for time-based
persistence-frequency.</p>
</div>
<div class="paragraph">
<p>For example, if you set the reap interval to 60 seconds, the value of
session data will be recorded every 60 seconds. But if a client accesses
a servlet to update a value at 20 second increments, then
inconsistencies will result.</p>
</div>
<div class="paragraph">
<p>For example, consider the following online auction scenario:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bidding starts at $5, in 60 seconds the value recorded will be $8
(three 20 second intervals).</p>
</li>
<li>
<p>During the next 40 seconds, the client starts incrementing the price.
The value the client sees is $10.</p>
</li>
<li>
<p>During the client&#8217;s 20 second rest, the Eclipse GlassFish stops and
starts in 10 seconds. As a result, the latest value recorded at the 60
second interval ($8) is be loaded into the session.</p>
</li>
<li>
<p>The client clicks again expecting to see $11; but instead sees is $9,
which is incorrect.</p>
</li>
<li>
<p>So, to avoid data inconsistencies, take into the account the expected
behavior of the application when adjusting the reap interval.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="disable-dynamic-jsp-reloading"><a class="anchor" href="#disable-dynamic-jsp-reloading"></a>Disable Dynamic JSP Reloading</h4>
<div class="paragraph">
<p>On a production system, improve web container performance by disabling
dynamic JSP reloading. To do so, edit the <code>default-web.xml</code> file in the
<code>config</code> directory for each instance. Change the servlet definition for
a JSP file to look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servlet&gt;</span>
  <span class="tag">&lt;servlet-name&gt;</span>jsp<span class="tag">&lt;/servlet-name&gt;</span>
  <span class="tag">&lt;servlet-class&gt;</span>org.glassfish.wasp.servlet.JspServlet<span class="tag">&lt;/servlet-class&gt;</span>
  <span class="tag">&lt;init-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>development<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>false<span class="tag">&lt;/param-value&gt;</span>
  <span class="tag">&lt;/init-param&gt;</span>
  <span class="tag">&lt;init-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>xpoweredBy<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
  <span class="tag">&lt;/init-param&gt;</span>
  <span class="tag">&lt;init-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>genStrAsCharArray<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
  <span class="tag">&lt;/init-param&gt;</span>  <span class="tag">&lt;load-on-startup&gt;</span>3<span class="tag">&lt;/load-on-startup&gt;</span>
<span class="tag">&lt;/servlet&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ejb-container-settings"><a class="anchor" href="#ejb-container-settings"></a>EJB Container Settings</h3>
<div class="paragraph">
<p>The EJB Container has many settings that affect performance. As with
other areas, use monitor the EJB Container to track its execution and
performance.</p>
</div>
<div class="paragraph">
<p>You can configure most EJB container settings from the Eclipse GlassFish
Administration Console by navigating to the
Configurations&gt;configuration-name&gt;EJB Container node and then following
the instructions in the online help.</p>
</div>
<div class="sect3">
<h4 id="monitoring-the-ejb-container"><a class="anchor" href="#monitoring-the-ejb-container"></a>Monitoring the EJB Container</h4>
<div class="paragraph">
<p>Monitoring the EJB container is disabled by default. You can enable EJB
monitoring through the Eclipse GlassFish Administration Console by
navagating to the the Configurations&gt;configuration-name&gt;Monitoring node
and then following the instructions in the online help. Set the
monitoring level to LOW for to monitor all deployed EJB components, EJB
pools, and EJB caches. Set the monitoring level to HIGH to also monitor
EJB business methods.</p>
</div>
</div>
<div class="sect3">
<h4 id="tuning-the-ejb-container"><a class="anchor" href="#tuning-the-ejb-container"></a>Tuning the EJB Container</h4>
<div class="paragraph">
<p>The EJB container caches and pools EJB components for better
performance. Tuning the cache and pool properties can provide
significant performance benefits to the EJB container.</p>
</div>
<div class="paragraph">
<p>The pool settings are valid for stateless session and entity beans while
the cache settings are valid for stateful session and entity beans.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#overview-of-ejb-pooling-and-caching">Overview of EJB Pooling and Caching</a></p>
</li>
<li>
<p><a href="#tuning-the-ejb-pool">Tuning the EJB Pool</a></p>
</li>
<li>
<p><a href="#tuning-the-ejb-cache">Tuning the EJB Cache</a></p>
</li>
<li>
<p><a href="#pool-and-cache-settings-for-individual-ejb-components">Pool and Cache Settings for Individual EJB Components</a></p>
</li>
<li>
<p><a href="#commit-option">Commit Option</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="overview-of-ejb-pooling-and-caching"><a class="anchor" href="#overview-of-ejb-pooling-and-caching"></a>Overview of EJB Pooling and Caching</h5>
<div class="paragraph">
<p>Both stateless session beans and entity beans can be pooled to improve
server performance. In addition, both stateful session beans and entity
beans can be cached to improve performance.</p>
</div>
<div id="gacmo" class="paragraph">
<p>Table 3-1 Bean Type Pooling or Caching</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Bean Type</th>
<th class="tableblock halign-left valign-top">Pooled</th>
<th class="tableblock halign-left valign-top">Cached</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stateless Session</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stateful Session</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The difference between a pooled bean and a cached bean is that pooled
beans are all equivalent and indistinguishable from one another. Cached
beans, on the contrary, contain conversational state in the case of
stateful session beans, and are associated with a primary key in the
case of entity beans. Entity beans are removed from the pool and added
to the cache on <code>ejbActivate()</code> and removed from the cache and added to
the pool on <code>ejbPassivate()</code>. <code>ejbActivate()</code> is called by the container
when a needed entity bean is not in the cache. <code>ejbPassivate()</code> is
called by the container when the cache grows beyond its configured
limits.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you develop and deploy your EJB components using Oracle Java Studio,
then you need to edit the individual bean descriptor settings for bean
pool and bean cache. These settings might not be suitable for
production-level deployment.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="tuning-the-ejb-pool"><a class="anchor" href="#tuning-the-ejb-pool"></a>Tuning the EJB Pool</h5>
<div class="paragraph">
<p>A bean in the pool represents the pooled state in the EJB lifecycle.
This means that the bean does not have an identity. The advantage of
having beans in the pool is that the time to create a bean can be saved
for a request. The container has mechanisms that create pool objects in
the background, to save the time of bean creation on the request path.</p>
</div>
<div class="paragraph">
<p>Stateless session beans and entity beans use the EJB pool. Keeping in
mind how you use stateless session beans and the amount of traffic your
server handles, tune the pool size to prevent excessive creation and
deletion of beans.</p>
</div>
<div id="ejb-pool-settings" class="paragraph">
<p>EJB Pool Settings</p>
</div>
<div class="paragraph">
<p>An individual EJB component can specify cache settings that override
those of the EJB container in the <code>&lt;bean-pool&gt;</code> element of the EJB
component&#8217;s <code>sun-ejb-jar.xml</code> deployment descriptor.</p>
</div>
<div class="paragraph">
<p>The EJB pool settings are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initial and Minimum Pool Size: the initial and minimum number of beans
maintained in the pool. Valid values are from 0 to <code>MAX_INTEGER,</code> and
the default value is 8. The corresponding EJB deployment descriptor
attribute is <code>steady-pool-size.</code></p>
<div class="paragraph">
<p>Set this property to a number greater than zero for a moderately loaded
system. Having a value greater than zero ensures that there is always a
pooled instance to process an incoming request.</p>
</div>
</li>
<li>
<p>Maximum Pool Size: the maximum number of connections that can be
created to satisfy client requests. Valid values are from zero to
<code>MAX_INTEGER</code>., and the default is 32. A value of zero means that the
size of the pool is unbounded. The potential implication is that the JVM
heap will be filled with objects in the pool. The corresponding EJB
deployment descriptor attribute is <code>max-pool-size</code>.</p>
<div class="paragraph">
<p>Set this property to be representative of the anticipated high load of
the system. An very large pool wastes memory and can slow down the
system. A very small pool is also inefficient due to contention.</p>
</div>
</li>
<li>
<p>Pool Resize Quantity: the number of beans to be created or deleted
when the cache is being serviced by the server. Valid values are from
zero to <code>MAX_INTEGER</code> and default is 16. The corresponding EJB
deployment descriptor attribute is <code>resize-quantity</code>.</p>
<div class="paragraph">
<p>Be sure to re-calibrate the pool resize quantity when you change the
maximum pool size, to maintain an equilibrium. Generally, a larger
maximum pool size should have a larger pool resize quantity.</p>
</div>
</li>
<li>
<p>Pool Idle Timeout: the maximum time that a stateless session bean,
entity bean, or message-driven bean is allowed to be idle in the pool.
After this time, the bean is destroyed if the bean in case is a
stateless session bean or a message driver bean. This is a hint to
server. The default value is 600 seconds. The corresponding EJB
deployment descriptor attribute is <code>pool-idle-timeout-in-seconds</code>.</p>
<div class="paragraph">
<p>If there are more beans in the pool than the maximum pool size, the pool
drains back to initial and minimum pool size, in steps of pool resize
quantity at an interval specified by the pool idle timeout. If the
resize quantity is too small and the idle timeout large, you will not
see the pool draining back to steady size quickly enough.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tuning-the-ejb-cache"><a class="anchor" href="#tuning-the-ejb-cache"></a>Tuning the EJB Cache</h5>
<div class="paragraph">
<p>A bean in the cache represents the ready state in the EJB lifecycle.
This means that the bean has an identity (for example, a primary key or
session ID) associated with it.</p>
</div>
<div class="paragraph">
<p>Beans moving out of the cache have to be passivated or destroyed
according to the EJB lifecycle. Once passivated, a bean has to be
activated to come back into the cache. Entity beans are generally stored
in databases and use some form of query language semantics to load and
store data. Session beans have to be serialized when storing them upon
passivation onto the disk or a database; and similarly have to be
deserialized upon activation.</p>
</div>
<div class="paragraph">
<p>Any incoming request using these "ready" beans from the cache avoids the
overhead of creation, setting identity, and potentially activation. So,
theoretically, it is good to cache as many beans as possible. However,
there are drawbacks to caching:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Memory consumed by all the beans affects the heap available in the
Virtual Machine.</p>
</li>
<li>
<p>Increasing objects and memory taken by cache means longer, and
possibly more frequent, garbage collection.</p>
</li>
<li>
<p>The application server might run out of memory unless the heap is
carefully tuned for peak loads.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Keeping in mind how your application uses stateful session beans and
entity beans, and the amount of traffic your server handles, tune the
EJB cache size and timeout settings to minimize the number of
activations and passivations.</p>
</div>
<div id="ejb-cache-settings" class="paragraph">
<p>EJB Cache Settings</p>
</div>
<div class="paragraph">
<p>An individual EJB component can specify cache settings that override
those of the EJB container in the <code>&lt;bean-cache&gt;</code> element of the EJB
component&#8217;s <code>sun-ejb-jar.xml</code> deployment descriptor.</p>
</div>
<div class="paragraph">
<p>The EJB cache settings are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Max Cache Size: Maximum number of beans in the cache. Make this
setting greater than one. The default value is 512. A value of zero
indicates the cache is unbounded, which means the size of the cache is
governed by Cache Idle Timeout and Cache Resize Quantity. The
corresponding EJB deployment descriptor attribute is <code>max-cache-size</code>.</p>
</li>
<li>
<p>Cache Resize Quantity: Number of beans to be created or deleted when
the cache is serviced by the server. Valid values are from zero to
MAX_INTEGER, and the default is 16. The corresponding EJB deployment
descriptor attribute is <code>resize-quantity</code>.</p>
</li>
<li>
<p>Removal Timeout: Amount of time that a stateful session bean remains
passivated (idle in the backup store). If a bean was not accessed after
this interval of time, then it is removed from the backup store and will
not be accessible to the client. The default value is 60 minutes. The
corresponding EJB deployment descriptor attribute is
<code>removal-timeout-in-seconds</code>.</p>
</li>
<li>
<p>Removal Selection Policy: Algorithm used to remove objects from the
cache. The corresponding EJB deployment descriptor attribute is
<code>victim-selection-policy</code>. Choices are:</p>
<div class="ulist">
<ul>
<li>
<p>NRU (not recently used). This is the default, and is actually
pseudo-random selection policy.</p>
</li>
<li>
<p>FIFO (first in, first out)</p>
</li>
<li>
<p>LRU (least recently used)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Cache Idle Timeout: Maximum time that a stateful session bean or
entity bean is allowed to be idle in the cache. After this time, the
bean is passivated to the backup store. The default value is 600
seconds. The corresponding EJB deployment descriptor attribute is
<code>cache-idle-timeout-in-seconds</code>.</p>
</li>
<li>
<p>Refresh period: Rate at which a read-only-bean is refreshed from the
data source. Zero (0) means that the bean is never refreshed. The
default is 600 seconds. The corresponding EJB deployment descriptor
attribute is <code>refresh-period-in-seconds</code>. Note: this setting does not
have a custom field in the Admin Console. To set it, use the Add
Property button in the Additional Properties section.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="pool-and-cache-settings-for-individual-ejb-components"><a class="anchor" href="#pool-and-cache-settings-for-individual-ejb-components"></a>Pool and Cache Settings for Individual EJB Components</h5>
<div class="paragraph">
<p>Individual EJB pool and cache settings in the <code>sun-ejb-jar.xml</code>
deployment descriptor override those of the EJB container. The following
table lists the cache and pool settings for each type of EJB component.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 35%;">
<col style="width: 13%;">
<col style="width: 13%;">
<col style="width: 13%;">
<col style="width: 13%;">
<col style="width: 13%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Cache or Pool Setting</th>
<th class="tableblock halign-left valign-top">Stateful Session Bean</th>
<th class="tableblock halign-left valign-top">Stateless Session Bean</th>
<th class="tableblock halign-left valign-top">Entity Bean</th>
<th class="tableblock halign-left valign-top">Entity Read-Only Bean</th>
<th class="tableblock halign-left valign-top">Message Driven Bean</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-resize-quantity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max-cache-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache-idle-timeout-in-seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>removal-timeout-in-seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>victim-selection-policy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>refresh-period-in-seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>steady-pool-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool-resize-quantity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max-pool-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool-idle-timeout-in-seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="commit-option"><a class="anchor" href="#commit-option"></a>Commit Option</h5>
<div class="paragraph">
<p>The commit option controls the action taken by the EJB container when an
EJB component completes a transaction. The commit option has a
significant impact on performance.</p>
</div>
<div class="paragraph">
<p>The following are the possible values for the commit option:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Commit option B: When a transaction completes, the bean is kept in the
cache and retains its identity. The next invocation for the same primary
key can use the cached instance. The EJB container will call the bean&#8217;s
<code>ejbLoad()</code> method before the method invocation to synchronize with the database.</p>
</li>
<li>
<p>Commit option C: When a transaction completes, the EJB container calls
the bean&#8217;s <code>ejbPassivate()</code> method, the bean is disassociated from its
primary key and returned to the free pool. The next invocation for the
same primary key will have to get a free bean from the pool, set the
<code>PrimaryKey</code> on this instance, and then call <code>ejbActivate()</code> on the
instance. Again, the EJB container will call the bean&#8217;s <code>ejbLoad()</code>
before the method invocation to synchronize with the database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Option B avoids <code>ejbAcivate()</code> and <code>ejbPassivate()</code> calls. So, in most
cases it performs better than option C since it avoids some overhead in
acquiring and releasing objects back to pool.</p>
</div>
<div class="paragraph">
<p>However, there are some cases where option C can provide better
performance. If the beans in the cache are rarely reused and if beans
are constantly added to the cache, then it makes no sense to cache
beans. With option C is used, the container puts beans back into the
pool (instead of caching them) after method invocation or on transaction
completion. This option reuses instances better and reduces the number
of live objects in the JVM, speeding garbage collection.</p>
</div>
<div id="determining-the-best-commit-option" class="paragraph">
<p>Determining the Best Commit Option</p>
</div>
<div class="paragraph">
<p>To determine whether to use commit option B or commit option C, first
take a look at the cache-hits value using the monitoring command for the
bean. If the cache hits are much higher than cache misses, then option B
is an appropriate choice. You might still have to change the
<code>max-cache-size</code> and <code>cache-resize-quantity</code> to get the best result.</p>
</div>
<div class="paragraph">
<p>If the cache hits are too low and cache misses are very high, then the
application is not reusing the bean instances and hence increasing the
cache size (using <code>max-cache-size</code>) will not help (assuming that the
access pattern remains the same). In this case you might use commit
option C. If there is no great difference between cache-hits and
cache-misses then tune <code>max-cache-size</code>, and probably
<code>cache-idle-timeout-in-seconds</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java-message-service-settings"><a class="anchor" href="#java-message-service-settings"></a>Java Message Service Settings</h3>
<div class="paragraph">
<p>The Type attribute that determines whether the Java Message Service
(JMS) is on local or remote system affects performance. Local JMS
performance is better than remote JMS performance. However, a remote
cluster can provide failover capabilities and can be administrated
together, so there may be other advantages of using remote JMS. For more
information on using JMS, see "<a href="administration-guide.html#administering-the-java-message-service-jms">Administering the Java
Message Service (JMS)</a>" in Eclipse GlassFish
Administration Guide.</p>
</div>
</div>
<div class="sect2">
<h3 id="transaction-service-settings"><a class="anchor" href="#transaction-service-settings"></a>Transaction Service Settings</h3>
<div class="paragraph">
<p>The transaction manager makes it possible to commit and roll back
distributed transactions.</p>
</div>
<div class="paragraph">
<p>A distributed transactional system writes transactional activity into
transaction logs so that they can be recovered later. But writing
transactional logs has some performance penalty.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#monitoring-the-transaction-service">Monitoring the Transaction Service</a></p>
</li>
<li>
<p><a href="#tuning-the-transaction-service">Tuning the Transaction Service</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="monitoring-the-transaction-service"><a class="anchor" href="#monitoring-the-transaction-service"></a>Monitoring the Transaction Service</h4>
<div class="paragraph">
<p>Transaction Manager monitoring is disabled by default. Enable monitoring
of the transaction service through the Eclipse GlassFish Administration
Console by navigating to the
Configurations&gt;configuration-name&gt;Monitoring node. Refer to the
Administration Console for complete instructions.</p>
</div>
<div class="paragraph">
<p>You can also enable monitoring with these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>set serverInstance.transaction-service.monitoringEnabled=true
reconfig serverInstance</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="viewing-monitoring-information"><a class="anchor" href="#viewing-monitoring-information"></a>Viewing Monitoring Information</h5>
<div class="paragraph">
<p>To view monitoring information for the transaction service in the
Eclipse GlassFish Administration Console, navigate to the server (Admin
Server) node and then select the Monitor tab.</p>
</div>
<div class="paragraph">
<p>The following statistics are gathered on the transaction service:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>total-tx-completed</code> Completed transactions.</p>
</li>
<li>
<p><code>total-tx-rolled-back</code> Total rolled back transactions.</p>
</li>
<li>
<p><code>total-tx-inflight</code> Total inflight (active) transactions.</p>
</li>
<li>
<p><code>isFrozen</code> Whether transaction system is frozen (true or false)</p>
</li>
<li>
<p><code>inflight-tx</code> List of inflight (active) transactions.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tuning-the-transaction-service"><a class="anchor" href="#tuning-the-transaction-service"></a>Tuning the Transaction Service</h4>
<div class="paragraph">
<p>This property can be used to disable the transaction logging, where the
performance is of utmost importance more than the recovery. This
property, by default, won&#8217;t exist in the server configuration.</p>
</div>
<div class="paragraph">
<p>Most Transaction Service tuning tasks can be performed through the
Eclipse GlassFish Administration Console by navigating to the
Configurations&gt;configuration-name&gt;Transaction Service node and then
following the instructions in the online help. Alternatively, you can
follow the instructions in "<a href="administration-guide.html#administering-transactions">Administering
Transactions</a>" in Eclipse GlassFish Administration
Guide.</p>
</div>
<div class="sect4">
<h5 id="disable-distributed-transaction-logging"><a class="anchor" href="#disable-distributed-transaction-logging"></a>Disable Distributed Transaction Logging</h5>
<div class="paragraph">
<p>You can disable transaction logging through the Administration Console
or by using the following <code>asadmin set</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin set
server1.transaction-service.disable-distributed-transaction-logging=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Disabling transaction logging can improve performance. Setting it to
false (the default), makes the transaction service write transactional
activity to transaction logs so that transactions can be recovered. If
Recover on Restart is checked, this property is ignored.</p>
</div>
<div class="paragraph">
<p>Set this property to true only if performance is more important than
transaction recovery.</p>
</div>
</div>
<div class="sect4">
<h5 id="recover-on-restart-automatic-recovery"><a class="anchor" href="#recover-on-restart-automatic-recovery"></a>Recover On Restart (Automatic Recovery)</h5>
<div class="paragraph">
<p>You can set the Recover on Restart attribute through the Administration
Console or by entering the following <code>asadmin set</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin set server1.transaction-service.automatic-recovery=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>When Recover on Restart is true, the server will always perform
transaction logging, regardless of the Disable Distributed Transaction
Logging attribute.</p>
</div>
<div class="paragraph">
<p>If Recover on Restart is false, then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If Disable Distributed Transaction Logging is false (the default),
then the server will write transaction logs.</p>
</li>
<li>
<p>If Disable Distributed Transaction Logging is true, then the server
will not write transaction logs.</p>
<div class="paragraph">
<p>Not writing transaction logs will give approximately twenty percent
improvement in performance, but at the cost of not being able to recover
from any interrupted transactions. The performance benefit applies to
transaction-intensive tests. Gains in real applications may be less.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="keypoint-interval"><a class="anchor" href="#keypoint-interval"></a>Keypoint Interval</h5>
<div class="paragraph">
<p>The keypoint interval determines how often entries for completed
transactions are removed from the log file. Keypointing prevents a
process log from growing indefinitely.</p>
</div>
<div class="paragraph">
<p>Frequent keypointing is detrimental to performance. The default value of
the Keypoint Interval is 2048, which is sufficient in most cases.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="http-service-settings"><a class="anchor" href="#http-service-settings"></a>HTTP Service Settings</h3>
<div class="paragraph">
<p>Tuning the monitoring and access logging settings for the HTTP server
instances that handle client requests are important parts of ensuring
peak Eclipse GlassFish performance.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#monitoring-the-http-service">Monitoring the HTTP Service</a></p>
</li>
<li>
<p><a href="#http-service-access-logging">HTTP Service Access Logging</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="monitoring-the-http-service"><a class="anchor" href="#monitoring-the-http-service"></a>Monitoring the HTTP Service</h4>
<div class="paragraph">
<p>Disabling the collection of monitoring statistics can increase overall
Eclipse GlassFish performance. You can enable or disable monitoring
statistics collection for the HTTP service using either the
Administration Console or <code>asadmin</code> subcommands.</p>
</div>
<div class="paragraph">
<p>Refer to "<a href="administration-guide.html#administering-the-monitoring-service">Administering the Monitoring Service</a>" in
Eclipse GlassFish Administration Guide for complete
instructions on configuring the monitoring service using <code>asadmin</code>
subcommands.</p>
</div>
<div class="paragraph">
<p>If using the Administration Console, click the
Configurations&gt;configuration-name&gt;Monitoring node for the configuration
for which you want to enable or disable monitoring for selected
components. Refer to the Administration Console online help for complete
instructions.</p>
</div>
<div class="paragraph">
<p>For instructions on viewing comprehensive monitoring statistics using
<code>asadmin</code> subcommands, see "<a href="administration-guide.html#viewing-comprehensive-monitoring-data">Viewing Comprehensive
Monitoring Data</a>" in Eclipse GlassFish Administration
Guide. If using the Administration Console, you can view monitoring
statistics by navigating to the server (Admin Server) node, and then
clicking the Monitor tab. Refer to the online help for configuring
different views of the available monitoring statistics.</p>
</div>
<div class="paragraph">
<p>When viewing monitoring statistics, some key performance-related
information to review includes the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#dns-cache-information-dns">DNS Cache Information (dns)</a></p>
</li>
<li>
<p><a href="#file-cache-information-file-cache">File Cache Information (file-cache)</a></p>
</li>
<li>
<p><a href="#keep-alive-keep-alive">Keep Alive (keep-alive)</a></p>
</li>
<li>
<p><a href="#connection-queue">Connection Queue</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="dns-cache-information-dns"><a class="anchor" href="#dns-cache-information-dns"></a>DNS Cache Information (dns)</h5>
<div class="paragraph">
<p>The DNS cache caches IP addresses and DNS names. The DNS cache is
disabled by default. In the DNS Statistics for Process ID All page under
Monitor in the web-based Administration interface the following
statistics are displayed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#enabled">Enabled</a></p>
</li>
<li>
<p><a href="#cacheentries-currentcacheentries-maxcacheentries">CacheEntries (CurrentCacheEntries / MaxCacheEntries)</a></p>
</li>
<li>
<p><a href="#hitratio">HitRatio</a></p>
</li>
<li>
<p><a href="#caching-dns-entries">Caching DNS Entries</a></p>
</li>
<li>
<p><a href="#limit-dns-lookups-to-asynchronous">Limit DNS Lookups to Asynchronous</a></p>
</li>
<li>
<p><a href="#enabled-1">Enabled</a></p>
</li>
<li>
<p><a href="#namelookups">NameLookups</a></p>
</li>
<li>
<p><a href="#addrlookups">AddrLookups</a></p>
</li>
<li>
<p><a href="#lookupsinprogress">LookupsInProgress</a></p>
</li>
</ul>
</div>
<div id="enabled" class="paragraph">
<p>Enabled</p>
</div>
<div class="paragraph">
<p>If the DNS cache is disabled, the rest of this section is not displayed.</p>
</div>
<div class="paragraph">
<p>By default, the DNS cache is off. Enable DNS caching in the
Administration Console by clicking the
Configurations&gt;configuration-name&gt;Network Config&gt;http-listener-name
node. Click the HTTP tab and enable the DNS Lookup option.</p>
</div>
<div id="cacheentries-currentcacheentries-maxcacheentries" class="paragraph">
<p>CacheEntries (CurrentCacheEntries / MaxCacheEntries)</p>
</div>
<div class="paragraph">
<p>The number of current cache entries and the maximum number of cache
entries. A single cache entry represents a single IP address or DNS name
lookup. Make the cache as large as the maximum number of clients that
access your web site concurrently. Note that setting the cache size too
high is a waste of memory and degrades performance.</p>
</div>
<div class="paragraph">
<p>Set the maximum size of the DNS cache by entering or changing the value
in the in the Administration Console by clicking the
Configurations&gt;configuration-name&gt;Network Config&gt;http-listener-name
node. Click the File tab and set the desired options.</p>
</div>
<div id="hitratio" class="paragraph">
<p>HitRatio</p>
</div>
<div class="paragraph">
<p>The hit ratio is the number of cache hits divided by the number of cache
lookups.</p>
</div>
<div class="paragraph">
<p>This setting is not tunable.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you turn off DNS lookups on your server, host name restrictions will
not work and IP addresses will appear instead of host names in log
files.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="caching-dns-entries" class="paragraph">
<p>Caching DNS Entries</p>
</div>
<div class="paragraph">
<p>It is possible to also specify whether to cache the DNS entries. If you
enable the DNS cache, the server can store hostname information after
receiving it. If the server needs information about the client in the
future, the information is cached and available without further
querying. specify the size of the DNS cache and an expiration time for
DNS cache entries. The DNS cache can contain 32 to 32768 entries; the
default value is 1024. Values for the time it takes for a cache entry to
expire can range from 1 second to 1 year specified in seconds; the
default value is 1200 seconds (20 minutes).</p>
</div>
<div id="limit-dns-lookups-to-asynchronous" class="paragraph">
<p>Limit DNS Lookups to Asynchronous</p>
</div>
<div class="paragraph">
<p>Do not use DNS lookups in server processes because they are
resource-intensive. If you must include DNS lookups, make them
asynchronous.</p>
</div>
<div id="enabled-1" class="paragraph">
<p>Enabled</p>
</div>
<div class="paragraph">
<p>If asynchronous DNS is disabled, the rest of this section will not be
displayed.</p>
</div>
<div id="namelookups" class="paragraph">
<p>NameLookups</p>
</div>
<div class="paragraph">
<p>The number of name lookups (DNS name to IP address) that have been done
since the server was started. This setting is not tunable.</p>
</div>
<div id="addrlookups" class="paragraph">
<p>AddrLookups</p>
</div>
<div class="paragraph">
<p>The number of address loops (IP address to DNS name) that have been done
since the server was started. This setting is not tunable.</p>
</div>
<div id="lookupsinprogress" class="paragraph">
<p>LookupsInProgress</p>
</div>
<div class="paragraph">
<p>The current number of lookups in progress.</p>
</div>
</div>
<div class="sect4">
<h5 id="file-cache-information-file-cache"><a class="anchor" href="#file-cache-information-file-cache"></a>File Cache Information (file-cache)</h5>
<div class="paragraph">
<p>The file cache caches static content so that the server handles requests
for static content quickly. The file-cache section provides statistics
on how your file cache is being used.</p>
</div>
<div class="paragraph">
<p>For information about tuning the file cache, see <a href="#file-cache-settings">File Cache
Settings</a>.</p>
</div>
<div class="paragraph">
<p>The Monitoring page lists the following file cache statistics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Number of Hits on Cached File Content</p>
</li>
<li>
<p>Number of Cache Entries</p>
</li>
<li>
<p>Number of Hits on Cached File Info</p>
</li>
<li>
<p>Heap Space Used for Cache</p>
</li>
<li>
<p>Number of Misses on Cached File Content</p>
</li>
<li>
<p>Cache Lookup Misses</p>
</li>
<li>
<p>Number of Misses on Cached File Content</p>
</li>
<li>
<p>Max Age of a Cache Entry</p>
</li>
<li>
<p>Max Number of Cache Entries</p>
</li>
<li>
<p>Max Number of Open Entries</p>
</li>
<li>
<p>Is File Cached Enabled?</p>
</li>
<li>
<p>Maximum Memory Map to be Used for Cache</p>
</li>
<li>
<p>Memory Map Used for cache</p>
</li>
<li>
<p>Cache Lookup Hits</p>
</li>
<li>
<p>Open Cache Entries: The number of current cache entries and the
maximum number of cache entries are both displayed. A single cache entry
represents a single URI. This is a tunable setting.</p>
</li>
<li>
<p>Maximum Heap Space to be Used for Cache</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="keep-alive-keep-alive"><a class="anchor" href="#keep-alive-keep-alive"></a>Keep Alive (keep-alive)</h5>
<div class="paragraph">
<p>The following are statistics related to the Keep Alive system. The most
important settings you can tune here relate to HTTP Timeout. See
<a href="#timeout">Timeout</a> for more information.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Connections Terminated Due to Client Connection Timed Out</p>
</li>
<li>
<p>Max Connection Allowed in Keep-alive</p>
</li>
<li>
<p>Number of Hits</p>
</li>
<li>
<p>Connections in Keep-alive Mode</p>
</li>
<li>
<p>Connections not Handed to Keep-alive Thread Due to too Many Persistent
Connections</p>
</li>
<li>
<p>The Time in Seconds Before Idle Connections are Closed</p>
</li>
<li>
<p>Connections Closed Due to Max Keep-alive Being Exceeded</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="connection-queue"><a class="anchor" href="#connection-queue"></a>Connection Queue</h5>
<div class="ulist">
<ul>
<li>
<p>Total Connections Queued: Total connections queued is the total number
of times a connection has been queued. This includes newly accepted
connections and connections from the keep-alive system.</p>
</li>
<li>
<p>Average Queuing Delay: Average queueing delay is the average amount of
time a connection spends in the connection queue. This represents the
delay between when a request connection is accepted by the server, and a
request processing thread (also known as a session) begins servicing the
request.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="http-service-access-logging"><a class="anchor" href="#http-service-access-logging"></a>HTTP Service Access Logging</h4>
<div class="paragraph">
<p>Accessing Logging can be tuned using several <code>asadmin</code> subcommands.
Refer to "<a href="administration-guide.html#administering-the-monitoring-service">Administering the Monitoring Service</a>" in
Eclipse GlassFish Administration Guide for
information about using these subcommands.</p>
</div>
<div class="paragraph">
<p>If using the Administration Console, Access Logging is configured from
the Configurations&gt;configuration-name&gt;HTTP Service page. Refer to the
Administration Console online help for complete instructions about the
options on this page.</p>
</div>
<div class="paragraph">
<p>To enable or disable access logging, check or uncheck the Access Logging
Enabled checkbox. Access Logging is disabled by default.</p>
</div>
<div class="paragraph">
<p>When performing benchmarking, ensure that Access Logging is disabled. If
Access Logging is enabled, it is recommended that you also enable
Rotation to ensure that the logs do not run out of disk space.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="network-listener-settings"><a class="anchor" href="#network-listener-settings"></a>Network Listener Settings</h3>
<div class="paragraph">
<p>You can tune Network Listener settings from the command line by using
the instructions in "<a href="administration-guide.html#administering-http-network-listeners">Administering HTTP Network
Listeners</a>" in Eclipse GlassFish Administration
Guide.</p>
</div>
<div class="paragraph">
<p>If using the Administration Console, navigate to the Configurations
&gt;configuration-name&gt;Network Config&gt;Network Listeners&gt;listener-name node,
and then click the tab for the desired configuration page. Refer to the
online help for complete instructions about the options on these tabs.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish Network Listener performance can be enhanced by
modifying settings on the following Edit Network Listener tabs in the
Administration Console:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#general-settings-1">General Settings</a></p>
</li>
<li>
<p><a href="#http-settings">HTTP Settings</a></p>
</li>
<li>
<p><a href="#file-cache-settings">File Cache Settings</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="general-settings-1"><a class="anchor" href="#general-settings-1"></a>General Settings</h4>
<div class="paragraph">
<p>For machines with only one network interface card (NIC), set the network
address to the IP address of the machine (for example, 192.18.80.23
instead of default 0.0.0.0). If you specify an IP address other than
0.0.0.0, the server will make one less system call per connection.
Specify an IP address other than 0.0.0.0 for best possible performance.
If the server has multiple NIC cards then create multiple listeners for
each NIC.</p>
</div>
</div>
<div class="sect3">
<h4 id="http-settings"><a class="anchor" href="#http-settings"></a>HTTP Settings</h4>
<div class="paragraph">
<p>The following settings on the HTTP tab can significantly affect
performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#max-connections">Max Connections</a></p>
</li>
<li>
<p><a href="#dns-lookup-enabled">DNS Lookup Enabled</a></p>
</li>
<li>
<p><a href="#timeout">Timeout</a></p>
</li>
<li>
<p><a href="#header-buffer-length">Header Buffer Length</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="max-connections"><a class="anchor" href="#max-connections"></a>Max Connections</h5>
<div class="paragraph">
<p>Max Connections controls the number of requests that a particular client
can make over a keep-alive connection. The range is any positive
integer, and the default is 256.</p>
</div>
<div class="paragraph">
<p>Adjust this value based on the number of requests a typical client makes
in your application. For best performance specify quite a large number,
allowing clients to make many requests.</p>
</div>
<div class="paragraph">
<p>The number of connections specified by Max Connections is divided
equally among the keep alive threads. If Max Connections is not equally
divisible by Thread Count, the server can allow slightly more than Max
Connections simultaneous keep alive connections.</p>
</div>
</div>
<div class="sect4">
<h5 id="dns-lookup-enabled"><a class="anchor" href="#dns-lookup-enabled"></a>DNS Lookup Enabled</h5>
<div class="paragraph">
<p>This setting specifies whether the server performs DNS (domain name
service) lookups on clients that access the server. When DNS lookup is
not enabled, when a client connects, the server knows the client&#8217;s IP
address but not its host name (for example, it knows the client as
198.95.251.30, rather than <code>www.xyz.com</code>). When DNS lookup is enabled,
the server will resolve the client&#8217;s IP address into a host name for
operations like access control, common gateway interface (CGI) programs,
error reporting, and access logging.</p>
</div>
<div class="paragraph">
<p>If the server responds to many requests per day, reduce the load on the
DNS or NIS (Network Information System) server by disabling DNS lookup.
Enabling DNS lookup will increase the latency and load on the system, so
modify this setting with caution.</p>
</div>
</div>
<div class="sect4">
<h5 id="timeout"><a class="anchor" href="#timeout"></a>Timeout</h5>
<div class="paragraph">
<p>Timeout determines the maximum time (in seconds) that the server holds
open an HTTP keep alive connection. A client can keep a connection to
the server open so that multiple requests to one server can be serviced
by a single network connection. Since the number of open connections
that the server can handle is limited, a high number of open connections
will prevent new clients from connecting.</p>
</div>
<div class="paragraph">
<p>The default time out value is 30 seconds. Thus, by default, the server
will close the connection if idle for more than 30 seconds. The maximum
value for this parameter is 300 seconds (5 minutes).</p>
</div>
<div class="paragraph">
<p>The proper value for this parameter depends upon how much time is
expected to elapse between requests from a given client. For example, if
clients are expected to make requests frequently then, set the parameter
to a high value; likewise, if clients are expected to make requests
rarely, then set it to a low value.</p>
</div>
<div class="paragraph">
<p>Both HTTP 1.0 and HTTP 1.1 support the ability to send multiple requests
across a single HTTP session. A server can receive hundreds of new HTTP
requests per second. If every request was allowed to keep the connection
open indefinitely, the server could become overloaded with connections.
On Unix/Linux systems, this could easily lead to a file table overflow.</p>
</div>
<div class="paragraph">
<p>The Eclipse GlassFish&#8217;s Keep Alive system, which is affected by the
Timeout setting, addresses this problem. A waiting keep alive connection
has completed processing the previous request, and is waiting for a new
request to arrive on the same connection. The server maintains a counter
for the maximum number of waiting keep-alive connections. If the server
has more than the maximum waiting connections open when a new connection
waits for a keep-alive request, the server closes the oldest connection.
This algorithm limits the number of open waiting keep-alive connections.</p>
</div>
<div class="paragraph">
<p>If your system has extra CPU cycles, incrementally increase the keep
alive settings and monitor performance after each increase. When
performance saturates (stops improving), then stop increasing the
settings.</p>
</div>
</div>
<div class="sect4">
<h5 id="header-buffer-length"><a class="anchor" href="#header-buffer-length"></a>Header Buffer Length</h5>
<div class="paragraph">
<p>The size (in bytes) of the buffer used by each of the request processing
threads for reading the request data from the client.</p>
</div>
<div class="paragraph">
<p>Adjust the value based on the actual request size and observe the impact
on performance. In most cases the default should suffice. If the request
size is large, increase this parameter.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="file-cache-settings"><a class="anchor" href="#file-cache-settings"></a>File Cache Settings</h4>
<div class="paragraph">
<p>The Eclipse GlassFish uses a file cache to serve static information
faster. The file cache contains information about static files such as
HTML, CSS, image, or text files. Enabling the HTTP file cache will
improve performance of applications that contain static files.</p>
</div>
<div class="paragraph">
<p>The following settings on the File Cache tab can significantly affect
performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#max-file-count">Max File Count</a></p>
</li>
<li>
<p><a href="#max-age">Max Age</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="max-file-count"><a class="anchor" href="#max-file-count"></a>Max File Count</h5>
<div class="paragraph">
<p>Max File Count determines how many files are in the cache. If the value
is too big, the server caches little-needed files, which wastes memory.
If the value is too small, the benefit of caching is lost. Try different
values of this attribute to find the optimal solution for specific
applicationsâgenerally, the effects will not be great.</p>
</div>
</div>
<div class="sect4">
<h5 id="max-age"><a class="anchor" href="#max-age"></a>Max Age</h5>
<div class="paragraph">
<p>This parameter controls how long cached information is used after a file
has been cached. An entry older than the maximum age is replaced by a
new entry for the same file.</p>
</div>
<div class="paragraph">
<p>If your Web site&#8217;s content changes infrequently, increase this value for
improved performance. Set the maximum age by entering or changing the
value in the Maximum Age field of the File Cache Configuration page in
the web-based Admin Console for the HTTP server node and selecting the
File Caching Tab.</p>
</div>
<div class="paragraph">
<p>Set the maximum age based on whether the content is updated (existing
files are modified) on a regular schedule or not. For example, if
content is updated four times a day at regular intervals, you could set
the maximum age to 21600 seconds (6 hours). Otherwise, consider setting
the maximum age to the longest time you are willing to serve the
previous version of a content file after the file has been modified.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transport-settings"><a class="anchor" href="#transport-settings"></a>Transport Settings</h3>
<div class="paragraph">
<p>The Acceptor Threads property for the Transport service specifies how
many threads you want in accept mode on a listen socket at any time. It
is a good practice to set this to less than or equal to the number of
CPUs in your system.</p>
</div>
<div class="paragraph">
<p>In the Eclipse GlassFish, acceptor threads on an HTTP Listener accept
connections and put them onto a connection queue. Session threads then
pick up connections from the queue and service the requests. The server
posts more session threads if required at the end of the request.</p>
</div>
<div class="paragraph">
<p>See "<a href="administration-guide.html#administering-http-network-listeners-1">Administering HTTP Network Listeners</a>" in
Eclipse GlassFish Administration Guide for
instructions on modifying the Acceptor Threads property. If using the
Administration Console, the Acceptor Threads property is available on
the Configurations&gt;configuration-name&gt;Network Config&gt;Transports&gt;tcp
page.</p>
</div>
</div>
<div class="sect2">
<h3 id="thread-pool-settings"><a class="anchor" href="#thread-pool-settings"></a>Thread Pool Settings</h3>
<div class="paragraph">
<p>You can tune thread pool settings by following the instructions in
"<a href="administration-guide.html#administering-thread-pools">Administering Thread Pools</a>" in Eclipse GlassFish Administration Guide. If using the Administration Console
Thread Pool settings are available on the
Configurations&gt;configuration-name&gt;Thread Pools&gt;thread-pool-name page.</p>
</div>
<div class="paragraph">
<p>The following thread pool settings can have significant effects on
Eclipse GlassFish performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#max-thread-pool-size">Max Thread Pool Size</a></p>
</li>
<li>
<p><a href="#min-thread-pool-size">Min Thread Pool Size</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="max-thread-pool-size"><a class="anchor" href="#max-thread-pool-size"></a>Max Thread Pool Size</h4>
<div class="paragraph">
<p>The Max Thread Pool Size parameter specifies the maximum number of
simultaneous requests the server can handle. The default value is 5.
When the server has reached the limit or request threads, it defers
processing new requests until the number of active requests drops below
the maximum amount. Increasing this value will reduce HTTP response
latency times.</p>
</div>
<div class="paragraph">
<p>In practice, clients frequently connect to the server and then do not
complete their requests. In these cases, the server waits a length of
time specified by the Timeout parameter.</p>
</div>
<div class="paragraph">
<p>Also, some sites do heavyweight transactions that take minutes to
complete. Both of these factors add to the maximum simultaneous requests
that are required. If your site is processing many requests that take
many seconds, you might need to increase the number of maximum
simultaneous requests.</p>
</div>
<div class="paragraph">
<p>Adjust the thread count value based on your load and the length of time
for an average request. In general, increase this number if you have
idle CPU time and requests that are pending; decrease it if the CPU
becomes overloaded. If you have many HTTP 1.0 clients (or HTTP 1.1
clients that disconnect frequently), adjust the timeout value to reduce
the time a connection is kept open.</p>
</div>
<div class="paragraph">
<p>Suitable Request Max Thread Pool Size values range from 100 to 500,
depending on the load. If your system has extra CPU cycles, keep
incrementally increasing thread count and monitor performance after each
incremental increase. When performance saturates (stops improving), then
stop increasing thread count.</p>
</div>
</div>
<div class="sect3">
<h4 id="min-thread-pool-size"><a class="anchor" href="#min-thread-pool-size"></a>Min Thread Pool Size</h4>
<div class="paragraph">
<p>The Min Thread Pool Size property specifies the minimum number of
threads the server initiates upon startup. The default value is 2. Min
Thread Pool Size represents a hard limit for the maximum number of
active threads that can run simultaneously, which can become a
bottleneck for performance.</p>
</div>
<div class="paragraph">
<p>Specifying the same value for minimum and maximum threads allows
Eclipse GlassFish to use a slightly more optimized thread pool. This
configuration should be considered unless the load on the server varies
quite significantly.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="orb-settings"><a class="anchor" href="#orb-settings"></a>ORB Settings</h3>
<div class="paragraph">
<p>The Eclipse GlassFish includes a high performance and scalable CORBA
Object Request Broker (ORB). The ORB is the foundation of the EJB
Container on the server.</p>
</div>
<div class="paragraph">
<p>For complete instructions on configuring ORB settings, refer to
"<a href="administration-guide.html#administering-the-object-request-broker-orb">Administering the Object Request Broker (ORB)</a>" in
Eclipse GlassFish Administration Guide. Also refer to
"<a href="ha-administration-guide.html#rmi-iiop-load-balancing-and-failover">RMI-IIOP Load Balancing and Failover</a>" in Eclipse GlassFish High Availability Administration Guide. You
can also configure most ORB settings through the Eclipse GlassFish
Administration Console by navigating to the
Configurations&gt;configuration-name&gt; ORB node and then following the
instructions in the Administration Console online help.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#overview">Overview</a></p>
</li>
<li>
<p><a href="#how-a-client-connects-to-the-orb">How a Client Connects to the ORB</a></p>
</li>
<li>
<p><a href="#monitoring-the-orb">Monitoring the ORB</a></p>
</li>
<li>
<p><a href="#tuning-the-orb">Tuning the ORB</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="overview"><a class="anchor" href="#overview"></a>Overview</h4>
<div class="paragraph">
<p>The ORB is primarily used by EJB components via:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RMI/IIOP path from an application client (or rich client) using the
application client container.</p>
</li>
<li>
<p>RMI/IIOP path from another Eclipse GlassFish instance ORB.</p>
</li>
<li>
<p>RMI/IIOP path from another vendor&#8217;s ORB.</p>
</li>
<li>
<p>In-process path from the Web Container or MDB (message driven beans)
container.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a server instance makes a connection to another server instance
ORB, the first instance acts as a client ORB. SSL over IIOP uses a fast
optimized transport with high-performance native implementations of
cryptography algorithms.</p>
</div>
<div class="paragraph">
<p>It is important to remember that EJB local interfaces do not use the
ORB. Using a local interface passes all arguments by reference and does
not require copying any objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-a-client-connects-to-the-orb"><a class="anchor" href="#how-a-client-connects-to-the-orb"></a>How a Client Connects to the ORB</h4>
<div class="paragraph">
<p>A rich client Java program performs a new <code>initialContext()</code> call which
creates a client side ORB instance. This in turn creates a socket
connection to the Eclipse GlassFish IIOP port. The reader thread is
started on the server ORB to service IIOP requests from this client.
Using the <code>initialContext</code>, the client code does a lookup of an EJB
deployed on the server. An IOR which is a remote reference to the
deployed EJB on the server is returned to the client. Using this object
reference, the client code invokes remote methods on the EJB.</p>
</div>
<div class="paragraph">
<p><code>InitialContext</code> lookup for the bean and the method invocations
translate the marshalling application request data in Java into IIOP
message(s) that are sent on the socket connection that was created
earlier on to the server ORB. The server then creates a response and
sends it back on the same connection. This data in the response is then
un-marshalled by the client ORB and given back to the client code for
processing. The Client ORB shuts down and closes the connection when the
rich client application exits.</p>
</div>
</div>
<div class="sect3">
<h4 id="monitoring-the-orb"><a class="anchor" href="#monitoring-the-orb"></a>Monitoring the ORB</h4>
<div class="paragraph">
<p>ORB statistics are disabled by default. To gather ORB statistics, enable
monitoring with the following <code>asadmin</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>set serverInstance.iiop-service.orb.system.monitoringEnabled=true
reconfig serverInstance</code></pre>
</div>
</div>
<div class="paragraph">
<p>If using the Administration Console, you can enable ORB monitoring on
the Configurations&gt;configuration-name&gt;Monitoring page. To view ORB
monitoring statistics through the Administration Console, navigate to
the server (Admin Server) page and click the Monitor tab. Refer to the
Administration Console online help for complete instructions.</p>
</div>
<div class="paragraph">
<p>The following statistics are of particular interest when tuning the ORB:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#connection-statistics">Connection Statistics</a></p>
</li>
<li>
<p><a href="#thread-pools">Thread Pools</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="connection-statistics"><a class="anchor" href="#connection-statistics"></a>Connection Statistics</h5>
<div class="paragraph">
<p>The following statistics are gathered on ORB connections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>total-inbound-connections</code>: Total inbound connections to ORB.</p>
</li>
<li>
<p><code>total-outbound-connections</code>: Total outbound connections from ORB.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the following command to get ORB connection statistics:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get --monitor
    serverInstance.iiop-service.orb.system.orb-connection.*</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="thread-pools"><a class="anchor" href="#thread-pools"></a>Thread Pools</h5>
<div class="paragraph">
<p>The following statistics are gathered on ORB thread pools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>thread-pool-size</code>: Number of threads in ORB thread pool.</p>
</li>
<li>
<p><code>waiting-thread-count</code>: Number of thread pool threads waiting for work to arrive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the following command to display ORB thread pool statistics:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get --monitor
    serverInstance.iiop-service.orb.system.orb-thread-pool.*</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tuning-the-orb"><a class="anchor" href="#tuning-the-orb"></a>Tuning the ORB</h4>
<div class="paragraph">
<p>Tune ORB performance by setting ORB parameters and ORB thread pool
parameters. You can often decrease response time by leveraging
load-balancing, multiple shared connections, thread pool and message
fragment size. You can improve scalability by load balancing between
multiple ORB servers from the client, and tuning the number of
connection between the client and the server.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#tunable-orb-parameters">Tunable ORB Parameters</a></p>
</li>
<li>
<p><a href="#orb-thread-pool-parameters">ORB Thread Pool Parameters</a></p>
</li>
<li>
<p><a href="#client-orb-properties">Client ORB Properties</a></p>
</li>
<li>
<p><a href="#thread-pool-sizing">Thread Pool Sizing</a></p>
</li>
<li>
<p><a href="#examining-iiop-messages">Examining IIOP Messages</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="tunable-orb-parameters"><a class="anchor" href="#tunable-orb-parameters"></a>Tunable ORB Parameters</h5>
<div class="paragraph">
<p>You can tune ORB parameters using the instructions in
"<a href="administration-guide.html#administering-the-object-request-broker-orb">Administering the Object Request Broker (ORB)</a>" in
Eclipse GlassFish Administration Guide. If using the
Administration Console, navigate to the
Configurations&gt;configuration-name&gt;ORB node and refer to the online help.</p>
</div>
<div class="paragraph">
<p>The following table summarizes the tunable ORB parameters.</p>
</div>
<div id="gacma" class="paragraph">
<p>Table 3-2 Tunable ORB Parameters</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33%;">
<col style="width: 27%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">ORB Modules</th>
<th class="tableblock halign-left valign-top">Server Settings</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RMI/ IIOP from application client to application server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">communication
infrastructure, thread pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">steady-thread-pool-size,
max-thread-pool-size, idle-thread-timeout-in-seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RMI/ IIOP from ORB to Eclipse GlassFish</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">communication infrastructure,
thread pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">steady-thread-pool-size, max-thread-pool-size,
idle-thread-timeout-in-seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RMI/ IIOP from a vendor ORB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parts of communication infrastructure,
thread pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">steady-thread-pool-size, max-thread-pool-size,
idle-thread-timeout-in-seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thread pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">steady-thread-pool-size, max-thread-pool-size,
idle-thread-timeout-in-seconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="orb-thread-pool-parameters"><a class="anchor" href="#orb-thread-pool-parameters"></a>ORB Thread Pool Parameters</h5>
<div class="paragraph">
<p>The ORB thread pool contains a task queue and a pool of threads. Tasks
or jobs are inserted into the task queue and free threads pick tasks
from this queue for execution. Do not set a thread pool size such that
the task queue is always empty. It is normal for a large application&#8217;s
Max Pool Size to be ten times the size of the current task queue.</p>
</div>
<div class="paragraph">
<p>The Eclipse GlassFish uses the ORB thread pool to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute every ORB request</p>
</li>
<li>
<p>Trim EJB pools and caches</p>
</li>
<li>
<p>Execute MDB requests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Thus, even when one is not using ORB for remote-calls (via RMI/ IIOP),
set the size of the threadpool to facilitate cleaning up the EJB pools
and caches.</p>
</div>
<div class="paragraph">
<p>You can set ORB thread pool attributes using the instructions in
"<a href="administration-guide.html#administering-thread-pools">Administering Thread Pools</a>" in Eclipse GlassFish Administration Guide. If using the Administration
Console, navigate to Configurations&gt;configuration-name&gt; Thread
Pools&gt;thread-pool-name, where thread-pool-name is the thread pool ID
selected for the ORB. Thread pools have the following attributes that
affect performance.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minimum Pool Size: The minimum number of threads in the ORB thread
pool. Set to the average number of threads needed at a steady (RMI/IIOP) load.</p>
</li>
<li>
<p>Maximum Pool Size: The maximum number of threads in the ORB thread pool.</p>
</li>
<li>
<p>Idle Timeout: Number of seconds to wait before removing an idle thread from pool.
Allows shrinking of the thread pool.</p>
</li>
<li>
<p>Number of Work Queues</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In particular, the maximum pool size is important to performance. For
more information, see <a href="#thread-pool-sizing">Thread Pool Sizing</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="client-orb-properties"><a class="anchor" href="#client-orb-properties"></a>Client ORB Properties</h5>
<div class="paragraph">
<p>Specify the following properties as command-line arguments when
launching the client program. You do this by using the following syntax
when starting the Java VM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>-Dproperty=value</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#controlling-connections-between-client-and-server-orb">Controlling Connections Between Client and Server ORB</a></p>
</li>
<li>
<p><a href="#limiting-the-maximum-number-of-client-connections">Limiting the Maximum Number of Client Connections</a></p>
</li>
<li>
<p><a href="#load-balancing">Load Balancing</a></p>
</li>
</ul>
</div>
<div id="controlling-connections-between-client-and-server-orb" class="paragraph">
<p>Controlling Connections Between Client and Server ORB</p>
</div>
<div class="paragraph">
<p>When using the default JDK ORB on the client, a connection is
established from the client ORB to the application server ORB every time
an initial context is created. To pool or share these connections when
they are opened from the same process by adding to the configuration on
the client ORB.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>-Djava.naming.factory.initial=com.sun.enterprise.naming.SerialInitContextFactory</code></pre>
</div>
</div>
<div id="limiting-the-maximum-number-of-client-connections" class="paragraph">
<p>Limiting the Maximum Number of Client Connections</p>
</div>
<div class="paragraph">
<p>You can specify the total maximum number of client connections on all
ORB listener ports (TCP, SSL and SSL with mutual authentication). When
open client connections exceed the maximum value you specify, the ORB
rejects any new incoming client connections.</p>
</div>
<div class="paragraph">
<p>Set this value to support the expected number of simultaneous client
connections, but not to exceed the VM or system file descriptor limits.
If the value is set too high, the ORB will continue accepting new client
connections, resulting in a "too many open files" error if the VM runs
out of file descriptors.</p>
</div>
<div class="paragraph">
<p>To specify the maximum number of client connections, set the
<code>configs.config.<code>config-name.</code>iiop-service.orb.max-connections</code>
attribute to the number that you require:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set configs.config.config-name.iiop-service.orb.max-connections=max-connections</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration in which the IIOP service is defined.
For example, <code>server-config</code> is the name for the configuration of the
domain administration server (DAS).</p>
</dd>
<dt class="hdlist1">max-connections</dt>
<dd>
<p>An integer that specifies the maximum number of client connections.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For updates to this value to take effect, restart Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>The following example shows how to set the maximum number of client
connections for the ORB in the DAS to <code>512</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set configs.config.server-config.iiop-service.orb.max-connections=512
configs.config.server-config.iiop-service.orb.max-connections=512
Command set executed successfully.</code></pre>
</div>
</div>
<div id="load-balancing" class="paragraph">
<p>Load Balancing</p>
</div>
<div class="paragraph">
<p>For information on how to configure HTTP load balancing, see
"<a href="ha-administration-guide.html#configuring-http-load-balancing">Configuring HTTP Load Balancing</a>" in Eclipse GlassFish High Availability Administration Guide.</p>
</div>
<div class="paragraph">
<p>For information on how to configure RMI/IIOP for multiple application
server instances in a cluster, "<a href="ha-administration-guide.html#rmi-iiop-load-balancing-and-failover">RMI-IIOP Load Balancing
and Failover</a>" in Eclipse GlassFish High Availability
Administration Guide.</p>
</div>
<div class="paragraph">
<p>When tuning the client ORB for load-balancing and connections, consider
the number of connections opened on the server ORB. Start from a low
number of connections and then increase it to observe any performance
benefits. A connection to the server translates to an ORB thread reading
actively from the connection (these threads are not pooled, but exist
currently for the lifetime of the connection).</p>
</div>
</div>
<div class="sect4">
<h5 id="thread-pool-sizing"><a class="anchor" href="#thread-pool-sizing"></a>Thread Pool Sizing</h5>
<div class="paragraph">
<p>After examining the number of inbound and outbound connections as
explained above, tune the size of the thread pool appropriately. This
can affect performance and response times significantly.</p>
</div>
<div class="paragraph">
<p>The size computation takes into account the number of client requests to
be processed concurrently, the resource (number of CPUs and amount of
memory) available on the machine and the response times required for
processing the client requests.</p>
</div>
<div class="paragraph">
<p>Setting the size to a very small value can affect the ability of the
server to process requests concurrently, thus affecting the response
times since requests will sit longer in the task queue. On the other
hand, having a large number of worker threads to service requests can
also be detrimental because they consume system resources, which
increases concurrency. This can mean that threads take longer to acquire
shared structures in the EJB container, thus affecting response times.</p>
</div>
<div class="paragraph">
<p>The worker thread pool is also used for the EJB container&#8217;s housekeeping
activity such as trimming the pools and caches. This activity needs to
be accounted for also when determining the size. Having too many ORB
worker threads is detrimental for performance since the server has to
maintain all these threads. The idle threads are destroyed after the
idle thread timeout period.</p>
</div>
</div>
<div class="sect4">
<h5 id="examining-iiop-messages"><a class="anchor" href="#examining-iiop-messages"></a>Examining IIOP Messages</h5>
<div class="paragraph">
<p>It is sometimes useful to examine the IIOP messages passed by the
Eclipse GlassFish. To make the server save IIOP messages to the
<code>server.log</code> file, set the JVM option <code>-Dcom.sun.CORBA.ORBDebug=giop</code>.
Use the same option on the client ORB.</p>
</div>
<div class="paragraph">
<p>The following is an example of IIOP messages saved to the server log.
Note: in the actual output, each line is preceded by the timestamp, such
as <code>[29/Aug/2002:22:41:43] INFO (27179): CORE3282: stdout</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code> ++++++++++++++++++++++++++++++
 Message(Thread[ORB Client-side Reader, conn to 192.18.80.118:1050,5,main]):
createFromStream: type is 4 &lt;
 MessageBase(Thread[ORB Client-side Reader, conn to 192.18.80.118:1050,5,main]):
Message GIOP version: 1.2
 MessageBase(Thread[ORB Client-side Reader, conn to 192.18.80.118:1050,5,main]):
ORB Max GIOP Version: 1.2
 Message(Thread[ORB Client-side Reader, conn to 192.18.80.118:1050,5,main]):
createFromStream: message construction complete.
 com.sun.corba.ee.internal.iiop.MessageMediator
(Thread[ORB Client-side Reader, conn to 192.18.80.118:1050,5,main]): Received message:
 ----- Input Buffer -----
 Current index: 0
 Total length : 340
 47 49 4f 50 01 02 00 04 0 0 00 01 48 00 00 00 05 GIOP.......H....</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The flag <code>-Dcom.sun.CORBA.ORBdebug=giop</code> generates many debug messages
in the logs. This is used only when you suspect message fragmentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this sample output above, the <code>createFromStream</code> type is shown as
<code>4</code>. This implies that the message is a fragment of a bigger message. To
avoid fragmented messages, increase the fragment size. Larger fragments
mean that messages are sent as one unit and not as fragments, saving the
overhead of multiple messages and corresponding processing at the
receiving end to piece the messages together.</p>
</div>
<div class="paragraph">
<p>If most messages being sent in the application are fragmented,
increasing the fragment size is likely to improve efficiency. On the
other hand, if only a few messages are fragmented, it might be more
efficient to have a lower fragment size that requires smaller buffers
for writing messages.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resource-settings"><a class="anchor" href="#resource-settings"></a>Resource Settings</h3>
<div class="paragraph">
<p>Tuning JDBC and connector resources can significantly improve Eclipse GlassFish performance.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#jdbc-connection-pool-settings">JDBC Connection Pool Settings</a></p>
</li>
<li>
<p><a href="#connector-connection-pool-settings">Connector Connection Pool Settings</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="jdbc-connection-pool-settings"><a class="anchor" href="#jdbc-connection-pool-settings"></a>JDBC Connection Pool Settings</h4>
<div class="paragraph">
<p>For optimum performance of database-intensive applications, tune the
JDBC Connection Pools managed by the Eclipse GlassFish. These connection
pools maintain numerous live database connections that can be reused to
reduce the overhead of opening and closing database connections. This
section describes how to tune JDBC Connection Pools to improve
performance.</p>
</div>
<div class="paragraph">
<p>J2EE applications use JDBC Resources to obtain connections that are
maintained by the JDBC Connection Pool. More than one JDBC Resource is
allowed to refer to the same JDBC Connection Pool. In such a case, the
physical connection pool is shared by all the resources.</p>
</div>
<div class="paragraph">
<p>Refer to "<a href="administration-guide.html#administering-database-connectivity">Administering Database Connectivity</a>" in
Eclipse GlassFish Administration Guide for more
information about managing JDBC connection pools.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#monitoring-jdbc-connection-pools">Monitoring JDBC Connection Pools</a></p>
</li>
<li>
<p><a href="#tuning-jdbc-connection-pools">Tuning JDBC Connection Pools</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="monitoring-jdbc-connection-pools"><a class="anchor" href="#monitoring-jdbc-connection-pools"></a>Monitoring JDBC Connection Pools</h5>
<div class="paragraph">
<p>Statistics-gathering is disabled by default for JDBC Connection Pools.
Refer to for instructions on enabling JDBC monitoring in
"<a href="administration-guide.html#administering-the-monitoring-service">Administering the Monitoring Service</a>" in Eclipse GlassFish Administration Guide. If using the
Administration Console, JDBC monitoring can be enabled on the
Configurations&gt;configuration-name&gt;Monitoring page.</p>
</div>
<div class="paragraph">
<p>The following attributes are monitored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>numConnFailedValidation (count)</code> Number of connections that failed
validation.</p>
</li>
<li>
<p><code>numConnUsed (range)</code> Number of connections that have been used.</p>
</li>
<li>
<p><code>numConnFree (count)</code> Number of free connections in the pool.</p>
</li>
<li>
<p><code>numConnTimedOut (bounded range)</code> Number of connections in the pool
that have timed out.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To get JDBC monitoring statistics, use the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin get --monitor=true
serverInstance.resources.jdbc-connection-pool.*asadmin get
--monitor=true serverInstance.resources.jdbc-connection-pool. poolName.* *</code></pre>
</div>
</div>
<div class="paragraph">
<p>To view JDBC monitoring statistics through the Administration Console,
navigate to the server (Admin Server) page and click the Monitor tab.
Refer to the Administration Console online help for complete
instructions.</p>
</div>
</div>
<div class="sect4">
<h5 id="tuning-jdbc-connection-pools"><a class="anchor" href="#tuning-jdbc-connection-pools"></a>Tuning JDBC Connection Pools</h5>
<div class="paragraph">
<p>Refer to "<a href="administration-guide.html#administering-database-connectivity">Administering Database Connectivity</a>" in
Eclipse GlassFish Administration Guide for
instructions on configuring JDBC connection pools. If using the
Eclipse GlassFish Administration Console by navigating to the
Resources&gt;JDBC&gt;JDBC Connection Pools&gt;jdbc-pool-name page and then
clicking the desired tab.</p>
</div>
<div class="paragraph">
<p>The following JDBC properites affect Eclipse GlassFish performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#pool-size-settings">Pool Size Settings</a></p>
</li>
<li>
<p><a href="#timeout-settings">Timeout Settings</a></p>
</li>
<li>
<p><a href="#isolation-level-settings">Isolation Level Settings</a></p>
</li>
<li>
<p><a href="#connection-validation-settings">Connection Validation Settings</a></p>
</li>
</ul>
</div>
<div id="pool-size-settings" class="paragraph">
<p>Pool Size Settings</p>
</div>
<div class="paragraph">
<p>Pool Size settings can be configured in the Pool Settings section on the
General tab in the Edit JDBC Connection Pool page.</p>
</div>
<div class="paragraph">
<p>The following settings control the size of the connection pool:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initial and Mimimum Pool Size: Size of the pool when created, and its
minimum allowable size.</p>
</li>
<li>
<p>Maximum Pool Size: Upper limit of size of the pool.</p>
</li>
<li>
<p>Pool Resize Quantity: Number of connections to be removed when the
idle timeout expires. Connections that have idled for longer than the
timeout are candidates for removal. When the pool size reaches the
initial and minimum pool size, removal of connections stops.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table summarizes advantages and disadvantages to consider
when sizing connection pools.</p>
</div>
<div id="gacmi" class="paragraph">
<p>Table 3-3 Connection Pool Sizing</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 21%;">
<col style="width: 38%;">
<col style="width: 41%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Connection Pool</th>
<th class="tableblock halign-left valign-top">Advantages</th>
<th class="tableblock halign-left valign-top">Disadvantages</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Small Connection pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Faster access on the connection table.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>May not have enough connections to satisfy requests.</p>
</div>
<div class="paragraph">
<p>Requests may spend more time in the queue.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Large Connection pool</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>More connections to fulfill requests.</p>
</div>
<div class="paragraph">
<p>Requests will spend less (or no) time in the queue</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slower access on the connection table.</p></td>
</tr>
</tbody>
</table>
<div id="timeout-settings" class="paragraph">
<p>Timeout Settings</p>
</div>
<div class="paragraph">
<p>The following JDBC timeout settings can be configured on the in the Pool
Settings section on the General tab in the Edit JDBC Connection Pool
page.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Max Wait Time: Amount of time the caller (the code requesting a
connection) will wait before getting a connection timeout. The default
is 60 seconds. A value of zero forces caller to wait indefinitely.</p>
<div class="paragraph">
<p>To improve performance set Max Wait Time to zero (0). This essentially
blocks the caller thread until a connection becomes available. Also,
this allows the server to alleviate the task of tracking the elapsed
wait time for each request and increases performance.</p>
</div>
</li>
<li>
<p>Idle Timeout: Maximum time in seconds that a connection can remain
idle in the pool. After this time, the pool can close this connection.
This property does not control connection timeouts on the database
server.</p>
<div class="paragraph">
<p>Keep this timeout shorter than the database server timeout (if such
timeouts are configured on the database), to prevent accumulation of
unusable connection in Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>For best performance, set Idle Timeout to zero (0) seconds, so that idle
connections will not be removed. This ensures that there is normally no
penalty in creating new connections and disables the idle monitor
thread. However, there is a risk that the database server will reset a
connection that is unused for too long.</p>
</div>
</li>
</ul>
</div>
<div id="isolation-level-settings" class="paragraph">
<p>Isolation Level Settings</p>
</div>
<div class="paragraph">
<p>The following JDBC Isolation Level settings can be configured in the
Transaction section on the General tab in the Edit JDBC Connection Pool
page.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Transaction Isolation: Specifies the transaction isolation level of
the pooled database connections. If this parameter is unspecified, the
pool uses the default isolation level provided by the JDBC Driver.</p>
</li>
<li>
<p>Isolation Level Guaranteed: Guarantees that every connection obtained
from the pool has the isolation specified for the Transaction Isolation
level. Applicable only when the Transaction Isolation level is
specified. The default value is Guaranteed.</p>
<div class="paragraph">
<p>This setting can have some performance impact on some JDBC drivers. Set
to false when certain that the application does not change the isolation
level before returning the connection.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Avoid specifying the Transaction Isolation level. If that is not
possible, consider disabling the Isolation Level Guaranteed option and
then make sure applications do not programmatically alter the
connections; isolation level.</p>
</div>
<div class="paragraph">
<p>If you must specify a Transaction Isolation level, specify the
best-performing level possible. The isolation levels listed from best
performance to worst are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>READ_UNCOMMITTED</code></p>
</li>
<li>
<p><code>READ_COMMITTED</code></p>
</li>
<li>
<p><code>REPEATABLE_READ</code></p>
</li>
<li>
<p><code>SERIALIZABLE</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Choose the isolation level that provides the best performance, yet still
meets the concurrency and consistency needs of the application.</p>
</div>
<div id="connection-validation-settings" class="paragraph">
<p>Connection Validation Settings</p>
</div>
<div class="paragraph">
<p>JDBC Connection Validation settings can be configured in the Connection
Validation section on the Advanced tab in the Edit JDBC Connection Pool
page.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Connection Validation Required: If enabled, the pool validates
connections (checks to find out if they are usable) before providing
them to an application.</p>
<div class="paragraph">
<p>If possible, keep this option disabled. Requiring connection validation
forces the server to apply the validation algorithm every time the pool
returns a connection, which adds overhead to the latency of
<code>getConnection()</code>. If the database connectivity is reliable, you can
omit validation.</p>
</div>
</li>
<li>
<p>Validation Method: Specifies the type of connection validation to
perform. Must be one of the following:</p>
<div class="ulist">
<ul>
<li>
<p><code>auto-commit</code>: Attempt to perform an auto-commit on the connection.</p>
</li>
<li>
<p><code>metadata</code>: Attempt to get metadata from the connection.</p>
</li>
<li>
<p><code>table</code>: Performing the query on a specified table. If this option is
selected, Table Name must also be set. Choosing this option may be
necessary if the JDBC driver caches calls to <code>setAutoCommit()</code> and
<code>getMetaData()</code>.</p>
</li>
<li>
<p><code>custom-validation</code>: Define a custom validation method.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Table Name: Name of the table to query when the Validation Method is
set to <code>table</code>.</p>
</li>
<li>
<p>Close All Connections On Any Failure: Specify whether all connections
in the pool should be closed if a single validation check fails. This
option is disabled by default. One attempt will be made to re-establish
failed connections.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="connector-connection-pool-settings"><a class="anchor" href="#connector-connection-pool-settings"></a>Connector Connection Pool Settings</h4>
<div class="paragraph">
<p>From a performance standpoint, connector connection pools are similar to
JDBC connection pools. Follow all the recommendations in the previous
section, <a href="#tuning-jdbc-connection-pools">Tuning JDBC Connection Pools</a>.</p>
</div>
<div class="sect4">
<h5 id="transaction-support"><a class="anchor" href="#transaction-support"></a>Transaction Support</h5>
<div class="paragraph">
<p>You may be able to improve performance by overriding the default
transaction support specified for each connector connection pool.</p>
</div>
<div class="paragraph">
<p>For example, consider a case where an Enterprise Information System
(EIS) has a connection factory that supports local transactions with
better performance than global transactions. If a resource from this EIS
needs to be mixed with a resource coming from another resource manager,
the default behavior forces the use of XA transactions, leading to lower
performance. However, by changing the EIS&#8217;s connector connection pool to
use LocalTransaction transaction support and leveraging the Last Agent
Optimization feature previously described, you could leverage the
better-performing EIS LocalTransaction implementation. For more
information on LAO, see <a href="#configure-jdbc-resources-as-one-phase-commit-resources">Configure JDBC
Resources as One-Phase Commit Resources</a>.</p>
</div>
<div class="paragraph">
<p>You can specify transaction support when you create or edit a connector
connection pool.</p>
</div>
<div class="paragraph">
<p>Also set transaction support using <code>asadmin</code>. For example, the following
<code>asadmin</code> command could be used to create a connector connection pool
<code>TESTPOOL</code> with <code>transaction-support</code> set to <code>LOCAL</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-connector-connection-pool --raname jdbcra
--connectiondefinition javax.sql.DataSource
-transactionsupport LocalTransaction
TESTPOOL</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="load-balancer-settings"><a class="anchor" href="#load-balancer-settings"></a>Load Balancer Settings</h3>
<div class="paragraph">
<p>Eclipse GlassFish is compatible with the Apache HTTP
server <code>mod_jk</code> module for load balancing.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish load balancing configurations can vary widely depending
on the needs of your enterprise and are beyond the scope of this
Performance Tuning Guide. For complete information about configuring
load balancing in Eclipse GlassFish, refer to the following
documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"<a href="ha-administration-guide.html#configuring-http-load-balancing">Configuring HTTP Load Balancing</a>" in Eclipse GlassFish High Availability Administration Guide</p>
</li>
<li>
<p>"<a href="ha-administration-guide.html#rmi-iiop-load-balancing-and-failover">RMI-IIOP Load Balancing and Failover</a>" in Eclipse GlassFish High Availability Administration Guide</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tuning-the-java-runtime-system"><a class="anchor" href="#tuning-the-java-runtime-system"></a>4 Tuning the Java Runtime System</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#java-virtual-machine-settings">Java Virtual Machine Settings</a></p>
</li>
<li>
<p><a href="#start-options">Start Options</a></p>
</li>
<li>
<p><a href="#tuning-high-availability-persistence">Tuning High Availability Persistence</a></p>
</li>
<li>
<p><a href="#managing-memory-and-garbage-collection">Managing Memory and Garbage Collection</a></p>
</li>
<li>
<p><a href="#further-information">Further Information</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="java-virtual-machine-settings"><a class="anchor" href="#java-virtual-machine-settings"></a>Java Virtual Machine Settings</h3>
<div class="paragraph">
<p>Each JDK have own set of JVM options useful for tuning.
The easiest way is to run the following command and then consult the JDK&#8217;s
documentation to understand all consequences.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>JAVA_HOME/bin/java -XX:+UnlockDiagnosticVMOptions -XX:+PrintFlagsFinal -version</code></pre>
</div>
</div>
<div id="start-options" class="paragraph">
<p>In some situations, performance can be improved by using large page sizes.
For Ultrasparc CMT systems, include the <code>-XX:+UseLargePages</code> and
<code>-XX:LargePageSizeInBytes=256m</code> arguments with your JVM tuning.</p>
</div>
</div>
<div class="sect2">
<h3 id="tuning-high-availability-persistence"><a class="anchor" href="#tuning-high-availability-persistence"></a>Tuning High Availability Persistence</h3>
<div class="paragraph">
<p>If session <code>s1</code> and <code>s2</code> need to be replicated to an instance (backup
server), the replication module batches the replication messages to be
sent to that instance instead of sending separate replication messages.
This improves performance. In configurations in which a lot of session
replication is performed, you may find better performance by tuning the
<code>org.shoal.cache.transmitter.max.batch.size</code> system property. This
property determines the number of replication messages that constitute
one batch.</p>
</div>
<div class="paragraph">
<p>The default value for this property is <code>20</code>. You can try setting it as
high as <code>90</code>, depending on system loads. Like all system properties,
this property is set with the <code>-D</code> flag in your Java arguments.</p>
</div>
</div>
<div class="sect2">
<h3 id="managing-memory-and-garbage-collection"><a class="anchor" href="#managing-memory-and-garbage-collection"></a>Managing Memory and Garbage Collection</h3>
<div class="paragraph">
<p>The efficiency of any application depends on how well memory and garbage
collection are managed. The following sections provide information on
optimizing memory and allocation functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#tuning-the-garbage-collector">Tuning the Garbage Collector</a></p>
</li>
<li>
<p><a href="#tracing-garbage-collection">Tracing Garbage Collection</a></p>
</li>
<li>
<p><a href="#other-garbage-collector-settings">Other Garbage Collector Settings</a></p>
</li>
<li>
<p><a href="#tuning-the-java-heap">Tuning the Java Heap</a></p>
</li>
<li>
<p><a href="#rebasing-dlls-on-windows">Rebasing DLLs on Windows</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="tuning-the-garbage-collector"><a class="anchor" href="#tuning-the-garbage-collector"></a>Tuning the Garbage Collector</h4>
<div class="paragraph">
<p>Garbage collection (GC) reclaims the heap space previously allocated to
objects no longer needed. The process of locating and removing the dead
objects can stall any application and consume as much as 25 percent
throughput.</p>
</div>
<div class="paragraph">
<p>Almost all Java Runtime Environments come with a generational object
memory system and sophisticated GC algorithms. A generational memory
system divides the heap into a few carefully sized partitions called
generations. The efficiency of a generational memory system is based on
the observation that most of the objects are short lived. As these
objects accumulate, a low memory condition occurs forcing GC to take
place.</p>
</div>
<div class="paragraph">
<p>The heap space is divided into the old and the new generation. The new
generation includes the new object space (eden), and two survivor
spaces. The JVM allocates new objects in the eden space, and moves
longer lived objects from the new generation to the old generation.</p>
</div>
<div class="paragraph">
<p>The young generation uses a fast copying garbage collector which employs
two semi-spaces (survivor spaces) in the eden, copying surviving objects
from one survivor space to the second. Objects that survive multiple
young space collections are tenured, meaning they are copied to the
tenured generation. The tenured generation is larger and fills up less
quickly. So, it is garbage collected less frequently; and each
collection takes longer than a young space only collection. Collecting
the tenured space is also referred to as doing a full generation
collection.</p>
</div>
<div class="paragraph">
<p>The frequent young space collections are quick (a few milliseconds),
while the full generation collection takes a longer (tens of
milliseconds to a few seconds, depending upon the heap size).</p>
</div>
<div class="paragraph">
<p>Other GC algorithms, such as the Concurrent Mark Sweep (CMS) algorithm,
are incremental. They divide the full GC into several incremental
pieces. This provides a high probability of small pauses. This process
comes with an overhead and is not required for enterprise web
applications.</p>
</div>
<div class="paragraph">
<p>When the new generation fills up, it triggers a minor collection in
which the surviving objects are moved to the old generation. When the
old generation fills up, it triggers a major collection which involves
the entire object heap.</p>
</div>
<div class="paragraph">
<p>Both HotSpot and Solaris JDK use thread local object allocation pools
for lock-free, fast, and scalable object allocation. So, custom object
pooling is not often required. Consider pooling only if object
construction cost is high and significantly affects execution profiles.</p>
</div>
<div class="sect4">
<h5 id="choosing-the-garbage-collection-algorithm"><a class="anchor" href="#choosing-the-garbage-collection-algorithm"></a>Choosing the Garbage Collection Algorithm</h5>
<div class="paragraph">
<p>The default collector for Java server class machines will optimize for
throughput but be tolerant of somewhat long pause times. If you would
prefer to have minimal pause times at the expense of some throughput and
increased CPU usage, consider using the CMS collector.</p>
</div>
<div id="to-use-the-cms-collector" class="paragraph">
<p>To use the CMS collector</p>
</div>
<div class="paragraph">
<p>Follow this procedure.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that the system is not using 100 percent of its CPU.</p>
</li>
<li>
<p>Configure the CMS collector in the server instance.</p>
<div class="paragraph">
<p>To do this, add the following JVM options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-XX:+UseConcMarkSweepGC</code></p>
</li>
<li>
<p><code>-XX:SoftRefLRUPolicyMSPerMB=1</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="additional-information"><a class="anchor" href="#additional-information"></a>Additional Information</h5>
<div class="paragraph">
<p>Use the <code>jstat</code> utility to monitor Java Virtual Machine statistics. (See
<a href="#further-information">Further Information</a>.)</p>
</div>
<div class="paragraph">
<p>For detailed information on tuning the garbage collector, see
<a href="https://docs.oracle.com/en/java/javase/17/gctuning/introduction-garbage-collection-tuning.html">Java
 Garbage Collection Tuning</a>
(` <a href="https://docs.oracle.com/en/java/javase/17/gctuning/introduction-garbage-collection-tuning.html`" class="bare">https://docs.oracle.com/en/java/javase/17/gctuning/introduction-garbage-collection-tuning.html`</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tracing-garbage-collection"><a class="anchor" href="#tracing-garbage-collection"></a>Tracing Garbage Collection</h4>
<div class="paragraph">
<p>The two primary measures of garbage collection performance are
throughput and pauses. Throughput is the percentage of the total time
spent on other activities apart from GC. Pauses are times when an
application appears unresponsive due to GC.</p>
</div>
<div class="paragraph">
<p>Two other considerations are footprint and promptness. Footprint is the
working size of the JVM process, measured in pages and cache lines.
Promptness is the time between when an object becomes dead, and when the
memory becomes available. This is an important consideration for
distributed systems.</p>
</div>
<div class="paragraph">
<p>A particular generation size makes a trade-off between these four
metrics. For example, a large young generation likely maximizes
throughput, but at the cost of footprint and promptness. Conversely,
using a small young generation and incremental GC will minimize pauses,
and thus increase promptness, but decrease throughput.</p>
</div>
<div class="paragraph">
<p>JVM diagnostic output will display information on pauses due to garbage
collection. If you start the server in verbose mode (use the command
<code>asadmin start-domain --verbose</code> domain), then the command line argument
<code>-verbose:gc</code> prints information for every collection. Here is an
example of output of the information generated with this JVM flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[GC 50650K-&gt;21808K(76868K), 0.0478645 secs]
 [GC 51197K-&gt;22305K(76868K), 0.0478645 secs]
 [GC 52293K-&gt;23867K(76868K), 0.0478645 secs]
 [Full GC 52970K-&gt;1690K(76868K), 0.54789968 secs]</code></pre>
</div>
</div>
<div class="paragraph">
<p>On each line, the first number is the combined size of live objects
before GC, the second number is the size of live objects after GC, the
number in parenthesis is the total available space, which is the total
heap minus one of the survivor spaces. The final figure is the amount of
time that the GC took. This example shows three minor collections and
one major collection. In the first GC, 50650 KB of objects existed
before collection and 21808 KB of objects after collection. This means
that 28842 KB of objects were dead and collected. The total heap size is
76868 KB. The collection process required 0.0478645 seconds.</p>
</div>
<div class="paragraph">
<p>Other useful monitoring options include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-XX:+PrintGCDetails</code> for more detailed logging information</p>
</li>
<li>
<p><code>-Xloggc:file</code> to save the information in a log file</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="other-garbage-collector-settings"><a class="anchor" href="#other-garbage-collector-settings"></a>Other Garbage Collector Settings</h4>
<div class="paragraph">
<p>To specify the attributes for the Java virtual machine, use the
Administration Console and set the property under config-name &gt; JVM
settings (JVM options).</p>
</div>
<div class="sect4">
<h5 id="setting-the-maximum-permanent-generation"><a class="anchor" href="#setting-the-maximum-permanent-generation"></a>Setting the Maximum Permanent Generation</h5>
<div class="paragraph">
<p>For applications that do not dynamically generate and load classes, the
size of the permanent generation does not affect GC performance. For
applications that dynamically generate and load classes (for example,
JSP applications), the size of the permanent generation does affect GC
performance, since filling the permanent generation can trigger a Full
GC. Tune the maximum permanent generation with the <code>-XX:MaxPermSize</code>
option.</p>
</div>
</div>
<div class="sect4">
<h5 id="disabling-explicit-garbage-collection"><a class="anchor" href="#disabling-explicit-garbage-collection"></a>Disabling Explicit Garbage Collection</h5>
<div class="paragraph">
<p>Although applications can explicitly invoke GC with the <code>System.gc()</code>
method, doing so is a bad idea since this forces major collections, and
inhibits scalability on large systems. It is best to disable explicit GC
by using the flag <code>-XX:+DisableExplicitGC</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>On Windows systems, setting the <code>-XX:+DisableExplicitGC</code> option might
prevent the renaming or removal of open application files. As a result,
deployment, redeployment, or other operations that attempt to rename or
delete files might fail.</p>
</div>
<div class="paragraph">
<p>Application files can remain open because the files have been used by
class loaders to find classes or resources, or have been opened
explicitly by Eclipse GlassFish or application code but never explicitly
closed. On Windows systems, open files cannot be renamed or deleted. To
overcome this limitation, Eclipse GlassFish uses the <code>System.gc()</code> method
to garbage collect the Java object that corresponds to an open file.
When the Java object that corresponds to an open file is garbage
collected, the object&#8217;s <code>finalize</code> method closes the open channel to the
file. Eclipse GlassFish can then delete or rename the file.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="setting-the-frequency-of-full-garbage-collection"><a class="anchor" href="#setting-the-frequency-of-full-garbage-collection"></a>Setting the Frequency of Full Garbage Collection</h5>
<div class="paragraph">
<p>Eclipse GlassFish uses RMI in the Administration module for monitoring.
Garbage cannot be collected in RMI-based distributed applications
without occasional local collections, so RMI forces a periodic full
collection. Control the frequency of these collections with the property
<code>-sun.rmi.dgc.client.gcInterval</code>. For example,
<code>- java -Dsun.rmi.dgc.client.gcInterval=3600000</code> specifies explicit
collection once per hour instead of the default rate of once per minute.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tuning-the-java-heap"><a class="anchor" href="#tuning-the-java-heap"></a>Tuning the Java Heap</h4>
<div class="paragraph">
<p>This section discusses topics related to tuning the Java Heap for
performance.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#guidelines-for-java-heap-sizing">Guidelines for Java Heap Sizing</a></p>
</li>
<li>
<p><a href="#heap-tuning-parameters">Heap Tuning Parameters</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="guidelines-for-java-heap-sizing"><a class="anchor" href="#guidelines-for-java-heap-sizing"></a>Guidelines for Java Heap Sizing</h5>
<div class="paragraph">
<p>Maximum heap size depends on maximum address space per process. The
following table shows the maximum per-process address values for various
platforms:</p>
</div>
<div id="gacna" class="paragraph">
<p>Table 4-1 Maximum Address Space Per Process</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 62%;">
<col style="width: 38%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operating System</th>
<th class="tableblock halign-left valign-top">Maximum Address Space Per Process</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oracle/Redhat/Ubuntu Linux 32-bit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oracle/Redhat/Ubuntu Linux 64-bit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terabytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows XP/2008/7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris x86 (32-bit)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris 32-bit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris 64-bit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terabytes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Maximum heap space is always smaller than maximum address space per
process, because the process also needs space for stack, libraries, and
so on. To determine the maximum heap space that can be allocated, use a
profiling tool to examine the way memory is used. Gauge the maximum
stack space the process uses and the amount of memory taken up libraries
and other memory structures. The difference between the maximum address
space and the total of those values is the amount of memory that can be
allocated to the heap.</p>
</div>
<div class="paragraph">
<p>You can improve performance by increasing your heap size or using a
different garbage collector. In general, for long-running server
applications, use the Java SE throughput collector on machines with
multiple processors (<code>-XX:+AggressiveHeap</code>) and as large a heap as you
can fit in the free memory of your machine.</p>
</div>
</div>
<div class="sect4">
<h5 id="heap-tuning-parameters"><a class="anchor" href="#heap-tuning-parameters"></a>Heap Tuning Parameters</h5>
<div class="paragraph">
<p>You can control the heap size with the following JVM parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-Xms</code>value</p>
</li>
<li>
<p><code>-Xmx</code>value</p>
</li>
<li>
<p><code>-XX:MinHeapFreeRatio=</code>minimum</p>
</li>
<li>
<p><code>-XX:MaxHeapFreeRatio=</code>maximum</p>
</li>
<li>
<p><code>-XX:NewRatio=</code>ratio</p>
</li>
<li>
<p><code>-XX:NewSize=</code>size</p>
</li>
<li>
<p><code>-XX:MaxNewSize=</code>size</p>
</li>
<li>
<p><code>-XX:+AggressiveHeap</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>-Xms</code> and <code>-Xmx</code> parameters define the minimum and maximum heap
sizes, respectively. Since GC occurs when the generations fill up,
throughput is inversely proportional to the amount of the memory
available. By default, the JVM grows or shrinks the heap at each GC to
try to keep the proportion of free space to the living objects at each
collection within a specific range. This range is set as a percentage by
the parameters <code>-XX:MinHeapFreeRatio=`minimum and
`-XX:MaxHeapFreeRatio=`maximum; and the total size bounded by `-Xms</code> and
<code>-Xmx</code>.</p>
</div>
<div class="paragraph">
<p>Set the values of <code>-Xms</code> and <code>-Xmx</code> equal to each other for a fixed heap
size. When the heap grows or shrinks, the JVM must recalculate the old
and new generation sizes to maintain a predefined <code>NewRatio</code>.</p>
</div>
<div class="paragraph">
<p>The <code>NewSize</code> and <code>MaxNewSize</code> parameters control the new generation&#8217;s
minimum and maximum size. Regulate the new generation size by setting
these parameters equal. The bigger the younger generation, the less
often minor collections occur. The size of the young generation relative
to the old generation is controlled by <code>NewRatio</code>. For example, setting
<code>-XX:NewRatio=3</code> means that the ratio between the old and young
generation is 1:3, the combined size of eden and the survivor spaces
will be fourth of the heap.</p>
</div>
<div class="paragraph">
<p>By default, the Eclipse GlassFish is invoked with the Java HotSpot Server
JVM. The default <code>NewRatio</code> for the Server JVM is 2: the old generation
occupies 2/3 of the heap while the new generation occupies 1/3. The
larger new generation can accommodate many more short-lived objects,
decreasing the need for slow major collections. The old generation is
still sufficiently large enough to hold many long-lived objects.</p>
</div>
<div class="paragraph">
<p>To size the Java heap:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Decide the total amount of memory you can afford for the JVM.
Accordingly, graph your own performance metric against young generation
sizes to find the best setting.</p>
</li>
<li>
<p>Make plenty of memory available to the young generation. The default
is calculated from <code>NewRatio</code> and the <code>-Xmx</code> setting.</p>
</li>
<li>
<p>Larger eden or younger generation spaces increase the spacing between
full GCs. But young space collections could take a proportionally longer
time. In general, keep the eden size between one fourth and one third
the maximum heap size. The old generation must be larger than the new
generation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For up-to-date defaults, see
<a href="https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html">Java
HotSpot VM Options</a>
(<code><a href="https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html" class="bare">https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html</a></code>).</p>
</div>
<div id="fxxpw" class="paragraph">
<p>Example 4-1 Heap Configuration on Solaris</p>
</div>
<div class="paragraph">
<p>This is an exmple heap configuration used by Eclipse GlassFish on Solaris
for large applications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>-Xms3584m
-Xmx3584m
-verbose:gc
-Dsun.rmi.dgc.client.gcInterval=3600000</code></pre>
</div>
</div>
<div id="survivor-ratio-sizing" class="paragraph">
<p>Survivor Ratio Sizing</p>
</div>
<div class="paragraph">
<p>The <code>SurvivorRatio</code> parameter controls the size of the two survivor
spaces. For example, <code>-XX:SurvivorRatio=6</code> sets the ratio between each
survivor space and eden to be 1:6, each survivor space will be one
eighth of the young generation. The default for Solaris is 32. If
survivor spaces are too small, copying collection overflows directly
into the old generation. If survivor spaces are too large, they will be
empty. At each GC, the JVM determines the number of times an object can
be copied before it is tenured, called the tenure threshold. This
threshold is chosen to keep the survivor space half full.</p>
</div>
<div class="paragraph">
<p>Use the option <code>-XX:+PrintTenuringDistribution</code> to show the threshold
and ages of the objects in the new generation. It is useful for
observing the lifetime distribution of an application.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rebasing-dlls-on-windows"><a class="anchor" href="#rebasing-dlls-on-windows"></a>Rebasing DLLs on Windows</h4>
<div class="paragraph">
<p>When the JVM initializes, it tries to allocate its heap using the <code>-Xms</code>
setting. The base addresses of Eclipse GlassFish DLLs can restrict the
amount of contiguous address space available, causing JVM initialization
to fail. The amount of contiguous address space available for Java
memory varies depending on the base addresses assigned to the DLLs. You
can increase the amount of contiguous address space available by
rebasing the Eclipse GlassFish DLLs.</p>
</div>
<div class="paragraph">
<p>To prevent load address collisions, set preferred base addresses with
the rebase utilty that comes with Visual Studio and the Platform SDK.
Use the rebase utility to reassign the base addresses of the Eclipse GlassFish DLLs to prevent relocations at load time and increase the
available process memory for the Java heap.</p>
</div>
<div class="paragraph">
<p>There are a few Eclipse GlassFish DLLs that have non-default base
addresses that can cause collisions. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>nspr</code> libraries have a preferred address of 0x30000000.</p>
</li>
<li>
<p>The <code>icu</code> libraries have the address of 0x4A?00000.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Move these libraries near the system DLLs (<code>msvcrt.dll</code> is at
<code>0x78000000</code>) to increase the available maximum contiguous address space
substantially. Since rebasing can be done on any DLL, rebase to the DLLs
after installing the Eclipse GlassFish.</p>
</div>
<div class="sect4">
<h5 id="to-rebase-the-glassfish-servers-dlls"><a class="anchor" href="#to-rebase-the-glassfish-servers-dlls"></a>To rebase the Eclipse GlassFish&#8217;s DLLs</h5>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>To perform rebasing, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows 2000</p>
</li>
<li>
<p>Visual Studio and the Microsoft Framework SDK rebase utility</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make as-install\ <code>bin</code> the default directory.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>cd as-install\bin</code></pre>
</div>
</div>
</li>
<li>
<p>Enter this command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>rebase -b 0x6000000 *.dll</code></pre>
</div>
</div>
</li>
<li>
<p>Use the <code>dependencywalker</code> utility to make sure the DLLs were
rebased correctly.</p>
<div class="paragraph">
<p>For more information, see the <a href="http://www.dependencywalker.com">Dependency
Walker website</a> (<code><a href="http://www.dependencywalker.com" class="bare">http://www.dependencywalker.com</a></code>).</p>
</div>
</li>
<li>
<p>Increase the size for the Java heap, and set the JVM Option
accordingly on the JVM Settings page in the Admin Console.</p>
</li>
<li>
<p>Restart the Eclipse GlassFish.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="fxxpz" class="paragraph">
<p>Example 4-2 Heap Configuration on Windows</p>
</div>
<div class="paragraph">
<p>This is an example heap configuration used by Eclipse GlassFish
for heavy server-centric applications, on Windows, as set in the
<code>domain.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jvm-options&gt;</span> -Xms1400m <span class="tag">&lt;/jvm-options&gt;</span>
<span class="tag">&lt;jvm-options&gt;</span> -Xmx1400m <span class="tag">&lt;/jvm-options&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>For more information on rebasing, see
<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tools/tools/rebase.asp">MSDN
documentation for rebase utility</a>
(<code><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tools/tools/rebase.asp" class="bare">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tools/tools/rebase.asp</a></code>).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="further-information"><a class="anchor" href="#further-information"></a>Further Information</h3>
<div class="paragraph">
<p>For more information on the jstat command, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/17/docs/specs/man/jstat.html">
The jstat Command</a>
(<code><a href="https://docs.oracle.com/en/java/javase/17/docs/specs/man/jstat.html" class="bare">https://docs.oracle.com/en/java/javase/17/docs/specs/man/jstat.html</a></code>)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tuning-the-operating-system-and-platform"><a class="anchor" href="#tuning-the-operating-system-and-platform"></a>5 Tuning the Operating System and Platform</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter discusses tuning the operating system (OS) for optimum
performance. It discusses the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#server-scaling">Server Scaling</a></p>
</li>
<li>
<p><a href="#solaris-10-platform-specific-tuning-information">Solaris 10 Platform-Specific Tuning Information</a></p>
</li>
<li>
<p><a href="#tuning-for-the-solaris-os">Tuning for the Solaris OS</a></p>
</li>
<li>
<p><a href="#tuning-for-solaris-on-x86">Tuning for Solaris on x86</a></p>
</li>
<li>
<p><a href="#tuning-for-linux-platforms">Tuning for Linux platforms</a></p>
</li>
<li>
<p><a href="#tuning-ultrasparc-cmt-based-systems">Tuning UltraSPARC CMT-Based Systems</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="server-scaling"><a class="anchor" href="#server-scaling"></a>Server Scaling</h3>
<div class="paragraph">
<p>This section provides recommendations for optimal performance scaling
server for the following server subsystems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#processors">Processors</a></p>
</li>
<li>
<p><a href="#memory">Memory</a></p>
</li>
<li>
<p><a href="#disk-space">Disk Space</a></p>
</li>
<li>
<p><a href="#networking">Networking</a></p>
</li>
<li>
<p><a href="#udp-buffer-sizes">UDP Buffer Sizes</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="processors"><a class="anchor" href="#processors"></a>Processors</h4>
<div class="paragraph">
<p>The Eclipse GlassFish automatically takes advantage of multiple CPUs. In
general, the effectiveness of multiple CPUs varies with the operating
system and the workload, but more processors will generally improve
dynamic content performance.</p>
</div>
<div class="paragraph">
<p>Static content involves mostly input/output (I/O) rather than CPU
activity. If the server is tuned properly, increasing primary memory
will increase its content caching and thus increase the relative amount
of time it spends in I/O versus CPU activity. Studies have shown that
doubling the number of CPUs increases servlet performance by 50 to 80
percent.</p>
</div>
</div>
<div class="sect3">
<h4 id="memory"><a class="anchor" href="#memory"></a>Memory</h4>
<div class="paragraph">
<p>See the section Hardware and Software Requirements in the Eclipse GlassFish Release Notes for specific memory recommendations for each
supported operating system.</p>
</div>
</div>
<div class="sect3">
<h4 id="disk-space"><a class="anchor" href="#disk-space"></a>Disk Space</h4>
<div class="paragraph">
<p>It is best to have enough disk space for the OS, document tree, and log
files. In most cases 2GB total is sufficient.</p>
</div>
<div class="paragraph">
<p>Put the OS, swap/paging file, Eclipse GlassFish logs, and document tree
each on separate hard drives. This way, if the log files fill up the log
drive, the OS does not suffer. Also, its easy to tell if the OS paging
file is causing drive activity, for example.</p>
</div>
<div class="paragraph">
<p>OS vendors generally provide specific recommendations for how much swap
or paging space to allocate. Based on Oracle testing, Eclipse GlassFish
performs best with swap space equal to RAM, plus enough to map the
document tree.</p>
</div>
</div>
<div class="sect3">
<h4 id="networking"><a class="anchor" href="#networking"></a>Networking</h4>
<div class="paragraph">
<p>To determine the bandwidth the application needs, determine the
following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of peak concurrent users (N <sub>peak</sub>) the server needs to
handle.</p>
</li>
<li>
<p>The average request size on your site, r. The average request can
include multiple documents. When in doubt, use the home page and all its
associated files and graphics.</p>
</li>
<li>
<p>Decide how long, t, the average user will be willing to wait for a
document at peak utilization.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then, the bandwidth required is:</p>
</div>
<div class="paragraph">
<p>N<sub>peak</sub>r / t</p>
</div>
<div class="paragraph">
<p>For example, to support a peak of 50 users with an average document size
of 24 Kbytes, and transferring each document in an average of 5 seconds,
requires 240 Kbytes (1920 Kbit/s). So the site needs two T1 lines (each
1544 Kbit/s). This bandwidth also allows some overhead for growth.</p>
</div>
<div class="paragraph">
<p>The server&#8217;s network interface card must support more than the WAN to
which it is connected. For example, if you have up to three T1 lines,
you can get by with a 10BaseT interface. Up to a T3 line (45 Mbit/s),
you can use 100BaseT. But if you have more than 50 Mbit/s of WAN
bandwidth, consider configuring multiple 100BaseT interfaces, or look at
Gigabit Ethernet technology.</p>
</div>
</div>
<div class="sect3">
<h4 id="udp-buffer-sizes"><a class="anchor" href="#udp-buffer-sizes"></a>UDP Buffer Sizes</h4>
<div class="paragraph">
<p>Eclipse GlassFish uses User Datagram Protocol (UDP) for the transmission
of multicast messages to Eclipse GlassFish instances in a cluster. For
peak performance from a Eclipse GlassFish cluster that uses UDP
multicast, limit the need to retransmit UDP messages. To limit the need
to retransmit UDP messages, set the size of the UDP buffer to avoid
excessive UDP datagram loss.</p>
</div>
<div class="sect4">
<h5 id="to-determine-an-optimal-udp-buffer-size"><a class="anchor" href="#to-determine-an-optimal-udp-buffer-size"></a>To Determine an Optimal UDP Buffer Size</h5>
<div class="paragraph">
<p>The size of UDP buffer that is required to prevent excessive UDP
datagram loss depends on many factors, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of instances in the cluster</p>
</li>
<li>
<p>The number of instances on each host</p>
</li>
<li>
<p>The number of processors</p>
</li>
<li>
<p>The amount of memory</p>
</li>
<li>
<p>The speed of the hard disk for virtual memory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If only one instance is running on each host in your cluster, the
default UDP buffer size should suffice. If several instances are running
on each host, determine whether the UDP buffer is large enough by
testing for the loss of UDP packets.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>On Linux systems, the default UDP buffer size might be insufficient even
if only one instance is running on each host. In this situation, set the
UDP buffer size as explained in <a href="#to-set-the-udp-buffer-size-on-linux-systems">To Set the UDP Buffer Size
on Linux Systems</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="glgiw" class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that no Eclipse GlassFish clusters are running.</p>
<div class="paragraph">
<p>If necessary, stop any running clusters as explained in
"<a href="ha-administration-guide.html#to-stop-a-cluster">To Stop a Cluster</a>"
in Eclipse GlassFish High Availability Administration Guide.</p>
</div>
</li>
<li>
<p>Determine the absolute number of lost UDP packets when no clusters
are running.</p>
<div class="paragraph">
<p>How you determine the number of lost packets depends on the operating
system. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On Linux systems, use the <code>netstat -su</code> command and look for the
<code>packet receive errors</code> count in the <code>Udp</code> section.</p>
</li>
<li>
<p>On AIX systems, use the <code>netstat -s</code> command and look for the
<code>fragments dropped (dup or out of space)</code> count in the <code>ip</code> section.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Start all the clusters that are configured for your installation of
Eclipse GlassFish.</p>
<div class="paragraph">
<p>Start each cluster as explained in "<a href="ha-administration-guide.html#to-start-a-cluster">To Start a
Cluster</a>" in Eclipse GlassFish High Availability
Administration Guide.</p>
</div>
</li>
<li>
<p>Determine the absolute number of lost UDP packets after the clusters are started.</p>
</li>
<li>
<p>If the difference in the number of lost packets is significant,
increase the size of the UDP buffer.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="to-set-the-udp-buffer-size-on-linux-systems"><a class="anchor" href="#to-set-the-udp-buffer-size-on-linux-systems"></a>To Set the UDP Buffer Size on Linux Systems</h5>
<div class="paragraph">
<p>On Linux systems, a default UDP buffer size is set for the client, but
not for the server. Therefore, on Linux systems, the UDP buffer size
might have to be increased. Setting the UDP buffer size involves setting
the following kernel parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>net.core.rmem_max</code></p>
</li>
<li>
<p><code>net.core.wmem_max</code></p>
</li>
<li>
<p><code>net.core.rmem_default</code></p>
</li>
<li>
<p><code>net.core.wmem_default</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Set the kernel parameters in the <code>/etc/sysctl.conf</code> file or at runtime.</p>
</div>
<div class="paragraph">
<p>If you set the parameters in the <code>/etc/sysctl.conf</code> file, the settings
are preserved when the system is rebooted. If you set the parameters at
runtime, the settings are not preserved when the system is rebooted.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To set the parameters in the <code>/etc/sysctl.conf</code> file, add or edit the
following lines in the file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>net.core.rmem_max=rmem-max
net.core.wmem_max=wmem-max
net.core.rmem_default=rmem-default
net.core.wmem_default=wmem-default</code></pre>
</div>
</div>
</li>
<li>
<p>To set the parameters at runtime, use the sysctl command.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ /sbin/sysctl -w net.core.rmem_max=rmem-max \
net.core.wmem_max=wmem-max \
net.core.rmem_default=rmem-default \
net.core.wmem_default=wmem-default</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div id="tun-ex-5-1" class="paragraph">
<p>Example 5-1 Setting the UDP Buffer Size in the <code>/etc/sysctl.conf</code> File</p>
</div>
<div class="paragraph">
<p>This example shows the lines in the <code>/etc/sysctl.conf</code> file for setting
the kernel parameters for controlling the UDP buffer size to 524288.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>net.core.rmem_max=524288
net.core.wmem_max=524288
net.core.rmem_default=524288
net.core.wmem_default=524288</code></pre>
</div>
</div>
<div id="glgjp" class="paragraph">
<p>Example 5-2 Setting the UDP Buffer Size at Runtime</p>
</div>
<div class="paragraph">
<p>This example sets the kernel parameters for controlling the UDP buffer
size to 524288 at runtime.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ /sbin/sysctl -w net.core.rmem_max=524288 \
net.core.wmem_max=52428 \
net.core.rmem_default=52428 \
net.core.wmem_default=524288
net.core.rmem_max = 524288
net.core.wmem_max = 52428
net.core.rmem_default = 52428
net.core.wmem_default = 524288</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="solaris-10-platform-specific-tuning-information"><a class="anchor" href="#solaris-10-platform-specific-tuning-information"></a>Solaris 10 Platform-Specific Tuning Information</h3>
<div class="paragraph">
<p>Solaris Dynamic Tracing (DTrace) is a comprehensive dynamic tracing
framework for the Solaris Operating System (OS). You can use the DTrace
Toolkit to monitor the system. The DTrace Toolkit is available through
the OpenSolaris project from the
<a href="http://hub.opensolaris.org/bin/view/Community+Group+dtrace/dtracetoolkit">DTraceToolkit
page</a>
(<code><a href="http://hub.opensolaris.org/bin/view/Community+Group+dtrace/dtracetoolkit" class="bare">http://hub.opensolaris.org/bin/view/Community+Group+dtrace/dtracetoolkit</a></code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="tuning-for-the-solaris-os"><a class="anchor" href="#tuning-for-the-solaris-os"></a>Tuning for the Solaris OS</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#tuning-parameters">Tuning Parameters</a></p>
</li>
<li>
<p><a href="#file-descriptor-setting">File Descriptor Setting</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="tuning-parameters"><a class="anchor" href="#tuning-parameters"></a>Tuning Parameters</h4>
<div class="paragraph">
<p>Tuning Solaris TCP/IP settings benefits programs that open and close
many sockets. Since the Eclipse GlassFish operates with a small fixed set
of connections, the performance gain might not be significant.</p>
</div>
<div class="paragraph">
<p>The following table shows Solaris tuning parameters that affect
performance and scalability benchmarking. These values are examples of
how to tune your system for best performance.</p>
</div>
<div id="gacmm" class="paragraph">
<p>Table 5-1 Tuning Parameters for Solaris</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27.4725%;">
<col style="width: 17.5824%;">
<col style="width: 10.989%;">
<col style="width: 10.989%;">
<col style="width: 32.9671%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Tuned</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rlim_fd_max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limit of process open file descriptors.
Set to account for expected load (for associated sockets, files, and pipes if any).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rlim_fd_cur</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8192</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sq_max_size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls streams driver queue size;
setting to 0 makes it infinite so the performance runs won&#8217;t be hit by
lack of buffer space. Set on clients too. Note that setting
<code>sq_max_size</code> to 0 might not be optimal for production systems with high
network traffic.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_close_wait_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set on clients too.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_time_wait_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set on clients too.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_conn_req_max_q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_conn_req_max_q0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_ip_abort_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">480000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60000</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_keepalive_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7200000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">900000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For high traffic web sites, lower this value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_rexmit_interval_initial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If retransmission is greater than 30-40%, you should increase this value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_rexmit_interval_max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_rexmit_interval_min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_smallest_anon_port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32768</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set on clients too.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_slow_start_initial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slightly faster transmission of small amounts of data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_xmit_hiwat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32768</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of transmit buffer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_recv_hiwat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32768</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of receive buffer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_conn_hash_size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8192</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of connection hash table. See <a href="#sizing-the-connection-hash-table">Sizing the Connection Hash Table</a>.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="sizing-the-connection-hash-table"><a class="anchor" href="#sizing-the-connection-hash-table"></a>Sizing the Connection Hash Table</h5>
<div class="paragraph">
<p>The connection hash table keeps all the information for active TCP
connections. Use the following command to get the size of the connection
hash table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ndd -get /dev/tcp tcp_conn_hash</code></pre>
</div>
</div>
<div class="paragraph">
<p>This value does not limit the number of connections, but it can cause
connection hashing to take longer. The default size is 512.</p>
</div>
<div class="paragraph">
<p>To make lookups more efficient, set the value to half of the number of
concurrent TCP connections that are expected on the server. You can set
this value only in <code>/etc/system</code>, and it becomes effective at boot time.</p>
</div>
<div class="paragraph">
<p>Use the following command to get the current number of TCP connections.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>netstat -nP tcp|wc -l</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="file-descriptor-setting"><a class="anchor" href="#file-descriptor-setting"></a>File Descriptor Setting</h4>
<div class="paragraph">
<p>On the Solaris OS, setting the maximum number of open files property
using <code>ulimit</code> has the biggest impact on efforts to support the maximum
number of RMI/IIOP clients.</p>
</div>
<div class="paragraph">
<p>To increase the hard limit, add the following command to <code>/etc/system</code>
and reboot it once:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>set rlim_fd_max = 8192</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify this hard limit by using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ulimit -a -H</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the above hard limit is set, increase the value of this property
explicitly (up to this limit) using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ulimit -n 8192</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify this limit by using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ulimit -a</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, with the default <code>ulimit</code> of 64, a simple test driver can
support only 25 concurrent clients, but with <code>ulimit</code> set to 8192, the
same test driver can support 120 concurrent clients. The test driver
spawned multiple threads, each of which performed a JNDI lookup and
repeatedly called the same business method with a think (delay) time of
500 ms between business method calls, exchanging data of about 100 KB.
These settings apply to RMI/IIOP clients on the Solaris OS.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tuning-for-solaris-on-x86"><a class="anchor" href="#tuning-for-solaris-on-x86"></a>Tuning for Solaris on x86</h3>
<div class="paragraph">
<p>The following are some options to consider when tuning Solaris on x86
for Eclipse GlassFish:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#file-descriptors">File Descriptors</a></p>
</li>
<li>
<p><a href="#ip-stack-settings">IP Stack Settings</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some of the values depend on the system resources available. After
making any changes to <code>/etc/system</code>, reboot the machines.</p>
</div>
<div class="sect3">
<h4 id="file-descriptors"><a class="anchor" href="#file-descriptors"></a>File Descriptors</h4>
<div class="paragraph">
<p>Add (or edit) the following lines in the <code>/etc/system</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>set rlim_fd_max=65536
set rlim_fd_cur=65536
set sq_max_size=0
set tcp:tcp_conn_hash_size=8192
set autoup=60
set pcisch:pci_stream_buf_enable=0</code></pre>
</div>
</div>
<div class="paragraph">
<p>These settings affect the file descriptors.</p>
</div>
</div>
<div class="sect3">
<h4 id="ip-stack-settings"><a class="anchor" href="#ip-stack-settings"></a>IP Stack Settings</h4>
<div class="paragraph">
<p>Add (or edit) the following lines in the <code>/etc/system</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>set ip:tcp_squeue_wput=1
set ip:tcp_squeue_close=1
set ip:ip_squeue_bind=1
set ip:ip_squeue_worker_wait=10
set ip:ip_squeue_profile=0</code></pre>
</div>
</div>
<div class="paragraph">
<p>These settings tune the IP stack.</p>
</div>
<div class="paragraph">
<p>To preserve the changes to the file between system reboots, place the
following changes to the default TCP variables in a startup script that
gets executed when the system reboots:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ndd -set /dev/tcp tcp_time_wait_interval 60000
ndd -set /dev/tcp tcp_conn_req_max_q 16384
ndd -set /dev/tcp tcp_conn_req_max_q0 16384
ndd -set /dev/tcp tcp_ip_abort_interval 60000
ndd -set /dev/tcp tcp_keepalive_interval 7200000
ndd -set /dev/tcp tcp_rexmit_interval_initial 4000
ndd -set /dev/tcp tcp_rexmit_interval_min 3000
ndd -set /dev/tcp tcp_rexmit_interval_max 10000
ndd -set /dev/tcp tcp_smallest_anon_port 32768
ndd -set /dev/tcp tcp_slow_start_initial 2
ndd -set /dev/tcp tcp_xmit_hiwat 32768
ndd -set /dev/tcp tcp_recv_hiwat 32768</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tuning-for-linux-platforms"><a class="anchor" href="#tuning-for-linux-platforms"></a>Tuning for Linux platforms</h3>
<div class="paragraph">
<p>To tune for maximum performance on Linux, you need to make adjustments
to the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#startup-files">Startup Files</a></p>
</li>
<li>
<p><a href="#file-descriptors-1">File Descriptors</a></p>
</li>
<li>
<p><a href="#virtual-memory">Virtual Memory</a></p>
</li>
<li>
<p><a href="#network-interface">Network Interface</a></p>
</li>
<li>
<p><a href="#disk-io-settings">Disk I/O Settings</a></p>
</li>
<li>
<p><a href="#tcpip-settings">TCP/IP Settings</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="startup-files"><a class="anchor" href="#startup-files"></a>Startup Files</h4>
<div class="paragraph">
<p>The following parameters must be added to the <code>/etc/rc.d/rc.local</code> file
that gets executed during system startup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;-- begin
#max file count updated ~256 descriptors per 4Mb.
Specify number of file descriptors based on the amount of system RAM.
echo &quot;6553&quot;&gt; /proc/sys/fs/file-max
#inode-max 3-4 times the file-max
#file not present!!!!!
#echo&quot;262144&quot;&gt; /proc/sys/fs/inode-max
#make more local ports available
echo 1024 25000&gt; /proc/sys/net/ipv4/ip_local_port_range
#increase the memory available with socket buffers
echo 2621143&gt; /proc/sys/net/core/rmem_max
echo 262143&gt; /proc/sys/net/core/rmem_default
#above configuration for 2.4.X kernels
echo 4096 131072 262143&gt; /proc/sys/net/ipv4/tcp_rmem
echo 4096 13107262143&gt; /proc/sys/net/ipv4/tcp_wmem
#disable &quot;RFC2018 TCP Selective Acknowledgements,&quot; and
&quot;RFC1323 TCP timestamps&quot; echo 0&gt; /proc/sys/net/ipv4/tcp_sack
echo 0&gt; /proc/sys/net/ipv4/tcp_timestamps
#double maximum amount of memory allocated to shm at runtime
echo &quot;67108864&quot;&gt; /proc/sys/kernel/shmmax
#improve virtual memory VM subsystem of the Linux
echo &quot;100 1200 128 512 15 5000 500 1884 2&quot;&gt; /proc/sys/vm/bdflush
#we also do a sysctl
sysctl -p /etc/sysctl.conf
-- end --&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, create an <code>/etc/sysctl.conf</code> file and append it with the
following values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;-- begin
#Disables packet forwarding
net.ipv4.ip_forward = 0
#Enables source route verification
net.ipv4.conf.default.rp_filter = 1
#Disables the magic-sysrq key
kernel.sysrq = 0
fs.file-max=65536
vm.bdflush = 100 1200 128 512 15 5000 500 1884 2
net.ipv4.ip_local_port_range = 1024 65000
net.core.rmem_max= 262143
net.core.rmem_default = 262143
net.ipv4.tcp_rmem = 4096 131072 262143
net.ipv4.tcp_wmem = 4096 131072 262143
net.ipv4.tcp_sack = 0
net.ipv4.tcp_timestamps = 0
kernel.shmmax = 67108864</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="file-descriptors-1"><a class="anchor" href="#file-descriptors-1"></a>File Descriptors</h4>
<div class="paragraph">
<p>You may need to increase the number of file descriptors from the
default. Having a higher number of file descriptors ensures that the
server can open sockets under high load and not abort requests coming in
from clients.</p>
</div>
<div class="paragraph">
<p>Start by checking system limits for file descriptors with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>cat /proc/sys/fs/file-max
8192</code></pre>
</div>
</div>
<div class="paragraph">
<p>The current limit shown is 8192. To increase it to 65535, use the
following command (as root):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>echo &quot;65535&quot;&gt; /proc/sys/fs/file-max</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make this value to survive a system reboot, add it to
<code>/etc/sysctl.conf</code> and specify the maximum number of open files
permitted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>fs.file-max = 65535</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the parameter is not <code>proc.sys.fs.file-max</code>, as one might
expect.</p>
</div>
<div class="paragraph">
<p>To list the available parameters that can be modified using <code>sysctl</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>sysctl -a</code></pre>
</div>
</div>
<div class="paragraph">
<p>To load new values from the <code>sysctl.conf</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>sysctl -p /etc/sysctl.conf</code></pre>
</div>
</div>
<div class="paragraph">
<p>To check and modify limits per shell, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>limit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>cputime         unlimited
filesize        unlimited
datasize        unlimited
stacksize       8192 kbytes
coredumpsize    0 kbytes
memoryuse       unlimited
descriptors     1024
memorylocked    unlimited
maxproc         8146
openfiles       1024</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>openfiles</code> and <code>descriptors</code> show a limit of 1024. To increase the
limit to 65535 for all users, edit <code>/etc/security/limits.conf</code> as root,
and modify or add the <code>nofile</code> setting (number of file) entries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>*         soft    nofile                     65535
*         hard    nofile                     65535</code></pre>
</div>
</div>
<div class="paragraph">
<p>The character &#8220;*&#8221; is a wildcard that identifies all users. You could
also specify a user ID instead.</p>
</div>
<div class="paragraph">
<p>Then edit <code>/etc/pam.d/login</code> and add the line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>session required /lib/security/pam_limits.so</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Red Hat, you also need to edit <code>/etc/pam.d/sshd</code> and add the
following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>session required /lib/security/pam_limits.so</code></pre>
</div>
</div>
<div class="paragraph">
<p>On many systems, this procedure will be sufficient. Log in as a regular
user and try it before doing the remaining steps. The remaining steps
might not be required, depending on how pluggable authentication modules
(PAM) and secure shell (SSH) are configured.</p>
</div>
</div>
<div class="sect3">
<h4 id="virtual-memory"><a class="anchor" href="#virtual-memory"></a>Virtual Memory</h4>
<div class="paragraph">
<p>To change virtual memory settings, add the following to <code>/etc/rc.local</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>echo 100 1200 128 512 15 5000 500 1884 2&gt; /proc/sys/vm/bdflush</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information, view the man pages for <code>bdflush</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="network-interface"><a class="anchor" href="#network-interface"></a>Network Interface</h4>
<div class="paragraph">
<p>To ensure that the network interface is operating in full duplex mode,
add the following entry into <code>/etc/rc.local</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>mii-tool -F 100baseTx-FD eth0</code></pre>
</div>
</div>
<div class="paragraph">
<p>where eth0 is the name of the network interface card (NIC).</p>
</div>
</div>
<div class="sect3">
<h4 id="disk-io-settings"><a class="anchor" href="#disk-io-settings"></a>Disk I/O Settings</h4>
<div class="paragraph">
<p>Â </p>
</div>
<div class="sect4">
<h5 id="to-tune-disk-io-performance-for-non-scsi-disks"><a class="anchor" href="#to-tune-disk-io-performance-for-non-scsi-disks"></a>To tune disk I/O performance for non SCSI disks</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Test the disk speed.</p>
<div class="paragraph">
<p>Use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/sbin/hdparm -t /dev/hdX</code></pre>
</div>
</div>
</li>
<li>
<p>Enable direct memory access (DMA).</p>
<div class="paragraph">
<p>Use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/sbin/hdparm -d1 /dev/hdX</code></pre>
</div>
</div>
</li>
<li>
<p>Check the speed again using the <code>hdparm</code> command.</p>
<div class="paragraph">
<p>Given that DMA is not enabled by default, the transfer rate might have
improved considerably. In order to do this at every reboot, add the
<code>/sbin/hdparm -d1 /dev/hdX</code> line to <code>/etc/conf.d/local.start</code>,
<code>/etc/init.d/rc.local</code>, or whatever the startup script is called.</p>
</div>
<div class="paragraph">
<p>For information on SCSI disks, see:
<a href="http://people.redhat.com/alikins/system_tuning.html#scsi">System Tuning
for Linux Servers â SCSI</a>
(<code><a href="http://people.redhat.com/alikins/system_tuning.html#scsi" class="bare">http://people.redhat.com/alikins/system_tuning.html#scsi</a></code>).</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tcpip-settings"><a class="anchor" href="#tcpip-settings"></a>TCP/IP Settings</h4>
<div class="paragraph">
<p>Â </p>
</div>
<div class="sect4">
<h5 id="to-tune-the-tcpip-settings"><a class="anchor" href="#to-tune-the-tcpip-settings"></a>To tune the TCP/IP settings</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following entry to <code>/etc/rc.local</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>echo 30&gt; /proc/sys/net/ipv4/tcp_fin_timeout
echo 60000&gt; /proc/sys/net/ipv4/tcp_keepalive_time
echo 15000&gt; /proc/sys/net/ipv4/tcp_keepalive_intvl
echo 0&gt; /proc/sys/net/ipv4/tcp_window_scaling</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following to <code>/etc/sysctl.conf</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code># Disables packet forwarding
net.ipv4.ip_forward = 0
# Enables source route verification
net.ipv4.conf.default.rp_filter = 1
# Disables the magic-sysrq key
kernel.sysrq = 0
net.ipv4.ip_local_port_range = 1204 65000
net.core.rmem_max = 262140
net.core.rmem_default = 262140
net.ipv4.tcp_rmem = 4096 131072 262140
net.ipv4.tcp_wmem = 4096 131072 262140
net.ipv4.tcp_sack = 0
net.ipv4.tcp_timestamps = 0
net.ipv4.tcp_window_scaling = 0
net.ipv4.tcp_keepalive_time = 60000
net.ipv4.tcp_keepalive_intvl = 15000
net.ipv4.tcp_fin_timeout = 30</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following as the last entry in <code>/etc/rc.local</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>sysctl -p /etc/sysctl.conf</code></pre>
</div>
</div>
</li>
<li>
<p>Reboot the system.</p>
</li>
<li>
<p>Use this command to increase the size of the transmit buffer:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>tcp_recv_hiwat ndd /dev/tcp 8129 32768</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tuning-ultrasparc-cmt-based-systems"><a class="anchor" href="#tuning-ultrasparc-cmt-based-systems"></a>Tuning UltraSPARC CMT-Based Systems</h3>
<div class="paragraph">
<p>Use a combination of tunable parameters and other parameters to tune
UltraSPARC CMT-based systems. These values are an example of how you
might tune your system to achieve the desired result.</p>
</div>
<div class="sect3">
<h4 id="tuning-operating-system-and-tcp-settings"><a class="anchor" href="#tuning-operating-system-and-tcp-settings"></a>Tuning Operating System and TCP Settings</h4>
<div class="paragraph">
<p>The following table shows the operating system tuning for Solaris 10
used when benchmarking for performance and scalability on UtraSPARC
CMT-based systems (64-bit systems).</p>
</div>
<div id="gkuaa" class="paragraph">
<p>Table 5-2 Tuning 64-bit Systems for Performance Benchmarking</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 26.3157%;">
<col style="width: 21.0526%;">
<col style="width: 10.5263%;">
<col style="width: 10.5263%;">
<col style="width: 31.5791%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Tuned</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rlim_fd_max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">260000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process open file descriptors limit;
should account for the expected load
(for the associated sockets, files, pipes if any).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hires_tick</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sq_max_size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls streams driver queue size;
setting to 0 makes it infinite so the performance runs won&#8217;t be hit by
lack of buffer space. Set on clients too. Note that setting
<code>sq_max_size</code> to 0 might not be optimal for production systems with high
network traffic.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ip:ip_squeue_bind</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ip:ip_squeue_fanout</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipge:ipge_taskq_disable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipge:ipge_tx_ring_size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2048</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipge:ipge_srv_fifo_depth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2048</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipge:ipge_bcopy_thresh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">384</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipge:ipge_dvma_thresh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">384</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipge:ipge_tx_syncq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/system</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_conn_req_max_q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_conn_req_max_q0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_max_buf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4194304</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_cwnd_max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd/dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2097152</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_xmit_hiwat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To increase the transmit buffer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tcp_recv_hiwat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ndd /dev/tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To increase the receive buffer.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that the IPGE driver version is 1.25.25.</p>
</div>
</div>
<div class="sect3">
<h4 id="disk-configuration"><a class="anchor" href="#disk-configuration"></a>Disk Configuration</h4>
<div class="paragraph">
<p>If HTTP access is logged, follow these guidelines for the disk:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write access logs on faster disks or attached storage.</p>
</li>
<li>
<p>If running multiple instances, move the logs for each instance onto
separate disks as much as possible.</p>
</li>
<li>
<p>Enable the disk read/write cache. Note that if you enable write cache
on the disk, some writes might be lost if the disk fails.</p>
</li>
<li>
<p>Consider mounting the disks with the following options, which might
yield better disk performance: <code>nologging</code>, <code>directio</code>, <code>noatime</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="network-configuration"><a class="anchor" href="#network-configuration"></a>Network Configuration</h4>
<div class="paragraph">
<p>If more than one network interface card is used, make sure the network
interrupts are not all going to the same core. Run the following script
to disable interrupts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>allpsr=`/usr/sbin/psrinfo | grep -v off-line | awk '{ print $1 }'`
   set $allpsr
   numpsr=$#
   while [ $numpsr -gt 0 ];
   do
       shift
       numpsr=`expr $numpsr - 1`
       tmp=1
       while [ $tmp -ne 4 ];
       do
           /usr/sbin/psradm -i $1
           shift
           numpsr=`expr $numpsr - 1`
           tmp=`expr $tmp + 1`
       done
   done</code></pre>
</div>
</div>
<div class="paragraph">
<p>Put all network interfaces into a single group. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ifconfig ipge0 group webserver
$ifconfig ipge1 group webserver</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-06-10 18:38:23 UTC
</div>
</div>
</body>
</html>