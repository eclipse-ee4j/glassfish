<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Eclipse GlassFish High Availability Administration Guide, Release 7</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Eclipse GlassFish High Availability Administration Guide, Release 7</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#eclipse-glassfish-server">Eclipse GlassFish</a></li>
<li><a href="#preface">Preface</a>
<ul class="sectlevel2">
<li><a href="#oracle-glassfish-server-documentation-set">Eclipse GlassFish Documentation Set</a></li>
<li><a href="#typographic-conventions">Typographic Conventions</a></li>
<li><a href="#symbol-conventions">Symbol Conventions</a></li>
<li><a href="#default-paths-and-file-names">Default Paths and File Names</a></li>
</ul>
</li>
<li><a href="#high-availability-in-glassfish-server">1 High Availability in Eclipse GlassFish</a>
<ul class="sectlevel2">
<li><a href="#overview-of-high-availability">Overview of High Availability</a>
<ul class="sectlevel3">
<li><a href="#load-balancing-with-the-apache-mod_jk-or-mod_proxy_ajp-module">Load Balancing With the Apache <code>mod_jk</code> or <code>mod_proxy_ajp</code> Module</a></li>
<li><a href="#high-availability-session-persistence">High Availability Session Persistence</a></li>
<li><a href="#high-availability-java-message-service">High Availability Java Message Service</a></li>
<li><a href="#overview-rmiiop-lb-failover">RMI-IIOP Load Balancing and Failover</a></li>
</ul>
</li>
<li><a href="#how-glassfish-server-provides-high-availability">How Eclipse GlassFish Provides High Availability</a>
<ul class="sectlevel3">
<li><a href="#storage-for-session-state-data">Storage for Session State Data</a></li>
<li><a href="#highly-available-clusters">Highly Available Clusters</a></li>
</ul>
</li>
<li><a href="#recovering-from-failures">Recovering from Failures</a>
<ul class="sectlevel3">
<li><a href="#recovering-the-domain-administration-server">Recovering the Domain Administration Server</a></li>
<li><a href="#recovering-glassfish-server-instances">Recovering Eclipse GlassFish Instances</a></li>
<li><a href="#recovering-the-http-load-balancer-and-web-server">Recovering the HTTP Load Balancer and Web Server</a></li>
<li><a href="#recovering-message-queue">Recovering Message Queue</a></li>
</ul>
</li>
<li><a href="#more-information">More Information</a></li>
</ul>
</li>
<li><a href="#enabling-centralized-administration-of-glassfish-server-instances">2 Enabling Centralized Administration of Eclipse GlassFish Instances</a>
<ul class="sectlevel2">
<li><a href="#about-centralized-administration-of-glassfish-server-instances">About Centralized Administration of Eclipse GlassFish Instances</a>
<ul class="sectlevel3">
<li><a href="#determining-whether-to-enable-centralized-administration">Determining Whether to Enable Centralized Administration</a></li>
<li><a href="#considerations-for-using-ssh-for-centralized-administration">Considerations for Using SSH for Centralized Administration</a></li>
</ul>
</li>
<li><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a>
<ul class="sectlevel3">
<li><a href="#to-download-and-install-cygwin">To Download and Install Cygwin</a></li>
<li><a href="#to-set-the-path-for-windows-and-for-the-cygwin-shell">To Set the Path for Windows and for the Cygwin Shell</a></li>
<li><a href="#to-set-the-home-directory-for-the-cygwin-ssh-user">To Set the Home Directory for the Cygwin SSH User</a></li>
<li><a href="#to-configure-and-start-the-cygwin-ssh-server-daemon-sshd">To Configure and Start the Cygwin SSH Server Daemon <code>sshd</code></a></li>
</ul>
</li>
<li><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a>
<ul class="sectlevel3">
<li><a href="#to-install-the-mks-toolkit">To Install the MKS Toolkit</a></li>
<li><a href="#to-set-the-path-for-windows-and-for-the-mks-toolkit-shell">To Set the Path for Windows and for the MKS Toolkit Shell</a></li>
<li><a href="#to-set-the-home-directory-for-the-mks-toolkit-ssh-user">To Set the Home Directory for the MKS Toolkit SSH User</a></li>
<li><a href="#to-configure-and-start-the-mks-toolkit-ssh-server-daemon-sshd">To Configure and Start the MKS Toolkit SSH Server Daemon <code>sshd</code></a></li>
</ul>
</li>
<li><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a>
<ul class="sectlevel3">
<li><a href="#to-set-up-ssh-on-macos-systems">To Set Up SSH on MacOS Systems</a></li>
<li><a href="#to-set-up-ssh-on-linux-systems">To Set Up SSH on Linux systems</a></li>
</ul>
</li>
<li><a href="#testing-the-ssh-setup-on-a-host">Testing the SSH Setup on a Host</a>
<ul class="sectlevel3">
<li><a href="#to-test-the-ssh-setup-on-a-host">To Test the SSH Setup on a Host</a></li>
</ul>
</li>
<li><a href="#setting-up-ssh-user-authentication">Setting Up SSH User Authentication</a>
<ul class="sectlevel3">
<li><a href="#to-set-up-public-key-authentication-without-encryption">To Set Up Public Key Authentication Without Encryption</a></li>
<li><a href="#to-set-up-encrypted-public-key-authentication">To Set Up Encrypted Public Key Authentication</a></li>
<li><a href="#to-set-up-password-authentication">To Set Up Password Authentication</a></li>
</ul>
</li>
<li><a href="#installing-and-removing-glassfish-server-software-on-multiple-hosts">Installing and Removing Eclipse GlassFish Software on Multiple Hosts</a>
<ul class="sectlevel3">
<li><a href="#to-copy-a-glassfish-server-installation-to-multiple-hosts">To Copy a Eclipse GlassFish Installation to Multiple Hosts</a></li>
<li><a href="#to-remove-glassfish-server-software-from-multiple-hosts">To Remove Eclipse GlassFish Software From Multiple Hosts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#administering-glassfish-server-nodes">3 Administering Eclipse GlassFish Nodes</a>
<ul class="sectlevel2">
<li><a href="#types-of-glassfish-server-nodes">Types of Eclipse GlassFish Nodes</a></li>
<li><a href="#creating-listing-testing-and-deleting-ssh-nodes">Creating, Listing, Testing, and Deleting <code>SSH</code> Nodes</a>
<ul class="sectlevel3">
<li><a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a></li>
<li><a href="#to-list-ssh-nodes-in-a-domain">To List <code>SSH</code> Nodes in a Domain</a></li>
<li><a href="#to-test-if-an-ssh-node-is-reachable">To Test if an <code>SSH</code> Node is Reachable</a></li>
<li><a href="#to-delete-an-ssh-node">To Delete an <code>SSH</code> Node</a></li>
</ul>
</li>
<li><a href="#creating-listing-and-deleting-config-nodes">Creating, Listing, and Deleting <code>CONFIG</code> Nodes</a>
<ul class="sectlevel3">
<li><a href="#to-create-a-config-node">To Create a <code>CONFIG</code> Node</a></li>
<li><a href="#to-list-config-nodes-in-a-domain">To List <code>CONFIG</code> Nodes in a Domain</a></li>
<li><a href="#to-delete-a-config-node">To Delete a <code>CONFIG</code> Node</a></li>
</ul>
</li>
<li><a href="#updating-and-changing-the-type-of-a-node">Updating and Changing the Type of a Node</a>
<ul class="sectlevel3">
<li><a href="#to-update-an-ssh-node">To Update an <code>SSH</code> Node</a></li>
<li><a href="#to-update-a-config-node">To Update a <code>CONFIG</code> Node</a></li>
<li><a href="#to-change-the-type-of-a-node">To Change the Type of a Node</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#administering-glassfish-server-clusters">4 Administering Eclipse GlassFish Clusters</a>
<ul class="sectlevel2">
<li><a href="#about-glassfish-server-clusters">About Eclipse GlassFish Clusters</a></li>
<li><a href="#group-management-service">Group Management Service</a>
<ul class="sectlevel3">
<li><a href="#protocols-and-transports-for-gms">Protocols and Transports for GMS</a></li>
<li><a href="#gms-configuration-settings">GMS Configuration Settings</a></li>
<li><a href="#dotted-names-for-gms-settings">Dotted Names for GMS Settings</a></li>
<li><a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS Configuration Settings</a></li>
<li><a href="#to-change-gms-settings-after-cluster-creation">To Change GMS Settings After Cluster Creation</a></li>
<li><a href="#to-check-the-health-of-instances-in-a-cluster">To Check the Health of Instances in a Cluster</a></li>
<li><a href="#to-validate-that-multicast-transport-is-available-for-a-cluster">To Validate That Multicast Transport Is Available for a Cluster</a></li>
<li><a href="#discovering-a-cluster-when-multicast-transport-is-unavailable">Discovering a Cluster When Multicast Transport Is Unavailable</a></li>
<li><a href="#using-the-multi-homing-feature-with-gms">Using the Multi-Homing Feature With GMS</a></li>
</ul>
</li>
<li><a href="#creating-listing-and-deleting-clusters">Creating, Listing, and Deleting Clusters</a>
<ul class="sectlevel3">
<li><a href="#to-create-a-cluster">To Create a Cluster</a></li>
<li><a href="#to-list-all-clusters-in-a-domain">To List All Clusters in a Domain</a></li>
<li><a href="#to-delete-a-cluster">To Delete a Cluster</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#administering-glassfish-server-instances">5 Administering Eclipse GlassFish Instances</a>
<ul class="sectlevel2">
<li><a href="#types-of-glassfish-server-instances">Types of Eclipse GlassFish Instances</a></li>
<li><a href="#administering-glassfish-server-instances-centrally">Administering Eclipse GlassFish Instances Centrally</a>
<ul class="sectlevel3">
<li><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></li>
<li><a href="#to-list-all-instances-in-a-domain">To List All Instances in a Domain</a></li>
<li><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></li>
<li><a href="#to-start-a-cluster">To Start a Cluster</a></li>
<li><a href="#to-stop-a-cluster">To Stop a Cluster</a></li>
<li><a href="#to-start-an-individual-instance-centrally">To Start an Individual Instance Centrally</a></li>
<li><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></li>
<li><a href="#to-restart-an-individual-instance-centrally">To Restart an Individual Instance Centrally</a></li>
</ul>
</li>
<li><a href="#administering-glassfish-server-instances-locally">Administering Eclipse GlassFish Instances Locally</a>
<ul class="sectlevel3">
<li><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></li>
<li><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></li>
<li><a href="#to-start-an-individual-instance-locally">To Start an Individual Instance Locally</a></li>
<li><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></li>
<li><a href="#to-restart-an-individual-instance-locally">To Restart an Individual Instance Locally</a></li>
</ul>
</li>
<li><a href="#resynchronizing-glassfish-server-instances-and-the-das">Resynchronizing Eclipse GlassFish Instances and the DAS</a>
<ul class="sectlevel3">
<li><a href="#default-synchronization-for-files-and-directories">Default Synchronization for Files and Directories</a></li>
<li><a href="#to-resynchronize-an-instance-and-the-das-online">To Resynchronize an Instance and the DAS Online</a></li>
<li><a href="#to-resynchronize-library-files">To Resynchronize Library Files</a></li>
<li><a href="#to-resynchronize-custom-configuration-files-for-an-instance">To Resynchronize Custom Configuration Files for an Instance</a></li>
<li><a href="#to-resynchronize-users-changes-to-files">To Resynchronize Users' Changes to Files</a></li>
<li><a href="#to-resynchronize-additional-configuration-files">To Resynchronize Additional Configuration Files</a></li>
<li><a href="#to-prevent-deletion-of-application-generated-files">To Prevent Deletion of Application-Generated Files</a></li>
<li><a href="#to-resynchronize-an-instance-and-the-das-offline">To Resynchronize an Instance and the DAS Offline</a></li>
</ul>
</li>
<li><a href="#migrating-ejb-timers">Migrating EJB Timers</a>
<ul class="sectlevel3">
<li><a href="#to-enable-automatic-ejb-timer-migration-for-failed-clustered-instances">To Enable Automatic EJB Timer Migration for Failed Clustered Instances</a></li>
<li><a href="#to-migrate-ejb-timers-manually">To Migrate EJB Timers Manually</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#administering-named-configurations">6 Administering Named Configurations</a>
<ul class="sectlevel2">
<li><a href="#about-named-configurations">About Named Configurations</a>
<ul class="sectlevel3">
<li><a href="#types-of-named-configurations">Types of Named Configurations</a></li>
<li><a href="#the-default-config-configuration">The <code>default-config</code> Configuration</a></li>
<li><a href="#automatically-created-configurations">Automatically Created Configurations</a></li>
<li><a href="#directory-for-configuration-synchronization">Directory for Configuration Synchronization</a></li>
</ul>
</li>
<li><a href="#creating-listing-and-deleting-named-configurations">Creating, Listing, and Deleting Named Configurations</a>
<ul class="sectlevel3">
<li><a href="#to-create-a-named-configuration">To Create a Named Configuration</a></li>
<li><a href="#to-list-the-named-configurations-in-a-domain">To List the Named Configurations in a Domain</a></li>
<li><a href="#to-list-the-targets-of-a-named-configuration">To List the Targets of a Named Configuration</a></li>
<li><a href="#to-delete-a-named-configuration">To Delete a Named Configuration</a></li>
</ul>
</li>
<li><a href="#modifying-properties-for-named-configurations-and-instances">Modifying Properties for Named Configurations and Instances</a>
<ul class="sectlevel3">
<li><a href="#properties-for-port-numbers-in-a-named-configuration">Properties for Port Numbers in a Named Configuration</a></li>
<li><a href="#to-modify-a-named-configurations-properties">To Modify a Named Configuration&#8217;s Properties</a></li>
<li><a href="#to-modify-port-numbers-of-an-instance">To Modify Port Numbers of an Instance</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuring-http-load-balancing">7 Configuring HTTP Load Balancing</a>
<ul class="sectlevel2">
<li><a href="#setting-up-http-load-balancing">Setting Up HTTP Load Balancing</a>
<ul class="sectlevel3">
<li><a href="#prerequisites-for-setting-up-http-load-balancing">Prerequisites for Setting Up HTTP Load Balancing</a></li>
<li><a href="#configuring-glassfish-server-with-apache-http-server-and-mod_jk">Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_jk</code></a></li>
<li><a href="#configuring-glassfish-server-with-apache-http-server-and-mod_proxy_ajp">Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_proxy_ajp</code></a></li>
<li><a href="#http-load-balancer-deployments">HTTP Load Balancer Deployments</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#upgrading-applications-without-loss-of-availability">8 Upgrading Applications Without Loss of Availability</a>
<ul class="sectlevel2">
<li><a href="#application-compatibility">Application Compatibility</a></li>
<li><a href="#upgrading-in-a-single-cluster">Upgrading In a Single Cluster</a>
<ul class="sectlevel3">
<li><a href="#to-upgrade-an-application-in-a-single-cluster">To Upgrade an Application in a Single Cluster</a></li>
</ul>
</li>
<li><a href="#upgrading-in-multiple-clusters">Upgrading in Multiple Clusters</a>
<ul class="sectlevel3">
<li><a href="#to-upgrade-a-compatible-application-in-two-or-more-clusters">To Upgrade a Compatible Application in Two or More Clusters</a></li>
</ul>
</li>
<li><a href="#upgrading-incompatible-applications">Upgrading Incompatible Applications</a>
<ul class="sectlevel3">
<li><a href="#to-upgrade-an-incompatible-application-by-creating-a-second-cluster">To Upgrade an Incompatible Application by Creating a Second Cluster</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuring-high-availability-session-persistence-and-failover">9 Configuring High Availability Session Persistence and Failover</a>
<ul class="sectlevel2">
<li><a href="#overview-of-session-persistence-and-failover">Overview of Session Persistence and Failover</a>
<ul class="sectlevel3">
<li><a href="#requirements">Requirements</a></li>
<li><a href="#restrictions">Restrictions</a></li>
<li><a href="#scope">Scope</a></li>
</ul>
</li>
<li><a href="#enabling-the-high-availability-session-persistence-service">Enabling the High Availability Session Persistence Service</a>
<ul class="sectlevel3">
<li><a href="#to-enable-availability-for-a-cluster-standalone-instance-or-container">To Enable Availability for a Cluster, Standalone Instance or Container</a></li>
<li><a href="#configuring-availability-for-individual-web-applications">Configuring Availability for Individual Web Applications</a></li>
<li><a href="#configuring-replication-and-multi-threaded-concurrent-access-to-httpsessions">Configuring Replication and Multi-Threaded Concurrent Access to <code>HttpSessions</code></a></li>
<li><a href="#using-single-sign-on-with-session-failover">Using Single Sign-on with Session Failover</a></li>
<li><a href="#using-coherenceweb-for-http-session-persistence">Using Coherence*Web for HTTP Session Persistence</a></li>
</ul>
</li>
<li><a href="#stateful-session-bean-failover">Stateful Session Bean Failover</a>
<ul class="sectlevel3">
<li><a href="#configuring-availability-for-the-ejb-container">Configuring Availability for the EJB Container</a></li>
<li><a href="#configuring-availability-for-an-individual-application-or-ejb-module">Configuring Availability for an Individual Application or EJB Module</a></li>
<li><a href="#configuring-availability-for-an-individual-bean">Configuring Availability for an Individual Bean</a></li>
<li><a href="#specifying-methods-to-be-checkpointed">Specifying Methods to Be Checkpointed</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuring-java-message-service-high-availability">10 Configuring Java Message Service High Availability</a>
<ul class="sectlevel2">
<li><a href="#using-message-queue-broker-clusters-with-glassfish-server">Using Message Queue Broker Clusters With Eclipse GlassFish</a>
<ul class="sectlevel3">
<li><a href="#about-message-queue-broker-clusters">About Message Queue Broker Clusters</a></li>
<li><a href="#configuring-glassfish-clusters-to-use-message-queue-broker-clusters">Configuring GlassFish Clusters to Use Message Queue Broker Clusters</a></li>
<li><a href="#to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-with-master-broker">To Configure a GlassFish Cluster to Use an Embedded or Local Conventional Broker Cluster With Master Broker</a></li>
<li><a href="#to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-of-peer-brokers">To Configure a GlassFish Cluster to Use an Embedded or Local Conventional Broker Cluster of Peer Brokers</a></li>
<li><a href="#to-change-the-master-broker-in-an-embedded-or-local-broker-cluster">To Change the Master Broker in an Embedded or Local Broker Cluster</a></li>
<li><a href="#to-migrate-between-types-of-embedded-or-local-conventional-broker-clusters">To Migrate Between Types of Embedded or Local Conventional Broker Clusters</a></li>
<li><a href="#to-configure-a-glassfish-cluster-to-use-a-local-enhanced-broker-cluster">To Configure a GlassFish Cluster to Use a Local Enhanced Broker Cluster</a></li>
<li><a href="#to-configure-a-glassfish-cluster-to-use-a-remote-broker-cluster">To Configure a GlassFish Cluster to Use a Remote Broker Cluster</a></li>
</ul>
</li>
<li><a href="#connection-failover">Connection Failover</a></li>
<li><a href="#load-balanced-delivery-to-mdbs">Load-Balanced Delivery to MDBs</a></li>
</ul>
</li>
<li><a href="#rmi-iiop-load-balancing-and-failover">11 RMI-IIOP Load Balancing and Failover</a>
<ul class="sectlevel2">
<li><a href="#overview">Overview</a>
<ul class="sectlevel3">
<li><a href="#general-requirements-for-configuring-load-balancing">General Requirements for Configuring Load Balancing</a></li>
<li><a href="#load-balancing-models">Load Balancing Models</a></li>
</ul>
</li>
<li><a href="#initialcontext-load-balancing"><code>InitialContext</code> Load Balancing</a>
<ul class="sectlevel3">
<li><a href="#initialcontext-summary"><code>InitialContext</code> Summary</a></li>
<li><a href="#initialcontext-algorithm"><code>InitialContext</code> Algorithm</a></li>
<li><a href="#enabling-rmi-iiop-hardware-load-balancing-and-failover">Enabling RMI-IIOP Hardware Load Balancing and Failover</a></li>
</ul>
</li>
<li><a href="#per-request-load-balancing-prlb">Per-Request Load Balancing (PRLB)</a>
<ul class="sectlevel3">
<li><a href="#prlb-summary">PRLB Summary</a></li>
<li><a href="#enabling-per-request-load-balancing">Enabling Per-Request Load Balancing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="eclipse-glassfish-server"><a class="anchor" href="#eclipse-glassfish-server"></a>Eclipse GlassFish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>High Availability Administration Guide</p>
</div>
<div class="paragraph">
<p>Release 7</p>
</div>
<div class="paragraph">
<p>Contributed 2018 - 2024</p>
</div>
<div class="paragraph">
<p>This book describes thehigh-availability features in Eclipse GlassFish,
including converged load balancing, HTTP load balancing, clusters,
session persistence and failover.</p>
</div>
<div class="paragraph">
<p>Note: The main thrust of the Eclipse GlassFish 7
release is to provide an application server for developers to explore
and begin exploiting the new and updated technologies in the Jakarta EE 10
platform. Thus, the clustering, standalone instance and high
availability features of Eclipse GlassFish were not a focus of this
release. These features are included in the release, but they may not
function properly with some of the new features added in support of the
Jakarta EE 10 platform.</p>
</div>
<hr>
<div class="paragraph">
<p>Eclipse GlassFish High Availability Administration
Guide, Release 7</p>
</div>
<div class="paragraph">
<p>Copyright © 2013, 2019 Oracle and/or its affiliates. All rights reserved.</p>
</div>
<div class="paragraph">
<p>This program and the accompanying materials are made available under the
terms of the Eclipse Public License v. 2.0, which is available at
<a href="http://www.eclipse.org/legal/epl-2.0" class="bare">http://www.eclipse.org/legal/epl-2.0</a>.</p>
</div>
<div class="paragraph">
<p>SPDX-License-Identifier: EPL-2.0</p>
</div>
<div class="paragraph">
<p>Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.</p>
</div>
<div class="paragraph">
<p>Intel and Intel Xeon are trademarks or registered trademarks of Intel
Corporation. All SPARC trademarks are used under license and are
trademarks or registered trademarks of SPARC International, Inc. AMD,
Opteron, the AMD logo, and the AMD Opteron logo are trademarks or
registered trademarks of Advanced Micro Devices. UNIX is a registered
trademark of The Open Group.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHoAAAAoCAYAAAAxH+4YAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4gsHAhURI94LCQAADalJREFUeNrtnHmw19QVxz+/t0EeyKJVXBAxWAUVcUcbE6xaRTvWsVXrUlsdbZUaday4MCLWjVbEVm2sjLbVukxVFFrtQlUUEuO4gguCGxERkMciD/QReNuvf+RErnnJ75ffAwo678xkXn5Zbu69Z7nnfM+5r0AKhY6OZgfq725AD2Bf4DBgIFAPtACLgFnAS0ATsE6zg3a6aKuiQqmboaP3BYYDPwVOAWqBdmHuZ8AXwmxNXnGBacC7wFKgqApMF205qklqMoBmB4SOfiQwGvi+3F4IPAH4wDvAx5odhIn3dwO+Dewmmr2qa4q3Mo0WJhc0OyiGjn4ZMA7oI7fHAI8AizQ7aC1l5uVaAajR7KCla4q3Moq1OXT08aGjF+V4N3T0vUNHr1Kfi58t1U7yvIu2EgbL+SUKk/3Q0XfpYtg3g1RNPQK4Xn6+BZyl2cHiNNPcRV/TNTp09N7Ag8CJwDrgMM0O3uxi8jdPo4cLkwEu3lRMtkyj0/fT7uW91pk2N7adjZmDjR1XLo0WMORe4GzgbeBAzQ5aVUbLR7tV2Har6/ltWQNwPT/+3UtAmP5iYRYAvuv56+Ln42fld7USFhZdz2+uUPhqFQH/Sh8t0ygIVpCFLxTlnXZ1PGr/0q5bpnGIhKl7Ad2BVcCbwFOu5wdZ7VimUQNUVzjv64VXRSCOkNpriBCuk+XCBKAtjqUT8fa6Cj94O3BZ2uAt09As0zgauBowMhgyWfozG2hTJuJKYLwyqO4V9mseMEjOrwVuUu4NFcBnpzLCshJ4HLhDwKGiMra4n1WWaRwD/AHYM2uOLNOYClzlev4HKcyeoljavLSDzFt3YC5wJHBxlUhZT6ABeFGzg2KGJNMJyUpjcj9gEvBUFpOFTgVeAK6zTKOHMgFqu2s60a/Ps/ooQv55jja2Ay4A3gDOUy2UjLEAnC5jVJn8BRGiqM7nycDTlmnsm2IZmioc2xdire4CngXqgGeAQTWyPkOEVX+Wo7GiPFcKz65XJ0xhci3wKDAi8fzzwEfS5u7A0XK9G3Ac8PtODHpT0FIgTJjyetEaZCJvt0xjmev5TyoauSMwVu4DzAd+CwRiTnsDFvALoBdR7mA0cE4ZJoZl/K1G4c9Hcj4NWA7sWCMfAXg/p4a0AqY0VMqbT9OMSQkmTxXzvQxolk7WAdsDtwD7AD8DVmWthZuR2gEbmK4wLCYTuAfYlijZc6FlGk+7nr9OfJCdgCGKYoxwPX9xwsJNA/4D3AjcD/y9TH/uAO4uo2DtwArxIVYq1xfWsCEhsbSCrFOD6/l5tF/V5v2AHym3HgQucD0/TDguoev5qy3TOAWodz2/aQswOaZG1/MbUxzJJyzT2AX4nThLg4Wxs+XR3kob7yWZLNTiev5zwHMVLDlL0xzcPFQjmkRsFnKGVbnTkAqDzhBfADEt45NMTqx1RWBLMrnUWAD+Jk5PNdBXrFBMy5XzwZZpnAx4wJo4SkhEEnnG2B47yp1l9CdJlCwHyLK/ZRqlzHw18LYaIgEHyvUi8JLr+e+mTF65yd3ilMGUYuxgifX6lChlayneswu8YZnGIlmqPgHedT1/Sc4x9gcOtkyjvQRfVgCfqOGfyuhZct4zJazKYuL9ZbS6N3CoOCGxy99H8Wz9CiR5S1KxhOCdo8TzK8Rxi59ZaZnGNUQZv11iGVEY3yZr6KeWabwC3OB6/qIy8/GTMqFWnViZcWlOW42yrgwIHb02R2qxQJRvLke1ynk35XdRJmZrZzJpptIyjXrgQnEiYzBjruv5byeE9wXgEOByCcV6JpRlBzn2A061TMNwPX9uCWZvK0cp2j4L7KkR7k8DhonWLc8xAWvLxNY9EhrfrKA0hbjDW7lGVwEzckCRK4Hb0sbjev6nEjaNtkxjiCCAg4EDgMPFEa6WeX8O2LHEfDQTVfNkUbcUXKAD4nU/8FegXw5GNwN7CIyXFzBZoYRj1RK73/010Ohy9DFwrev5XiJy6CDArufPE1Qufqa7IHwXCx/6WaZxkuv5/8j41g2CNraVsUCpwlAjFSUzJI4+IXT0OWXW6gIQxo5WTuelzTKNdwQIqQKOsExjoOv5CzIw3s54pZuDAsEWVHPYIijibOBR1/PnCBJWVNdxudZPni2mjGedZRo3Agcpa/dQIIvRLcBaiUY65XWj2UFD6Oi3iITdodnB+k0RXiXM3sOyVmmCNV9nmcb5IgRf4sSJiTrQ9fzXtxCT2wULn5EATNqAphhHkD4XVW2WCGMcMAA4yvX8RlVYlfFUJeaylLa2d5bJADVx3KzZwcOho48EbgZGl4mnh1umsbqMZ77I9fxPFCl/zTKNp4DTFK+1v2UaF7qeP1+dAMs0DhAUaF/LNM5MwIslveIKQqJcEKjr+UsqDP8KgnLtKr99yzROjLNUCTozgRS+WuJTAy3TOLyEMBTED3rL9fyWNNONwuyzQ0efETq6odmBHwMoxz3awZt+OsckTQSuSFw7C9ifDUD/McCHlmkEwBy5djCws/LOZMs0DnI9f07KN3awTKMcs+90Pf/STipCoZMh2RjgIfm9NzDfMo2ZwExZCnYCRgrEG9M81/OfLdHuRXKU8592B5akeZZxeS9yfqSs1YNyxtW5QhPRqlbgOyIoajWpDvxAjp0TDt0/E45fVYX9aE2xNlltFZT7VZ1htGj448CtCcdohJjziRJyfYXJcYycWO4qzUW3lFyjVWYLY68FDggdvV6zg7UKbJk3LdgdWJycAGH2SoEEfyyDO4yO+d8lEodOBaa6nr9eMb8NRAUSefyEWgX5i2kuG5InSxP3QrEsTSKoFadBpZ/rLdMYK2DUGUTp2O1SHp8F/Bu41/X8hSlLTCD9bclpfdZket3qD4XZ7aGjz1Ikvk0ksr0Ck7cmaz1zPX8tcJ9lGlOAbwHbyAEReP85sNz1/DUpa+xUorRmMWc/klm0S9hQRZL0MxaKw1irAjuVarT0txl4xDKN/8oY+8jfWgk1V4qlaogTFSnr/QTAqWCs7eRLNYtYb6La7CywIatGqlztVGfrqErVhZWrGdvYb6aNMXkv61oXddH/n5Ian3cXRynrkdVm2vVS36+0L5X2s5J5ydt2pc/mtbiFnMwsSPzbnAgj3tHs4AP1o7GXHjr6gYLn1gGzNTuYUaL9k4D5mh3MUa4NF6/zJbUgInT0GuB7wAeaHXwo1+olVAvUNuTejoLItUqfVwEvaHYQho5eSKuRi8cROvpZwAfAKyn7y3oDx6Z47kXgec0OlivPVovj+Z5mB/MyvtUdOEni72XAk5odNGbsbRtIVOs3Pa7YlTBuN7nWXNIZK0FVRCm3ZmFcXEp6jYQRqjNXkOtXiPe9FugVOvqDwM+BlpSQ7S8CkIxVrl0sKNqZCdy8TuLUgaGjD9HsoIko8X8b8IASj6PEsQ+Jo1IlXumC0NFHaXYwPW0iZRwj5T1f+rAw0W5/orRgtfSvyIaK1BF8NWdQB9wpx7wUJg8R6HMQUW1YPbA8dPSTNTt4OaWPhwCPAT8U57RAVE58OvBymkNWaUx6swTkg4k2xf8p5ZljieqgHBl4X+B8otqvURlxeS861o3Xy5FmhbqL5KvATU861nbFwtxMVFXaV6xBHXBX6Oi7qxhCgsZLuDUMKaBMPDdX+tdblOB5ojRhNwkNk9Shf/LtGmCytLO3Zge9ier4GoFpoaN3T5mzWEEnh44+UKxSHVHWsJClqZVQI9Em+MVyrE6YlG5ifl4FfqPZQVEQt/sERLh6E7kGNaIZw0JHvxWlwqMEbv2ZZgeNmh3MBL4rpu8oFRRSfAGLKJU4TjTmIlkeVE0siolcL+FnO7Bes4NmCU/zjuUEonqz0zQ7eE+Wk8VEhQZ9gHMzhL1ZNHdm6Oh9yuDkFTP6PGHYI2Im90rcryNKYc6KA3dlwHPILoz/MvujPF8s4UfUElVnXimw4Nk5/I0qpf2lEiPvlNQwobFEe8Eniok0gX3i+wkNK6SdV4Ao7ip9mxkLkLwfV/7skTGW1cKPnrKE9CyFc1TK6OXAh3LMp+PujTaRsgFAdWJt2VXWnyzorkeKqWsrIan1mh38kaiadBxRLXU5DDruTw8BL1alePbDxVQvCx39UqKdDk3ITtPNsIU4Bpb2VJeR0NFjIWzIGEs34DVZl0cK0LN+UzF6qmYHo4GrROoXJDRiLVG1yvHA8YpJPJzof6Dcn9HuS8CI0NF3kMH2l7V0fonSpljjryfaMVGOya3SlwFExXoNwIvJaEF8iV5EJT4TxCncBjg+dPS9NsPu0uniZT+QsAST5O8jpaBmzQ6eAUaJ4BbLYt2VgOZp7rtCU8QDfDx09PfF6x4mzsu4jHcuFemcFzr6fKJ87gKifUtJRhRFy2MNXRI6+hjxWrO2E2mAq2hjE/ArzQ5mJ0LCwaIdEzU7uELR9n5Ee6x+Ldh12jfKwcPtyf7Jt5eEjn458OfQ0dcKjr8HUbnVKM0OFmakjNXvPSDLy9CN1egi0c6J2eVAAs0O1kjC4lzgdTHxVxHtuV6VFvBrdvAWUTbnIXH2JgBHaHbwYcogW8Tb/5fyvgv8kigNmKSPJAS8SY5LgaGaHdwjoWByPqaoIaO03yD+wHsp7bdKXx4rYTpbJfzzU7zugmYHDxGlZ+8V/2EycKhmB5PkfrK9OURZsEbFko4h2lCQum3nf8vVJ/NUdLY+AAAAAElFTkSuQmCC" alt="Eclipse Logo"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preface"><a class="anchor" href="#preface"></a>Preface</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This documentation is part of the Java Enterprise Edition contribution
to the Eclipse Foundation and is not intended for use in relation to
Java Enterprise Edition or Orace GlassFish. The documentation is in the
process of being revised to reflect the new Jakarta EE branding.
Additional changes will be made as requirements and procedures evolve
for Jakarta EE. Where applicable, references to Jakarta EE or Java
Enterprise Edition should be considered references to Jakarta EE.</p>
</div>
<div class="paragraph">
<p>Please see the Title page for additional license information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This book describes the high-availability features in Eclipse GlassFish,
including converged load balancing, HTTP load balancing, clusters,
session persistence and failover.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The main thrust of the Eclipse GlassFish 7 release
is to provide an application server for developers to explore and begin
exploiting the new and updated technologies in the Jakarta EE 10 platform.
Thus, the clustering, standalone instance and high availability features
of Eclipse GlassFish were not a focus of this release. These features are
included in the release, but they may not function properly with some of
the new features added in support of the Jakarta EE 10 platform.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This preface contains information about and conventions for the entire
Eclipse GlassFish (Eclipse GlassFish) documentation
set.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish 7 is developed through the GlassFish project
open-source community at <code><a href="http://glassfish.java.net/" class="bare">http://glassfish.java.net/</a></code>. The GlassFish
project provides a structured process for developing the Eclipse GlassFish platform that makes the new features of the Jakarta EE platform
available faster, while maintaining the most important feature of Java
EE: compatibility. It enables Java developers to access the Eclipse GlassFish source code and to contribute to the development of the Eclipse GlassFish. The GlassFish project is designed to encourage communication
between Oracle engineers and the community.</p>
</div>
<div class="sect2">
<h3 id="oracle-glassfish-server-documentation-set"><a class="anchor" href="#oracle-glassfish-server-documentation-set"></a>Eclipse GlassFish Documentation Set</h3>
<div class="paragraph">
<p>The Eclipse GlassFish documentation set describes deployment planning and
system installation. For an introduction to Eclipse GlassFish, refer to
the books in the order in which they are listed in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Book Title</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="release-notes.html#GSRLN">Release Notes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides late-breaking information about
the software and the documentation and includes a comprehensive,
table-based summary of the supported hardware, operating system, Java
Development Kit (JDK), and database drivers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="quick-start-guide.html#GSQSG">Quick Start Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to get started with the
Eclipse GlassFish product.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="installation-guide.html#GSING">Installation Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to install the software
and its components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="upgrade-guide.html#GSUPG">Upgrade Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to upgrade to the latest
version of Eclipse GlassFish. This guide also describes differences
between adjacent product releases and configuration options that can
result in incompatibility with the product specifications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="deployment-planning-guide.html#GSPLG">Deployment Planning Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to build a
production deployment of Eclipse GlassFish that meets the requirements of
your system and enterprise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="administration-guide.html#GSADG">Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to configure, monitor,
and manage Eclipse GlassFish subsystems and components from the command
line by using the <a href="reference-manual.html#asadmin"><code>asadmin</code></a> utility. Instructions for
performing these tasks from the Administration Console are provided in
the Administration Console online help.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="security-guide.html#GSSCG">Security Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides instructions for configuring and
administering Eclipse GlassFish security.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="application-deployment-guide.html#GSDPG">Application Deployment Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to assemble and
deploy applications to the Eclipse GlassFish and provides information
about deployment descriptors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="application-development-guide.html#GSDVG">Application Development Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to create and
implement Java Platform, Enterprise Edition (Jakarta EE platform)
applications that are intended to run on the Eclipse GlassFish. These
applications follow the open Java standards model for Jakarta EE components
and application programmer interfaces (APIs). This guide provides
information about developer tools, security, and debugging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="embedded-server-guide.html#GSESG">Embedded Server Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to run applications in
embedded Eclipse GlassFish and to develop applications in which Eclipse GlassFish is embedded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="ha-administration-guide.html#GSHAG">High Availability Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to
configure Eclipse GlassFish to provide higher availability and
scalability through failover and load balancing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="performance-tuning-guide.html#GSPTG">Performance Tuning Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to optimize the
performance of Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="troubleshooting-guide.html#GSTSG">Troubleshooting Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes common problems that you
might encounter when using Eclipse GlassFish and explains how to solve
them.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="error-messages-reference.html#GSEMR">Error Message Reference</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes error messages that you
might encounter when using Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="reference-manual.html#GSRFM">Reference Manual</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides reference information in man
page format for Eclipse GlassFish administration commands, utility
commands, and related concepts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-release-notes/toc.html">Message Queue Release Notes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes new features,
compatibility issues, and existing bugs for Open Message Queue.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-tech-over/toc.html">Message Queue Technical Overview</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides an introduction
to the technology, concepts, architecture, capabilities, and features of
the Message Queue messaging service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html">Message Queue Administration Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to set up
and manage a Message Queue messaging system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-jmx/toc.html">Message Queue Developer&#8217;s Guide for JMX Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes
the application programming interface in Message Queue for
programmatically configuring and monitoring Message Queue resources in
conformance with the Java Management Extensions (JMX).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-java/toc.html">Message Queue Developer&#8217;s Guide for Java Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides
information about concepts and procedures for developing Java messaging
applications (Java clients) that work with Eclipse GlassFish.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-c/toc.html">Message Queue Developer&#8217;s Guide for C Clients</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides
programming and reference information for developers working with
Message Queue who want to use the C language binding to the Message
Queue messaging service to send, receive, and process Message Queue
messages.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="typographic-conventions"><a class="anchor" href="#typographic-conventions"></a>Typographic Conventions</h3>
<div class="paragraph">
<p>The following table describes the typographic changes that are used in
this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 37%;">
<col style="width: 49%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Typeface</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AaBbCc123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The names of commands, files, and directories, and
onscreen computer output</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Edit your <code>.login</code> file.</p>
</div>
<div class="paragraph">
<p>Use <code>ls</code> <code>a</code> to list all files.</p>
</div>
<div class="paragraph">
<p><code>machine_name% you have mail.</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AaBbCc123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What you type, contrasted with onscreen computer output</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>machine_name%</code> <code>su</code></p>
</div>
<div class="paragraph">
<p><code>Password:</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AaBbCc123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A placeholder to be replaced with a real name or value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
command to remove a file is <code>rm</code> filename.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AaBbCc123</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Book titles, new terms, and terms to be emphasized (note
that some emphasized items appear bold online)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Read Chapter 6 in the User&#8217;s Guide.</p>
</div>
<div class="paragraph">
<p>A cache is a copy that is stored locally.</p>
</div>
<div class="paragraph">
<p>Do not save the file.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="symbol-conventions"><a class="anchor" href="#symbol-conventions"></a>Symbol Conventions</h3>
<div class="paragraph">
<p>The following table explains symbols that might be used in this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 26%;">
<col style="width: 28%;">
<col style="width: 36%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbol</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains optional arguments and command options.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ls [-l]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
<code>-l</code> option is not required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{ | }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains a set of choices for a required command option.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-d {y|n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>-d</code> option requires that you use either the <code>y</code>
argument or the <code>n</code> argument.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${ }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a variable reference.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${com.sun.javaRoot}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the value of the <code>com.sun.javaRoot</code> variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joins simultaneous multiple keystrokes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control-A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Press the
Control key while you press the A key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+<br></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Joins consecutive multiple keystrokes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ctrl+A+N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Press the
Control key, release it, and then press the subsequent keys.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates menu item selection in a graphical user interface.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File &gt;
New &gt; Templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">From the File menu, choose New. From the New submenu,
choose Templates.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="default-paths-and-file-names"><a class="anchor" href="#default-paths-and-file-names"></a>Default Paths and File Names</h3>
<div class="paragraph">
<p>The following table describes the default paths and file names that are
used in this book.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 34%;">
<col style="width: 52%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Placeholder</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Represents the base installation directory for Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>In configuration files, as-install is represented as follows:</p>
</div>
<div class="paragraph">
<p><code>${com.sun.aas.installRoot}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Installations on the Oracle Solaris operating system, Linux operating
system, and Mac OS operating system:</p>
</div>
<div class="paragraph">
<p>user&#8217;s-home-directory<code>/glassfish7/glassfish</code></p>
</div>
<div class="paragraph">
<p>Installations on the Windows operating system:</p>
</div>
<div class="paragraph">
<p>SystemDrive<code>:\glassfish7\glassfish</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install-parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the parent of the base installation directory for Eclipse GlassFish.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Installations on the Oracle Solaris operating system, Linux operating
system, and Mac operating system:</p>
</div>
<div class="paragraph">
<p>user&#8217;s-home-directory<code>/glassfish7</code></p>
</div>
<div class="paragraph">
<p>Installations on the Windows operating system:</p>
</div>
<div class="paragraph">
<p>SystemDrive<code>:\glassfish7</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-root-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory in which a domain is created by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">as-install<code>/domains/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Represents the directory in which a domain&#8217;s configuration is stored.</p>
</div>
<div class="paragraph">
<p>In configuration files, domain-dir is represented as follows:</p>
</div>
<div class="paragraph">
<p><code>${com.sun.aas.instanceRoot}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-root-dir<code>/</code>domain-name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the directory for a server instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/</code>instance-name</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="high-availability-in-glassfish-server"><a class="anchor" href="#high-availability-in-glassfish-server"></a>1 High Availability in Eclipse GlassFish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the high availability features in Eclipse GlassFish 7.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#overview-of-high-availability">Overview of High Availability</a></p>
</li>
<li>
<p><a href="#how-glassfish-server-provides-high-availability">How Eclipse GlassFish Provides High Availability</a></p>
</li>
<li>
<p><a href="#recovering-from-failures">Recovering from Failures</a></p>
</li>
<li>
<p><a href="#more-information">More Information</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="overview-of-high-availability"><a class="anchor" href="#overview-of-high-availability"></a>Overview of High Availability</h3>
<div class="paragraph">
<p>High availability applications and services provide their functionality
continuously, regardless of hardware and software failures. To make such
reliability possible, Eclipse GlassFish provides mechanisms for
maintaining application state data between clustered Eclipse GlassFish
instances. Application state data, such as HTTP session data, stateful
EJB sessions, and dynamic cache information, is replicated in real time
across server instances. If any one server instance goes down, the
session state is available to the next failover server, resulting in
minimum application downtime and enhanced transactional security.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish provides the following high availability features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#load-balancing-with-the-apache-mod_jk-or-mod_proxy_ajp-module">Load Balancing With the Apache <code>mod_jk</code> or <code>mod_proxy_ajp</code> Module</a></p>
</li>
<li>
<p><a href="#high-availability-session-persistence">High Availability Session Persistence</a></p>
</li>
<li>
<p><a href="#high-availability-java-message-service">High Availability Java Message Service</a></p>
</li>
<li>
<p><a href="#overview-rmiiop-lb-failover">RMI-IIOP Load Balancing and Failover</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="load-balancing-with-the-apache-mod_jk-or-mod_proxy_ajp-module"><a class="anchor" href="#load-balancing-with-the-apache-mod_jk-or-mod_proxy_ajp-module"></a>Load Balancing With the Apache <code>mod_jk</code> or <code>mod_proxy_ajp</code> Module</h4>
<div class="paragraph">
<p>A common load balancing configuration for Eclipse GlassFish 7 is to use
the Apache HTTP Server as the web server front-end, and the Apache
<code>mod_jk</code> or <code>mod_proxy_ajp</code> module as the connector between the web
server and Eclipse GlassFish. See
<a href="#configuring-glassfish-server-with-apache-http-server-and-mod_jk">Configuring Eclipse GlassFish with
Apache HTTP Server and <code>mod_jk</code></a> and
<a href="#configuring-glassfish-server-with-apache-http-server-and-mod_proxy_ajp">Configuring Eclipse GlassFish with
Apache HTTP Server and <code>mod_proxy_ajp</code></a> for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="high-availability-session-persistence"><a class="anchor" href="#high-availability-session-persistence"></a>High Availability Session Persistence</h4>
<div class="paragraph">
<p>Eclipse GlassFish provides high availability of HTTP requests and session
data (both HTTP session data and stateful session bean data).</p>
</div>
<div class="paragraph">
<p>Jakarta EE applications typically have significant amounts of session state
data. A web shopping cart is the classic example of a session state.
Also, an application can cache frequently-needed data in the session
object. In fact, almost all applications with significant user
interactions need to maintain session state. Both HTTP sessions and
stateful session beans (SFSBs) have session state data.</p>
</div>
<div class="paragraph">
<p>Preserving session state across server failures can be important to end
users. If the Eclipse GlassFish instance hosting the user session
experiences a failure, the session state can be recovered, and the
session can continue without loss of information. High availability is
implemented in Eclipse GlassFish by means of in-memory session
replication on Eclipse GlassFish instances running in a cluster.</p>
</div>
<div class="paragraph">
<p>For more information about in-memory session replication in Eclipse GlassFish, see <a href="#how-glassfish-server-provides-high-availability">How Eclipse GlassFish Provides High
Availability</a>. For detailed instructions on configuring high
availability session persistence, see
<a href="#configuring-high-availability-session-persistence-and-failover">Configuring High
Availability Session Persistence and Failover</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="high-availability-java-message-service"><a class="anchor" href="#high-availability-java-message-service"></a>High Availability Java Message Service</h4>
<div class="paragraph">
<p>Eclipse GlassFish supports the Java Message Service (JMS) API and JMS
messaging through its built-in jmsra resource adapter communicating with
Open Message Queue as the JMS provider. This combination is often called
the JMS Service.</p>
</div>
<div class="paragraph">
<p>The JMS service makes JMS messaging highly available as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Message Queue Broker Clusters</dt>
<dd>
<p>By default, when a GlassFish cluster is created, the JMS service
automatically configures a Message Queue broker cluster to provide JMS
messaging services, with one clustered broker assigned to each cluster
instance. This automatically created broker cluster is configurable to
take advantage of the two types of broker clusters, conventional and
enhanced, supported by Message Queue.<br>
Additionally, Message Queue broker clusters created and managed using
Message Queue itself can be used as external, or remote, JMS hosts.
Using external broker clusters provides additional deployment options,
such as deploying Message Queue brokers on different hosts from the
GlassFish instances they service, or deploying different numbers of
Message Queue brokers and GlassFish instances.<br>
For more information about Message Queue clustering, see
<a href="#using-message-queue-broker-clusters-with-glassfish-server">Using Message Queue Broker Clusters With Eclipse GlassFish</a>.</p>
</dd>
<dt class="hdlist1">Connection Failover</dt>
<dd>
<p>The use of Message Queue broker clusters allows connection failover in
the event of a broker failure. If the primary JMS host (Message Queue
broker) in use by a GlassFish instance fails, connections to the
failed JMS host will automatically fail over to another host in the
JMS host list, allowing messaging operations to continue and
maintaining JMS messaging semantics.<br>
For more information about JMS connection failover, see
<a href="#connection-failover">Connection Failover</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="overview-rmiiop-lb-failover"><a class="anchor" href="#overview-rmiiop-lb-failover"></a>RMI-IIOP Load Balancing and Failover</h4>
<div class="paragraph">
<p>With RMI-IIOP load balancing, IIOP client requests are distributed to
different server instances or name servers, which spreads the load
evenly across the cluster, providing scalability. IIOP load balancing
combined with EJB clustering and availability also provides EJB
failover.</p>
</div>
<div class="paragraph">
<p>When a client performs a JNDI lookup for an object, the Naming Service
essentially binds the request to a particular server instance. From then
on, all lookup requests made from that client are sent to the same
server instance, and thus all <code>EJBHome</code> objects will be hosted on the
same target server. Any bean references obtained henceforth are also
created on the same target host. This effectively provides load
balancing, since all clients randomize the list of target servers when
performing JNDI lookups. If the target server instance goes down, the
lookup or EJB method invocation will failover to another server
instance.</p>
</div>
<div class="paragraph">
<p>IIOP Load balancing and failover happens transparently. No special steps
are needed during application deployment. If the Eclipse GlassFish
instance on which the application client is deployed participates in a
cluster, the Eclipse GlassFish finds all currently active IIOP endpoints
in the cluster automatically. However, a client should have at least two
endpoints specified for bootstrapping purposes, in case one of the
endpoints has failed.</p>
</div>
<div class="paragraph">
<p>For more information on RMI-IIOP load balancing and failover, see
<a href="#rmi-iiop-load-balancing-and-failover">RMI-IIOP Load Balancing and Failover</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-glassfish-server-provides-high-availability"><a class="anchor" href="#how-glassfish-server-provides-high-availability"></a>How Eclipse GlassFish Provides High Availability</h3>
<div class="paragraph">
<p>Eclipse GlassFish provides high availability through the following
subcomponents and features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#storage-for-session-state-data">Storage for Session State Data</a></p>
</li>
<li>
<p><a href="#highly-available-clusters">Highly Available Clusters</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="storage-for-session-state-data"><a class="anchor" href="#storage-for-session-state-data"></a>Storage for Session State Data</h4>
<div class="paragraph">
<p>Storing session state data enables the session state to be recovered
after the failover of a server instance in a cluster. Recovering the
session state enables the session to continue without loss of
information. Eclipse GlassFish supports in-memory session replication on
other servers in the cluster for maintaining HTTP session and stateful
session bean data.</p>
</div>
<div class="paragraph">
<p>In-memory session replication is implemented in Eclipse GlassFish 7 as
an OSGi module. Internally, the replication module uses a consistent
hash algorithm to pick a replica server instance within a cluster of
instances. This allows the replication module to easily locate the
replica or replicated data when a container needs to retrieve the data.</p>
</div>
<div class="paragraph">
<p>The use of in-memory replication requires the Group Management Service
(GMS) to be enabled. For more information about GMS, see
<a href="#group-management-service">Group Management Service</a>.</p>
</div>
<div class="paragraph">
<p>If server instances in a cluster are located on different hosts, ensure
that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To ensure that GMS and in-memory replication function correctly, the
hosts must be on the same subnet.</p>
</li>
<li>
<p>To ensure that in-memory replication functions correctly, the system
clocks on all hosts in the cluster must be synchronized as closely as
possible.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="highly-available-clusters"><a class="anchor" href="#highly-available-clusters"></a>Highly Available Clusters</h4>
<div class="paragraph">
<p>A highly available cluster integrates a state replication service with
clusters and load balancer.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When implementing a highly available cluster, use a load balancer that
includes session-based stickiness as part of its load-balancing
algorithm. Otherwise, session data can be misdirected or lost.
An example of a load balancer that includes session-based stickiness is the
Loadbalancer Plug-In available in Eclipse GlassFish.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="clusters-instances-sessions-and-load-balancing"><a class="anchor" href="#clusters-instances-sessions-and-load-balancing"></a>Clusters, Instances, Sessions, and Load Balancing</h5>
<div class="paragraph">
<p>Clusters, server instances, load balancers, and sessions are related as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A server instance is not required to be part of a cluster. However, an
instance that is not part of a cluster cannot take advantage of high
availability through transfer of session state from one instance to
other instances.</p>
</li>
<li>
<p>The server instances within a cluster can be hosted on one or multiple
hosts. You can group server instances across different hosts into a
cluster.</p>
</li>
<li>
<p>A particular load balancer can forward requests to server instances on
multiple clusters. You can use this ability of the load balancer to
perform an online upgrade without loss of service. For more information,
see <a href="#upgrading-in-multiple-clusters">Upgrading in Multiple Clusters</a>.</p>
</li>
<li>
<p>A single cluster can receive requests from multiple load balancers. If
a cluster is served by more than one load balancer, you must configure
the cluster in exactly the same way on each load balancer.</p>
</li>
<li>
<p>Each session is tied to a particular cluster. Therefore, although you
can deploy an application on multiple clusters, session failover will
occur only within a single cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The cluster thus acts as a safe boundary for session failover for the
server instances within the cluster. You can use the load balancer and
upgrade components within the Eclipse GlassFish without loss of service.</p>
</div>
</div>
<div class="sect4">
<h5 id="protocols-for-centralized-cluster-administration"><a class="anchor" href="#protocols-for-centralized-cluster-administration"></a>Protocols for Centralized Cluster Administration</h5>
<div class="paragraph">
<p>Eclipse GlassFish uses the  secure shell (SSH) to ensure that clusters that span
multiple hosts can be administered centrally. To perform administrative
operations on Eclipse GlassFish instances that are remote from the domain
administration server (DAS), the DAS must be able to communicate with
those instances. If an instance is running, the DAS connects to the
running instance directly. For example, when you deploy an application
to an instance, the DAS connects to the instance and deploys the
application to the instance.</p>
</div>
<div class="paragraph">
<p>However, the DAS cannot connect to an instance to perform operations on
an instance that is not running, such as creating or starting the
instance. For these operations, the DAS uses SSH to contact a
remote host and administer instances there. SSH provides
confidentiality and security for data that is exchanged between the DAS
and remote hosts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The use of SSH to enable centralized administration of remote
instances is optional. If the use of SSH is not feasible in your
environment, you can administer remote instances locally.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information, see <a href="#enabling-centralized-administration-of-glassfish-server-instances">Enabling Centralized
Administration of Eclipse GlassFish Instances</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="recovering-from-failures"><a class="anchor" href="#recovering-from-failures"></a>Recovering from Failures</h3>
<div class="paragraph">
<p>You can use various techniques to manually recover individual
subcomponents after hardware failures such as disk crashes.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#recovering-the-domain-administration-server">Recovering the Domain Administration Server</a></p>
</li>
<li>
<p><a href="#recovering-glassfish-server-instances">Recovering Eclipse GlassFish Instances</a></p>
</li>
<li>
<p><a href="#recovering-the-http-load-balancer-and-web-server">Recovering the HTTP Load Balancer and Web Server</a></p>
</li>
<li>
<p><a href="#recovering-message-queue">Recovering Message Queue</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="recovering-the-domain-administration-server"><a class="anchor" href="#recovering-the-domain-administration-server"></a>Recovering the Domain Administration Server</h4>
<div class="paragraph">
<p>Loss of the Domain Administration Server (DAS) affects only
administration. Eclipse GlassFish clusters and standalone instances, and
the applications deployed to them, continue to run as before, even if
the DAS is not reachable</p>
</div>
<div class="paragraph">
<p>Use any of the following methods to recover the DAS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Back up the domain periodically, so you have periodic snapshots. After
a hardware failure, re-create the DAS on a new host, as described in
"<a href="administration-guide.html#re-creating-the-domain-administration-server-das">Re-Creating the Domain Administration Server (DAS)</a>"
in Eclipse GlassFish Administration Guide.</p>
</li>
<li>
<p>Put the domain installation and configuration on a shared and robust
file system (NFS for example). If the primary DAS host fails, a second
host is brought up with the same IP address and will take over with
manual intervention or user supplied automation.</p>
</li>
<li>
<p>Zip the Eclipse GlassFish installation and domain root directory.
Restore it on the new host, assigning it the same network identity.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="recovering-glassfish-server-instances"><a class="anchor" href="#recovering-glassfish-server-instances"></a>Recovering Eclipse GlassFish Instances</h4>
<div class="paragraph">
<p>Eclipse GlassFish provide tools for backing up and restoring Eclipse GlassFish instances. For more information, see <a href="#to-resynchronize-an-instance-and-the-das-offline">To
Resynchronize an Instance and the DAS Offline</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="recovering-the-http-load-balancer-and-web-server"><a class="anchor" href="#recovering-the-http-load-balancer-and-web-server"></a>Recovering the HTTP Load Balancer and Web Server</h4>
<div class="paragraph">
<p>There are no explicit commands to back up only a web server
configuration. Simply zip the web server installation directory. After
failure, unzip the saved backup on a new host with the same network
identity. If the new host has a different IP address, update the DNS
server or the routers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This assumes that the web server is either reinstalled or restored from
an image first.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Load Balancer Plug-In (<code>plugins</code> directory) and configurations are
in the web server installation directory, typically <code>/opt/SUNWwbsvr</code>.
The web-install<code>/</code>web-instance<code>/config</code> directory contains the
<code>loadbalancer.xml</code> file.</p>
</div>
</div>
<div class="sect3">
<h4 id="recovering-message-queue"><a class="anchor" href="#recovering-message-queue"></a>Recovering Message Queue</h4>
<div class="paragraph">
<p>When a Message Queue broker becomes unavailable, the method you use to
restore the broker to operation depends on the nature of the failure
that caused the broker to become unavailable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Power failure or failure other than disk storage</p>
</li>
<li>
<p>Failure of disk storage</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, the urgency of restoring an unavailable broker to
operation depends on the type of the broker:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standalone Broker. When a standalone broker becomes unavailable, both
service availability and data availability are interrupted. Restore the
broker to operation as soon as possible to restore availability.</p>
</li>
<li>
<p>Broker in a Conventional Cluster. When a broker in a conventional
cluster becomes unavailable, service availability continues to be
provided by the other brokers in the cluster. However, data availability
of the persistent data stored by the unavailable broker is interrupted.
Restore the broker to operation to restore availability of its
persistent data.</p>
</li>
<li>
<p>Broker in an Enhanced Cluster. When a broker in an enhanced cluster
becomes unavailable, service availability and data availability continue
to be provided by the other brokers in the cluster. Restore the broker
to operation to return the cluster to its previous capacity.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="recovering-from-power-failure-and-failures-other-than-disk-storage"><a class="anchor" href="#recovering-from-power-failure-and-failures-other-than-disk-storage"></a>Recovering From Power Failure and Failures Other Than Disk Storage</h5>
<div class="paragraph">
<p>When a host is affected by a power failure or failure of a non-disk
component such as memory, processor or network card, restore Message
Queue brokers on the affected host by starting the brokers after the
failure has been remedied.</p>
</div>
<div class="paragraph">
<p>To start brokers serving as Embedded or Local JMS hosts, start the
GlassFish instances the brokers are servicing. To start brokers serving
as Remote JMS hosts, use the <code>imqbrokerd</code> Message Queue utility.</p>
</div>
</div>
<div class="sect4">
<h5 id="recovering-from-failure-of-disk-storage"><a class="anchor" href="#recovering-from-failure-of-disk-storage"></a>Recovering from Failure of Disk Storage</h5>
<div class="paragraph">
<p>Message Queue uses disk storage for software, configuration files and
persistent data stores. In a default GlassFish installation, all three
of these are generally stored on the same disk: the Message Queue
software in as-install-parent<code>/mq</code>, and broker configuration files and
persistent data stores (except for the persistent data stores of
enhanced clusters, which are housed in highly available databases) in
domain-dir<code>/imq</code>. If this disk fails, restoring brokers to operation is
impossible unless you have previously created a backup of these items.
To create such a backup, use a utility such as <code>zip</code>, <code>gzip</code> or <code>tar</code> to
create archives of these directories and all their content. When
creating the backup, you should first quiesce all brokers and physical
destinations, as described in "<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/broker-management.html#GMADG00522">Quiescing a Broker</a>" and
"<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/message-delivery.html#GMADG00533">Pausing and Resuming a Physical Destination</a>" in Open
Message Queue Administration Guide, respectively. Then, after the failed
disk is replaced and put into service, expand the backup archive into
the same location.</p>
</div>
<div class="paragraph">
<p>Restoring the Persistent Data Store From Backup. For many messaging
applications, restoring a persistent data store from backup does not
produce the desired results because the backed up store does not
represent the content of the store when the disk failure occurred. In
some applications, the persistent data changes rapidly enough to make
backups obsolete as soon as they are created. To avoid issues in
restoring a persistent data store, consider using a RAID or SAN data
storage solution that is fault tolerant, especially for data stores in
production environments.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="more-information"><a class="anchor" href="#more-information"></a>More Information</h3>
<div class="paragraph">
<p>For information about planning a high-availability deployment, including
assessing hardware requirements, planning network configuration, and
selecting a topology, see the <a href="deployment-planning-guide.html#GSPLG">Eclipse GlassFish Deployment Planning Guide</a>. This manual also provides a
high-level introduction to concepts such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eclipse GlassFish components such as node agents, domains, and clusters</p>
</li>
<li>
<p>IIOP load balancing in a cluster</p>
</li>
<li>
<p>Message queue failover</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about developing applications that take advantage
of high availability features, see the <a href="application-development-guide.html#GSDVG">Eclipse GlassFish Application Development Guide</a>.</p>
</div>
<div class="paragraph">
<p>For information on how to configure and tune applications and Eclipse GlassFish for best performance with high availability, see the
<a href="performance-tuning-guide.html#GSPTG">Eclipse GlassFish Performance Tuning
Guide</a>, which discusses topics such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tuning persistence frequency and persistence scope</p>
</li>
<li>
<p>Checkpointing stateful session beans</p>
</li>
<li>
<p>Configuring the JDBC connection pool</p>
</li>
<li>
<p>Session size</p>
</li>
<li>
<p>Configuring load balancers for best performance</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-centralized-administration-of-glassfish-server-instances"><a class="anchor" href="#enabling-centralized-administration-of-glassfish-server-instances"></a>2 Enabling Centralized Administration of Eclipse GlassFish Instances</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Eclipse GlassFish uses the secure shell (SSH) to ensure that clusters that span
multiple hosts can be administered centrally. To perform administrative
operations on Eclipse GlassFish instances that are remote from the domain
administration server (DAS), the DAS must be able to communicate with
those instances. If an instance is running, the DAS connects to the
running instance directly. For example, when you deploy an application
to an instance, the DAS connects to the instance and deploys the
application to the instance.</p>
</div>
<div class="paragraph">
<p>However, the DAS cannot connect to an instance to perform operations on
an instance that is not running, such as creating or starting the
instance. For these operations, the DAS uses SSH to contact a
remote host and administer instances there. SSH provides
confidentiality and security for data that is exchanged between the DAS
and remote hosts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The use of SSH to enable centralized administration of remote
instances is optional. If the use of SSH is not feasible in your
environment, you can administer remote instances locally.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#about-centralized-administration-of-glassfish-server-instances">About Centralized Administration of Eclipse GlassFish Instances</a></p>
</li>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
</li>
<li>
<p><a href="#testing-the-ssh-setup-on-a-host">Testing the SSH Setup on a Host</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-user-authentication">Setting Up SSH User Authentication</a></p>
</li>
<li>
<p><a href="#installing-and-removing-glassfish-server-software-on-multiple-hosts">Installing and Removing Eclipse GlassFish Software on Multiple Hosts</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="about-centralized-administration-of-glassfish-server-instances"><a class="anchor" href="#about-centralized-administration-of-glassfish-server-instances"></a>About Centralized Administration of Eclipse GlassFish Instances</h3>
<div class="paragraph">
<p>The use of SSH to enable centralized administration of remote
instances is optional and is required only for specific operations.
Instances local to the DAS can be administered without SSH. If
SSH is not practicable in your environment, you can administer
remote instances locally.</p>
</div>
<div class="sect3">
<h4 id="determining-whether-to-enable-centralized-administration"><a class="anchor" href="#determining-whether-to-enable-centralized-administration"></a>Determining Whether to Enable Centralized Administration</h4>
<div class="paragraph">
<p>Before setting up a Eclipse GlassFish cluster, use the following
considerations to determine whether to enable centralized administration
of remote instances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are planning a large cluster of many instances, consider
enabling centralized administration of instances in the cluster.
Centralized administration of instances simplifies the administration of
the cluster by enabling you to perform all administrative operations on
the cluster and its instances from the DAS.</p>
</li>
<li>
<p>If you are planning a small cluster of few instances, consider whether
enabling centralized administration requires more effort than logging in
to individual hosts to administer remote instances locally.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How you administer instances and the nodes on which they resides varies
depending on whether and how centralized administration is enabled. The
following table provides cross-references to instructions for
administering nodes and instances depending on the protocol that is used
for enabling centralized administration, if any.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 42%;">
<col style="width: 43%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Node Administration Instructions</th>
<th class="tableblock halign-left valign-top">Instance Administration Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#creating-listing-testing-and-deleting-ssh-nodes">Creating, Listing, Testing, and Deleting <code>SSH</code> Nodes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#administering-glassfish-server-instances-centrally">Administering Eclipse GlassFish Instances Centrally</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#creating-listing-and-deleting-config-nodes">Creating, Listing, and Deleting <code>CONFIG</code> Nodes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#administering-glassfish-server-instances-locally">Administering Eclipse GlassFish Instances Locally</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="considerations-for-using-ssh-for-centralized-administration"><a class="anchor" href="#considerations-for-using-ssh-for-centralized-administration"></a>Considerations for Using SSH for Centralized Administration</h4>
<div class="paragraph">
<p>In a typical Eclipse GlassFish deployment, the DAS acts as the SSH
client, and hosts where instances reside act as SSH servers. The SSH
Server Daemon <code>sshd</code> must be running on hosts where instances reside,
but is not required to be running on the DAS host. The DAS uses its own
SSH client for communicating with hosts where instances reside. However,
to generate keys and test SSH setup, a native SSH client must be
installed on the DAS host.</p>
</div>
<div class="paragraph">
<p>The requirements for SSH configuration and user management are different
for each operating system on which Eclipse GlassFish is supported.
Therefore, the use of SSH for centralized administration involves using
SSH tools to configure SSH on the operating system that you are using.</p>
</div>
<div class="paragraph">
<p>On UNIX and Linux systems, SSH is typically installed and preconfigured,
and requires minimal additional setup. On Windows systems, additional
setup is required to install and configure an SSH provider.</p>
</div>
<div class="sect4">
<h5 id="obtaining-ssh-software"><a class="anchor" href="#obtaining-ssh-software"></a>Obtaining SSH Software</h5>
<div class="paragraph">
<p>On UNIX and Linux systems, SSH software is typically installed as part
of the base operating system.</p>
</div>
<div class="paragraph">
<p>However, on Windows systems, you must install one of the following SSH providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.cygwin.com/">Cygwin</a> (<code><a href="http://www.cygwin.com/" class="bare">http://www.cygwin.com/</a></code>) release 1.7.6</p>
</li>
<li>
<p><a href="http://www.mkssoftware.com">MKS Toolkit for Developers</a>
(<code><a href="http://www.mkssoftware.com" class="bare">http://www.mkssoftware.com</a></code>) release 9.2</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="determining-the-ssh-user"><a class="anchor" href="#determining-the-ssh-user"></a>Determining the SSH User</h5>
<div class="paragraph">
<p>Before setting up SSH, decide which SSH user Eclipse GlassFish will use
when connecting to remote hosts. For the following reasons,
administration is simplest if the SSH user is the user that starts the
DAS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For public key authentication, the user that starts the DAS must be
able to read the SSH user&#8217;s private key file.</p>
</li>
<li>
<p>Remote instances are started as the SSH user.</p>
</li>
<li>
<p>By default, the DAS assumes that the SSH user is the user that is
running the DAS.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="requirements-for-the-ssh-users-environment"><a class="anchor" href="#requirements-for-the-ssh-users-environment"></a>Requirements for the SSH User&#8217;s Environment</h5>
<div class="paragraph">
<p>The environment of the SSH user on any remote host to which the user
will connect must meet the requirements that are stated in
"<a href="release-notes.html#paths-and-environment-settings-for-the-jdk-software">Paths and Environment Settings for the JDK Software</a>"
in Eclipse GlassFish Release Notes.</p>
</div>
<div class="paragraph">
<p>The SSH user&#8217;s environment on a host is set by the environment set-up
files that are run when the user uses SSH to run a command on the host.
You must ensure that these files set up the SSH user&#8217;s environment
correctly.</p>
</div>
<div class="paragraph">
<p>The files that are run when the user uses SSH to run a command are
different than the files that are run when the user logs in to a host.
For example, in the bash shell, <code>.profile</code> and <code>.bashrc</code> are run when
the user logs in, but only <code>.bashrc</code> is run when the user runs a
command. Therefore, in the bash shell, you must ensure that <code>.bashrc</code>
contains the required environment settings for the SSH user.</p>
</div>
</div>
<div class="sect4">
<h5 id="file-access-permissions-on-uac-enabled-windows-systems"><a class="anchor" href="#file-access-permissions-on-uac-enabled-windows-systems"></a>File Access Permissions on UAC-Enabled Windows Systems</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="http://technet.microsoft.com/en-us/library/cc709691%28WS.10%29.aspx">User
Account Control (UAC)</a>(<code><a href="http://technet.microsoft.com/en-us/library/cc709691%28WS.10%29.aspx" class="bare">http://technet.microsoft.com/en-us/library/cc709691%28WS.10%29.aspx</a></code>)
feature is available only on some versions of the Windows operating
system, for example, Windows 7, Windows Vista, and Windows 2008.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You might be using a UAC-enabled Windows system and choose to store
files for Eclipse GlassFish instances in a directory other than the SSH
user&#8217;s home directory. In this situation, the SSH user must have native
(that is, nonvirtual) read and write access to the file system where the
instances are to be stored. The OS-level administrator has such access
by default. You can also configure the system to grant such access to
other users. For more information, see the documentation for the Windows
operating system.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-cygwin-ssh-on-windows"><a class="anchor" href="#setting-up-cygwin-ssh-on-windows"></a>Setting Up Cygwin SSH on Windows</h3>
<div class="paragraph">
<p>Set up Cygwin SSH on the DAS host and on all hosts where instances in
your cluster will reside.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-download-and-install-cygwin">To Download and Install Cygwin</a></p>
</li>
<li>
<p><a href="#to-set-the-path-for-windows-and-for-the-cygwin-shell">To Set the Path for Windows and for the Cygwin Shell</a></p>
</li>
<li>
<p><a href="#to-set-the-home-directory-for-the-cygwin-ssh-user">To Set the Home Directory for the Cygwin SSH User</a></p>
</li>
<li>
<p><a href="#to-configure-and-start-the-cygwin-ssh-server-daemon-sshd">To Configure and Start the Cygwin SSH Server Daemon
<code>sshd</code></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-download-and-install-cygwin"><a class="anchor" href="#to-download-and-install-cygwin"></a>To Download and Install Cygwin</h4>
<div class="paragraph">
<p>For centralized Eclipse GlassFish administration, a basic Cygwin
installation that includes the SSH client and the SSH server daemon
<code>sshd</code> is sufficient. The default installation options are sufficient to
create such a basic installation.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as a user with Administrator privileges.</p>
</li>
<li>
<p>Create the folder <code>C:\cygwin</code>.</p>
</li>
<li>
<p>From the <a href="http://www.cygwin.com/">Cygwin home page</a>
(<code><a href="http://www.cygwin.com/" class="bare">http://www.cygwin.com/</a></code>), download and save the <code>setup.exe</code> file to your desktop.</p>
</li>
<li>
<p>Run the <code>setup.exe</code> file.</p>
</li>
<li>
<p>Select the default for the following options:</p>
<div class="ulist">
<ul>
<li>
<p>Install from Internet</p>
</li>
<li>
<p>Install Root Directory: <code>C:\cygwin</code></p>
</li>
<li>
<p>Install for All Users</p>
</li>
</ul>
</div>
</li>
<li>
<p>Specify a folder for the local package directory that is not the
Cygwin root folder, for example, <code>C:\cygwin\packages</code>.</p>
</li>
<li>
<p>Specify the connection method.<br>
For example, if the host is connected to the Internet through a proxy
server, specify the proxy server.</p>
</li>
<li>
<p>Select the mirror site from which to download the software.</p>
</li>
<li>
<p>Select the <code>openssh</code> package for installation.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Under the Net category, search for <code>openssh</code>.</p>
</li>
<li>
<p>Locate the <code>openssh</code> package and click Skip.<br>
The package is selected.</p>
</li>
<li>
<p>Click Next.<br>
Any unsatisfied dependencies are listed.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Leave the Select Required Packages option selected and click Next<br>
The packages are installed.</p>
</li>
<li>
<p>Click Finish.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>For detailed information about installing Cygwin, see
"<a href="http://cygwin.com/cygwin-ug-net/setup-net.html#internet-setup">Internet
Setup</a>" in Cygwin User&#8217;s Guide
(<code><a href="http://cygwin.com/cygwin-ug-net/setup-net.html#internet-setup" class="bare">http://cygwin.com/cygwin-ug-net/setup-net.html#internet-setup</a></code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="to-set-the-path-for-windows-and-for-the-cygwin-shell"><a class="anchor" href="#to-set-the-path-for-windows-and-for-the-cygwin-shell"></a>To Set the Path for Windows and for the Cygwin Shell</h4>
<div class="paragraph">
<p>To enable Eclipse GlassFish tools to find commands for SSH, each user&#8217;s
path for Windows and for the Cygwin shell must contain the following directories:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The Cygwin <code>bin</code> directory, for example <code>C:\cygwin\bin</code></p>
</li>
<li>
<p>The <code>bin</code> directory of the JDK software</p>
</li>
</ul>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as a user with Administrator privileges.
Logging in as a user with Administrator privileges ensures that the
change applies to all users.</p>
</li>
<li>
<p>In the System Information control panel, click Advanced&gt;Environment Variables.</p>
</li>
<li>
<p>Add the following directories to the Path environment variable:</p>
<div class="ulist">
<ul>
<li>
<p>The Cygwin <code>bin</code> directory, for example <code>C:\cygwin\bin</code></p>
</li>
<li>
<p>The <code>bin</code> directory of the JDK software</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="to-set-the-home-directory-for-the-cygwin-ssh-user"><a class="anchor" href="#to-set-the-home-directory-for-the-cygwin-ssh-user"></a>To Set the Home Directory for the Cygwin SSH User</h4>
<div class="paragraph">
<p>The SSH Server Daemon <code>sshd</code> locates a user&#8217;s home directory from the
configuration in the user database, not from environment variables such
as <code>HOME</code>. To ensure that all Eclipse GlassFish commands can run without
errors, each SSH user must be configured to have a home directory.</p>
</div>
<div class="paragraph">
<p>Each user on a Windows host where SSH is set up potentially has two home
directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows home directory. Eclipse GlassFish commands, which are run in a
Windows command window, use the Windows home directory.</p>
</li>
<li>
<p>SSH home directory. SSH commands, which are run in a shell such as
<code>bash</code> or <code>ksh</code>, use the SSH home directory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If these home directories are different, Eclipse GlassFish and SSH each
locate a user&#8217;s <code>.ssh</code> directory in different directories. To simplify
the set up of SSH, configure each user&#8217;s home directory for SSH and
Windows to be the same directory. A disadvantage of this approach is
that the SSH home directory has spaces in its path name. Spaces in path
names are cumbersome in the UNIX environment.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as a user with Administrator privileges.</p>
</li>
<li>
<p>In the <code>c:\cygwin\etc\passwd</code> file, edit the home directory setting
for the SSH user to specify the user&#8217;s home directory for Windows.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="to-configure-and-start-the-cygwin-ssh-server-daemon-sshd"><a class="anchor" href="#to-configure-and-start-the-cygwin-ssh-server-daemon-sshd"></a>To Configure and Start the Cygwin SSH Server Daemon <code>sshd</code></h4>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A user account is created for each user that will log in to the host through SSH.</p>
</li>
<li>
<p>A password is set for each user account.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The SSH server daemon <code>sshd</code> disallows authentication of any user for
whose account a password is not set.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Double-click the Cygwin icon. A Cygwin terminal is started.</p>
</li>
<li>
<p>If necessary, set the password for your user account.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <code>passwd</code> command as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ passwd user-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">user-name</dt>
<dd>
<p>The user name for your account.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Type a password. The password for your Windows account is also set.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Configure SSH on the host.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <code>ssh-host-config</code> command.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ ssh-host-config</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using Windows XP, specify the <code>-y</code> option of
<code>ssh-host-config</code> to answer <code>yes</code> to all prompts. If you run
<code>ssh-host-config</code> with the <code>-y</code> option, omit Step <a href="#gkuat">b</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><a id="gkuat"></a>
Ensure that the <code>StrictModes</code> and <code>PubkeyAuthentication</code> options are set
to <code>yes</code> in the file <code>/etc/ssh_config</code>.<br>
The file <code>/etc/ssh_config</code> can also be accessed as <code>/cygdrive/c/cygwin/etc/sshd_config</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Start the SSH server daemon <code>sshd</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ net start sshd</code></pre>
</div>
</div>
</li>
<li>
<p>Confirm that the SSH server daemon <code>sshd</code> is running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ cygrunsrv --query sshd
 Service             : sshd
 Display name        : CYGWIN sshd
 Current State       : Running
 Controls Accepted   : Stop
 Command             : /usr/sbin/sshd -D</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="GSHAG323" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After you have completed the setup of SSH on a host, test the setup on
the host as explained in <a href="#testing-the-ssh-setup-on-a-host">Testing the SSH Setup on a Host</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-the-mks-toolkit-on-windows"><a class="anchor" href="#setting-up-the-mks-toolkit-on-windows"></a>Setting Up the MKS Toolkit on Windows</h3>
<div class="paragraph">
<p>Set up the MKS Toolkit on the DAS host and on all hosts where instances
in your cluster will reside.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-install-the-mks-toolkit">To Install the MKS Toolkit</a></p>
</li>
<li>
<p><a href="#to-set-the-path-for-windows-and-for-the-mks-toolkit-shell">To Set the Path for Windows and for the MKS Toolkit Shell</a></p>
</li>
<li>
<p><a href="#to-set-the-home-directory-for-the-mks-toolkit-ssh-user">To Set the Home Directory for the MKS Toolkit SSH User</a></p>
</li>
<li>
<p><a href="#to-configure-and-start-the-mks-toolkit-ssh-server-daemon-sshd">To Configure and Start the MKS Toolkit SSH Server Daemon
<code>sshd</code></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-install-the-mks-toolkit"><a class="anchor" href="#to-install-the-mks-toolkit"></a>To Install the MKS Toolkit</h4>
<div class="paragraph">
<p>For centralized Eclipse GlassFish administration, the default
installation of the MKS Toolkit is sufficient.</p>
</div>
<div class="paragraph">
<p>Follow the instructions in the MKS Toolkit product documentation to
install OpenSSH from the MKS Toolkit with default installation options.</p>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>For detailed information about installing MKS Toolkit, see
"<a href="http://www.mkssoftware.com/docs/rn/relnotes_tk94.asp#install">Installing
MKS Toolkit</a>" in MKS Toolkit v9.4 Release Notes
(<code><a href="http://www.mkssoftware.com/docs/rn/relnotes_tk94.asp#install" class="bare">http://www.mkssoftware.com/docs/rn/relnotes_tk94.asp#install</a></code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="to-set-the-path-for-windows-and-for-the-mks-toolkit-shell"><a class="anchor" href="#to-set-the-path-for-windows-and-for-the-mks-toolkit-shell"></a>To Set the Path for Windows and for the MKS Toolkit Shell</h4>
<div class="paragraph">
<p>To enable Eclipse GlassFish tools to find commands for SSH, each user&#8217;s
path for Windows and for the MKS Toolkit shell must contain the
following directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The MKS Toolkit <code>bin</code> directory, for example
<code>C:\Program Files\MKS Toolkit\mksnt</code></p>
</li>
<li>
<p>The <code>bin</code> directory of the JDK software</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The MKS Toolkit installer automatically adds the MKS Toolkit <code>bin</code>
directory to the path. However, you must add the <code>bin</code> directory of the
JDK software to the path yourself.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as a user with Administrator privileges.</p>
<div class="paragraph">
<p>Logging in as a user with Administrator privileges ensures that the
change applies to all users.</p>
</div>
</li>
<li>
<p>In the System Information control panel, click Advanced&gt;Environment
Variables.</p>
</li>
<li>
<p>Add the <code>bin</code> directory of the JDK software to the Path environment
variable.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="to-set-the-home-directory-for-the-mks-toolkit-ssh-user"><a class="anchor" href="#to-set-the-home-directory-for-the-mks-toolkit-ssh-user"></a>To Set the Home Directory for the MKS Toolkit SSH User</h4>
<div class="paragraph">
<p>The SSH Server Daemon <code>sshd</code> locates a user&#8217;s home directory from the
configuration in the user database, not from environment variables such
as <code>HOME</code>. To ensure that all Eclipse GlassFish commands can run without
errors, each SSH user must be configured to have a home directory.</p>
</div>
<div class="paragraph">
<p>Each user on a Windows host where SSH is set up potentially has two home
directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows home directory. Eclipse GlassFish commands, which are run in a
Windows command window, use the Windows home directory.</p>
</li>
<li>
<p>SSH home directory. SSH commands, which are run in a shell such as
<code>bash</code> or <code>ksh</code>, use the SSH home directory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If these home directories are different, Eclipse GlassFish and SSH each
locate a user&#8217;s <code>.ssh</code> directory in different directories. To simplify
the set up of SSH, configure each user&#8217;s home directory for SSH and
Windows to be the same directory. A disadvantage of this approach is
that the SSH home directory has spaces in its path name. Spaces in path
names are cumbersome in the UNIX environment.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="gkslo"></a>
Compare the pairs of settings for Windows and the MKS Toolkit that are
listed in the following table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Windows Environment Variable</th>
<th class="tableblock halign-left valign-top">MKS Toolkit Field</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HOMEPATH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home Directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HOMEDRIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home Directory Drive</p></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a Windows command window, determine the values of the <code>HOMEPATH</code>
and <code>HOMEDRIVE</code> environment variables.</p>
</li>
<li>
<p>In an MKS Toolkit shell, determine the current settings of the Home
Directory and Home Directory Drive fields for the user.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ userinfo user-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">user-name</dt>
<dd>
<p>The user name for the user whose home directory you are setting, for
example <code>Administrator</code>.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If the settings do not match, update setting of each MKS Toolkit
field to match its corresponding Windows environment variable.<br>
If the settings match, no further action is required.<br>
To update the settings, run the following command in an MKS Toolkit shell:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ userinfo -u -fHomeDirDrive:&quot;drive&quot; -fHomeDir:&quot;path&quot; user-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">drive</dt>
<dd>
<p>The drive identifier of the disk drive on which the user&#8217;s Windows
home directory resides, for example, <code>C:</code>.</p>
</dd>
<dt class="hdlist1">path</dt>
<dd>
<p>The path to the user&#8217;s Windows home directory, for example,
<code>\Documents and Settings\Administrator</code>.</p>
</dd>
<dt class="hdlist1">user-name</dt>
<dd>
<p>The user name for the user whose home directory you are setting, for
example <code>Administrator</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not set the <code>HOME</code> environment variable explicitly. If Home Directory
and Home Directory Drive are set correctly, the <code>HOME</code> environment
variable specifies the correct path by default.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>In an MKS Toolkit shell, confirm that the settings were updated.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ userinfo user-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">user-name</dt>
<dd>
<p>The user name for the user whose home directory you are setting, for
example <code>Administrator</code>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Log out of the host and log in to the host again.</p>
</li>
<li>
<p>Confirm that the home directories are the same as explained in
Step <a href="#gkslo">1</a>.</p>
</li>
</ol>
</div>
<div id="ssh-example-2-1" class="paragraph">
<p>Example 2-1 Setting the Home Directory for the MKS Toolkit User</p>
</div>
<div class="paragraph">
<p>This example sets the home directory for the MKS Toolkit user
<code>Administrator</code> to <code>C:\Documents and Settings\Administrator</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ userinfo -u -fHomeDirDrive:&quot;C:&quot;
-fHomeDir:&quot;\Documents and Settings\Administrator&quot; Administrator</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="to-configure-and-start-the-mks-toolkit-ssh-server-daemon-sshd"><a class="anchor" href="#to-configure-and-start-the-mks-toolkit-ssh-server-daemon-sshd"></a>To Configure and Start the MKS Toolkit SSH Server Daemon <code>sshd</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not set the command shell to <code>cmd.exe</code>. The use of SSH for
centralized Eclipse GlassFish administration requires a shell in the
style of a UNIX shell.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the Programs menu, choose MKS Toolkit&gt;Configuration&gt;Configuration Information.</p>
</li>
<li>
<p>Enable password authentication and strict modes.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the Secure Shell Service tab.</p>
</li>
<li>
<p>Select the Password Authentication option.</p>
</li>
<li>
<p>Click Advanced settings.</p>
</li>
<li>
<p>Click the Login tab.</p>
</li>
<li>
<p>Deselect the Strict Modes option.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If you are using SSH key-file authentication, enable <code>MKSAUTH</code> password authentication.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the Authentication tab.</p>
</li>
<li>
<p>Under Enable/Disable Password using MKSAUTH, type the user&#8217;s password and click the Enable.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Start the SSH server daemon <code>sshd</code>.</p>
</li>
<li>
<p>Confirm that the SSH server daemon <code>sshd</code> is running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ service query MKSSecureSH
Name:           MKS Secure Shell Service
Service Type:   WIN32_OWN_PROCESS
Current State:  RUNNING
Controls Accepted:      ACCEPT_STOP
Check Point:    0
Wait Hint:      0
Start Type:     AUTO_START
Error Control:  IGNORE
Path:           &quot;C:\Program Files\MKS Toolkit\bin\secshd.exe&quot;
Dependency:     NuTCRACKERService
Dependency:     tcpip
Service Start Name:     LocalSystem</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="GSHAG325" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After you have completed the setup of SSH on a host, test the setup on
the host as explained in <a href="#testing-the-ssh-setup-on-a-host">Testing the SSH Setup on a Host</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-ssh-on-unix-and-linux-systems"><a class="anchor" href="#setting-up-ssh-on-unix-and-linux-systems"></a>Setting Up SSH on UNIX and Linux Systems</h3>
<div class="paragraph">
<p>Setting up SSH on UNIX and Linux systems involves verifying that the SSH
server daemon <code>sshd</code> is running and, if necessary, starting this daemon.
Set up SSH on the DAS host and on all hosts where instances in your
cluster will reside.</p>
</div>
<div class="paragraph">
<p>On UNIX and Linux systems, SSH software is typically installed as part
of the base operating system. If SSH is not installed, download and
install the appropriate <a href="http://www.openssh.com/">OpenSSH</a>
(<code><a href="http://www.openssh.com/" class="bare">http://www.openssh.com/</a></code>) SSH package for your operating system.</p>
</div>
<div class="paragraph">
<p>How to set up SSH on UNIX and Linux systems depends on the flavor of the
operating system that you are running, as explained in the following
sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-set-up-ssh-on-macos-systems">To Set Up SSH on MacOS Systems</a></p>
</li>
<li>
<p><a href="#to-set-up-ssh-on-linux-systems">To Set Up SSH on Linux systems</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-set-up-ssh-on-macos-systems"><a class="anchor" href="#to-set-up-ssh-on-macos-systems"></a>To Set Up SSH on MacOS Systems</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open System Preferences and click Sharing.<br>
The Sharing window opens.</p>
</li>
<li>
<p>Ensure that Remote Login is selected in the Service list.</p>
</li>
<li>
<p>Ensure that either of the following is allowed access:</p>
<div class="ulist">
<ul>
<li>
<p>All Users</p>
</li>
<li>
<p>The user that running the DAS or instance</p>
</li>
</ul>
</div>
</li>
<li>
<p>(MacOS 10.6 systems only) Ensure that the SSH server daemon <code>sshd</code>
allows password authentication.<br>
On MacOS 10.5 systems, the SSH server daemon <code>sshd</code> allows password
authentication by default. However, on MacOS 10.6 systems, the SSH
server daemon <code>sshd</code> disallows password authentication by default.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit the configuration file <code>/etc/sshd_config</code> to set the <code>PasswordAuthentication</code> option to <code>yes</code>.</p>
</li>
<li>
<p>Stop the SSH server daemon <code>sshd</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ sudo launchctl stop com.openssh.sshd</code></pre>
</div>
</div>
</li>
<li>
<p>Start the SSH server daemon <code>sshd</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ sudo launchctl start com.openssh.sshd</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div id="GSHAG328" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After you have completed the setup of SSH on a host, test the setup on
the host as explained in <a href="#testing-the-ssh-setup-on-a-host">Testing the SSH Setup on a Host</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-set-up-ssh-on-linux-systems"><a class="anchor" href="#to-set-up-ssh-on-linux-systems"></a>To Set Up SSH on Linux systems</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the following options in the configuration file
<code>/etc/ssh/sshd_config</code> are set to <code>yes</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>StrictModes</code></p>
</li>
<li>
<p><code>PubkeyAuthentication</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Determine if the SSH server daemon <code>sshd</code> is running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ /sbin/service sshd status</code></pre>
</div>
</div>
</li>
<li>
<p>If the SSH server daemon <code>sshd</code> is not running, start this daemon.</p>
<div class="paragraph">
<p>If the daemon is running, no further action is required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ /sbin/service sshd start</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="ssh-example-2-2" class="paragraph">
<p>Example 2-2 Determining if the <code>sshd</code> Daemon Is Running on a Linux System</p>
</div>
<div class="paragraph">
<p>This example confirms that the SSH server daemon <code>sshd</code> is running on a
Linux system.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ /sbin/service sshd status
openssh-daemon (pid  2373) is running...</code></pre>
</div>
</div>
<div id="GSHAG329" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After you have completed the setup of SSH on a host, test the setup on
the host as explained in <a href="#testing-the-ssh-setup-on-a-host">Testing the SSH Setup on a Host</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="testing-the-ssh-setup-on-a-host"><a class="anchor" href="#testing-the-ssh-setup-on-a-host"></a>Testing the SSH Setup on a Host</h3>
<div class="paragraph">
<p>After setting up SSH on a host, test the setup to ensure that you can
use SSH to contact the host from another host. Testing the SSH setup on
a host verifies that the SSH server daemon <code>sshd</code> is running and that
the SSH user has a valid user account on the host.</p>
</div>
<div class="paragraph">
<p>If you cannot use SSH to contact the host, troubleshoot the SSH setup
before setting up SSH user authentication.</p>
</div>
<div class="sect3">
<h4 id="to-test-the-ssh-setup-on-a-host"><a class="anchor" href="#to-test-the-ssh-setup-on-a-host"></a>To Test the SSH Setup on a Host</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From another host, use SSH to log in into the host that you are
testing as the SSH user.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ ssh -l user-name host-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">user-name</dt>
<dd>
<p>The user name for the SSH user&#8217;s account on the host.</p>
</dd>
<dt class="hdlist1">host-name</dt>
<dd>
<p>The host name of the host that you are logging in to.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>In response to the prompt, type your password.</p>
<div class="paragraph">
<p>If this step succeeds, your setup of SSH is complete.</p>
</div>
<div class="paragraph">
<p>The first time that you connect to a host, you might be warned that the
authenticity cannot be established and be asked if you want to continue
connection. If you trust the host, answer <code>yes</code> to connect to the host.</p>
</div>
</li>
</ol>
</div>
<div id="GSHAG330" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>To obtain diagnostic information, use the <code>-v</code> option of the
command-line SSH client and the <code>-d</code> option of the SSH server daemon
<code>sshd</code>. How to start the SSH server daemon <code>sshd</code> manually depends on
the operating system and SSH provider that you are using.</p>
</div>
<div class="paragraph">
<p>If the SSH server daemon <code>sshd</code> is set up on a host that has a firewall,
ensure that a rule is defined to allow inbound traffic on the SSH port.
The default SSH port is port 22.</p>
</div>
<div class="paragraph">
<p>If your connection is refused, the SSH server daemon <code>sshd</code> is not
running and you must start the daemon. For instructions, see the
following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-configure-and-start-the-cygwin-ssh-server-daemon-sshd">To Configure and Start the Cygwin SSH Server Daemon <code>sshd</code></a></p>
</li>
<li>
<p><a href="#to-configure-and-start-the-mks-toolkit-ssh-server-daemon-sshd">To Configure and Start the MKS Toolkit SSH Server Daemon <code>sshd</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your connection is accepted, but you cannot log in, ensure that the
SSH user has a valid user account on the host.</p>
</div>
<div id="GSHAG331" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After testing the SSH setup, set up SSH user authentication to enable
SSH to authenticate users without prompting for a password. For more
information, see <a href="#setting-up-ssh-user-authentication">Setting Up SSH User Authentication</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-ssh-user-authentication"><a class="anchor" href="#setting-up-ssh-user-authentication"></a>Setting Up SSH User Authentication</h3>
<div class="paragraph">
<p>When a Eclipse GlassFish subcommand uses SSH to log in to a remote host,
Eclipse GlassFish must be able to authenticate the SSH user. Setting up
SSH user authentication ensures that this requirement is met.</p>
</div>
<div class="paragraph">
<p>Before setting up SSH user authentication, determine the authentication
scheme to use. If SSH is already deployed at your site, the
authentication scheme to use might already be chosen for you.</p>
</div>
<div class="paragraph">
<p>The following table lists the authentication schemes that Eclipse GlassFish supports. The table also lists the advantages and disadvantages
of each authentication scheme.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Authentication Scheme</th>
<th class="tableblock halign-left valign-top">Advantages</th>
<th class="tableblock halign-left valign-top">Disadvantages</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public key without encryption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eclipse GlassFish provides tools to
simplify set up.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH must be configured to locate users' key files in
the correct location. File access permissions for key files and the
directory that contains the key files must be set correctly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public key with passphrase-protected encryption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This scheme is more
secure than public key authentication without encryption.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH must be
configured to locate users' key files in the correct location. File
access permissions for key files and the directory that contains the key
files must be set correctly. For each SSH user, Eclipse GlassFish
password aliases are required for the encryption passphrase.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No SSH configuration is required to locate key files or to
ensure that file access permissions are correct.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For each SSH user,
Eclipse GlassFish password aliases are required for the SSH password.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-set-up-public-key-authentication-without-encryption">To Set Up Public Key Authentication Without Encryption</a></p>
</li>
<li>
<p><a href="#to-set-up-encrypted-public-key-authentication">To Set Up Encrypted Public Key Authentication</a></p>
</li>
<li>
<p><a href="#to-set-up-password-authentication">To Set Up Password Authentication</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-set-up-public-key-authentication-without-encryption"><a class="anchor" href="#to-set-up-public-key-authentication-without-encryption"></a>To Set Up Public Key Authentication Without Encryption</h4>
<div class="paragraph">
<p>Use the <code>setup-ssh</code> subcommand in local mode to set up public key
authentication without encryption. This subcommand enables you to set up
public key authentication on multiple hosts in a single operation.</p>
</div>
<div class="paragraph">
<p>The <code>setup-ssh</code> subcommand generates a key pair and distributes the
public key file to specified hosts. The private key file and the public
key file are protected only by the file system&#8217;s file access
permissions. If you require additional security, set up public key
authentication with passphrase-protected encryption as explained in
<a href="#to-set-up-encrypted-public-key-authentication">To Set Up Encrypted Public Key Authentication</a>.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SSH is set up on each host where you are setting up public key
authentication. For more information, see the following sections:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Only the SSH user has write access to the following files and
directories on each host where you are setting up public key
authentication:</p>
<div class="ulist">
<ul>
<li>
<p>The SSH user&#8217;s home directory</p>
</li>
<li>
<p>The <code>~/.ssh</code> directory</p>
</li>
<li>
<p>The <code>authorized_key</code> file</p>
<div class="paragraph">
<p>If other users can write to these files and directories, the secure
service might not trust the <code>authorized_key</code> file and might disallow
public key authentication.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate an SSH key pair and distribute the public key file to the
hosts where you are setting up public key authentication.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for setting up an SSH
key, see the <a href="reference-manual.html#setup-ssh"><code>setup-ssh</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; setup-ssh [--sshuser sshuser] host-list</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">sshuser</dt>
<dd>
<p>The SSH user for which you are generating the SSH key pair. If you are
running the subcommand as the SSH user, you may omit this option.</p>
</dd>
<dt class="hdlist1">host-list</dt>
<dd>
<p>A space-separated list of the names of the hosts where the SSH public
key is to be distributed.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>After generating the SSH key pair, the subcommand uses SSH to log in to
each host in host-list as the SSH user to distribute the public key.
Each time a password is required to log in to a host, you are prompted
for the SSH user&#8217;s password.</p>
<div class="paragraph">
<p>In response to each prompt for a password, type the SSH user&#8217;s password.</p>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="ssh-example-2-3" class="paragraph">
<p>Example 2-3 Setting Up Public Key Authentication Without Encryption</p>
</div>
<div class="paragraph">
<p>This example generates and sets up an SSH key for the user <code>gfuser</code> on
the hosts <code>sua01</code> and <code>sua02</code>. The command is run by the user <code>gfuser</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; setup-ssh --generatekey=true sua01 sua02
Enter SSH password for gfuser@sua01&gt;
Created directory /home/gfuser/.ssh
/usr/bin/ssh-keygen successfully generated the identification /home/gfuser/.ssh/id_rsa
Copied keyfile /home/gfuser/.ssh/id_rsa.pub to gfuser@sua01
Successfully connected to gfuser@sua01 using keyfile /home/gfuser/.ssh/id_rsa
Copied keyfile /home/gfuser/.ssh/id_rsa.pub to gfuser@sua02
Successfully connected to gfuser@sua02 using keyfile /home/gfuser/.ssh/id_rsa
Command setup-ssh executed successfully.</code></pre>
</div>
</div>
<div id="GSHAG333" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After setting up public key authentication, test the setup by using
<code>ssh</code> to log in as the SSH user to each host where the public key was
distributed. For each host, log in first with the unqualified host name
and then with the fully qualified name. If SSH does not prompt for
password, public key authentication is set up correctly on the host.</p>
</div>
<div class="paragraph">
<p>If you are prompted for a password, verify that the public key file was
copied correctly to the SSH user&#8217;s <code>authorized_keys</code> file.</p>
</div>
<div id="GSHAG334" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>Setup might fail because file access permissions in the SSH user&#8217;s home
directory are too permissive. In this situation, ensure that the file
access permissions in the SSH user&#8217;s home directory meet the
requirements for performing this procedure.</p>
</div>
<div class="paragraph">
<p>If you have set the file access permissions in the SSH user&#8217;s home
directory correctly, setup might still fail if you are using the MKS
Toolkit. In this situation, correct the problem in one of the following
ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On each remote host, copy the public key file to the SSH user&#8217;s
<code>~/.ssh</code> directory and import the file. To import the file, select the
Secure Service tab in the MKS configuration GUI and click Passwordless.</p>
</li>
<li>
<p>Disable strict modes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
</li>
<li>
<p><a href="reference-manual.html#setup-ssh"><code>setup-ssh</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help setup-ssh</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-set-up-encrypted-public-key-authentication"><a class="anchor" href="#to-set-up-encrypted-public-key-authentication"></a>To Set Up Encrypted Public Key Authentication</h4>
<div class="paragraph">
<p>Encrypted key file authentication uses an encrypted private key file
that is protected with a passphrase. This passphrase must be provided to
use the private key to unlock the public key. If you require encrypted
public key authentication, you must use the SSH utility <code>ssh-keygen</code> to
generate an SSH key pair with an encrypted private key. You can then use
the <code>setup-ssh</code> subcommand to distribute the public key file to
specified hosts.</p>
</div>
<div class="paragraph">
<p>To use the encrypted key file, Eclipse GlassFish requires the passphrase
with which the key file was encrypted. To provide this passphrase
securely to Eclipse GlassFish, create a Eclipse GlassFish password alias
to represent the passphrase and store this alias in a password file that
is passed to the <a href="reference-manual.html#asadmin"><code>asadmin</code></a> utility.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
each step. For information about all the options for the commands and
subcommands in this task, see their help pages or man pages.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SSH is set up on each host where you are setting up public key
authentication. For more information, see the following sections:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Only the SSH user has write access to the following files and
directories on each host where you are setting up public key
authentication:</p>
<div class="ulist">
<ul>
<li>
<p>The SSH user&#8217;s home directory</p>
</li>
<li>
<p>The <code>~/.ssh</code> directory</p>
</li>
<li>
<p>The <code>authorized_key</code> file</p>
<div class="paragraph">
<p>If other users can write to these files and directories, the secure
service might not trust the <code>authorized_key</code> file and might disallow
public key authentication.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate an SSH key pair with an encrypted private key file.</p>
<div class="paragraph">
<p>Use the SSH utility
<a href="https://www.oracle.com/pls/topic/lookup?ctx=E18752&amp;id=REFMAN1ssh-keygen-1"><code>ssh-keygen</code></a>
for this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ ssh-keygen -t type</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">type</dt>
<dd>
<p>The algorithm that is to be used for the key and which must be <code>rsa</code>,
<code>dsa</code>, or <code>rsa1</code>.</p>
<div class="paragraph">
<p>The <code>ssh-keygen</code> utility prompts you for a file in which to save the key.</p>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>To simplify the distribution of the key file, accept the default file.</p>
<div class="paragraph">
<p>The <code>ssh-keygen</code> utility prompts you for a passphrase.</p>
</div>
</li>
<li>
<p><a id="gktbh"></a>
In response to the prompt, type your choice of passphrase for encrypting
the private key file.</p>
</li>
<li>
<p>The <code>ssh-keygen</code> utility prompts you to type the passphrase again.</p>
<div class="paragraph">
<p>In response to the prompt, type the passphrase that you set in Step <a href="#gktbh">3</a>.</p>
</div>
</li>
<li>
<p>Distribute the public key file to the hosts where you are setting up
public key authentication.</p>
<div class="paragraph">
<p>Use the <a href="reference-manual.html#setup-ssh"><code>setup-ssh</code></a>
<code>asadmin</code> subcommand for this purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin setup-ssh --generatekey=false host-list</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">host-list</dt>
<dd>
<p>A space-separated list of the names of the hosts where the SSH public
key is to be distributed.</p>
<div class="paragraph">
<p>The subcommand uses SSH to log in to each host in host-list as the SSH
user to distribute the public key. Each time a passphrase or a password
is required to log in to a host, you are prompted for the passphrase or
the SSH user&#8217;s password.</p>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>In response to each prompt, type the requested information.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>In response to each prompt for a passphrase, type the passphrase that
you set in Step <a href="#gktbh">3</a>.</p>
</li>
<li>
<p>In response to each prompt for a password, type the SSH user&#8217;s password.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p><a id="gktbm"></a>
Create a Eclipse GlassFish password alias for the passphrase that you set
in Step <a href="#gktbh">3</a>.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.<br>
Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#create-password-alias"><code>create-password-alias</code></a>
<code>asadmin</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin create-password-alias alias-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">alias-name</dt>
<dd>
<p>Your choice of name for the alias that you are creating.</p>
<div class="paragraph">
<p>The <code>create-password-alias</code> subcommand prompts you to type the
passphrase for which you are creating an alias.</p>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>In response to the prompt, type the passphrase that you set in
Step <a href="#gktbh">3</a>.</p>
<div class="paragraph">
<p>The <code>create-password-alias</code> subcommand prompts you to type the passphrase again.</p>
</div>
</li>
<li>
<p>In response to the prompt, type the passphrase that you set in
Step <a href="#gktbh">3</a> again.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a plain text file that contains the following entry for the passphrase alias:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>AS_ADMIN_SSHKEYPASSPHRASE=${ALIAS=alias-name}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">alias-name</dt>
<dd>
<p>The alias name that you specified in Step <a href="#gktbm">7</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you create an <code>SSH</code> node, pass this file as the <code>--passwordfile</code>
option of the <code>asadmin</code> utility. For more information, see
<a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="ssh-example-2-4" class="paragraph">
<p>Example 2-4 Setting Up Encrypted Public Key Authentication</p>
</div>
<div class="paragraph">
<p>This example generates an SSH key pair with an encrypted private key for
the user <code>gfadmin</code> and distributes the public key to the hosts <code>sj01</code>
and <code>ja02</code>. The example also creates an alias that is named
<code>ssh-key-passphrase</code> for the private key&#8217;s passphrase.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/gfadmin/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/gfadmin/.ssh/id_rsa.
Your public key has been saved in /home/gfadmin/.ssh/id_rsa.pub.
The key fingerprint is:
db:b5:f6:0d:fe:16:33:91:20:64:90:1a:84:66:f5:d0 gfadmin@dashost
$ asadmin setup-ssh --generatekey=false sj01 sj02
Key /home/gfadmin/.ssh/id_rsa is encrypted
Enter key passphrase&gt;
Enter SSH password for gfadmin@sj01&gt;
Copied keyfile /home/gfadmin/.ssh/id_rsa.pub to gfadmin@sj01
Successfully connected to gfadmin@sj01 using keyfile /home/gfadmin/.ssh/id_rsa
Successfully connected to gfadmin@sj02 using keyfile /home/gfadmin/.ssh/id_rsa
SSH public key authentication is already configured for gfadmin@sj02
Command setup-ssh executed successfully.
$ asadmin create-password-alias ssh-key-passphrase
Enter the alias password&gt;
Enter the alias password again&gt;
Command create-password-alias executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The entry in the password file for the <code>ssh-key-passphrase</code> alias is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>AS_ADMIN_SSHKEYPASSPHRASE=${ALIAS=ssh-key-passphrase}</code></pre>
</div>
</div>
<div id="GSHAG337" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>Setup might fail because file access permissions in the SSH user&#8217;s home
directory are too permissive. In this situation, ensure that the file
access permissions in the SSH user&#8217;s home directory meet the
requirements for performing this procedure.</p>
</div>
<div class="paragraph">
<p>If you have set the file access permissions in the SSH user&#8217;s home
directory correctly, setup might still fail if you are using the MKS
Toolkit. In this situation, correct the problem in one of the following
ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On each remote host, copy the public key file to the SSH user&#8217;s
<code>~/.ssh</code> directory and import the file. To import the file, select the
Secure Service tab in the MKS configuration GUI and click Passwordless.</p>
</li>
<li>
<p>Disable strict modes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
</li>
<li>
<p><a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a></p>
</li>
<li>
<p><a href="reference-manual.html#create-password-alias"><code>create-password-alias</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#setup-ssh"><code>setup-ssh</code>(1)</a></p>
</li>
<li>
<p><a href="https://www.oracle.com/pls/topic/lookup?ctx=E18752&amp;id=REFMAN1ssh-keygen-1"><code>ssh-keygen</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help create-password-alias</code></p>
</li>
<li>
<p><code>asadmin help setup-ssh</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-set-up-password-authentication"><a class="anchor" href="#to-set-up-password-authentication"></a>To Set Up Password Authentication</h4>
<div class="paragraph">
<p>To use SSH to log in to a remote host, Eclipse GlassFish requires the SSH
user&#8217;s password. To provide this password securely to Eclipse GlassFish,
create a Eclipse GlassFish password alias to represent the password and
store this alias in a password file that is passed to the
<a href="reference-manual.html#asadmin"><code>asadmin</code></a> utility.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that SSH is set up on each host where you are setting up password
authentication. For more information, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.<br>
Remote subcommands require a running server.</p>
</li>
<li>
<p><a id="gktbb"></a>
Create an alias for the SSH user&#8217;s password.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for creating a password
alias, see the <a href="reference-manual.html#create-password-alias"><code>create-password-alias</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-password-alias alias-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">alias-name</dt>
<dd>
<p>Your choice of name for the alias that you are creating.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>The <code>create-password-alias</code> subcommand prompts you to type the password
for which you are creating an alias.<br>
In response to the prompt, type the SSH user&#8217;s password.<br>
The <code>create-password-alias</code> subcommand prompts you to type the password again.</p>
</li>
<li>
<p>In response to the prompt, type the SSH user&#8217;s password again.</p>
</li>
<li>
<p>Create a plain text file that contains the following entry for the password alias:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>AS_ADMIN_SSHPASSWORD=${ALIAS=alias-name}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">alias-name</dt>
<dd>
<p>The alias name that you specified in Step <a href="#gktbb">2</a>.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you create an <code>SSH</code> node, pass this file as the <code>--passwordfile</code>
option of the <code>asadmin</code> utility. For more information, see
<a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ssh-example-2-5" class="paragraph">
<p>Example 2-5 Creating an Alias for the SSH User&#8217;s Password</p>
</div>
<div class="paragraph">
<p>This example creates an alias that is named <code>ssh-password</code> for the SSH user&#8217;s password.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin create-password-alias ssh-password
Enter the alias password&gt;
Enter the alias password again&gt;
Command create-password-alias executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The entry in the password file for the <code>ssh-password</code> alias is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>AS_ADMIN_SSHPASSWORD=${ALIAS=ssh-password}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-cygwin-ssh-on-windows">Setting Up Cygwin SSH on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-the-mks-toolkit-on-windows">Setting Up the MKS Toolkit on Windows</a></p>
</li>
<li>
<p><a href="#setting-up-ssh-on-unix-and-linux-systems">Setting Up SSH on UNIX and Linux Systems</a></p>
</li>
<li>
<p><a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a></p>
</li>
<li>
<p><a href="reference-manual.html#create-password-alias"><code>create-password-alias</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help create-password-alias</code> at the command line.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing-and-removing-glassfish-server-software-on-multiple-hosts"><a class="anchor" href="#installing-and-removing-glassfish-server-software-on-multiple-hosts"></a>Installing and Removing Eclipse GlassFish Software on Multiple Hosts</h3>
<div class="paragraph">
<p>Eclipse GlassFish software must be installed on all hosts where Eclipse GlassFish will run. How to install Eclipse GlassFish software on multiple
hosts depends on the degree of control that you require over the
installation on each host.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you require complete control over the installation on each host,
install the software from a Eclipse GlassFish distribution on each host
individually. For more information, see <a href="installation-guide.html#GSING">Eclipse GlassFish Installation Guide</a>.</p>
</li>
<li>
<p>If the same set up on each host is acceptable, copy an existing
Eclipse GlassFish installation to the hosts. For more information, see
<a href="#to-copy-a-glassfish-server-installation-to-multiple-hosts">To Copy a Eclipse GlassFish Installation to Multiple Hosts</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eclipse GlassFish also enables you to remove Eclipse GlassFish software
from multiple hosts in a single operation. For more information, see
<a href="#to-remove-glassfish-server-software-from-multiple-hosts">To Remove Eclipse GlassFish Software From Multiple Hosts</a>.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-copy-a-glassfish-server-installation-to-multiple-hosts">To Copy a Eclipse GlassFish Installation to Multiple Hosts</a></p>
</li>
<li>
<p><a href="#to-remove-glassfish-server-software-from-multiple-hosts">To Remove Eclipse GlassFish Software From Multiple Hosts</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-copy-a-glassfish-server-installation-to-multiple-hosts"><a class="anchor" href="#to-copy-a-glassfish-server-installation-to-multiple-hosts"></a>To Copy a Eclipse GlassFish Installation to Multiple Hosts</h4>
<div class="paragraph">
<p>Use the <code>install-node-ssh</code> subcommand in local mode to copy an installation of Eclipse GlassFish
software to multiple hosts.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that SSH is set up on the host where you are running the
subcommand and on each host where you are copying the Eclipse GlassFish
software.</p>
</div>
<div class="paragraph">
<p>Run the appropriate subcommand for the protocol that is set up for
communication between the hosts.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If SSH is set up for communication between the hosts, run the
<code>install-node-ssh</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for copying an
installation of Eclipse GlassFish software, see the
<a href="reference-manual.html#install-node-ssh"><code>install-node-ssh</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; install-node-ssh host-list</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">host-list</dt>
<dd>
<p>A space-separated list of the names of the hosts where you are copying
the installation of Eclipse GlassFish software.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
<div id="ssh-example-2-6" class="paragraph">
<p>Example 2-6 Copying a Eclipse GlassFish Installation to Multiple
SSH-Enabled Hosts</p>
</div>
<div class="paragraph">
<p>This example copies the Eclipse GlassFish software on the host where the
subcommand is run to the default location on the SSH-enabled hosts
<code>sj03.example.com</code> and <code>sj04.example.com</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; install-node-ssh sj03.example.com sj04.example.com
Created installation zip /home/gfuser/glassfish2339538623689073993.zip
Successfully connected to gfuser@sj03.example.com using keyfile /home/gfuser
/.ssh/id_rsa
Copying /home/gfuser/glassfish2339538623689073993.zip (81395008 bytes) to
sj03.example.com:/export/glassfish7
Installing glassfish2339538623689073993.zip into sj03.example.com:/export/glassfish7
Removing sj03.example.com:/export/glassfish7/glassfish2339538623689073993.zip
Fixing file permissions of all files under sj03.example.com:/export/glassfish7/bin
Successfully connected to gfuser@sj04.example.com using keyfile /home/gfuser
/.ssh/id_rsa
Copying /home/gfuser/glassfish2339538623689073993.zip (81395008 bytes) to
sj04.example.com:/export/glassfish7
Installing glassfish2339538623689073993.zip into sj04.example.com:/export/glassfish7
Removing sj04.example.com:/export/glassfish7/glassfish2339538623689073993.zip
Fixing file permissions of all files under sj04.example.com:/export/glassfish7/bin
Command install-node-ssh executed successfully</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#install-node-ssh"><code>install-node-ssh</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help install-node-ssh</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-remove-glassfish-server-software-from-multiple-hosts"><a class="anchor" href="#to-remove-glassfish-server-software-from-multiple-hosts"></a>To Remove Eclipse GlassFish Software From Multiple Hosts</h4>
<div class="paragraph">
<p>Use the <code>uninstall-node-ssh</code> subcommand in local mode to remove Eclipse GlassFish
software from multiple hosts.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SSH is set up on the host where you are running the subcommand
and on each host from which you are removing the Eclipse GlassFish software.</p>
</li>
<li>
<p>No process is accessing the parent of the base installation directory
for the Eclipse GlassFish software or any subdirectory of this directory.</p>
</li>
<li>
<p>The parent of the base installation directory for the Eclipse GlassFish
software is the same on each host from which you are removing the
Eclipse GlassFish software.</p>
</li>
<li>
<p>For hosts that use SSH for remote communication, the configuration of
the following items is the same on each host:</p>
<div class="ulist">
<ul>
<li>
<p>SSH port</p>
</li>
<li>
<p>SSH user</p>
</li>
<li>
<p>SSH key file</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the appropriate subcommand for the protocol that is set up for
communication between the hosts.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If SSH is set up for communication between the hosts, run the
<code>uninstall-node-ssh</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in this step.
For information about all the options for removing Eclipse GlassFish software, see the
<a href="reference-manual.html#uninstall-node-ssh"><code>uninstall-node-ssh</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; uninstall-node-ssh host-list</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">host-list</dt>
<dd>
<p>A space-separated list of the names of the hosts from which you are
removing Eclipse GlassFish software.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
<div id="ssh-example-2-7" class="paragraph">
<p>Example 2-7 Removing Eclipse GlassFish Software From Multiple
SSH-Enabled Hosts</p>
</div>
<div class="paragraph">
<p>This example removes Eclipse GlassFish software on the SSH-enabled hosts
<code>sj03.example.com</code> and <code>sj04.example.com</code> from the default location.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; uninstall-node-ssh sj03 sj04
Successfully connected to gfuser@sj03.example.com using keyfile /home/gfuser
/.ssh/id_rsa
Successfully connected to gfuser@sj04.example.com using keyfile /home/gfuser
/.ssh/id_rsa
Command uninstall-node-ssh executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#uninstall-node-ssh"><code>uninstall-node-ssh</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help uninstall-node-ssh</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administering-glassfish-server-nodes"><a class="anchor" href="#administering-glassfish-server-nodes"></a>3 Administering Eclipse GlassFish Nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A node represents a host on which the Eclipse GlassFish software is
installed. A node must exist for every host on which Eclipse GlassFish
instances reside. A node&#8217;s configuration contains information about the
host such as the name of the host and the location where the Eclipse GlassFish is installed on the host.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#types-of-glassfish-server-nodes">Types of Eclipse GlassFish Nodes</a></p>
</li>
<li>
<p><a href="#creating-listing-testing-and-deleting-ssh-nodes">Creating, Listing, Testing, and Deleting <code>SSH</code> Nodes</a></p>
</li>
<li>
<p><a href="#creating-listing-and-deleting-config-nodes">Creating, Listing, and Deleting <code>CONFIG</code> Nodes</a></p>
</li>
<li>
<p><a href="#updating-and-changing-the-type-of-a-node">Updating and Changing the Type of a Node</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="types-of-glassfish-server-nodes"><a class="anchor" href="#types-of-glassfish-server-nodes"></a>Types of Eclipse GlassFish Nodes</h3>
<div class="paragraph">
<p>Each Eclipse GlassFish node is one of the following types of node:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SSH</code></dt>
<dd>
<p>An <code>SSH</code> node supports communication over secure shell (SSH). If SSH
is set up and you plan to administer your Eclipse GlassFish instances
centrally, the instances must reside on <code>SSH</code> nodes.<br>
An <code>SSH</code> node&#8217;s configuration contains the information that is
required to connect to the host through SSH. This information
includes, for example, the user name of the SSH user and the port
number for SSH connections to the host.</p>
</dd>
<dt class="hdlist1"><code>CONFIG</code></dt>
<dd>
<p>A <code>CONFIG</code> node does not support remote communication. If SSH is not set up
and you plan to administer your instances locally,
the instances can reside on <code>CONFIG</code> nodes. You cannot use <code>CONFIG</code>
nodes for instances that you plan to administer centrally.<br>
Each domain contains a predefined <code>CONFIG</code> node that is named
<code>localhost-</code>domain, where domain is the name of the domain. On the
host where the domain administration server (DAS) is running, this
node represents the local host.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="creating-listing-testing-and-deleting-ssh-nodes"><a class="anchor" href="#creating-listing-testing-and-deleting-ssh-nodes"></a>Creating, Listing, Testing, and Deleting <code>SSH</code> Nodes</h3>
<div class="paragraph">
<p>An <code>SSH</code> node supports communication over SSH. If SSH is set up and you
plan to administer your Eclipse GlassFish instances centrally, the
instances must reside on <code>SSH</code> nodes. For information about setting up
SSH, see <a href="#enabling-centralized-administration-of-glassfish-server-instances">Enabling Centralized Administration of
Eclipse GlassFish Instances</a>.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish enables you to create <code>SSH</code> nodes for use by instances,
obtain information about <code>SSH</code> nodes, test if <code>SSH</code> nodes are reachable,
and delete <code>SSH</code> nodes that are no longer required.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a></p>
</li>
<li>
<p><a href="#to-list-ssh-nodes-in-a-domain">To List <code>SSH</code> Nodes in a Domain</a></p>
</li>
<li>
<p><a href="#to-test-if-an-ssh-node-is-reachable">To Test if an <code>SSH</code> Node is Reachable</a></p>
</li>
<li>
<p><a href="#to-delete-an-ssh-node">To Delete an <code>SSH</code> Node</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-create-an-ssh-node"><a class="anchor" href="#to-create-an-ssh-node"></a>To Create an <code>SSH</code> Node</h4>
<div class="paragraph">
<p>Use the <code>create-node-ssh</code> subcommand in remote mode to create an <code>SSH</code>
node.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the SSH user can use SSH to log in to the host that the node
will represent. By default, the <code>create-node-ssh</code> subcommand validates
the node&#8217;s parameters and the SSH connection to the host. If the SSH
user cannot use SSH to log in to the host, the validation fails.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>create-node-ssh</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for configuring the
node, see the <a href="reference-manual.html#create-node-ssh"><code>create-node-ssh</code>(1)</a> help page.</p>
</div>
<div class="paragraph">
<p>If you are using password authentication for the SSH user, you must
specify a password file through the <code>--passwordfile</code> option of the
<a href="reference-manual.html#asadmin"><code>asadmin</code></a> utility. For more information about SSH user
authentication, see <a href="#setting-up-ssh-user-authentication">Setting Up SSH User
Authentication</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-node-ssh --nodehost node-host [--installdir install-dir ]
node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-host</dt>
<dd>
<p>The name of the host that the node represents. The name of the host
must be specified. Otherwise, an error occurs.</p>
</dd>
<dt class="hdlist1">install-dir</dt>
<dd>
<p>The full path to the parent of the base installation directory of the
Eclipse GlassFish software on the host, for example,
<code>/export/glassfish7/</code>. If the Eclipse GlassFish software is installed
in the same directory on the node&#8217;s host and the DAS host, you can
omit this option.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>Your choice of name for the node that you are creating.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-1" class="paragraph">
<p>Example 3-1 Creating an <code>SSH</code> Node</p>
</div>
<div class="paragraph">
<p>This example creates the <code>SSH</code> node <code>sj01</code> to represent the host
<code>sj01.example.com</code>. The Eclipse GlassFish software is installed in the
same directory on the DAS host and on the host <code>sj01.example.com</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-node-ssh --nodehost sj01.example.com sj01
Command create-node-ssh executed successfully.</code></pre>
</div>
</div>
<div id="GSHAG348" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>The <code>create-node-ssh</code> subcommand might fail to create the node and
report the error <code>Illegal sftp packet len</code>. If this error occurs, ensure
that no the startup file on the remote host displays text for
noninteractive shells. Examples of startup files are <code>.bashrc</code>,
<code>.cshrc</code>, <code>.login</code>, and <code>.profile</code>.</p>
</div>
<div class="paragraph">
<p>The SSH session interprets any text message that is displayed during
login as a file-transfer protocol packet. Therefore, any statement in a
startup file that displays text messages corrupts the SSH session,
causing this error.</p>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#create-node-ssh"><code>create-node-ssh</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help create-node-ssh</code> at the command line.</p>
</div>
<div id="GSHAG350" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After creating a node, you can create instances on the node as explained
in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-list-ssh-nodes-in-a-domain"><a class="anchor" href="#to-list-ssh-nodes-in-a-domain"></a>To List <code>SSH</code> Nodes in a Domain</h4>
<div class="paragraph">
<p>Use the <code>list-nodes-ssh</code> subcommand in remote mode to obtain information
about existing <code>SSH</code> nodes in a domain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To obtain information about all existing nodes in a domain, use the
<a href="reference-manual.html#list-nodes"><code>list-nodes</code></a> subcommand.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#list-nodes-ssh"><code>list-nodes-ssh</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-ssh</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-2" class="paragraph">
<p>Example 3-2 Listing Basic Information About All <code>SSH</code> Nodes in a Domain</p>
</div>
<div class="paragraph">
<p>This example lists the name, type, and host of all <code>SSH</code> nodes in the
current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-ssh
sj01  SSH  sj01.example.com
sj02  SSH  sj02.example.com
Command list-nodes-ssh executed successfully.</code></pre>
</div>
</div>
<div id="nodes-example-3-3" class="paragraph">
<p>Example 3-3 Listing Detailed Information About All <code>SSH</code> Nodes in a
Domain</p>
</div>
<div class="paragraph">
<p>This example lists detailed information about all <code>SSH</code> nodes in the
current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-ssh --long=true
NODE NAME   TYPE   NODE HOST          INSTALL DIRECTORY    REFERENCED BY
sj01        SSH    sj01.example.com   /export/glassfish7   pmd-i1
sj02        SSH    sj02.example.com   /export/glassfish7   pmd-i2
Command list-nodes-ssh executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#list-nodes"><code>list-nodes</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-nodes-ssh"><code>list-nodes-ssh</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help list-nodes</code></p>
</li>
<li>
<p><code>asadmin help list-nodes-ssh</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-test-if-an-ssh-node-is-reachable"><a class="anchor" href="#to-test-if-an-ssh-node-is-reachable"></a>To Test if an <code>SSH</code> Node is Reachable</h4>
<div class="paragraph">
<p>Use the <code>ping-node-ssh</code> subcommand in remote mode to test if an <code>SSH</code>
node is reachable.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that SSH is configured on the host where the DAS is running and
on the host that the node represents.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>ping-node-ssh</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for testing the node,
see the <a href="reference-manual.html#ping-node-ssh"><code>ping-node-ssh</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; ping-node-ssh node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The name of the node to test.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-4" class="paragraph">
<p>Example 3-4 Testing if an <code>SSH</code> Node Is Reachable</p>
</div>
<div class="paragraph">
<p>This example tests if the <code>SSH</code> node <code>sj01</code> is reachable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; ping-node-ssh sj01
Successfully made SSH connection to node sj01 (sj01.example.com)
Command ping-node-ssh executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#ping-node-ssh"><code>ping-node-ssh</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help ping-node-ssh</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-delete-an-ssh-node"><a class="anchor" href="#to-delete-an-ssh-node"></a>To Delete an <code>SSH</code> Node</h4>
<div class="paragraph">
<p>Use the <code>delete-node-ssh</code> subcommand in remote mode to delete an <code>SSH</code>
node.</p>
</div>
<div class="paragraph">
<p>Deleting a node removes the node from the configuration of the DAS. The
node&#8217;s directories and files are deleted when the last Eclipse GlassFish
instance that resides on the node is deleted.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that no Eclipse GlassFish instances reside on the node that you
are deleting. For information about how to delete an instance, see the
following sections.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Confirm that no instances reside on the node that you are deleting.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-ssh --long=true</code></pre>
</div>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#delete-node-ssh"><code>delete-node-ssh</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-node-ssh node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The name of the node that you are deleting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="nodes-example-3-5" class="paragraph">
<p>Example 3-5 Deleting an <code>SSH</code> Node</p>
</div>
<div class="paragraph">
<p>This example confirms that no instances reside on the <code>SSH</code> node <code>sj01</code>
and deletes the node <code>sj01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-ssh --long=true
NODE NAME   TYPE   NODE HOST          INSTALL DIRECTORY    REFERENCED BY
sj01        SSH    sj01.example.com   /export/glassfish7
sj02        SSH    sj02.example.com   /export/glassfish7   pmd-i2
Command list-nodes-ssh executed successfully.
asadmin&gt; delete-node-ssh sj01
Command delete-node-ssh executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-node-ssh"><code>delete-node-ssh</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-nodes-ssh"><code>list-nodes-ssh</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help delete-node-ssh</code></p>
</li>
<li>
<p><code>asadmin help list-nodes-ssh</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-listing-and-deleting-config-nodes"><a class="anchor" href="#creating-listing-and-deleting-config-nodes"></a>Creating, Listing, and Deleting <code>CONFIG</code> Nodes</h3>
<div class="paragraph">
<p>A <code>CONFIG</code> node does not support remote communication. If SSH is not set up
and you plan to administer your instances locally, the
instances can reside on <code>CONFIG</code> nodes. You cannot use <code>CONFIG</code> nodes
for instances that you plan to administer centrally.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish enables you to create <code>CONFIG</code> nodes for use by
instances, obtain information about <code>CONFIG</code> nodes, and delete <code>CONFIG</code>
nodes that are no longer required.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-a-config-node">To Create a <code>CONFIG</code> Node</a></p>
</li>
<li>
<p><a href="#to-list-config-nodes-in-a-domain">To List <code>CONFIG</code> Nodes in a Domain</a></p>
</li>
<li>
<p><a href="#to-delete-a-config-node">To Delete a <code>CONFIG</code> Node</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-create-a-config-node"><a class="anchor" href="#to-create-a-config-node"></a>To Create a <code>CONFIG</code> Node</h4>
<div class="paragraph">
<p>Use the <code>create-node-config</code> command in remote mode to create a <code>CONFIG</code> node.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you create an instance locally on a host for which no nodes are
defined, you can create the instance without creating a node beforehand.
In this situation, Eclipse GlassFish creates a <code>CONFIG</code> node for you. The
name of the node is the unqualified name of the host. For more
information, see <a href="#to-create-an-instance-locally">To Create an Instance Locally</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>create-node-config</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for configuring the
node, see the <a href="reference-manual.html#create-node-config"><code>create-node-config</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-node-config [--nodehost node-host] [--installdir install-dir ]
node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-host</dt>
<dd>
<p>The name of the host that the node represents. You may omit this
option. The name of the host can be determined when instances that
reside on the node are created.</p>
</dd>
<dt class="hdlist1">install-dir</dt>
<dd>
<p>The full path to the parent of the base installation directory of the
Eclipse GlassFish software on the host, for example,
<code>/export/glassfish7/</code>. You may omit this option. The installation
directory can be determined when instances that reside on the node are
created.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>Your choice of name for the node that you are creating.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-6" class="paragraph">
<p>Example 3-6 Creating a <code>CONFIG</code> Node</p>
</div>
<div class="paragraph">
<p>This example creates the <code>CONFIG</code> node <code>cfg01</code>. The host that the node
represents and the installation directory of the Eclipse GlassFish
software on the host are to be determined when instances are added to
the node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-node-config cfg01
Command create-node-config executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#create-node-config"><code>create-node-config</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help create-node-config</code> at the command line.</p>
</div>
<div id="GSHAG357" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After creating a node, you can create instances on the node as explained
in <a href="#to-create-an-instance-locally">To Create an Instance Locally</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-list-config-nodes-in-a-domain"><a class="anchor" href="#to-list-config-nodes-in-a-domain"></a>To List <code>CONFIG</code> Nodes in a Domain</h4>
<div class="paragraph">
<p>Use the <code>list-nodes-config</code> subcommand in remote mode to obtain
information about existing <code>CONFIG</code> nodes in a domain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To obtain information about all existing nodes in a domain, use the
<a href="reference-manual.html#list-nodes"><code>list-nodes</code></a> subcommand.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#list-nodes-config"><code>list-nodes-config</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-config</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-7" class="paragraph">
<p>Example 3-7 Listing Basic Information About All <code>CONFIG</code> Nodes in a
Domain</p>
</div>
<div class="paragraph">
<p>This example lists the name, type, and host of all <code>CONFIG</code> nodes in the
current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-config
localhost-domain1  CONFIG  localhost
cfg01  CONFIG  cfg01.example.com
cfg02  CONFIG  cfg02.example.com
Command list-nodes-config executed successfully.</code></pre>
</div>
</div>
<div id="nodes-example-3-8" class="paragraph">
<p>Example 3-8 Listing Detailed Information About All <code>CONFIG</code> Nodes in a
Domain</p>
</div>
<div class="paragraph">
<p>This example lists detailed information about all <code>CONFIG</code> nodes in the
current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-config --long=true
NODE NAME           TYPE     NODE HOST            INSTALL DIRECTORY    REFERENCED BY
localhost-domain1   CONFIG   localhost            /export/glassfish7
cfg01               CONFIG   cfg01.example.com    /export/glassfish7   yml-i1
cfg02               CONFIG   cfg02.example.com    /export/glassfish7   yml-i2
Command list-nodes-config executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#list-nodes"><code>list-nodes</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-nodes-config"><code>list-nodes-config</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help list-nodes</code></p>
</li>
<li>
<p><code>asadmin help list-nodes-config</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-delete-a-config-node"><a class="anchor" href="#to-delete-a-config-node"></a>To Delete a <code>CONFIG</code> Node</h4>
<div class="paragraph">
<p>Use the <code>delete-node-config</code> subcommand in remote mode to delete a
<code>CONFIG</code> node.</p>
</div>
<div class="paragraph">
<p>Deleting a node removes the node from the configuration of the DAS. The
node&#8217;s directories and files are deleted when the last Eclipse GlassFish
instance that resides on the node is deleted.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that no Eclipse GlassFish instances reside on the node that you
are deleting. For information about how to delete an instance that
resides on a <code>CONFIG</code> node, see <a href="#to-delete-an-instance-locally">To Delete an
Instance Locally</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Confirm that no instances reside on the node that you are deleting.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-config --long=true</code></pre>
</div>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#delete-node-config"><code>delete-node-config</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-node-config node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The name of the node that you are deleting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-9" class="paragraph">
<p>Example 3-9 Deleting a <code>CONFIG</code> Node</p>
</div>
<div class="paragraph">
<p>This example confirms that no instances reside on the <code>CONFIG</code> node
<code>cfg01</code> and deletes the node <code>cfg01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-nodes-config --long=true
NODE NAME           TYPE     NODE HOST           INSTALL DIRECTORY    REFERENCED BY
localhost-domain1   CONFIG   localhost           /export/glassfish7
cfg01               CONFIG   cfg01.example.com   /export/glassfish7
cfg02               CONFIG   cfg02.example.com   /export/glassfish7   yml-i2
Command list-nodes-config executed successfully.
asadmin&gt; delete-node-config cfg01
Command delete-node-config executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-node-config"><code>delete-node-config</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-nodes-config"><code>list-nodes-config</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help delete-node-config</code></p>
</li>
<li>
<p><code>asadmin help list-nodes-config</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="updating-and-changing-the-type-of-a-node"><a class="anchor" href="#updating-and-changing-the-type-of-a-node"></a>Updating and Changing the Type of a Node</h3>
<div class="paragraph">
<p>Eclipse GlassFish enables you to update the configuration data of any
node and to change the type of a node.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-update-an-ssh-node">To Update an <code>SSH</code> Node</a></p>
</li>
<li>
<p><a href="#to-update-a-config-node">To Update a <code>CONFIG</code> Node</a></p>
</li>
<li>
<p><a href="#to-change-the-type-of-a-node">To Change the Type of a Node</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-update-an-ssh-node"><a class="anchor" href="#to-update-an-ssh-node"></a>To Update an <code>SSH</code> Node</h4>
<div class="paragraph">
<p>Use the <code>update-node-ssh</code> subcommand in remote mode to update an <code>SSH</code> node.</p>
</div>
<div class="paragraph">
<p>Options of this subcommand specify the new values of the node&#8217;s
configuration data. If you omit an option, the existing value is unchanged.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SSH is configured on the host where the DAS is running and on the host
that the node represents.</p>
</li>
<li>
<p>The node that you are updating exists.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>update-node-ssh</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; update-node-ssh options node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">options</dt>
<dd>
<p>Options of the <code>update-node-ssh</code> subcommand for changing the node&#8217;s
configuration data. For information about these options, see the
<a href="reference-manual.html#update-node-ssh"><code>update-node-ssh</code>(1)</a> help page.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The name of the <code>SSH</code> node to update.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="nodes-example-3-10" class="paragraph">
<p>Example 3-10 Updating an <code>SSH</code> Node</p>
</div>
<div class="paragraph">
<p>This example updates the host that the node <code>sj01</code> represents to
<code>adc01.example.com</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; update-node-ssh --nodehost adc01.example.com sj01
Command update-node-ssh executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#update-node-ssh"><code>update-node-ssh</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help update-node-ssh</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-update-a-config-node"><a class="anchor" href="#to-update-a-config-node"></a>To Update a <code>CONFIG</code> Node</h4>
<div class="paragraph">
<p>Use the <code>update-node-config</code> subcommand in remote mode to update a
<code>CONFIG</code> node.</p>
</div>
<div class="paragraph">
<p>Options of this subcommand specify the new values of the node&#8217;s
configuration data. If you omit an option, the existing value is
unchanged.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the node that you are updating exists.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>update-node-config</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; uupdate-node-config options node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">options</dt>
<dd>
<p>Options of the <code>update-node-config</code> subcommand for changing the node&#8217;s
configuration data. For information about these options, see the
<a href="reference-manual.html#update-node-config"><code>update-node-config</code>(1)</a> help page.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The name of the <code>CONFIG</code> node to update.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="nodes-example-3-11" class="paragraph">
<p>Example 3-11 Updating a <code>CONFIG</code> Node</p>
</div>
<div class="paragraph">
<p>This example updates the host that the node <code>cfg02</code> represents to
<code>adc02.example.com</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; update-node-config --nodehost adc02.example.com cfg02
Command update-node-config executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#update-node-config"><code>update-node-config</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help update-node-config</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-change-the-type-of-a-node"><a class="anchor" href="#to-change-the-type-of-a-node"></a>To Change the Type of a Node</h4>
<div class="paragraph">
<p>The subcommands for updating a node can also be used to change the type
of a node.</p>
</div>
<div class="paragraph">
<p>Changing the type of a <code>CONFIG</code> node enables remote communication for
the node. The type of the node after the change determines the protocol
over which the node is enabled for remote communication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>SSH</code> node is enabled for communication over SSH.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As part of the process of changing the type of a node, you can also
change other configuration data for the node.</p>
</div>
<div class="paragraph">
<p>Options of the subcommands for updating a node specify the new values of
the node&#8217;s configuration data. For most options, if you omit the option,
the existing value is unchanged. However, default values are applied in
the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any of the following options of the <code>update-node-ssh</code> subcommand is omitted:</p>
<div class="ulist">
<ul>
<li>
<p><code>--sshport</code></p>
</li>
<li>
<p><code>--sshuser</code></p>
</li>
<li>
<p><code>--sshkeyfile</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Changing an <code>SSH</code> node to a <code>CONFIG</code> node disables remote communication for the node.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SSH is configured on the host where the DAS is running and on
the host that the node represents.</p>
</li>
<li>
<p>The node the type of which you are changing exists.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the appropriate subcommand for updating a node, depending on the
type of the node after the change.</p>
<div class="ulist">
<ul>
<li>
<p>To change the type of a node to <code>SSH</code>, run the <code>update-node-ssh</code>
subcommand on the node.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; update-node-ssh [options] config-node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">options</dt>
<dd>
<p>Options of the <code>update-node-ssh</code> subcommand for changing the node&#8217;s
configuration data. For information about these options, see the
<a href="reference-manual.html#update-node-ssh"><code>update-node-ssh</code>(1)</a> help page.</p>
</dd>
<dt class="hdlist1">config-node-name</dt>
<dd>
<p>The name of the <code>CONFIG</code> node to change.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>To change the type of a node to <code>CONFIG</code>, run the <code>update-node-config</code>
subcommand on the node.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; update-node-config [options] ssh-node-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">options</dt>
<dd>
<p>Options of the <code>update-node-config</code> subcommand for changing the node&#8217;s
configuration data. For information about these options, see the
<a href="reference-manual.html#update-node-config"><code>update-node-config</code>(1)</a> help page.</p>
</dd>
<dt class="hdlist1">ssh-node-name</dt>
<dd>
<p>The name of the <code>SSH</code> node to change.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="nodes-example-3-12" class="paragraph">
<p>Example 3-12 Changing a <code>CONFIG</code> Node to an <code>SSH</code> Node</p>
</div>
<div class="paragraph">
<p>This example changes the <code>CONFIG</code> node <code>cfg02</code> to an <code>SSH</code> node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; update-node-ssh cfg02
Command update-node-ssh executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#update-node-config"><code>update-node-config</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#update-node-ssh"><code>update-node-ssh</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing the following commands at the command line.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help update-node-config</code></p>
</li>
<li>
<p><code>asadmin help update-node-ssh</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administering-glassfish-server-clusters"><a class="anchor" href="#administering-glassfish-server-clusters"></a>4 Administering Eclipse GlassFish Clusters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A cluster is a collection of Eclipse GlassFish instances that work
together as one logical entity. A cluster provides a runtime environment
for one or more Java Platform, Enterprise Edition (Jakarta EE)
applications. A cluster provides high availability through failure
protection, scalability, and load balancing.</p>
</div>
<div class="paragraph">
<p>The Group Management Service (GMS) enables instances to participate in a
cluster by detecting changes in cluster membership and notifying
instances of the changes. To ensure that GMS can detect changes in
cluster membership, a cluster&#8217;s GMS settings must be configured
correctly.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#about-glassfish-server-clusters">About Eclipse GlassFish Clusters</a></p>
</li>
<li>
<p><a href="#group-management-service">Group Management Service</a></p>
</li>
<li>
<p><a href="#creating-listing-and-deleting-clusters">Creating, Listing, and Deleting Clusters</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="about-glassfish-server-clusters"><a class="anchor" href="#about-glassfish-server-clusters"></a>About Eclipse GlassFish Clusters</h3>
<div class="paragraph">
<p>A cluster is a named collection of Eclipse GlassFish instances that share
the same applications, resources, and configuration information. For
information about Eclipse GlassFish instances, see
<a href="#administering-glassfish-server-instances">Administering Eclipse GlassFish Instances</a>.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish enables you to administer all the instances in a
cluster as a single unit from a single host, regardless of whether the
instances reside on the same host or different hosts. You can perform
the same operations on a cluster that you can perform on an unclustered
instance, for example, deploying applications and creating resources.</p>
</div>
<div class="paragraph">
<p>A cluster provides high availability through failure protection,
scalability, and load balancing.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Failure protection. If an instance or a host in a cluster fails,
Eclipse GlassFish detects the failure and recovers the user session
state. If a load balancer is configured for the cluster, the load
balancer redirects requests from the failed instance to other instances
in the cluster. Because the same applications and resources are on all
instances in the cluster, an instance can fail over to any other
instance in the cluster.</p>
<div class="paragraph">
<p>To enable the user session state to be recovered, each instance in a
cluster sends in-memory state data to another instance. As state data is
updated in any instance, the data is replicated.</p>
</div>
</li>
<li>
<p>Scalability. If increased capacity is required, you can add instances
to a cluster with no disruption in service. When an instance is added or
removed, the changes are handled automatically.</p>
</li>
<li>
<p>Load balancing. If instances in a cluster are distributed among
different hosts, the workload can be distributed among the hosts to
increase overall system throughput.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="group-management-service"><a class="anchor" href="#group-management-service"></a>Group Management Service</h3>
<div class="paragraph">
<p>The Group Management Service (GMS) is an infrastructure component that
is enabled for the instances in a cluster. When GMS is enabled, if a
clustered instance fails, the cluster and the Domain Administration
Server (DAS) are aware of the failure and can take action when failure
occurs. Many features of Eclipse GlassFish depend upon GMS. For example,
GMS is used by the in-memory session replication, transaction service,
and timer service features.</p>
</div>
<div class="paragraph">
<p>GMS is a core service of the Shoal framework. For more information about
Shoal, visit the <a href="http://shoal.dev.java.net/">Project Shoal home page</a>
(<code><a href="https://shoal.dev.java.net/" class="bare">https://shoal.dev.java.net/</a></code>).</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#protocols-and-transports-for-gms">Protocols and Transports for GMS</a></p>
</li>
<li>
<p><a href="#gms-configuration-settings">GMS Configuration Settings</a></p>
</li>
<li>
<p><a href="#dotted-names-for-gms-settings">Dotted Names for GMS Settings</a></p>
</li>
<li>
<p><a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS Configuration Settings</a></p>
</li>
<li>
<p><a href="#to-change-gms-settings-after-cluster-creation">To Change GMS Settings After Cluster Creation</a></p>
</li>
<li>
<p><a href="#to-check-the-health-of-instances-in-a-cluster">To Check the Health of Instances in a Cluster</a></p>
</li>
<li>
<p><a href="#to-validate-that-multicast-transport-is-available-for-a-cluster">To Validate That Multicast Transport Is Available for a Cluster</a></p>
</li>
<li>
<p><a href="#discovering-a-cluster-when-multicast-transport-is-unavailable">Discovering a Cluster When Multicast Transport Is Unavailable</a></p>
</li>
<li>
<p><a href="#using-the-multi-homing-feature-with-gms">Using the Multi-Homing Feature With GMS</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="protocols-and-transports-for-gms"><a class="anchor" href="#protocols-and-transports-for-gms"></a>Protocols and Transports for GMS</h4>
<div class="paragraph">
<p>You can specify that GMS should use one of the following combinations of
protocol and transport for broadcasting messages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User Datagram Protocol (UDP) multicast</p>
</li>
<li>
<p>Transmission Control Protocol (TCP) without multicast</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even if GMS should use UDP multicast for broadcasting messages, you must
ensure that TCP is enabled. On Windows systems, enabling TCP involves
enabling a protocol and port for security when a firewall is enabled.</p>
</div>
<div class="paragraph">
<p>If GMS should use UDP multicast for broadcasting messages and if
Eclipse GlassFish instances in a cluster are located on different hosts,
the following conditions must be met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The DAS host and all hosts for the instances must be on the same subnet.</p>
</li>
<li>
<p>UDP multicast must be enabled for the network.
To test whether multicast is enabled, use the
<a href="reference-manual.html#validate-multicast"><code>validate-multicast</code>(1)</a>
subcommand.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If GMS should use TCP without multicast, you must configure GMS to
locate the instances to use for discovering the cluster. For more
information, see <a href="#discovering-a-cluster-when-multicast-transport-is-unavailable">Discovering a Cluster When Multicast
Transport Is Unavailable</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not configure GMS to locate the instances to use for
discovering a cluster, GMS uses UDP multicast by default.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="gms-configuration-settings"><a class="anchor" href="#gms-configuration-settings"></a>GMS Configuration Settings</h4>
<div class="paragraph">
<p>Eclipse GlassFish has the following types of GMS settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GMS cluster settings — These are determined during cluster creation.
For more information about these settings, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</li>
<li>
<p>GMS configuration settings — These are determined during configuration
creation and are explained here.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following GMS configuration settings are used in GMS for group
discovery and failure detection:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>group-discovery-timeout-in-millis</code></dt>
<dd>
<p>Indicates the amount of time (in milliseconds) an instance&#8217;s GMS
module will wait during instance startup for discovering other members
of the group.</p>
<div class="literalblock">
<div class="content">
<pre>The `group-discovery-timeout-in-millis` timeout value should be set to
the default or higher. The default is 5000.</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>max-missed-heartbeats</code></dt>
<dd>
<p>Indicates the maximum number of missed heartbeats that the health
monitor counts before the instance can be marked as a suspected
failure. GMS also tries to make a peer-to-peer connection with the
suspected member. If the maximum number of missed heartbeats is
exceeded and peer-to-peer connection fails, the member is marked as a
suspected failure. The default is 3.</p>
</dd>
<dt class="hdlist1"><code>heartbeat-frequency-in-millis</code></dt>
<dd>
<p>Indicates the frequency (in milliseconds) at which a heartbeat is sent
by each server instance to the cluster.<br>
The failure detection interval is the <code>max-missed-heartbeats</code>
multiplied by the <code>heartbeat-frequency-in-millis</code>. Therefore, the
combination of defaults, 3 multiplied by 2000 milliseconds, results in
a failure detection interval of 6 seconds.<br>
Lowering the value of <code>heartbeat-frequency-in-millis</code> below the
default would result in more frequent heartbeat messages being sent
out from each member. This could potentially result in more heartbeat
messages in the network than a system needs for triggering failure
detection protocols. The effect of this varies depending on how
quickly the deployment environment needs to have failure detection
performed. That is, the (lower) number of retries with a lower
heartbeat interval would make it quicker to detect failures.<br>
However, lowering this value could result in false positives because
you could potentially detect a member as failed when, in fact, the
member&#8217;s heartbeat is reflecting the network load from other parts of
the server. Conversely, a higher timeout interval results in fewer
heartbeats in the system because the time interval between heartbeats
is longer. As a result, failure detection would take a longer. In
addition, a startup by a failed member during this time results in a
new join notification but no failure notification, because failure
detection and verification were not completed.<br>
The default is 2000.</p>
</dd>
<dt class="hdlist1"><code>verify-failure-waittime-in-millis</code></dt>
<dd>
<p>Indicates the verify suspect protocol&#8217;s timeout used by the health
monitor. After a member is marked as suspect based on missed
heartbeats and a failed peer-to-peer connection check, the verify
suspect protocol is activated and waits for the specified timeout to
check for any further health state messages received in that time, and
to see if a peer-to-peer connection can be made with the suspect
member. If not, then the member is marked as failed and a failure
notification is sent. The default is 1500.</p>
</dd>
<dt class="hdlist1"><code>verify-failure-connect-timeout-in-millis</code></dt>
<dd>
<p>Indicates the time it takes for the GMS to detect a hardware or
network failure of a server instance. Be careful not to set this value
too low. The smaller this timeout value is, the greater the chance of
detecting false failures. That is, the instance has not failed but
doesn&#8217;t respond within the short window of time. The default is 10000.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The heartbeat frequency, maximum missed heartbeats, peer-to-peer
connection-based failure detection, and the verify timeouts are all
needed to ensure that failure detection is robust and reliable in
Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>For the dotted names for each of these GMS configuration settings, see
<a href="#dotted-names-for-gms-settings">Dotted Names for GMS Settings</a>. For the steps to specify
these settings, see <a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS
Configuration Settings</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="dotted-names-for-gms-settings"><a class="anchor" href="#dotted-names-for-gms-settings"></a>Dotted Names for GMS Settings</h4>
<div class="paragraph">
<p>Below are sample <a href="reference-manual.html#get"><code>get</code></a> subcommands to get all the GMS
configuration settings (attributes associated with the referenced
<code>mycfg</code> configuration) and GMS cluster settings (attributes and
properties associated with a cluster named <code>mycluster</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get &quot;configs.config.mycfg.group-management-service.*&quot;
configs.config.mycfg.group-management-service.failure-detection.heartbeat-frequency-in-millis=2000
configs.config.mycfg.group-management-service.failure-detection.max-missed-heartbeats=3
configs.config.mycfg.group-management-service.failure-detection.verify-failure-connect-timeout-in-millis=10000
configs.config.mycfg.group-management-service.failure-detection.verify-failure-waittime-in-millis=1500
configs.config.mycfg.group-management-service.group-discovery-timeout-in-millis=5000

asadmin&gt; get clusters.cluster.mycluster
clusters.cluster.mycluster.config-ref=mycfg
clusters.cluster.mycluster.gms-bind-interface-address=${GMS-BIND-INTERFACE-ADDRESS-mycluster}
clusters.cluster.mycluster.gms-enabled=true
clusters.cluster.mycluster.gms-multicast-address=228.9.245.47
clusters.cluster.mycluster.gms-multicast-port=9833
clusters.cluster.mycluster.name=mycluster

asadmin&gt; get &quot;clusters.cluster.mycluster.property.*&quot;
clusters.cluster.mycluster.property.GMS_LISTENER_PORT=${GMS_LISTENER_PORT-mycluster}
clusters.cluster.mycluster.property.GMS_MULTICAST_TIME_TO_LIVE=4
clusters.cluster.mycluster.property.GMS_LOOPBACK=false
clusters.cluster.mycluster.property.GMS_TCPSTARTPORT=9090
clusters.cluster.mycluster.property.GMS_TCPENDPORT=9200</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last <code>get</code> subcommand displays only the properties that have been
explicitly set.</p>
</div>
<div class="paragraph">
<p>For the steps to specify these settings, see <a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure
Nondefault GMS Configuration Settings</a> and <a href="#to-change-gms-settings-after-cluster-creation">To Change GMS
Settings After Cluster Creation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-preconfigure-nondefault-gms-configuration-settings"><a class="anchor" href="#to-preconfigure-nondefault-gms-configuration-settings"></a>To Preconfigure Nondefault GMS Configuration Settings</h4>
<div class="paragraph">
<p>You can preconfigure GMS with values different than the defaults without
requiring a restart of the DAS and the cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a configuration using the <a href="reference-manual.html#copy-config"><code>copy-config</code></a>
subcommand.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; copy-config default-config mycfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="#to-create-a-named-configuration">To Create
a Named Configuration</a>.</p>
</div>
</li>
<li>
<p>Set the values for the new configuration&#8217;s GMS configuration
settings.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set configs.config.mycfg.group-management-service.group-discovery-timeout-in-millis=8000
asadmin&gt; set configs.config.mycfg.group-management-service.failure-detection.max-missed-heartbeats=5</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of the dotted names for these settings, see
<a href="#dotted-names-for-gms-settings">Dotted Names for GMS Settings</a>.</p>
</div>
</li>
<li>
<p>Create the cluster so it uses the previously created configuration.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --config mycfg mycluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also set GMS cluster settings during this step. For more
information, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</div>
</li>
<li>
<p>Create server instances for the cluster.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-instance --node localhost --cluster mycluster instance01

asadmin&gt; create-instance --node localhost --cluster mycluster instance02</code></pre>
</div>
</div>
</li>
<li>
<p>Start the cluster.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-cluster mycluster</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of a subcommand by typing
<code>asadmin help</code> subcommand at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-change-gms-settings-after-cluster-creation"><a class="anchor" href="#to-change-gms-settings-after-cluster-creation"></a>To Change GMS Settings After Cluster Creation</h4>
<div class="paragraph">
<p>To avoid the need to restart the DAS and the cluster, configure GMS
configuration settings before cluster creation as explained in
<a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS Configuration Settings</a>.</p>
</div>
<div class="paragraph">
<p>To avoid the need to restart the DAS and the cluster, configure the GMS
cluster settings during cluster creation as explained in <a href="#to-create-a-cluster">To
Create a Cluster</a>.</p>
</div>
<div class="paragraph">
<p>Changing any GMS settings using the <code>set</code> subcommand after cluster
creation requires a domain administration server (DAS) and cluster
restart as explained here.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS and cluster are running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Use the <a href="reference-manual.html#get"><code>get</code></a> subcommand to determine the settings
to change.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get &quot;configs.config.mycfg.group-management-service.*&quot;
configs.config.mycfg.group-management-service.failure-detection.heartbeat-frequency-in-millis=2000
configs.config.mycfg.group-management-service.failure-detection.max-missed-heartbeats=3
configs.config.mycfg.group-management-service.failure-detection.verify-failure-connect-timeout-in-millis=10000
configs.config.mycfg.group-management-service.failure-detection.verify-failure-waittime-in-millis=1500
configs.config.mycfg.group-management-service.group-discovery-timeout-in-millis=5000</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of the dotted names for these settings, see
<a href="#dotted-names-for-gms-settings">Dotted Names for GMS Settings</a>.</p>
</div>
</li>
<li>
<p>Use the <a href="reference-manual.html#set"><code>set</code></a> subcommand to change the settings.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set configs.config.mycfg.group-management-service.group-discovery-timeout-in-millis=6000</code></pre>
</div>
</div>
</li>
<li>
<p>Use the <code>get</code> subcommand again to confirm that the changes were
made.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get configs.config.mycfg.group-management-service.group-discovery-timeout-in-millis</code></pre>
</div>
</div>
</li>
<li>
<p>Restart the DAS.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; stop-domain domain1

asadmin&gt; start-domain domain1</code></pre>
</div>
</div>
</li>
<li>
<p>Restart the cluster.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; stop-cluster mycluster

asadmin&gt; start-cluster mycluster</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of a subcommand by typing
<code>asadmin help</code> subcommand at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-check-the-health-of-instances-in-a-cluster"><a class="anchor" href="#to-check-the-health-of-instances-in-a-cluster"></a>To Check the Health of Instances in a Cluster</h4>
<div class="paragraph">
<p>The <code>get-health</code> subcommand only works when GMS is enabled. This is the
quickest way to evaluate the health of a cluster and to detect if
cluster is properly operating; that is, all members of the cluster are
running and visible to DAS.</p>
</div>
<div class="paragraph">
<p>If multicast is not enabled for the network, all instances could be
running (as shown by the <a href="reference-manual.html#list-instances"><code>list-instances</code></a> subcommand),
yet isolated from each other. The <code>get-health</code> subcommand does not show
the instances if they are running but cannot discover each other due to
multicast not being configured properly. See <a href="#to-validate-that-multicast-transport-is-available-for-a-cluster">To Validate
That Multicast Transport Is Available for a Cluster</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS and cluster are running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Check whether server instances in a cluster are running by using the
<a href="reference-manual.html#get-health"><code>get-health</code></a> subcommand.</p>
</li>
</ol>
</div>
<div id="clusters-example-4-1" class="paragraph">
<p>Example 4-1 Checking the Health of Instances in a Cluster</p>
</div>
<div class="paragraph">
<p>This example checks the health of a cluster named <code>cluster1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get-health cluster1
instance1 started since Wed Sep 29 16:32:46 EDT 2010
instance2 started since Wed Sep 29 16:32:45 EDT 2010
Command get-health executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help get-health</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-validate-that-multicast-transport-is-available-for-a-cluster"><a class="anchor" href="#to-validate-that-multicast-transport-is-available-for-a-cluster"></a>To Validate That Multicast Transport Is Available for a Cluster</h4>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>To test a specific multicast address, multicast port, or bind interface
address, get this information beforehand using the <code>get</code> subcommand. Use
the following subcommand to get the multicast address and port for a
cluster named <code>c1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get clusters.cluster.c1
clusters.cluster.c1.config-ref=mycfg
clusters.cluster.c1.gms-bind-interface-address=${GMS-BIND-INTERFACE-ADDRESS-c1}
clusters.cluster.c1.gms-enabled=true
clusters.cluster.c1.gms-multicast-address=228.9.174.162
clusters.cluster.c1.gms-multicast-port=5383
clusters.cluster.c1.name=c1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the following subcommand to get the bind interface address of a
server instance named <code>i1</code> that belongs to a cluster named <code>c1</code>, if this
system property has been set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get servers.server.i1.system-property.GMS-BIND-INTERFACE-ADDRESS-c1
servers.server.i1.system-property.GMS-BIND-INTERFACE-ADDRESS-c1.name=GMS-BIND-INTERFACE-ADDRESS-c1
servers.server.i1.system-property.GMS-BIND-INTERFACE-ADDRESS-c1.value=10.12.152.30</code></pre>
</div>
</div>
<div class="paragraph">
<p>For information on how to set this system property, see
<a href="#using-the-multi-homing-feature-with-gms">Using the Multi-Homing Feature With GMS</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not run the <code>validate-multicast</code> subcommand using the DAS and
cluster&#8217;s multicast address and port values while the DAS and cluster
are running. Doing so results in an error.</p>
</div>
<div class="paragraph">
<p>The <code>validate-multicast</code> subcommand must be run at the same time on two
or more machines to validate whether multicast messages are being
received between the machines.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check whether multicast transport is available for a cluster by using
the <a href="reference-manual.html#validate-multicast"><code>validate-multicast</code></a> subcommand.</p>
</div>
<div id="clusters-example-4-2" class="paragraph">
<p>Example 4-2 Validating That Multicast Transport Is Available for a
Cluster</p>
</div>
<div class="paragraph">
<p>This example checks whether multicast transport is available for a
cluster named <code>c1</code>.</p>
</div>
<div class="paragraph">
<p>Run from host <code>sr1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; validate-multicast
Will use port 2048
Will use address 228.9.3.1
Will use bind interface null
Will use wait period 2,000 (in milliseconds)

Listening for data...
Sending message with content &quot;sr1&quot; every 2,000 milliseconds
Received data from sr1 (loopback)
Received data from sr2
Exiting after 20 seconds. To change this timeout, use the --timeout command line option.
Command validate-multicast executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run from host <code>sr2</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; validate-multicast
Will use port 2048
Will use address 228.9.3.1
Will use bind interface null
Will use wait period 2,000 (in milliseconds)

Listening for data...
Sending message with content &quot;sr2&quot; every 2,000 milliseconds
Received data from sr2 (loopback)
Received data from sr1
Exiting after 20 seconds. To change this timeout, use the --timeout command line option.
Command validate-multicast executed successfully.</code></pre>
</div>
</div>
<div id="GSHAG371" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>As long as all machines see each other, multicast is validated to be
working properly across the machines. If the machines are not seeing
each other, set the <code>--bindaddress</code> option explicitly to ensure that all
machines are using interface on same subnet, or increase the
<code>--timetolive</code> option from the default of <code>4</code>. If these changes fail to
resolve the multicast issues, ask the network administrator to verify
that the network is configured so the multicast messages can be seen
between all the machines used to run the cluster.</p>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help get-health</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="discovering-a-cluster-when-multicast-transport-is-unavailable"><a class="anchor" href="#discovering-a-cluster-when-multicast-transport-is-unavailable"></a>Discovering a Cluster When Multicast Transport Is Unavailable</h4>
<div class="paragraph">
<p>When multicast transport is unavailable, Eclipse GlassFish instances that
are joining a cluster cannot rely on broadcast messages from GMS to
discover the cluster. Instead, an instance that is joining a cluster
uses a running instance or the DAS in the cluster to discover the
cluster.</p>
</div>
<div class="paragraph">
<p>Therefore, when multicast transport is unavailable, you must provide the
locations of instances in the cluster to use for discovering the
cluster. You are not required to provide the locations of all instances
in the cluster. However, for an instance to discover the cluster, at
least one instance whose location you provide must be running. To
increase the probability of finding a running instance, provide the
locations of several instances.</p>
</div>
<div class="paragraph">
<p>If the DAS will be left running after the cluster is started, provide
the location of the DAS first in the list of instances. When a cluster
is started, the DAS is running before any of the instances in the
cluster are started.</p>
</div>
<div class="paragraph">
<p>The locations of the instances to use for discovering a cluster are part
of the configuration data that you provide when creating the cluster.
How to provide this data depends on how instances are distributed, as
explained in the following subsections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-discover-a-cluster-when-multiple-instances-in-a-cluster-are-running-on-a-host">To Discover a Cluster When Multiple Instances in a
Cluster are Running on a Host</a></p>
</li>
<li>
<p><a href="#to-discover-a-cluster-when-each-instance-in-a-cluster-is-running-on-a-different-host">To Discover a Cluster When Each Instance in a Cluster
Is Running on a Different Host</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="to-discover-a-cluster-when-multiple-instances-in-a-cluster-are-running-on-a-host"><a class="anchor" href="#to-discover-a-cluster-when-multiple-instances-in-a-cluster-are-running-on-a-host"></a>To Discover a Cluster When Multiple Instances in a Cluster are Running on a Host</h5>
<div class="paragraph">
<p>If multiple instances in the same cluster are running on a host, you
must provide a list of uniform resource indicators (URIs). Each URI must
locate a Eclipse GlassFish instance or the DAS in the cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Create a system property to represent the port number of the port on
which the DAS listens for messages from GMS for the cluster.</p>
<div class="paragraph">
<p>Use the <a href="reference-manual.html#create-system-properties"><code>create-system-properties</code></a> subcommand for this
purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-system-properties GMS_LISTENER_PORT-cluster-name=gms-port</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster to which the messages from GMS apply.</p>
</dd>
<dt class="hdlist1">gms-port</dt>
<dd>
<p>The port number of the port on which the DAS listens for messages from
GMS.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Restart the DAS.</p>
</li>
<li>
<p>When creating the cluster, set the <code>GMS_DISCOVERY_URI_LIST</code> property
to a comma-separated list of URIs that locate instances to use for
discovering the cluster.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --properties GMS_DISCOVERY_URI_LIST=uri-list cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">uri-list</dt>
<dd>
<p>A comma-separated list of URIs that locate a Eclipse GlassFish instance
or the DAS in the cluster.<br>
The format of each URI in the list is as follows:<br>
scheme<code>://</code>host-name-or -IP-address<code>:</code>port</p>
<div class="ulist">
<ul>
<li>
<p>scheme is the URI scheme, which is <code>tcp</code>.</p>
</li>
<li>
<p>host-name-or -IP-address is the host name or IP address of the host
on which the instance is running.</p>
</li>
<li>
<p>port is the port number of the port on which the instance will
listen for messages from GMS.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are creating.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For complete instructions for creating a cluster, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>When you add each instance to the cluster, set the system property
<code>GMS_LISTENER_PORT-</code>clustername for the instance.</p>
<div class="ulist">
<ul>
<li>
<p>To create the instance centrally, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-instance --node node-name
--systemproperties GMS_LISTENER_PORT-cluster-name=gms-port --cluster  cluster-name instance-name</code></pre>
</div>
</div>
</li>
<li>
<p>To create the instance locally, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-local-instance
--systemproperties GMS_LISTENER_PORT-cluster-name=gms-port --cluster  cluster-name instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The name of an existing Eclipse GlassFish node on which the instance is
to reside. For more information about nodes, see
<a href="#administering-glassfish-server-nodes">Administering Eclipse GlassFish Nodes</a>.</p>
</dd>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster to which the you are adding the instance.</p>
</dd>
<dt class="hdlist1">gms-port</dt>
<dd>
<p>The port number of the port on which the instance listens for messages
from GMS.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are creating.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For full instructions for adding an instance to a cluster, see the
following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="clusters-ex-4-3" class="paragraph">
<p>Example 4-3 Discovering a Cluster When Multiple Instances are Running on a Host</p>
</div>
<div class="paragraph">
<p>This example creates a cluster that is named <code>tcpcluster</code> for which GMS
is not using multicast for broadcasting messages.</p>
</div>
<div class="paragraph">
<p>The cluster contains the instances <code>instance101</code> and <code>instance102</code>.
These instances reside on the host whose IP address is <code>10.152.23.224</code>
and listen for GMS events on ports 9091 and 9092. The DAS is also
running on this host and listens for GMS events on port 9090.</p>
</div>
<div class="paragraph">
<p>Instances that are joining the cluster will use the DAS and the
instances <code>instance101</code> and <code>instance102</code> to discover the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-system-properties GMS_LISTENER_PORT-tcpcluster=9090
Command create-system-properties executed successfully.
asadmin&gt; restart-domain
Successfully restarted the domain
Command restart-domain executed successfully.
asadmin&gt; create-cluster --properties GMS_DISCOVERY_URI_LIST=
tcp'\\:'//10.152.23.224'\\:'9090,
tcp'\\:'//10.152.23.224'\\:'9091,
tcp'\\:'//10.152.23.224'\\:'9092 tcpcluster
Command create-cluster executed successfully.
asadmin&gt; create-local-instance
--systemproperties GMS_LISTENER_PORT-tcpcluster=9091 --cluster tcpcluster
instance101
Rendezvoused with DAS on localhost:4848.
Port Assignments for server instance instance101:
JMX_SYSTEM_CONNECTOR_PORT=28686
JMS_PROVIDER_PORT=27676
HTTP_LISTENER_PORT=28080
ASADMIN_LISTENER_PORT=24848
JAVA_DEBUGGER_PORT=29009
IIOP_SSL_LISTENER_PORT=23820
IIOP_LISTENER_PORT=23700
OSGI_SHELL_TELNET_PORT=26666
HTTP_SSL_LISTENER_PORT=28181
IIOP_SSL_MUTUALAUTH_PORT=23920
Command create-local-instance executed successfully.
asadmin&gt; create-local-instance
--systemproperties GMS_LISTENER_PORT-tcpcluster=9092 --cluster tcpcluster
instance102
Rendezvoused with DAS on localhost:4848.
Using DAS host localhost and port 4848 from existing das.properties for node
localhost-domain1. To use a different DAS, create a new node using
create-node-ssh or create-node-config. Create the instance with the new node and
correct host and port:
asadmin --host das_host --port das_port create-local-instance --node node_name
instance_name.
Port Assignments for server instance instance102:
JMX_SYSTEM_CONNECTOR_PORT=28687
JMS_PROVIDER_PORT=27677
HTTP_LISTENER_PORT=28081
ASADMIN_LISTENER_PORT=24849
JAVA_DEBUGGER_PORT=29010
IIOP_SSL_LISTENER_PORT=23821
IIOP_LISTENER_PORT=23701
OSGI_SHELL_TELNET_PORT=26667
HTTP_SSL_LISTENER_PORT=28182
IIOP_SSL_MUTUALAUTH_PORT=23921
Command create-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#create-system-properties"><code>create-system-properties</code>(1)</a></p>
</li>
<li>
<p><a href="#to-create-a-cluster">To Create a Cluster</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="to-discover-a-cluster-when-each-instance-in-a-cluster-is-running-on-a-different-host"><a class="anchor" href="#to-discover-a-cluster-when-each-instance-in-a-cluster-is-running-on-a-different-host"></a>To Discover a Cluster When Each Instance in a Cluster Is Running on a Different Host</h5>
<div class="paragraph">
<p>If all instances in a cluster and the DAS are running on different
hosts, you can specify the locations of instances to use for discovering
the cluster as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>By specifying a list of host names or Internet Protocol (IP)
addresses. Each host name or IP address must locate a host on which the
DAS or a Eclipse GlassFish instance in the cluster is running. Instances
that are joining the cluster will use the DAS or the instances to
discover the cluster.</p>
</li>
<li>
<p>By generating the list of locations automatically. The generated list
contains the locations of the DAS and all instances in the cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Multiple instances on the same host cannot be members of the same
cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>When creating the cluster, set the properties of the cluster as
follows:</p>
<div class="ulist">
<ul>
<li>
<p>Set the <code>GMS_DISCOVERY_URI_LIST</code> property to one of the following
values:</p>
<div class="ulist">
<ul>
<li>
<p>A comma-separated list of IP addresses or host names on which the DAS
or the instances to use for discovering the cluster are running.</p>
<div class="paragraph">
<p>The list can contain a mixture of IP addresses and host names.</p>
</div>
</li>
<li>
<p>The keyword <code>generate</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Set the <code>GMS_LISTENER_PORT</code> property to a port number that is unique
for the cluster in the domain.</p>
<div class="paragraph">
<p>If you are specifying a list of IP addresses or host names, type the
following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --properties GMS_DISCOVERY_URI_LIST=host-list:
GMS_LISTENER_PORT=gms-port cluster-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are specifying the keyword <code>generate</code>, type the following
command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --properties GMS_DISCOVERY_URI_LIST=generate:
GMS_LISTENER_PORT=gms-port cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">host-list</dt>
<dd>
<p>A comma-separated list of IP addresses or host names on which the DAS
or the instances to use for discovering the cluster are running.</p>
</dd>
<dt class="hdlist1">gms-port</dt>
<dd>
<p>The port number of the port on which the cluster listens for messages
from GMS.</p>
</dd>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are creating.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For complete instructions for creating a cluster, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="clusters-example-4-4" class="paragraph">
<p>Example 4-4 Discovering a Cluster by Specifying a List of IP Addresses</p>
</div>
<div class="paragraph">
<p>This example creates a cluster that is named <code>ipcluster</code> for which GMS
is not using multicast for broadcasting messages. The instances to use
for discovering the cluster are located through a list of IP addresses.
In this example, one instance in the cluster is running on each host and
the DAS is running on a separate host. The cluster listens for messages
from GMS on port 9090.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --properties 'GMS_DISCOVERY_URI_LIST=
10.152.23.225,10.152.23.226,10.152.23.227,10.152.23.228:
GMS_LISTENER_PORT=9090' ipcluster
Command create-cluster executed successfully.</code></pre>
</div>
</div>
<div id="clusters-example-4-5" class="paragraph">
<p>Example 4-5 Discovering a Cluster by Generating a List of Locations of
Instances</p>
</div>
<div class="paragraph">
<p>This example creates a cluster that is named <code>gencluster</code> for which GMS
is not using multicast for broadcasting messages. The list of locations
of instances to use for discovering the cluster is generated
automatically. In this example, one instance in the cluster is running
on each host and the DAS is running on a separate host. The cluster
listens for messages from GMS on port 9090.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --properties 'GMS_DISCOVERY_URI_LIST=generate:
GMS_LISTENER_PORT=9090' gencluster
Command create-cluster executed successfully.</code></pre>
</div>
</div>
<div id="GSHAG492" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After creating the cluster, add instances to the cluster as explained in
the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-a-cluster">To Create a Cluster</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-the-multi-homing-feature-with-gms"><a class="anchor" href="#using-the-multi-homing-feature-with-gms"></a>Using the Multi-Homing Feature With GMS</h4>
<div class="paragraph">
<p>Multi-homing enables Eclipse GlassFish clusters to be used in an
environment that uses multiple Network Interface Cards (NICs). A
multi-homed host has multiple network connections, of which the
connections may or may not be the on same network. Multi-homing provides
the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provides redundant network connections within the same subnet. Having
multiple NICs ensures that one or more network connections are available
for communication.</p>
</li>
<li>
<p>Supports communication across two or more different subnets. The DAS
and all server instances in the same cluster must be on the same subnet
for GMS communication, however.</p>
</li>
<li>
<p>Binds to a specific IPv4 address and receives GMS messages in a system
that has multiple IP addresses configured. The responses for GMS
messages received on a particular interface will also go out through
that interface.</p>
</li>
<li>
<p>Supports separation of external and internal traffic.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="traffic-separation-using-multi-homing"><a class="anchor" href="#traffic-separation-using-multi-homing"></a>Traffic Separation Using Multi-Homing</h5>
<div class="paragraph">
<p>You can separate the internal traffic resulting from GMS from the
external traffic. Traffic separation enables you plan a network better
and augment certain parts of the network, as required.</p>
</div>
<div class="paragraph">
<p>Consider a simple cluster, <code>c1</code>, with three instances, <code>i101</code>, <code>i102</code>,
and <code>i103</code>. Each instance runs on a different machine. In order to
separate the traffic, the multi-homed machine should have at least two
IP addresses belonging to different networks. The first IP as the
external IP and the second one as internal IP. The objective is to
expose the external IP to user requests, so that all the traffic from
the user requests would be through them. The internal IP is used only by
the cluster instances for internal communication through GMS. The
following procedure describes how to set up traffic separation.</p>
</div>
<div class="paragraph">
<p>To configure multi-homed machines for GMS without traffic separation,
skip the steps or commands that configure the <code>EXTERNAL-ADDR</code> system
property, but perform the others.</p>
</div>
<div class="paragraph">
<p>To avoid having to restart the DAS or cluster, perform the following
steps in the specified order.</p>
</div>
<div class="paragraph">
<p>To set up traffic separation, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the system properties <code>EXTERNAL-ADDR</code> and
<code>GMS-BIND-INTERFACE-ADDRESS-c1</code> for the DAS.</p>
<div class="ulist">
<ul>
<li>
<p><code>asadmin create-system-properties</code> <code>target</code>
<code>server EXTERNAL-ADDR=192.155.35.4</code></p>
</li>
<li>
<p><code>asadmin create-system-properties</code> <code>target</code>
<code>server GMS-BIND-INTERFACE-ADDRESS-c1=10.12.152.20</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Create the cluster with the default settings.</p>
<div class="paragraph">
<p>Use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin create-cluster c1</code></pre>
</div>
</div>
<div class="paragraph">
<p>A reference to a system property for GMS traffic is already set up by
default in the <code>gms-bind-interface-address</code> cluster setting. The default
value of this setting is <code>${GMS-BIND-INTERFACE-ADDRESS-</code>cluster-name<code>}</code>.</p>
</div>
</li>
<li>
<p>When creating the clustered instances, configure the external and
GMS IP addresses.</p>
<div class="paragraph">
<p>Use the following commands:
* <code>asadmin create-instance</code> <code>node</code> <code>localhost</code> <code>cluster</code> <code>c1</code>
<code>systemproperties</code>
<code>EXTERNAL-ADDR=192.155.35.5:GMS-BIND-INTERFACE-ADDRESS-c1=10.12.152.30 i101</code>
* <code>asadmin create-instance</code> <code>node</code> <code>localhost</code> <code>cluster</code> <code>c1</code>
<code>systemproperties</code>
<code>EXTERNAL-ADDR=192.155.35.6:GMS-BIND-INTERFACE-ADDRESS-c1=10.12.152.40 i102</code>
* <code>asadmin create-instance</code> <code>node</code> <code>localhost</code> <code>cluster</code> <code>c1</code>
<code>systemproperties</code>
<code>EXTERNAL-ADDR=192.155.35.7:GMS-BIND-INTERFACE-ADDRESS-c1=10.12.152.50 i103</code></p>
</div>
</li>
<li>
<p>Set the address attribute of HTTP listeners to refer to the
<code>EXTERNAL-ADDR</code> system properties.</p>
<div class="paragraph">
<p>Use the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin set c1-config.network-config.network-listeners.network-listener.http-1.address=\${EXTERNAL-ADDR}
asadmin set c1-config.network-config.network-listeners.network-listener.http-2.address=\${EXTERNAL-ADDR}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-listing-and-deleting-clusters"><a class="anchor" href="#creating-listing-and-deleting-clusters"></a>Creating, Listing, and Deleting Clusters</h3>
<div class="paragraph">
<p>Eclipse GlassFish enables you to create clusters, obtain information
about clusters, and delete clusters that are no longer required.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-a-cluster">To Create a Cluster</a></p>
</li>
<li>
<p><a href="#to-list-all-clusters-in-a-domain">To List All Clusters in a Domain</a></p>
</li>
<li>
<p><a href="#to-delete-a-cluster">To Delete a Cluster</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-create-a-cluster"><a class="anchor" href="#to-create-a-cluster"></a>To Create a Cluster</h4>
<div class="paragraph">
<p>Use the <code>create-cluster</code> subcommand in remote mode to create a cluster.</p>
</div>
<div class="paragraph">
<p>To ensure that the GMS can detect changes in cluster membership, a
cluster&#8217;s GMS settings must be configured correctly. To avoid the need
to restart the DAS and the cluster, configure a cluster&#8217;s GMS settings
when you create the cluster. If you change GMS settings for an existing
cluster, the DAS and the cluster must be restarted to apply the changes.</p>
</div>
<div class="paragraph">
<p>When you create a cluster, Eclipse GlassFish automatically creates a
Message Queue cluster for the Eclipse GlassFish cluster. For more
information about Message Queue clusters, see <a href="#using-message-queue-broker-clusters-with-glassfish-server">Using
Message Queue Broker Clusters With Eclipse GlassFish</a>.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>If the cluster is to reference an existing named configuration, ensure
that the configuration exists. For more information, see
<a href="#to-create-a-named-configuration">To Create a Named Configuration</a>. If
you are using a named configuration to preconfigure GMS settings, ensure
that these settings have the required values in the named configuration.
For more information, see <a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS
Configuration Settings</a>.</p>
</div>
<div class="paragraph">
<p>If you are configuring the cluster&#8217;s GMS settings when you create the
cluster, ensure that you have the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The address on which GMS listens for group events</p>
</li>
<li>
<p>The port number of the communication port on which GMS listens for
group events</p>
</li>
<li>
<p>The maximum number of iterations or transmissions that a multicast
message for GMS events can experience before the message is discarded</p>
</li>
<li>
<p>The lowest port number in the range of ports from which GMS selects a
TCP port on which to listen</p>
</li>
<li>
<p>The highest port number in the range of ports from which GMS selects a
TCP port on which to listen</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the DAS is running on a multihome host, ensure that you have the
Internet Protocol (IP) address of the network interface on the DAS host
to which GMS binds.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p><a id="gkrco"></a>
Run the <code>create-cluster</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for configuring the
cluster, see the <a href="reference-manual.html#create-cluster"><code>create-cluster</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>If multicast transport is available, run the <code>create-cluster</code>
subcommand as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --config configuration
--multicastaddress multicast-address --multicastport multicast-port
--properties GMS_MULTICAST_TIME_TO_LIVE=max-iterations:
GMS_TCPSTARTPORT=start-port:GMS_TCPENDPORT=end-port cluster-name</code></pre>
</div>
</div>
</li>
<li>
<p>If multicast transport is not available, run the <code>create-cluster</code>
subcommand as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --config configuration
--properties GMS_DISCOVERY_URI_LIST=discovery-instances:
GMS_LISTENER_PORT=gms-port
cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">configuration</dt>
<dd>
<p>An existing named configuration that the cluster is to reference.</p>
</dd>
<dt class="hdlist1">multicast-address</dt>
<dd>
<p>The address on which GMS listens for group events.</p>
</dd>
<dt class="hdlist1">multicast-port</dt>
<dd>
<p>The port number of the communication port on which GMS listens for
group events.</p>
</dd>
<dt class="hdlist1">max-iterations</dt>
<dd>
<p>The maximum number of iterations or transmissions that a multicast
message for GMS events can experience before the message is discarded.</p>
</dd>
<dt class="hdlist1">discovery-instances</dt>
<dd>
<p>Instances to use for discovering the cluster. For more information,
see <a href="#discovering-a-cluster-when-multicast-transport-is-unavailable">Discovering a Cluster When Multicast Transport Is
Unavailable</a>.</p>
</dd>
<dt class="hdlist1">gms-port</dt>
<dd>
<p>The port number of the port on which the cluster listens for messages
from GMS.</p>
</dd>
<dt class="hdlist1">start-port</dt>
<dd>
<p>The lowest port number in the range of ports from which GMS selects a
TCP port on which to listen. The default is 9090.</p>
</dd>
<dt class="hdlist1">end-port</dt>
<dd>
<p>The highest port number in the range of ports from which GMS selects a
TCP port on which to listen. The default is 9200.</p>
</dd>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>Your choice of name for the cluster that you are creating.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If necessary, create a system property to represent the IP address
of the network interface on the DAS host to which GMS binds.</p>
<div class="paragraph">
<p>This step is necessary only if the DAS is running on a multihome host.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-system-properties
GMS-BIND-INTERFACE-ADDRESS-cluster-name=das-bind-address</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name that you assigned to the cluster in Step <a href="#gkrco">2</a>.</p>
</dd>
<dt class="hdlist1">das-bind-address</dt>
<dd>
<p>The IP address of the network interface on the DAS host to which GMS
binds.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="clusters-example-4-6" class="paragraph">
<p>Example 4-6 Creating a Cluster for a Network in Which Multicast
Transport Is Available</p>
</div>
<div class="paragraph">
<p>This example creates a cluster that is named <code>ltscluster</code> for which port
1169 is to be used for secure IIOP connections. Because the <code>--config</code>
option is not specified, the cluster references a copy of the named
configuration <code>default-config</code> that is named <code>ltscluster-config</code>. This
example assumes that multicast transport is available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster
--systemproperties IIOP_SSL_LISTENER_PORT=1169
ltscluster
Command create-cluster executed successfully.</code></pre>
</div>
</div>
<div id="clusters-example-4-7" class="paragraph">
<p>Example 4-7 Creating a Cluster and Setting GMS Options for a Network in
Which Multicast Transport Is Available</p>
</div>
<div class="paragraph">
<p>This example creates a cluster that is named <code>pmdcluster</code>, which
references the existing configuration <code>clusterpresets</code> and for which the
cluster&#8217;s GMS settings are configured as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GMS listens for group events on address 228.9.3.1 and port 2048.</p>
</li>
<li>
<p>A multicast message for GMS events is discarded after 3 iterations or
transmissions.</p>
</li>
<li>
<p>GMS selects a TCP port on which to listen from ports in the range
10000-10100.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example assumes that multicast transport is available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-cluster --config clusterpresets
--multicastaddress 228.9.3.1 --multicastport 2048
--properties GMS_MULTICAST_TIME_TO_LIVE=3:
GMS_TCPSTARTPORT=10000:GMS_TCPENDPORT=10100 pmdcluster
Command create-cluster executed successfully.</code></pre>
</div>
</div>
<div id="GSHAG375" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After creating a cluster, you can add Eclipse GlassFish instances to the
cluster as explained in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-a-named-configuration">To Create a Named Configuration</a></p>
</li>
<li>
<p><a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS Configuration Settings</a></p>
</li>
<li>
<p><a href="#using-message-queue-broker-clusters-with-glassfish-server">Using Message Queue Broker Clusters With Eclipse GlassFish</a></p>
</li>
<li>
<p><a href="reference-manual.html#create-cluster"><code>create-cluster</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#create-system-properties"><code>create-system-properties</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help create-cluster</code></p>
</li>
<li>
<p><code>asadmin help create-system-properties</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-list-all-clusters-in-a-domain"><a class="anchor" href="#to-list-all-clusters-in-a-domain"></a>To List All Clusters in a Domain</h4>
<div class="paragraph">
<p>Use the <code>list-clusters</code> subcommand in remote mode to obtain information
about existing clusters in a domain.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#list-clusters"><code>list-clusters</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="clusters-example-4-8" class="paragraph">
<p>Example 4-8 Listing All Clusters in a Domain</p>
</div>
<div class="paragraph">
<p>This example lists all clusters in the current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters
pmdclust not running
ymlclust not running
Command list-clusters executed successfully.</code></pre>
</div>
</div>
<div id="clusters-example-4-9" class="paragraph">
<p>Example 4-9 Listing All Clusters That Are Associated With a Node</p>
</div>
<div class="paragraph">
<p>This example lists the clusters that contain an instance that resides on
the node <code>sj01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters sj01
ymlclust not running
Command list-clusters executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#list-clusters"><code>list-clusters</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help list-clusters</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-delete-a-cluster"><a class="anchor" href="#to-delete-a-cluster"></a>To Delete a Cluster</h4>
<div class="paragraph">
<p>Use the <code>delete-cluster</code> subcommand in remote mode to remove a cluster
from the DAS configuration.</p>
</div>
<div class="paragraph">
<p>If the cluster&#8217;s named configuration was created automatically for the
cluster and no other clusters or unclustered instances refer to the
configuration, the configuration is deleted when the cluster is deleted.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The cluster that you are deleting is stopped. For information about
how to stop a cluster, see <a href="#to-stop-a-cluster">To Stop a Cluster</a>.</p>
</li>
<li>
<p>The cluster that you are deleting contains no Eclipse GlassFish
instances. For information about how to remove instances from a cluster,
see the following sections:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Confirm that the cluster is stopped.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are deleting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Confirm that the cluster contains no instances.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are deleting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#delete-cluster"><code>delete-cluster</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-cluster cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are deleting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="clusters-example-4-10" class="paragraph">
<p>Example 4-10 Deleting a Cluster</p>
</div>
<div class="paragraph">
<p>This example confirms that the cluster <code>adccluster</code> is stopped and
contains no instances and deletes the cluster <code>adccluster</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters adccluster
adccluster not running
Command list-clusters executed successfully.
asadmin&gt; list-instances adccluster
Nothing to list.
Command list-instances executed successfully.
asadmin&gt; delete-cluster adccluster
Command delete-cluster executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-stop-a-cluster">To Stop a Cluster</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-cluster"><code>delete-cluster</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-clusters"><code>list-clusters</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help delete-cluster</code></p>
</li>
<li>
<p><code>asadmin help list-clusters</code></p>
</li>
<li>
<p><code>asadmin help list-instances</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administering-glassfish-server-instances"><a class="anchor" href="#administering-glassfish-server-instances"></a>5 Administering Eclipse GlassFish Instances</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Eclipse GlassFish instance is a single Virtual Machine for the Java
platform (Java Virtual Machine or JVM machine) on a single node in which
Eclipse GlassFish is running. A node defines the host where the Eclipse GlassFish instance resides. The JVM machine must be compatible with the
Java Platform, Enterprise Edition (Jakarta EE).</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish instances form the basis of an application deployment.
An instance is a building block in the clustering, load balancing, and
session persistence features of Eclipse GlassFish. Each instance belongs
to a single domain and has its own directory structure, configuration,
and deployed applications. Every instance contains a reference to a node
that defines the host where the instance resides.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#types-of-glassfish-server-instances">Types of Eclipse GlassFish Instances</a></p>
</li>
<li>
<p><a href="#administering-glassfish-server-instances-centrally">Administering Eclipse GlassFish Instances Centrally</a></p>
</li>
<li>
<p><a href="#administering-glassfish-server-instances-locally">Administering Eclipse GlassFish Instances Locally</a></p>
</li>
<li>
<p><a href="#resynchronizing-glassfish-server-instances-and-the-das">Resynchronizing Eclipse GlassFish Instances and the DAS</a></p>
</li>
<li>
<p><a href="#migrating-ejb-timers">Migrating EJB Timers</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="types-of-glassfish-server-instances"><a class="anchor" href="#types-of-glassfish-server-instances"></a>Types of Eclipse GlassFish Instances</h3>
<div class="paragraph">
<p>Each Eclipse GlassFish instance is one of the following types of
instance:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Standalone instance</dt>
<dd>
<p>A standalone instance does not share its configuration with any other
instances or clusters. A standalone instance is created if either of
the following conditions is met:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>No configuration or cluster is specified in the command to create   the instance.</p>
</li>
<li>
<p>A configuration that is not referenced by any other instances or
clusters is specified in the command to create the instance.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>When no configuration or cluster is specified, a copy of the
<code>default-config</code> configuration is created for the instance. The name
of this configuration is instance-name`-config`, where instance-name
represents the name of an unclustered server instance.</p>
</div>
</dd>
<dt class="hdlist1">Shared instance</dt>
<dd>
<p>A shared instance shares its configuration with other instances or
clusters. A shared instance is created if a configuration that is
referenced by other instances or clusters is specified in the command
to create the instance.</p>
</dd>
<dt class="hdlist1">Clustered instance</dt>
<dd>
<p>A clustered instance inherits its configuration from the cluster to
which the instance belongs and shares its configuration with other
instances in the cluster. A clustered instance is created if a cluster
is specified in the command to create the instance.<br>
Any instance that is not part of a cluster is considered an
unclustered server instance. Therefore, standalone instances and
shared instances are unclustered server instances.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="administering-glassfish-server-instances-centrally"><a class="anchor" href="#administering-glassfish-server-instances-centrally"></a>Administering Eclipse GlassFish Instances Centrally</h3>
<div class="paragraph">
<p>Centralized administration requires the  secure shell (SSH) to be set up. If
SSH is set up, you can administer clustered instances without the
need to log in to hosts where remote instances reside. For information
about setting up SSH, see <a href="#enabling-centralized-administration-of-glassfish-server-instances">Enabling
Centralized Administration of Eclipse GlassFish Instances</a>.</p>
</div>
<div class="paragraph">
<p>Administering Eclipse GlassFish instances centrally involves the
following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-list-all-instances-in-a-domain">To List All Instances in a Domain</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-start-a-cluster">To Start a Cluster</a></p>
</li>
<li>
<p><a href="#to-stop-a-cluster">To Stop a Cluster</a></p>
</li>
<li>
<p><a href="#to-start-an-individual-instance-centrally">To Start an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-restart-an-individual-instance-centrally">To Restart an Individual Instance Centrally</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-create-an-instance-centrally"><a class="anchor" href="#to-create-an-instance-centrally"></a>To Create an Instance Centrally</h4>
<div class="paragraph">
<p>Use the <code>create-instance</code> subcommand in remote mode to create a
Eclipse GlassFish instance centrally. Creating an instance adds the
instance to the DAS configuration and creates the instance&#8217;s files on
the host where the instance resides.</p>
</div>
<div class="paragraph">
<p>If the instance is a clustered instance that is managed by GMS, system
properties for the instance that relate to GMS must be configured
correctly. To avoid the need to restart the DAS and the instance,
configure an instance&#8217;s system properties that relate to GMS when you
create the instance. If you change GMS-related system properties for an
existing instance, the DAS and the instance must be restarted to apply
the changes. For information about GMS, see
<a href="#group-management-service">Group Management Service</a>.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The node where the instance is to reside exists.</p>
</li>
<li>
<p>The node where the instance is to reside is either enabled for remote
communication or represents the host on which the DAS is running. For
information about how to create a node that is enabled for remote
communication, see the following section:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>The user of the DAS can use SSH to log in to the host for the
node where the instance is to reside.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these prerequisites is not met, create the instance locally as
explained in <a href="#to-create-an-instance-locally">To Create an Instance Locally</a>.</p>
</div>
<div class="paragraph">
<p>If you are adding the instance to a cluster, ensure that the cluster to
which you are adding the instance exists. For information about how to
create a cluster, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</div>
<div class="paragraph">
<p>If the instance is to reference an existing named configuration, ensure
that the configuration exists. For more information, see
<a href="#to-create-a-named-configuration">To Create a Named Configuration</a>.</p>
</div>
<div class="paragraph">
<p>The instance might be a clustered instance that is managed by GMS and
resides on a node that represents a multihome host. In this situation,
ensure that you have the Internet Protocol (IP) address of the network
interface to which GMS binds.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>create-instance</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for configuring the
instance, see the <a href="reference-manual.html#create-instance"><code>create-instance</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are creating a standalone instance, do not specify a cluster.</p>
<div class="paragraph">
<p>If the instance is to reference an existing configuration, specify a
configuration that no other cluster or instance references.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-instance --node node-name
[--config configuration-name]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance is to reside.</p>
</dd>
<dt class="hdlist1">configuration-name</dt>
<dd>
<p>The name of the existing named configuration that the instance will reference.<br>
If you do not require the instance to reference an existing
configuration, omit this option. A copy of the <code>default-config</code>
configuration is created for the instance. The name of this
configuration is instance-name`-config`, where instance-name is the
name of the server instance.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>Your choice of name for the instance that you are creating.<br>
If you are creating a shared instance, specify the configuration that
the instance will share with other clusters or instances.<br>
Do not specify a cluster.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-instance --node node-name
--config configuration-name instance-name</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance is to reside.</p>
</dd>
<dt class="hdlist1">configuration-name</dt>
<dd>
<p>The name of the existing named configuration that the instance will
reference.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>Your choice of name for the instance that you are creating.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>If you are creating a clustered instance, specify the cluster to which
the instance will belong.<br>
If the instance is managed by GMS and resides on a node that represents
a multihome host, specify the `GMS-BIND-INTERFACE-ADDRESS-`cluster-name
system property.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-instance --cluster cluster-name --node node-name
[--systemproperties GMS-BIND-INTERFACE-ADDRESS-cluster-name=bind-address]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster to which you are adding the instance.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance is to reside.</p>
</dd>
<dt class="hdlist1">bind-address</dt>
<dd>
<p>The IP address of the network interface to which GMS binds. Specify
this option only if the instance is managed by GMS and resides on a
node that represents a multihome host.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>Your choice of name for the instance that you are creating.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="gkqmv" class="paragraph">
<p>Example 5-1 Creating a Clustered Instance Centrally</p>
</div>
<div class="paragraph">
<p>This example adds the instance <code>pmd-i1</code> to the cluster <code>pmdclust</code> in the
domain <code>domain1</code>. The instance resides on the node <code>sj01</code>, which
represents the host <code>sj01.example.com</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-instance --cluster pmdclust --node sj01 pmd-i1
Port Assignments for server instance pmd-i1:
JMX_SYSTEM_CONNECTOR_PORT=28686
JMS_PROVIDER_PORT=27676
HTTP_LISTENER_PORT=28080
ASADMIN_LISTENER_PORT=24848
IIOP_SSL_LISTENER_PORT=23820
IIOP_LISTENER_PORT=23700
HTTP_SSL_LISTENER_PORT=28181
IIOP_SSL_MUTUALAUTH_PORT=23920
The instance, pmd-i1, was created on host sj01.example.com
Command create-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#create-instance"><code>create-instance</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help create-instance</code> at the command line.</p>
</div>
<div id="GSHAG382" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After creating an instance, you can start the instance as explained in
the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-start-an-individual-instance-centrally">To Start an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-list-all-instances-in-a-domain"><a class="anchor" href="#to-list-all-instances-in-a-domain"></a>To List All Instances in a Domain</h4>
<div class="paragraph">
<p>Use the <code>list-instances</code> subcommand in remote mode to obtain information
about existing instances in a domain.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#list-instances"><code>list-instances</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="gksfe" class="paragraph">
<p>Example 5-2 Listing Basic Information About All Eclipse GlassFish
Instances in a Domain</p>
</div>
<div class="paragraph">
<p>This example lists the name and status of all Eclipse GlassFish instances
in the current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances
pmd-i2 running
yml-i2 running
pmd-i1 running
yml-i1 running
pmdsa1 not running
Command list-instances executed successfully.</code></pre>
</div>
</div>
<div id="gkabz" class="paragraph">
<p>Example 5-3 Listing Detailed Information About All Eclipse GlassFish
Instances in a Domain</p>
</div>
<div class="paragraph">
<p>This example lists detailed information about all Eclipse GlassFish
instances in the current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances --long=true
NAME    HOST              PORT   PID    CLUSTER     STATE
pmd-i1  sj01.example.com  24848  31310  pmdcluster   running
yml-i1  sj01.example.com  24849  25355  ymlcluster   running
pmdsa1  localhost         24848  -1     ---          not running
pmd-i2  sj02.example.com  24848  22498  pmdcluster   running
yml-i2  sj02.example.com  24849  20476  ymlcluster   running
ymlsa1  localhost         24849  -1     ---          not running
Command list-instances executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help list-instances</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-delete-an-instance-centrally"><a class="anchor" href="#to-delete-an-instance-centrally"></a>To Delete an Instance Centrally</h4>
<div class="paragraph">
<p>Use the <code>delete-instance</code> subcommand in remote mode to delete a
Eclipse GlassFish instance centrally.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using a Java Message Service (JMS) cluster with a master
broker, do not delete the instance that is associated with the master
broker. If this instance must be deleted, use the
<a href="reference-manual.html#change-master-broker"><code>change-master-broker</code></a> subcommand to assign the master
broker to a different instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deleting an instance involves the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removing the instance from the configuration of the DAS</p>
</li>
<li>
<p>Deleting the instance&#8217;s files from file system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the instance that you are deleting is not running. For
information about how to stop an instance, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Confirm that the instance is not running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are deleting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#delete-instance"><code>delete-instance</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-instance instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are deleting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="gkqms" class="paragraph">
<p>Example 5-4 Deleting an Instance Centrally</p>
</div>
<div class="paragraph">
<p>This example confirms that the instance <code>pmd-i1</code> is not running and
deletes the instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances pmd-i1
pmd-i1   not running
Command list-instances executed successfully.
asadmin&gt; delete-instance pmd-i1
Command _delete-instance-filesystem executed successfully.
The instance, pmd-i1, was deleted from host sj01.example.com
Command delete-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#change-master-broker"><code>change-master-broker</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-instance"><code>delete-instance</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help delete-instance</code></p>
</li>
<li>
<p><code>asadmin help list-instances</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-start-a-cluster"><a class="anchor" href="#to-start-a-cluster"></a>To Start a Cluster</h4>
<div class="paragraph">
<p>Use the <code>start-cluster</code> subcommand in remote mode to start a cluster.</p>
</div>
<div class="paragraph">
<p>Starting a cluster starts all instances in the cluster that are not
already running.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each node where an instance in the cluster resides is either enabled
for remote communication or represents the host on which the DAS is
running.</p>
</li>
<li>
<p>The user of the DAS can use SSH to log in to the host for any
node where instances in the cluster reside.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these prerequisites is not met, start the cluster by starting
each instance locally as explained in <a href="#to-start-an-individual-instance-locally">To Start an Individual
Instance Locally</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#start-cluster"><code>start-cluster</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-cluster cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are starting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqml" class="paragraph">
<p>Example 5-5 Starting a Cluster</p>
</div>
<div class="paragraph">
<p>This example starts the cluster <code>pmdcluster</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-cluster pmdcluster
Command start-cluster executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-start-an-individual-instance-locally">To Start an Individual Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#start-cluster"><code>start-cluster</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help start-cluster</code> at the command line.</p>
</div>
<div id="GSHAG388" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After starting a cluster, you can deploy applications to the cluster.
For more information, see <a href="application-deployment-guide.html#GSDPG">Eclipse GlassFish Application Deployment Guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-stop-a-cluster"><a class="anchor" href="#to-stop-a-cluster"></a>To Stop a Cluster</h4>
<div class="paragraph">
<p>Use the <code>stop-cluster</code> subcommand in remote mode to stop a cluster.</p>
</div>
<div class="paragraph">
<p>Stopping a cluster stops all running instances in the cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#stop-cluster"><code>stop-cluster</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; stop-cluster cluster-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster that you are stopping.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqmn" class="paragraph">
<p>Example 5-6 Stopping a Cluster</p>
</div>
<div class="paragraph">
<p>This example stops the cluster <code>pmdcluster</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; stop-cluster pmdcluster
Command stop-cluster executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#stop-cluster"><code>stop-cluster</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help stop-cluster</code> at the command line.</p>
</div>
<div id="GSHAG390" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>If instances in the cluster have become unresponsive and fail to stop,
run the subcommand again with the <code>--kill</code> option set to <code>true</code>. When
this option is <code>true</code>, the subcommand uses functionality of the
operating system to kill the process for each running instance in the
cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-start-an-individual-instance-centrally"><a class="anchor" href="#to-start-an-individual-instance-centrally"></a>To Start an Individual Instance Centrally</h4>
<div class="paragraph">
<p>Use the <code>start-instance</code> subcommand in remote mode to start an
individual instance centrally.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The node where the instance resides is either enabled for remote
communication or represents the host on which the DAS is running.</p>
</li>
<li>
<p>The user of the DAS can use SSH to log in to the host for the
node where the instance resides.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these prerequisites is not met, start the instance locally as
explained in <a href="#to-start-an-individual-instance-locally">To Start an Individual Instance Locally</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>start-instance</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-instance instance-name</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for controlling the
behavior of the instance, see the <a href="reference-manual.html#start-instance"><code>start-instance</code>(1)</a>
help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are starting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqoa" class="paragraph">
<p>Example 5-7 Starting an Individual Instance Centrally</p>
</div>
<div class="paragraph">
<p>This example starts the instance <code>pmd-i2</code>, which resides on the node
<code>sj02</code>. This node represents the host <code>sj02.example.com</code>. The
configuration of the instance on this node already matched the
configuration of the instance in the DAS when the instance was started.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-instance pmd-i2
CLI801 Instance is already synchronized
Waiting for pmd-i2 to start ............
Successfully started the instance: pmd-i2
instance Location: /export/glassfish7/glassfish/nodes/sj02/pmd-i2
Log File: /export/glassfish7/glassfish/nodes/sj02/pmd-i2/logs/server.log
Admin Port: 24851
Command start-local-instance executed successfully.
The instance, pmd-i2, was started on host sj02.example.com
Command start-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#start-instance"><code>start-instance</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help start-instance</code> at the command line.</p>
</div>
<div id="GSHAG393" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After starting an instance, you can deploy applications to the instance.
For more information, see the <a href="application-deployment-guide.html#GSDPG">Eclipse GlassFish Application Deployment Guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-stop-an-individual-instance-centrally"><a class="anchor" href="#to-stop-an-individual-instance-centrally"></a>To Stop an Individual Instance Centrally</h4>
<div class="paragraph">
<p>Use the <code>stop-instance</code> subcommand in remote mode to stop an individual
instance centrally.</p>
</div>
<div class="paragraph">
<p>When an instance is stopped, the instance stops accepting new requests
and waits for all outstanding requests to be completed.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
<div class="paragraph">
<p>Remote subcommands require a running server.</p>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#stop-instance"><code>stop-instance</code></a> subcommand.</p>
</li>
</ol>
</div>
<div id="gkqpy" class="paragraph">
<p>Example 5-8 Stopping an Individual Instance Centrally</p>
</div>
<div class="paragraph">
<p>This example stops the instance <code>pmd-i2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; stop-instance pmd-i2
The instance, pmd-i2, is stopped.
Command stop-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#stop-instance"><code>stop-instance</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help stop-instance</code> at the command line.</p>
</div>
<div id="GSHAG395" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>If the instance has become unresponsive and fails to stop, run the
subcommand again with the <code>--kill</code> option set to <code>true</code>. When this
option is <code>true</code>, the subcommand uses functionality of the operating
system to kill the instance process.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-restart-an-individual-instance-centrally"><a class="anchor" href="#to-restart-an-individual-instance-centrally"></a>To Restart an Individual Instance Centrally</h4>
<div class="paragraph">
<p>Use the <code>restart-instance</code> subcommand in remote mode to start an
individual instance centrally.</p>
</div>
<div class="paragraph">
<p>When this subcommand restarts an instance, the DAS synchronizes the
instance with changes since the last synchronization as described in
<a href="#default-synchronization-for-files-and-directories">Default Synchronization for Files and Directories</a>.</p>
</div>
<div class="paragraph">
<p>If you require different synchronization behavior, stop and start the
instance as explained in <a href="#to-resynchronize-an-instance-and-the-das-online">To Resynchronize an Instance and
the DAS Online</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#restart-instance"><code>restart-instance</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; restart-instance instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are restarting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqqt" class="paragraph">
<p>Example 5-9 Restarting an Individual Instance Centrally</p>
</div>
<div class="paragraph">
<p>This example restarts the instance <code>pmd-i2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; restart-instance pmd-i2
pmd-i2 was restarted.
Command restart-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-start-an-individual-instance-centrally">To Start an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="reference-manual.html#restart-instance"><code>restart-instance</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help restart-instance</code> at the command line.</p>
</div>
<div id="GSHAG397" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>If the instance has become unresponsive and fails to stop, run the
subcommand again with the <code>--kill</code> option set to <code>true</code>. When this
option is <code>true</code>, the subcommand uses functionality of the operating
system to kill the instance process before restarting the instance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="administering-glassfish-server-instances-locally"><a class="anchor" href="#administering-glassfish-server-instances-locally"></a>Administering Eclipse GlassFish Instances Locally</h3>
<div class="paragraph">
<p>Local administration does not require SSH to be set up. If
SSH is not set up, you must log in to each host where
remote instances reside and administer the instances individually.</p>
</div>
<div class="paragraph">
<p>Administering Eclipse GlassFish instances locally involves the following
tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
</li>
<li>
<p><a href="#to-start-an-individual-instance-locally">To Start an Individual Instance Locally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
</li>
<li>
<p><a href="#to-restart-an-individual-instance-locally">To Restart an Individual Instance Locally</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Even if SSH is not set up, you can obtain information about
instances in a domain without logging in to each host where remote
instances reside. For instructions, see <a href="#to-list-all-instances-in-a-domain">To List All
Instances in a Domain</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="to-create-an-instance-locally"><a class="anchor" href="#to-create-an-instance-locally"></a>To Create an Instance Locally</h4>
<div class="paragraph">
<p>Use the <code>create-local-instance</code> subcommand in remote mode to create a
Eclipse GlassFish instance locally. Creating an instance adds the
instance to the DAS configuration and creates the instance&#8217;s files on
the host where the instance resides.</p>
</div>
<div class="paragraph">
<p>If the instance is a clustered instance that is managed by GMS, system
properties for the instance that relate to GMS must be configured
correctly. To avoid the need to restart the DAS and the instance,
configure an instance&#8217;s system properties that relate to GMS when you
create the instance. If you change GMS-related system properties for an
existing instance, the DAS and the instance must be restarted to apply
the changes. For information about GMS, see
<a href="#group-management-service">Group Management Service</a>.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>If you plan to specify the node on which the instance is to reside,
ensure that the node exists.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you create the instance on a host for which no nodes are defined, you
can create the instance without creating a node beforehand. In this
situation, Eclipse GlassFish creates a <code>CONFIG</code> node for you. The name of
the node is the unqualified name of the host.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For information about how to create a node, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a></p>
</li>
<li>
<p><a href="#to-create-a-config-node">To Create a <code>CONFIG</code> Node</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are adding the instance to a cluster, ensure that the cluster to
which you are adding the instance exists. For information about how to
create a cluster, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</div>
<div class="paragraph">
<p>If the instance is to reference an existing named configuration, ensure
that the configuration exists. For more information, see
<a href="#to-create-a-named-configuration">To Create a Named Configuration</a>.</p>
</div>
<div class="paragraph">
<p>The instance might be a clustered instance that is managed by GMS and
resides on a node that represents a multihome host. In this situation,
ensure that you have the Internet Protocol (IP) address of the network
interface to which GMS binds.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Log in to the host that is represented by the node where the
instance is to reside.</p>
</li>
<li>
<p>Run the <code>create-local-instance</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in this step.
For information about all the options for configuring the instance, see the
<a href="reference-manual.html#create-local-instance"><code>create-local-instance</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are creating a standalone instance, do not specify a cluster.</p>
<div class="paragraph">
<p>If the instance is to reference an existing configuration, specify a
configuration that no other cluster or instance references.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das-host [--port admin-port]
create-local-instance [--node node-name] [--config configuration-name]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">das-host</dt>
<dd>
<p>The name of the host where the DAS is running.</p>
</dd>
<dt class="hdlist1">admin-port</dt>
<dd>
<p>The HTTP or HTTPS port on which the DAS listens for administration
requests. If the DAS listens on the default port for administration
requests, you may omit this option.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance is to reside.<br>
If you are creating the instance on a host for which fewer than two
nodes are defined, you may omit this option.<br>
If no nodes are defined for the host, Eclipse GlassFish creates a
CONFIG node for you. The name of the node is the unqualified name of the host.<br>
If one node is defined for the host, the instance is created on that node.</p>
</dd>
<dt class="hdlist1">configuration-name</dt>
<dd>
<p>The name of the existing named configuration that the instance will reference.<br>
If you do not require the instance to reference an existing
configuration, omit this option. A copy of the <code>default-config</code>
configuration is created for the instance. The name of this
configuration is instance-name`-config`, where instance-name is the
name of the server instance.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>Your choice of name for the instance that you are creating.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>If you are creating a shared instance, specify the configuration that
the instance will share with other clusters or instances.<br>
Do not specify a cluster.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das-host [--port admin-port]
create-local-instance [--node node-name] --config configuration-name instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">das-host</dt>
<dd>
<p>The name of the host where the DAS is running.</p>
</dd>
<dt class="hdlist1">admin-port</dt>
<dd>
<p>The HTTP or HTTPS port on which the DAS listens for administration
requests. If the DAS listens on the default port for administration
requests, you may omit this option.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance is to reside.<br>
If you are creating the instance on a host for which fewer than two
nodes are defined, you may omit this option.<br>
If no nodes are defined for the host, Eclipse GlassFish creates a
<code>CONFIG</code> node for you. The name of the node is the unqualified name of the host.<br>
If one node is defined for the host, the instance is created on that node.</p>
</dd>
<dt class="hdlist1">configuration-name</dt>
<dd>
<p>The name of the existing named configuration that the instance will
reference.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>Your choice of name for the instance that you are creating.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>If you are creating a clustered instance, specify the cluster to which
the instance will belong.<br>
If the instance is managed by GMS and resides on a node that represents
a multihome host, specify the `GMS-BIND-INTERFACE-ADDRESS-`cluster-name
system property.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das-host [--port admin-port]
create-local-instance --cluster cluster-name [--node node-name]
[--systemproperties GMS-BIND-INTERFACE-ADDRESS-cluster-name=bind-address]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">das-host</dt>
<dd>
<p>The name of the host where the DAS is running.</p>
</dd>
<dt class="hdlist1">admin-port</dt>
<dd>
<p>The HTTP or HTTPS port on which the DAS listens for administration
requests. If the DAS listens on the default port for administration
requests, you may omit this option.</p>
</dd>
<dt class="hdlist1">cluster-name</dt>
<dd>
<p>The name of the cluster to which you are adding the instance.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance is to reside.<br>
If you are creating the instance on a host for which fewer than two
nodes are defined, you may omit this option.<br>
If no nodes are defined for the host, Eclipse GlassFish creates a
<code>CONFIG</code> node for you. The name of the node is the unqualified name of the host.<br>
If one node is defined for the host, the instance is created on that node.</p>
</dd>
<dt class="hdlist1">bind-address</dt>
<dd>
<p>The IP address of the network interface to which GMS binds. Specify
this option only if the instance is managed by GMS and resides on a
node that represents a multihome host.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>Your choice of name for the instance that you are creating.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="gktfa" class="paragraph">
<p>Example 5-10 Creating a Clustered Instance Locally Without Specifying a Node</p>
</div>
<div class="paragraph">
<p>This example adds the instance <code>kui-i1</code> to the cluster <code>kuicluster</code>
locally. The <code>CONFIG</code> node <code>xk01</code> is created automatically to represent
the host <code>xk01.example.com</code>, on which this example is run. The DAS is
running on the host <code>dashost.example.com</code> and listens for administration
requests on the default port.</p>
</div>
<div class="paragraph">
<p>The commands to list the nodes in the domain are included in this
example only to demonstrate the creation of the node <code>xk01</code>.
These commands are not required to create the instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host dashost.example.com list-nodes --long
NODE NAME          TYPE    NODE HOST         INSTALL DIRECTORY   REFERENCED BY
localhost-domain1  CONFIG  localhost         /export/glassfish7
Command list-nodes executed successfully.
$ asadmin --host dashost.example.com
create-local-instance --cluster kuicluster kui-i1
Rendezvoused with DAS on dashost.example.com:4848.
Port Assignments for server instance kui-i1:
JMX_SYSTEM_CONNECTOR_PORT=28687
JMS_PROVIDER_PORT=27677
HTTP_LISTENER_PORT=28081
ASADMIN_LISTENER_PORT=24849
JAVA_DEBUGGER_PORT=29009
IIOP_SSL_LISTENER_PORT=23820
IIOP_LISTENER_PORT=23700
OSGI_SHELL_TELNET_PORT=26666
HTTP_SSL_LISTENER_PORT=28182
IIOP_SSL_MUTUALAUTH_PORT=23920
Command create-local-instance executed successfully.
$ asadmin --host dashost.example.com list-nodes --long
NODE NAME          TYPE    NODE HOST         INSTALL DIRECTORY   REFERENCED BY
localhost-domain1  CONFIG  localhost         /export/glassfish7
xk01               CONFIG  xk01.example.com  /export/glassfish7  kui-i1
Command list-nodes executed successfully.</code></pre>
</div>
</div>
<div id="gkqps" class="paragraph">
<p>Example 5-11 Creating a Clustered Instance Locally</p>
</div>
<div class="paragraph">
<p>This example adds the instance <code>yml-i1</code> to the cluster <code>ymlcluster</code>
locally. The instance resides on the node <code>sj01</code>. The DAS is running on
the host <code>das1.example.com</code> and listens for administration requests on
the default port.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das1.example.com
create-local-instance --cluster ymlcluster --node sj01 yml-i1
Rendezvoused with DAS on das1.example.com:4848.
Port Assignments for server instance yml-i1:
JMX_SYSTEM_CONNECTOR_PORT=28687
JMS_PROVIDER_PORT=27677
HTTP_LISTENER_PORT=28081
ASADMIN_LISTENER_PORT=24849
JAVA_DEBUGGER_PORT=29009
IIOP_SSL_LISTENER_PORT=23820
IIOP_LISTENER_PORT=23700
OSGI_SHELL_TELNET_PORT=26666
HTTP_SSL_LISTENER_PORT=28182
IIOP_SSL_MUTUALAUTH_PORT=23920
Command create-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-an-ssh-node">To Create an <code>SSH</code> Node</a></p>
</li>
<li>
<p><a href="#to-create-a-config-node">To Create a <code>CONFIG</code> Node</a></p>
</li>
<li>
<p><a href="reference-manual.html#create-local-instance"><code>create-local-instance</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help create-local-instance</code> at the command line.</p>
</div>
<div id="GSHAG400" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After creating an instance, you can start the instance as explained in
the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-start-an-individual-instance-centrally">To Start an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-delete-an-instance-locally"><a class="anchor" href="#to-delete-an-instance-locally"></a>To Delete an Instance Locally</h4>
<div class="paragraph">
<p>Use the <code>delete-local-instance</code> subcommand in remote mode to delete a
Eclipse GlassFish instance locally.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using a Java Message Service (JMS) cluster with a master
broker, do not delete the instance that is associated with the master
broker. If this instance must be deleted, use the
<a href="reference-manual.html#change-master-broker"><code>change-master-broker</code></a> subcommand to assign the master
broker to a different instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deleting an instance involves the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removing the instance from the configuration of the DAS</p>
</li>
<li>
<p>Deleting the instance&#8217;s files from file system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that the instance that you are deleting is not running. For
information about how to stop an instance, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Log in to the host that is represented by the node where the instance resides.</p>
</li>
<li>
<p>Confirm that the instance is not running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das-host [--port admin-port]
list-instances instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">das-host</dt>
<dd>
<p>The name of the host where the DAS is running.</p>
</dd>
<dt class="hdlist1">admin-port</dt>
<dd>
<p>The HTTP or HTTPS port on which the DAS listens for administration
requests. If the DAS listens on the default port for administration
requests, you may omit this option.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are deleting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#delete-local-instance"><code>delete-local-instance</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das-host [--port admin-port]
delete-local-instance [--node node-name]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">das-host</dt>
<dd>
<p>The name of the host where the DAS is running.</p>
</dd>
<dt class="hdlist1">admin-port</dt>
<dd>
<p>The HTTP or HTTPS port on which the DAS listens for administration
requests. If the DAS listens on the default port for administration
requests, you may omit this option.</p>
</dd>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance resides. If only one node is defined
for the Eclipse GlassFish installation that you are running on the
node&#8217;s host, you may omit this option.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are deleting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="gkqqu" class="paragraph">
<p>Example 5-12 Deleting an Instance Locally</p>
</div>
<div class="paragraph">
<p>This example confirms that the instance <code>yml-i1</code> is not running and
deletes the instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das1.example.com list-instances yml-i1
yml-i1   not running
Command list-instances executed successfully.
$ asadmin --host das1.example.com delete-local-instance --node sj01 yml-i1
Command delete-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-stop-an-individual-instance-centrally">To Stop an Individual Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-stop-an-individual-instance-locally">To Stop an Individual Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#change-master-broker"><code>change-master-broker</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-local-instance"><code>delete-local-instance</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help delete-local-instance</code></p>
</li>
<li>
<p><code>asadmin help list-instances</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-start-an-individual-instance-locally"><a class="anchor" href="#to-start-an-individual-instance-locally"></a>To Start an Individual Instance Locally</h4>
<div class="paragraph">
<p>Use the <code>start-local-instance</code> subcommand in local mode to start an
individual instance locally.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the host that is represented by the node where the instance resides.</p>
</li>
<li>
<p>Run the <code>start-local-instance</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin start-local-instance [--node node-name]instance-name</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for controlling the
behavior of the instance, see the
<a href="reference-manual.html#start-local-instance"><code>start-local-instance</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance resides. If only one node is defined
for the Eclipse GlassFish installation that you are running on the
node&#8217;s host, you may omit this option.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are starting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqpu" class="paragraph">
<p>Example 5-13 Starting an Individual Instance Locally</p>
</div>
<div class="paragraph">
<p>This example starts the instance <code>yml-i1</code> locally. The instance resides
on the node <code>sj01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin start-local-instance --node sj01 yml-i1
Waiting for yml-i1 to start ...............
Successfully started the instance: yml-i1
instance Location: /export/glassfish7/glassfish/nodes/sj01/yml-i1
Log File: /export/glassfish7/glassfish/nodes/sj01/yml-i1/logs/server.log
Admin Port: 24849
Command start-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#start-local-instance"><code>start-local-instance</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help start-local-instance</code> at the command line.</p>
</div>
<div id="GSHAG404" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>After starting an instance, you can deploy applications to the instance.
For more information, see the <a href="application-deployment-guide.html#GSDPG">Eclipse GlassFish Application Deployment Guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-stop-an-individual-instance-locally"><a class="anchor" href="#to-stop-an-individual-instance-locally"></a>To Stop an Individual Instance Locally</h4>
<div class="paragraph">
<p>Use the <code>stop-local-instance</code> subcommand in local mode to stop an
individual instance locally.</p>
</div>
<div class="paragraph">
<p>When an instance is stopped, the instance stops accepting new requests
and waits for all outstanding requests to be completed.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the host that is represented by the node where the
instance resides.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#stop-local-instance"><code>stop-local-instance</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin stop-local-instance [--node node-name]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance resides. If only one node is defined
for the Eclipse GlassFish installation that you are running on the
node&#8217;s host, you may omit this option.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are stopping.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqoo" class="paragraph">
<p>Example 5-14 Stopping an Individual Instance Locally</p>
</div>
<div class="paragraph">
<p>This example stops the instance <code>yml-i1</code> locally. The instance resides
on the node <code>sj01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin stop-local-instance --node sj01 yml-i1
Waiting for the instance to stop ....
Command stop-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#stop-local-instance"><code>stop-local-instance</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help stop-local-instance</code> at the command line.</p>
</div>
<div id="GSHAG406" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>If the instance has become unresponsive and fails to stop, run the
subcommand again with the <code>--kill</code> option set to <code>true</code>. When this
option is <code>true</code>, the subcommand uses functionality of the operating
system to kill the instance process.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-restart-an-individual-instance-locally"><a class="anchor" href="#to-restart-an-individual-instance-locally"></a>To Restart an Individual Instance Locally</h4>
<div class="paragraph">
<p>Use the <code>restart-local-instance</code> subcommand in local mode to restart an
individual instance locally.</p>
</div>
<div class="paragraph">
<p>When this subcommand restarts an instance, the DAS synchronizes the
instance with changes since the last synchronization as described in
<a href="#default-synchronization-for-files-and-directories">Default Synchronization for Files and Directories</a>.</p>
</div>
<div class="paragraph">
<p>If you require different synchronization behavior, stop and start the
instance as explained in <a href="#to-resynchronize-an-instance-and-the-das-online">To Resynchronize an Instance and
the DAS Online</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the host that is represented by the node where the instance resides.</p>
</li>
<li>
<p>Run the <code>restart-local-instance</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin restart-local-instance [--node node-name]instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance resides. If only one node is defined
for the Eclipse GlassFish installation that you are running on the
node&#8217;s host, you may omit this option.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are restarting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkqnt" class="paragraph">
<p>Example 5-15 Restarting an Individual Instance Locally</p>
</div>
<div class="paragraph">
<p>This example restarts the instance <code>yml-i1</code> locally. The instance
resides on the node <code>sj01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin restart-local-instance --node sj01 yml-i1
Command restart-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#restart-local-instance"><code>restart-local-instance</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help restart-local-instance</code> at the command line.</p>
</div>
<div id="GSHAG408" class="paragraph">
<p>Troubleshooting</p>
</div>
<div class="paragraph">
<p>If the instance has become unresponsive and fails to stop, run the
subcommand again with the <code>--kill</code> option set to <code>true</code>. When this
option is <code>true</code>, the subcommand uses functionality of the operating
system to kill the instance process before restarting the instance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resynchronizing-glassfish-server-instances-and-the-das"><a class="anchor" href="#resynchronizing-glassfish-server-instances-and-the-das"></a>Resynchronizing Eclipse GlassFish Instances and the DAS</h3>
<div class="paragraph">
<p>Configuration data for a Eclipse GlassFish instance is stored as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the repository of the domain administration server (DAS)</p>
</li>
<li>
<p>In a cache on the host that is local to the instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The configuration data in these locations must be synchronized. The
cache is synchronized in the following circumstances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Whenever an <code>asadmin</code> subcommand is run. For more information, see
"<a href="administration-guide.html#impact-of-configuration-changes">Impact of Configuration Changes</a>" in Eclipse GlassFish Administration Guide.</p>
</li>
<li>
<p>When a user uses the administration tools to start or restart an instance.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="default-synchronization-for-files-and-directories"><a class="anchor" href="#default-synchronization-for-files-and-directories"></a>Default Synchronization for Files and Directories</h4>
<div class="paragraph">
<p>The <code>--sync</code> option of the subcommands for starting an instance controls
the type of synchronization between the DAS and the instance&#8217;s files
when the instance is started. You can use this option to override the
default synchronization behavior for the files and directories of an
instance. For more information, see <a href="#to-resynchronize-an-instance-and-the-das-online">To Resynchronize an
Instance and the DAS Online</a>.</p>
</div>
<div class="paragraph">
<p>On the DAS, the files and directories of an instance are stored in the
domain-dir directory, where domain-dir is the directory in which a
domain&#8217;s configuration is stored. The default synchronization behavior
for the files and directories of an instance is as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>applications</code></dt>
<dd>
<p>This directory contains a subdirectory for each application that is
deployed to the instance.<br>
By default, only a change to an application&#8217;s top-level directory
within the application directory causes the DAS to synchronize that
application&#8217;s directory. When the DAS resynchronizes the
<code>applications</code> directory, all the application&#8217;s files and all
generated content that is related to the application are copied to the instance.<br>
If a file below a top-level subdirectory is changed without a change
to a file in the top-level subdirectory, full synchronization is
required. In normal operation, files below the top-level
subdirectories of these directories are not changed and such files
should not be changed by users. If an application is deployed and
undeployed, full synchronization is not necessary to update the
instance with the change.</p>
</dd>
<dt class="hdlist1"><code>config</code></dt>
<dd>
<p>This directory contains configuration files for the entire domain.<br>
By default, the DAS resynchronizes files that have been modified since
the last resynchronization only if the <code>domain.xml</code> file in this
directory has been modified.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you add a file to the <code>config</code> directory of an instance, the file
is deleted when the instance is resynchronized with the DAS. However,
any file that you add to the <code>config</code> directory of the DAS is not
deleted when instances and the DAS are resynchronized.
By default, any file that you add to the <code>config</code> directory of the DAS
is not resynchronized.
If you require any additional configuration files to be resynchronized,
you must specify the files explicitly.
For more information, see <a href="#to-resynchronize-additional-configuration-files">To Resynchronize Additional Configuration Files</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>config/</code>config-name</dt>
<dd>
<p>This directory contains files that are to be shared by all instances
that reference the named configuration config-name. A config-name
directory exists for each named configuration in the configuration of the DAS.<br>
Because the config-name directory contains the subdirectories <code>lib</code>
and <code>docroot</code>, this directory might be very large. Therefore, by
default, only a change to a file or a top-level subdirectory of
config-name causes the DAS to resynchronize the config-name directory.</p>
</dd>
<dt class="hdlist1"><code>config/domain.xml</code></dt>
<dd>
<p>This file contains the DAS configuration for the domain to which the
instance belongs.<br>
By default, the DAS resynchronizes this file if it has been modified
since the last resynchronization.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A change to the <code>config/domain.xml</code> file is required to cause the DAS
to resynchronize an instance&#8217;s files. If the <code>config/domain.xml</code> file
has not changed since the last resynchronization, none of the
instance&#8217;s files is resynchronized, even if some of these files are
out of date in the cache.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>docroot</code></dt>
<dd>
<p>This directory is the HTTP document root directory. By default, all
instances in a domain use the same document root directory. To enable
instances to use a different document root directory, a virtual server
must be created in which the <code>docroot</code> property is set. For more
information, see the <a href="reference-manual.html#create-virtual-server"><code>create-virtual-server</code>(1)</a>
help page.<br>
The <code>docroot</code> directory might be very large. Therefore, by default,
only a change to a file or a subdirectory in the top level of the
<code>docroot</code> directory causes the DAS to resynchronize the <code>docroot</code>
directory. The DAS checks files in the top level of the <code>docroot</code>
directory to ensure that changes to the <code>index.html</code> file are
detected.<br>
When the DAS resynchronizes the <code>docroot</code> directory, all modified
files and subdirectories at any level are copied to the instance.<br>
If a file below a top-level subdirectory is changed without a change
to a file in the top-level subdirectory, full synchronization is required.</p>
</dd>
<dt class="hdlist1"><code>generated</code></dt>
<dd>
<p>This directory contains generated files for Jakarta EE applications and
modules, for example, EJB stubs, compiled JSP classes, and security
policy files. Do not modify the contents of this directory.<br>
This directory is resynchronized when the <code>applications</code> directory is
resynchronized. Therefore, only directories for applications that are
deployed to the instance are resynchronized.</p>
</dd>
<dt class="hdlist1"><code>java-web-start</code></dt>
<dd>
<p>This directory is not resynchronized. It is created and populated as
required on each instance.</p>
</dd>
<dt class="hdlist1"><code>lib</code></dt>
<dt class="hdlist1"><code>lib/classes</code></dt>
<dd>
<p>These directories contain common Java class files or JAR archives and
ZIP archives for use by applications that are deployed to the entire
domain. Typically, these directories contain common JDBC drivers and
other utility libraries that are shared by all applications in the domain.<br>
The contents of these directories are loaded by the common class
loader. For more information, see "<a href="application-development-guide.html#using-the-common-class-loader">
Using the Common Class Loader</a>" in Eclipse GlassFish Application
Development Guide.
The class loader loads the contents of these directories in the following order:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>lib/classes</code></p>
</li>
<li>
<p><code>lib/*.jar</code></p>
</li>
<li>
<p><code>lib/*.zip</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>lib</code> directory also contains the following subdirectories:</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>applibs</code></dt>
<dd>
<p>This directory contains application-specific Java class files or JAR
archives and ZIP archives for use by applications that are deployed
to the entire domain.</p>
</dd>
<dt class="hdlist1"><code>ext</code></dt>
<dd>
<p>This directory contains optional packages in JAR archives and ZIP
archives for use by applications that are deployed to the entire
domain. These archive files are loaded by using Java extension
mechanism. For more information, see
<a href="http://download.oracle.com/javase/6/docs/technotes/guides/extensions/extensions.html">Optional
Packages - An Overview</a>
(<code><a href="http://docs.oracle.com/javase/7/docs/technotes/guides/extensions/extensions.html" class="bare">http://docs.oracle.com/javase/7/docs/technotes/guides/extensions/extensions.html</a></code>).</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Optional packages were formerly known as standard extensions or extensions.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>lib</code> directory and its subdirectories typically contain only a
small number of files. Therefore, by default, a change to any file in
these directories causes the DAS to resynchronize the file that
changed.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="to-resynchronize-an-instance-and-the-das-online"><a class="anchor" href="#to-resynchronize-an-instance-and-the-das-online"></a>To Resynchronize an Instance and the DAS Online</h4>
<div class="paragraph">
<p>Resynchronizing an instance and the DAS updates the instance with
changes to the instance&#8217;s configuration files on the DAS. An instance is
resynchronized with the DAS when the instance is started or restarted.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Resynchronization of an instance is only required if the instance is
stopped. A running instance does not require resynchronization.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
</li>
<li>
<p>Determine whether the instance is stopped.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances instance-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>  The name of the instance that you are resynchronizing with the DAS.<br>
If the instance is stopped, the <code>list-instances</code> subcommand indicates
that the instance is not running.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>If the instance is stopped, start the instance.<br>
If the instance is running, no further action is required.</p>
<div class="ulist">
<ul>
<li>
<p>If SSH is set up, start the instance centrally.</p>
<div class="paragraph">
<p>If you require full synchronization, set the <code>--sync</code> option of the
<code>start-instance</code> subcommand to <code>full</code>. If default synchronization is
sufficient, omit this option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-instance [--sync full] instance-name</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for controlling the
behavior of the instance, see the <a href="reference-manual.html#start-instance"><code>start-instance</code>(1)</a>
help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are starting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>If SSH is not set up, start the instance locally from the
host where the instance resides.</p>
<div class="paragraph">
<p>If you require full synchronization, set the <code>--sync</code> option of the
<code>start-local-instance</code> subcommand to <code>full</code>. If default synchronization
is sufficient, omit this option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin start-local-instance [--node node-name] [--sync full] instance-name</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for controlling the
behavior of the instance, see the
<a href="reference-manual.html#start-local-instance"><code>start-local-instance</code>(1)</a> help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance resides. If only one node is defined
for the Eclipse GlassFish installation that you are running on the
node&#8217;s host, you may omit this option.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are starting.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="gksfu" class="paragraph">
<p>Example 5-16 Resynchronizing an Instance and the DAS Online</p>
</div>
<div class="paragraph">
<p>This example determines that the instance <code>yml-i1</code> is stopped and fully
resynchronizes the instance with the DAS. Because SSH
is not set up, the instance is started locally on the host where the
instance resides. In this example, multiple nodes are defined for the
Eclipse GlassFish installation that is running on the node&#8217;s host.</p>
</div>
<div class="paragraph">
<p>To determine whether the instance is stopped, the following command is
run in multimode on the DAS host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances yml-i1
yml-i1   not running
Command list-instances executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>To start the instance, the following command is run in single mode on
the host where the instance resides:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin start-local-instance --node sj01 --sync full yml-i1
Removing all cached state for instance yml-i1.
Waiting for yml-i1 to start ...............
Successfully started the instance: yml-i1
instance Location: /export/glassfish7/glassfish/nodes/sj01/yml-i1
Log File: /export/glassfish7/glassfish/nodes/sj01/yml-i1/logs/server.log
Admin Port: 24849
Command start-local-instance executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#start-instance"><code>start-instance</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#start-local-instance"><code>start-local-instance</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line.</p>
</div>
<div class="paragraph">
<p><code>asadmin help list-instances</code>
<code>asadmin help start-instance</code>
<code>asadmin help start-local-instance</code></p>
</div>
</div>
<div class="sect3">
<h4 id="to-resynchronize-library-files"><a class="anchor" href="#to-resynchronize-library-files"></a>To Resynchronize Library Files</h4>
<div class="paragraph">
<p>To ensure that library files are resynchronized correctly, you must
ensure that each library file is placed in the correct directory for the
type of file.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Place each library file in the correct location for the type of
library file as shown in the following table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 53%;">
<col style="width: 47%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type of Library Files</th>
<th class="tableblock halign-left valign-top">Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common JAR archives and ZIP archives for all applications in a domain.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/lib</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Java class files for a domain for all applications in a domain.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/lib/classes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application-specific libraries.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/lib/applibs</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional packages for all applications in a domain.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/lib/ext</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Library files for all applications that are deployed to a specific
cluster or standalone instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/config/</code>config-name<code>/lib</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional packages for all applications that are deployed to a specific
cluster or standalone instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain-dir<code>/config/</code>config-name<code>/lib/ext</code></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">domain-dir</dt>
<dd>
<p>The directory in which the domain&#8217;s configuration is stored.</p>
</dd>
<dt class="hdlist1">config-name</dt>
<dd>
<p>For a standalone instance: the named configuration that the instance references.<br>
For a clustered instance: the named configuration that the cluster to
which the instance belongs references.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>When you deploy an application that depends on these library files,
use the <code>--libraries</code> option of the deploy subcommand to specify these dependencies.<br>
For library files in the domain-dir`/lib/applib` directory, only the JAR
file name is required, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; deploy --libraries commons-coll.jar,X1.jar app.ear</code></pre>
</div>
</div>
<div class="paragraph">
<p>For other types of library file, the full path is required.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#deploy"><code>deploy</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the command <code>asadmin help deploy</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-resynchronize-custom-configuration-files-for-an-instance"><a class="anchor" href="#to-resynchronize-custom-configuration-files-for-an-instance"></a>To Resynchronize Custom Configuration Files for an Instance</h4>
<div class="paragraph">
<p>Configuration files in the domain-dir<code>/config</code> directory that are
resynchronized are resynchronized for the entire domain. If you create a
custom configuration file for an instance or a cluster, the custom file
is resynchronized only for the instance or cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Place the custom configuration file in the</p>
<div class="dlist">
<dl>
<dt class="hdlist1">domain-dir<code>/config/</code>config-name directory.</dt>
<dt class="hdlist1">domain-dir</dt>
<dd>
<p>The directory in which the domain&#8217;s configuration is stored.</p>
</dd>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The named configuration that the instance references.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>If the instance locates the file through an option of the Java
application launcher, update the option.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the option.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-jvm-options --target instance-name
option-name=current-value</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance for which the custom configuration file is
created.</p>
</dd>
<dt class="hdlist1">option-name</dt>
<dd>
<p>The name of the option for locating the file.</p>
</dd>
<dt class="hdlist1">current-value</dt>
<dd>
<p>The current value of the option for locating the file.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Re-create the option that you deleted in the previous step.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-jvm-options --target instance-name
option-name=new-value</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance for which the custom configuration file is
created.</p>
</dd>
<dt class="hdlist1">option-name</dt>
<dd>
<p>The name of the option for locating the file.</p>
</dd>
<dt class="hdlist1">new-value</dt>
<dd>
<p>The new value of the option for locating the file.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div id="gksfr" class="paragraph">
<p>Example 5-17 Updating the Option for Locating a Configuration File</p>
</div>
<div class="paragraph">
<p>This example updates the option for locating the <code>server.policy</code> file to
specify a custom file for the instance <code>pmd</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-jvm-options --target pmd
-Djava.security.policy=${com.sun.aas.instanceRoot}/config/server.policy
Deleted 1 option(s)
Command delete-jvm-options executed successfully.
asadmin&gt; create-jvm-options --target pmd
-Djava.security.policy=${com.sun.aas.instanceRoot}/config/pmd-config/server.policy
Created 1 option(s)
Command create-jvm-options executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#create-jvm-options"><code>create-jvm-options</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-jvm-options"><code>delete-jvm-options</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line.</p>
</div>
<div class="paragraph">
<p><code>asadmin help create-jvm-options</code></p>
</div>
<div class="paragraph">
<p><code>asadmin help delete-jvm-options</code></p>
</div>
</div>
<div class="sect3">
<h4 id="to-resynchronize-users-changes-to-files"><a class="anchor" href="#to-resynchronize-users-changes-to-files"></a>To Resynchronize Users' Changes to Files</h4>
<div class="paragraph">
<p>A change to the <code>config/domain.xml</code> file is required to cause the DAS to
resynchronize instances' files. If other files in the domain directory
are changed without a change to the <code>config/domain.xml</code> file, instances
are not resynchronized with these changes.</p>
</div>
<div class="paragraph">
<p>The following changes are examples of changes to the domain directory
without a change to the <code>config/domain.xml</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding files to the <code>lib</code> directory</p>
</li>
<li>
<p>Adding certificates to the key store by using the <code>keytool</code> command</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change the last modified time of the <code>config/domain.xml</code> file.<br>
Exactly how to change the last modified time depends on the operating
system. For example, on UNIX and Linux systems, you can use the
<a href="https://www.oracle.com/pls/topic/lookup?ctx=E18752&amp;id=REFMAN1touch-1"><code>touch</code>(1)</a> command.</p>
</li>
<li>
<p>Resynchronize each instance in the domain with the DAS.<br>
For instructions, see <a href="#to-resynchronize-an-instance-and-the-das-online">To Resynchronize an Instance and the DAS Online</a>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-resynchronize-an-instance-and-the-das-online">To Resynchronize an Instance and the DAS Online</a></p>
</li>
<li>
<p><a href="https://www.oracle.com/pls/topic/lookup?ctx=E18752&amp;id=REFMAN1touch-1"><code>touch</code>(1)</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-resynchronize-additional-configuration-files"><a class="anchor" href="#to-resynchronize-additional-configuration-files"></a>To Resynchronize Additional Configuration Files</h4>
<div class="paragraph">
<p>By default, Eclipse GlassFish synchronizes only the following
configuration files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>admin-keyfile</code></p>
</li>
<li>
<p><code>cacerts.jks</code></p>
</li>
<li>
<p><code>default-web.xml</code></p>
</li>
<li>
<p><code>domain.xml</code></p>
</li>
<li>
<p><code>domain-passwords</code></p>
</li>
<li>
<p><code>keyfile</code></p>
</li>
<li>
<p><code>keystore.jks</code></p>
</li>
<li>
<p><code>server.policy</code></p>
</li>
<li>
<p><code>sun-acc.xml</code></p>
</li>
<li>
<p><code>wss-server-config-1.0</code></p>
</li>
<li>
<p><code>xml wss-server-config-2.0.xml</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you require instances in a domain to be resynchronized with
additional configuration files for the domain, you can specify a list of
files to resynchronize.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you specify a list of files to resynchronize, you must specify all
the files that the instances require, including the files that Eclipse GlassFish resynchronizes by default. Any file in the instance&#8217;s cache that
is not in the list is deleted when the instance is resynchronized with
the DAS.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the <code>config</code> directory of the domain, create a plain text file that
is named <code>config-files</code> that lists the files to resynchronize.</p>
</div>
<div class="paragraph">
<p>In the <code>config-files</code> file, list each file name on a separate line.</p>
</div>
<div id="gksgl" class="paragraph">
<p>Example 5-18 <code>config-files</code> File</p>
</div>
<div class="paragraph">
<p>This example shows the content of a <code>config-files</code> file. This file
specifies that the <code>some-other-info</code> file is to be resynchronized in
addition to the files that Eclipse GlassFish resynchronizes by default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>admin-keyfile
cacerts.jks
default-web.xml
domain.xml
domain-passwords
keyfile
keystore.jks
server.policy
sun-acc.xml
wss-server-config-1.0.xml
wss-server-config-2.0.xml
some-other-info</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="to-prevent-deletion-of-application-generated-files"><a class="anchor" href="#to-prevent-deletion-of-application-generated-files"></a>To Prevent Deletion of Application-Generated Files</h4>
<div class="paragraph">
<p>When the DAS resynchronizes an instance&#8217;s files, the DAS deletes from
the instance&#8217;s cache any files that are not listed for
resynchronization. If an application creates files in a directory that
the DAS resynchronizes, these files are deleted when the DAS
resynchronizes an instance with the DAS.</p>
</div>
<div class="paragraph">
<p>Put the files in a subdirectory under the domain directory that is not
defined by Eclipse GlassFish, for example,
<code>/export/glassfish7/glassfish/domains/domain1/myapp/myfile</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-resynchronize-an-instance-and-the-das-offline"><a class="anchor" href="#to-resynchronize-an-instance-and-the-das-offline"></a>To Resynchronize an Instance and the DAS Offline</h4>
<div class="paragraph">
<p>Resynchronizing an instance and the DAS offline updates the instance&#8217;s
cache without the need for the instance to be able to communicate with
the DAS. Offline resynchronization is typically required for the
following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To reestablish the instance after an upgrade</p>
</li>
<li>
<p>To synchronize the instance manually with the DAS when the instance cannot contact the DAS</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running.</p>
</li>
<li>
<p><a id="gktio"></a>
Export the configuration data that you are resynchronizing to an archive file.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for exporting the
configuration data, see the
<a href="reference-manual.html#export-sync-bundle"><code>export-sync-bundle</code>(1)</a>
help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>How to export the data depends on the host from where you run the
<code>export-sync-bundle</code> subcommand.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>From the DAS host, run the <code>export-sync-bundle</code> subcommand as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; export-sync-bundle --target target</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">target</dt>
<dd>
<p>The cluster or standalone instance for which to export configuration data.<br>
Do not specify a clustered instance. If you specify a clustered
instance, an error occurs. To export configuration data for a
clustered instance, specify the name of the cluster of which the
instance is a member, not the instance.</p>
<div class="paragraph">
<p>The file is created on the DAS host.</p>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>From the host where the instance resides, run the <code>export-sync-bundle</code>
subcommand as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host das-host [--port admin-port]
export-sync-bundle [--retrieve=true] --target target</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">das-host</dt>
<dd>
<p>The name of the host where the DAS is running.</p>
</dd>
<dt class="hdlist1">admin-port</dt>
<dd>
<p>The HTTP or HTTPS port on which the DAS listens for administration
requests. If the DAS listens on the default port for administration
requests, you may omit this option.</p>
</dd>
<dt class="hdlist1">target</dt>
<dd>
<p>The cluster or standalone instance for which to export configuration data.<br>
Do not specify a clustered instance. If you specify a clustered
instance, an error occurs. To export configuration data for a
clustered instance, specify the name of the cluster of which the
instance is a member, not the instance.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To create the archive file on the host where the instance resides, set
the <code>--retrieve</code> option to <code>true</code>. If you omit this option, the archive
file is created on the DAS host.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>If necessary, copy the archive file that you created in
Step <a href="#gktio">2</a> from the DAS host to the host where the instance resides.</p>
</li>
<li>
<p>From the host where the instance resides, import the instance&#8217;s
configuration data from the archive file that you created in
Step <a href="#gktio">2</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for importing the
configuration data, see the <a href="reference-manual.html#import-sync-bundle"><code>import-sync-bundle</code>(1)</a>
help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin import-sync-bundle [--node node-name] --instance instance-name archive-file</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">node-name</dt>
<dd>
<p>The node on which the instance resides. If you omit this option, the
subcommand determines the node from the DAS configuration in the
archive file.</p>
</dd>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance that you are resynchronizing.</p>
</dd>
<dt class="hdlist1">archive-file</dt>
<dd>
<p>The name of the file, including the path, that contains the archive
file to import.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="gksgg" class="paragraph">
<p>Example 5-19 Resynchronizing an Instance and the DAS Offline</p>
</div>
<div class="paragraph">
<p>This example resynchronizes the clustered instance <code>yml-i1</code> and the DAS
offline. The instance is a member of the cluster <code>ymlcluster</code>. The
archive file that contains the instance&#8217;s configuration data is created
on the host where the instance resides.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ asadmin --host dashost.example.com
export-sync-bundle --retrieve=true --target ymlcluster
Command export-sync-bundle executed successfully.
$ asadmin import-sync-bundle --node sj01
--instance yml-i1 ymlcluster-sync-bundle.zip
Command import-sync-bundle executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#export-sync-bundle"><code>export-sync-bundle</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#import-sync-bundle"><code>import-sync-bundle</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line.</p>
</div>
<div class="paragraph">
<p><code>asadmin help export-sync-bundle</code></p>
</div>
<div class="paragraph">
<p><code>asadmin help import-sync-bundle</code></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="migrating-ejb-timers"><a class="anchor" href="#migrating-ejb-timers"></a>Migrating EJB Timers</h3>
<div class="paragraph">
<p>If a Eclipse GlassFish server instance stops or fails abnormally, it may
be desirable to migrate the EJB timers defined for that stopped server
instance to another running server instance.</p>
</div>
<div class="paragraph">
<p>Automatic timer migration is enabled by default for clustered server
instances that are stopped normally. Automatic timer migration can also
be enabled to handle clustered server instance crashes. In addition,
timers can be migrated manually for stopped or crashed server instances.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-enable-automatic-ejb-timer-migration-for-failed-clustered-instances">To Enable Automatic EJB Timer Migration for Failed Clustered Instances</a></p>
</li>
<li>
<p><a href="#to-migrate-ejb-timers-manually">To Migrate EJB Timers Manually</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-enable-automatic-ejb-timer-migration-for-failed-clustered-instances"><a class="anchor" href="#to-enable-automatic-ejb-timer-migration-for-failed-clustered-instances"></a>To Enable Automatic EJB Timer Migration for Failed Clustered Instances</h4>
<div class="paragraph">
<p>Automatic migration of EJB timers is enabled by default for clustered
server instances that are stopped normally. If the Group Management
Service (GMS) is enabled and a clustered instance is stopped normally,
no further action is required for timer migration to occur. The
procedure in this section is only necessary if you want to enable
automatic timer migration for clustered server instances that have
stopped abnormally.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the GMS is enabled, the default automatic timer migration cannot be
disabled. To disable automatic timer migration, you must first disable
the GMS. For information about the GMS, see
<a href="#group-management-service">Group Management Service</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Automatic EJB timer migration can only be configured for clustered
server instances. Automatic timer migration is not possible for
standalone server instances.</p>
</div>
<div class="paragraph">
<p>Enable delegated transaction recovery for the cluster.</p>
</div>
<div class="paragraph">
<p>This enables automatic timer migration for failed server instances in
the cluster.</p>
</div>
<div class="paragraph">
<p>For instructions on enabling delegated transaction recovery, see
"<a href="administration-guide.html#administering-transactions">Administering Transactions</a>" in Eclipse GlassFish Administration Guide.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-migrate-ejb-timers-manually"><a class="anchor" href="#to-migrate-ejb-timers-manually"></a>To Migrate EJB Timers Manually</h4>
<div class="paragraph">
<p>EJB timers can be migrated manually from a stopped source instance to a
specified target instance in the same cluster if GMS notification is not
enabled. If no target instance is specified, the DAS will attempt to
find a suitable server instance. A migration notification will then be
sent to the selected target server instance.</p>
</div>
<div class="paragraph">
<p>Note the following restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the source instance is part of a cluster, then the target instance
must also be part of that same cluster.</p>
</li>
<li>
<p>It is not possible to migrate timers from a standalone instance to a
clustered instance, or from one cluster to another cluster.</p>
</li>
<li>
<p>It is not possible to migrate timers from one standalone instance to
another standalone instance.</p>
</li>
<li>
<p>All EJB timers defined for a given instance are migrated with this
procedure. It is not possible to migrate individual timers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>The server instance from which the EJB timers are to be migrated should
not be active during the migration process.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that the source clustered server instance from which the EJB
timers are to be migrated is not currently running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances source-instance</code></pre>
</div>
</div>
</li>
<li>
<p>Stop the instance from which the timers are to be migrated, if that
instance is still running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; stop-instance source-instance</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The target instance to which the timers will be migrated should be running.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>List the currently defined EJB timers on the source instance, if desired.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-timers source-cluster</code></pre>
</div>
</div>
</li>
<li>
<p>Migrate the timers from the stopped source instance to the target instance.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; migrate-timers --target target-instance source-instance</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="gkmgw" class="paragraph">
<p>Example 5-20 Migrating an EJB Timer</p>
</div>
<div class="paragraph">
<p>The following example show how to migrate timers from a clustered source
instance named <code>football</code> to a clustered target instance named <code>soccer</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; migrate-timers --target soccer football</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#list-timers"><code>list-timers</code>(1)</a>,
<a href="reference-manual.html#migrate-timers"><code>migrate-timers</code>(1)</a>,
<a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a>,
<a href="reference-manual.html#stop-instance"><code>stop-instance</code>(1)</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administering-named-configurations"><a class="anchor" href="#administering-named-configurations"></a>6 Administering Named Configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A named configuration is a set of configuration information for
Eclipse GlassFish instances and clusters. A configuration sets port
numbers for listeners that an instance or a cluster uses and defines
settings for items such as the EJB container, security, logging, and
monitoring. Applications and resources are not defined in named configurations.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish enables you to create configurations for use by
clusters and instances. Eclipse GlassFish creates configurations
automatically for clusters and instances that do not reference an
existing configuration. You can modify any existing named configuration
regardless of how the configuration was created.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#about-named-configurations">About Named Configurations</a></p>
</li>
<li>
<p><a href="#creating-listing-and-deleting-named-configurations">Creating, Listing, and Deleting Named Configurations</a></p>
</li>
<li>
<p><a href="#modifying-properties-for-named-configurations-and-instances">Modifying Properties for Named Configurations and Instances</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="about-named-configurations"><a class="anchor" href="#about-named-configurations"></a>About Named Configurations</h3>
<div class="paragraph">
<p>Configurations exist in a domain. Multiple Eclipse GlassFish instances or
clusters in the domain can reference the same configuration, or they can
have separate configurations. To ensure that the environment in a
cluster&#8217;s instances is homogenous, all instances in the cluster inherit
the cluster&#8217;s configuration.</p>
</div>
<div class="sect3">
<h4 id="types-of-named-configurations"><a class="anchor" href="#types-of-named-configurations"></a>Types of Named Configurations</h4>
<div class="paragraph">
<p>Each named configuration is one of the following types of configuration:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Standalone configuration</dt>
<dd>
<p>A standalone configuration is referenced by only one instance or
cluster and is not shared with any other instances or clusters.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A configuration that is referenced by only one cluster is a standalone
configuration, even if the cluster contains multiple instances.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Shared configuration</dt>
<dd>
<p>A shared configuration is referenced by multiple instances or clusters.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The type of an unclustered instance is determined by the type of the
configuration that the instance references. For more information, see
<a href="#types-of-glassfish-server-instances">Types of Eclipse GlassFish Instances</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-default-config-configuration"><a class="anchor" href="#the-default-config-configuration"></a>The <code>default-config</code> Configuration</h4>
<div class="paragraph">
<p>The <code>default-config</code> configuration is a special configuration that acts
as a template for creating named configurations. Clusters and instances
cannot refer to the <code>default-config</code> configuration. The <code>default-config</code>
configuration can only be copied to create configurations.</p>
</div>
</div>
<div class="sect3">
<h4 id="automatically-created-configurations"><a class="anchor" href="#automatically-created-configurations"></a>Automatically Created Configurations</h4>
<div class="paragraph">
<p>When you create a cluster or an instance, you can choose whether to
specify an existing configuration that the new cluster or instance will
reference. If you choose to create a cluster or an instance without
specifying an existing configuration, Eclipse GlassFish automatically
creates a configuration for the cluster or instance. For more
information, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-a-cluster">To Create a Cluster</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eclipse GlassFish automatically creates a configuration by copying the
<code>default-config</code> configuration. If you require an instance or cluster to
reference a copy of a different configuration, copy the configuration
and specify the copy when you create the instance or cluster. For
information about how to copy a configuration, see <a href="#to-create-a-named-configuration">To Create
a Named Configuration</a>.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish assigns the name cluster-or-instance`-config` to an
automatically created configuration. cluster-or-instance is the name of
the cluster or instance for which the configuration is created. The
<code>server-config</code> configuration is automatically created for the domain
administration server (DAS) when the domain is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="directory-for-configuration-synchronization"><a class="anchor" href="#directory-for-configuration-synchronization"></a>Directory for Configuration Synchronization</h4>
<div class="paragraph">
<p>When a named configuration is created, Eclipse GlassFish creates a
configuration directory on the domain administration server (DAS) at
domain-dir<code>/config/</code>config-name.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">domain-dir</dt>
<dd>
<p>The directory in which the domain&#8217;s configuration is stored.</p>
</dd>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name that was assigned to the configuration when the configuration was created.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This contents of this directory are synchronized to all instances that
inherit or reference the configuration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-listing-and-deleting-named-configurations"><a class="anchor" href="#creating-listing-and-deleting-named-configurations"></a>Creating, Listing, and Deleting Named Configurations</h3>
<div class="paragraph">
<p>Eclipse GlassFish enables you to create configurations for use by
clusters and instances, obtain information about configurations, and
delete configurations that are no longer required.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-create-a-named-configuration">To Create a Named Configuration</a></p>
</li>
<li>
<p><a href="#to-list-the-named-configurations-in-a-domain">To List the Named Configurations in a Domain</a></p>
</li>
<li>
<p><a href="#to-list-the-targets-of-a-named-configuration">To List the Targets of a Named Configuration</a></p>
</li>
<li>
<p><a href="#to-delete-a-named-configuration">To Delete a Named Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-create-a-named-configuration"><a class="anchor" href="#to-create-a-named-configuration"></a>To Create a Named Configuration</h4>
<div class="paragraph">
<p>Use the <code>copy-config</code> subcommand in remote mode to create a named
configuration by copying an existing configuration.</p>
</div>
<div class="paragraph">
<p>Eclipse GlassFish requires you to create a configuration by copying a
configuration because a configuration contains many required settings.
The newly created configuration is identical to the configuration that
you copy until you change its configuration settings.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Create a named configuration only if you plan to share the configuration
among multiple unclustered instances or clusters, or if you are using a
configuration to preconfigure GMS settings. Otherwise, create clusters
and instances without specifying an existing configuration.
If no configuration is specified, Eclipse GlassFish creates a copy of the
default configuration for the cluster or instance.</p>
</div>
<div class="paragraph">
<p>For more information, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS Configuration Settings</a></p>
</li>
<li>
<p><a href="#to-create-a-cluster">To Create a Cluster</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <code>copy-config</code> subcommand.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only the options that are required to complete this task are provided in
this step. For information about all the options for configuring the
named configuration, see the <a href="reference-manual.html#copy-config"><code>copy-config</code>(1)</a>
help page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; copy-config source-config-name destination-config-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">source-config-name</dt>
<dd>
<p>The name of the configuration that you are copying. You must specify a
configuration to copy even if you are copying the default
configuration. The configuration must already exist.</p>
</dd>
<dt class="hdlist1">destination-config-name</dt>
<dd>
<p>Your choice of name for the configuration that you are creating by
copying the source configuration.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkrhn" class="paragraph">
<p>Example 6-1 Creating a Named Configuration</p>
</div>
<div class="paragraph">
<p>This example creates the named configuration <code>clusterpresets-config</code> by
copying the default configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; copy-config default-config clusterpresets-config
Command copy-config executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-preconfigure-nondefault-gms-configuration-settings">To Preconfigure Nondefault GMS Configuration Settings</a></p>
</li>
<li>
<p><a href="#to-create-a-cluster">To Create a Cluster</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-create-an-instance-locally">To Create an Instance Locally</a></p>
</li>
<li>
<p><a href="reference-manual.html#copy-config"><code>copy-config</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help copy-config</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-list-the-named-configurations-in-a-domain"><a class="anchor" href="#to-list-the-named-configurations-in-a-domain"></a>To List the Named Configurations in a Domain</h4>
<div class="paragraph">
<p>Use the <code>list-configs</code> subcommand in remote mode to list existing named
configurations in a domain.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Run the <a href="reference-manual.html#list-configs"><code>list-configs</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-configs</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="gkrhp" class="paragraph">
<p>Example 6-2 Listing All Named Configurations in a Domain</p>
</div>
<div class="paragraph">
<p>This example lists all named configurations in the current domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-configs
server-config
default-config
ymlcluster-config
clusterpresets-config
Command list-configs executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p><a href="reference-manual.html#list-configs"><code>list-configs</code>(1)</a></p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help list-configs</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-list-the-targets-of-a-named-configuration"><a class="anchor" href="#to-list-the-targets-of-a-named-configuration"></a>To List the Targets of a Named Configuration</h4>
<div class="paragraph">
<p>Use the <code>list-clusters</code> subcommand and the <code>list-instances</code> subcommand
in remote mode to list the targets of a named configuration.</p>
</div>
<div class="paragraph">
<p>The targets of a named configuration are the clusters and Eclipse GlassFish instances that reference the configuration.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>List the clusters that refer to the configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters config-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration whose targets you are listing.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>List the instances that refer to the configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances config-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration whose targets you are listing.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div id="gkrfz" class="paragraph">
<p>Example 6-3 Listing the Targets of a Named Configuration</p>
</div>
<div class="paragraph">
<p>This example shows that the cluster <code>ymlcluster</code> and the instances
<code>yml-i1</code> and <code>yml-i2</code> reference the named configuration
<code>ymlcluster-config</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters ymlcluster-config
ymlcluster partially running
Command list-clusters executed successfully.
asadmin&gt; list-instances ymlcluster-config
yml-i1   running
yml-i2   not running
Command list-instances executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#list-clusters"><code>list-clusters</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help list-clusters</code></p>
</li>
<li>
<p><code>asadmin help list-instances</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-delete-a-named-configuration"><a class="anchor" href="#to-delete-a-named-configuration"></a>To Delete a Named Configuration</h4>
<div class="paragraph">
<p>Use the <code>delete-config</code> subcommand in remote mode to delete an existing
named configuration from the configuration of the DAS.</p>
</div>
<div class="paragraph">
<p>You cannot delete the <code>default-config</code> configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A standalone configuration that was created automatically for a cluster
or a Eclipse GlassFish instance is deleted when the cluster or instance is deleted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Ensure that no clusters or instances refer to the configuration. If a
cluster or instance refers to the configuration and is no longer
required, delete the cluster or instance. For information about how to
delete an instance and how to delete a cluster, see the following
sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
</li>
<li>
<p><a href="#to-delete-a-cluster">To Delete a Cluster</a></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>Confirm that no clusters refer to the configuration that you are deleting.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters config-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration that you are deleting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Confirm that no instances refer to the configuration that you are
deleting.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances config-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration that you are deleting.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Run the <a href="reference-manual.html#delete-config"><code>delete-config</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; delete-config config-name</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration that you are deleting.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="gkrgs" class="paragraph">
<p>Example 6-4 Deleting a Named Configuration</p>
</div>
<div class="paragraph">
<p>This example confirms that no clusters or instances refer to the
configuration <code>clusterpresets-config</code> and then deletes the
configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters clusterpresets-config
Nothing to list
Command list-clusters executed successfully.
asadmin&gt; list-instances clusterpresets-config
Nothing to list.
Command list-instances executed successfully.
asadmin&gt; delete-config clusterpresets-config
Command delete-config executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-delete-an-instance-centrally">To Delete an Instance Centrally</a></p>
</li>
<li>
<p><a href="#to-delete-an-instance-locally">To Delete an Instance Locally</a></p>
</li>
<li>
<p><a href="#to-delete-a-cluster">To Delete a Cluster</a></p>
</li>
<li>
<p><a href="reference-manual.html#delete-config"><code>delete-config</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-clusters"><code>list-clusters</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#list-instances"><code>list-instances</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help delete-config</code></p>
</li>
<li>
<p><code>asadmin help list-clusters</code></p>
</li>
<li>
<p><code>asadmin help list-instances</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modifying-properties-for-named-configurations-and-instances"><a class="anchor" href="#modifying-properties-for-named-configurations-and-instances"></a>Modifying Properties for Named Configurations and Instances</h3>
<div class="paragraph">
<p>The properties in a named configuration define port numbers for
unclustered instances that reference the configuration or clustered
instances that inherit the configuration. An instance initially obtains
port numbers from the configuration that the instance references or
inherits. To avoid port conflicts, edit the properties of named
configurations and instances.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#properties-for-port-numbers-in-a-named-configuration">Properties for Port Numbers in a Named Configuration</a></p>
</li>
<li>
<p><a href="#to-modify-a-named-configurations-properties">To Modify a Named Configuration&#8217;s Properties</a></p>
</li>
<li>
<p><a href="#to-modify-port-numbers-of-an-instance">To Modify Port Numbers of an Instance</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="properties-for-port-numbers-in-a-named-configuration"><a class="anchor" href="#properties-for-port-numbers-in-a-named-configuration"></a>Properties for Port Numbers in a Named Configuration</h4>
<div class="paragraph">
<p>The default configuration <code>default-config</code> contains properties that
define the initial values of port numbers in a configuration that is
copied from <code>default-config</code>. When an instance or a cluster that
references the configuration is created, these properties are set for
the instance.</p>
</div>
<div class="paragraph">
<p>You can create additional system properties for a configuration either
by specifying the <code>--systemproperties</code> option of the
<a href="reference-manual.html#copy-config"><code>copy-config</code></a> subcommand or by using the
<a href="reference-manual.html#create-system-properties"><code>create-system-properties</code></a> subcommand. To reference a
system property from the configuration, use the <code>${`prop-name</code>}`
notation, where prop-name is the name of the system property.</p>
</div>
<div class="paragraph">
<p>For example, if a configuration defines additional HTTP listeners, use
system properties to define the ports for those listeners. However,
these properties are not set automatically when an instance or a cluster
that references the configuration is created. You must set these
properties explicitly when you create the instance or cluster.</p>
</div>
<div class="paragraph">
<p>The properties in a named configuration that define port numbers are as
follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ASADMIN_LISTENER_PORT</code></dt>
<dd>
<p>This property specifies the port number of the HTTP port or HTTPS port
through which the DAS connects to the instance to manage the instance.
Valid values are 1-65535. On UNIX, creating sockets that listen on
ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>HTTP_LISTENER_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used to
listen for HTTP requests. Valid values are 1-65535. On UNIX, creating
sockets that listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>HTTP_SSL_LISTENER_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used to
listen for HTTPS requests. Valid values are 1-65535. On UNIX, creating
sockets that listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>IIOP_LISTENER_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used for
IIOP connections. Valid values are 1-65535. On UNIX, creating sockets
that listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>IIOP_SSL_LISTENER_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used for
secure IIOP connections. Valid values are 1-65535. On UNIX, creating
sockets that listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>IIOP_SSL_MUTUALAUTH_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used for
secure IIOP connections with client authentication. Valid values are
1-65535. On UNIX, creating sockets that listen on ports 1-1024
requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>JAVA_DEBUGGER_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used for
connections to the
<a href="http://java.sun.com/javase/technologies/core/toolsapis/jpda/">Java
Platform Debugger Architecture (JPDA)</a>
(<code><a href="http://java.sun.com/javase/technologies/core/toolsapis/jpda/" class="bare">http://java.sun.com/javase/technologies/core/toolsapis/jpda/</a></code>)
debugger. Valid values are 1-65535. On UNIX, creating sockets that
listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>JMS_PROVIDER_PORT</code></dt>
<dd>
<p>This property specifies the port number for the Java Message Service
provider. Valid values are 1-65535. On UNIX, creating sockets that
listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>JMX_SYSTEM_CONNECTOR_PORT</code></dt>
<dd>
<p>This property specifies the port number on which the JMX connector
listens. Valid values are 1-65535. On UNIX, creating sockets that
listen on ports 1-1024 requires superuser privileges.</p>
</dd>
<dt class="hdlist1"><code>OSGI_SHELL_TELNET_PORT</code></dt>
<dd>
<p>This property specifies the port number of the port that is used for
connections to the
<a href="http://felix.apache.org/site/apache-felix-remote-shell.html">Apache
Felix Remote Shell</a>
(<code><a href="http://felix.apache.org/site/apache-felix-remote-shell.html" class="bare">http://felix.apache.org/site/apache-felix-remote-shell.html</a></code>). This
shell uses the Felix shell service to interact with the OSGi module
management subsystem. Valid values are 1-65535. On UNIX, creating
sockets that listen on ports 1-1024 requires superuser privileges.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="to-modify-a-named-configurations-properties"><a class="anchor" href="#to-modify-a-named-configurations-properties"></a>To Modify a Named Configuration&#8217;s Properties</h4>
<div class="paragraph">
<p>Use the <code>get</code> subcommand and the <code>set</code> subcommand in remote mode to
modify a named configuration&#8217;s properties.</p>
</div>
<div class="paragraph">
<p>You might copy a configuration for use by instances that reside on the
same host as instances that refer to the original configuration. In this
situation, edit the properties of one of the configurations to ensure
that instances that will refer to the configuration have the correct
initial settings.</p>
</div>
<div class="paragraph">
<p>If you change the port number in a configuration, the port number is
changed for any instance that references or inherits the configuration.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>For each property that you are modifying, determine the current
value and set the new value.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine the current value of the property.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get configs.config.config-name.system-property.property-name.value</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration whose properties you are modifying.</p>
</dd>
<dt class="hdlist1">property-name</dt>
<dd>
<p>The name of the property that you are modifying. For a list of
available properties, see <a href="#properties-for-port-numbers-in-a-named-configuration">Properties for Port Numbers in a
Named Configuration</a>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Set the property to its new value.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set
configs.config.config-name.system-property.property-name.value=new-value</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">config-name</dt>
<dd>
<p>The name of the configuration whose properties you are modifying.</p>
</dd>
<dt class="hdlist1">property-name</dt>
<dd>
<p>The name of the property that you are modifying. For a list of
available properties, see <a href="#properties-for-port-numbers-in-a-named-configuration">Properties for Port Numbers in a
Named Configuration</a>.</p>
</dd>
<dt class="hdlist1">new-value</dt>
<dd>
<p>The value to which you are setting the property.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div id="gkrky" class="paragraph">
<p>Example 6-5 Modifying a Property of a Named Configuration</p>
</div>
<div class="paragraph">
<p>This example changes the value of the <code>JMS_PROVIDER_PORT</code> property in
the <code>clusterpresets-config</code> configuration from 27676 to 27678.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get
configs.config.clusterpresets-config.system-property.JMS_PROVIDER_PORT.value
configs.config.clusterpresets-config.system-property.JMS_PROVIDER_PORT.value=27676
Command get executed successfully.
asadmin&gt; set
configs.config.clusterpresets-config.system-property.JMS_PROVIDER_PORT.value=27678
configs.config.clusterpresets-config.system-property.JMS_PROVIDER_PORT.value=27678
Command set executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#get"><code>get</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#set"><code>set</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help get</code></p>
</li>
<li>
<p><code>asadmin help set</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="to-modify-port-numbers-of-an-instance"><a class="anchor" href="#to-modify-port-numbers-of-an-instance"></a>To Modify Port Numbers of an Instance</h4>
<div class="paragraph">
<p>Use the <code>get</code> subcommand and the <code>set</code> subcommand in remote mode to
modify the port numbers of an instance.</p>
</div>
<div class="paragraph">
<p>The port numbers of a instance are initially set in the configuration
that the instance references or inherits from its parent cluster.
Multiple instances that reside on the same host must each listen on a
unique port number. Therefore, if multiple instances that reference or
inherit the same configuration reside on the same host, a port conflict
prevents all except one of the instances from starting. To avoid port
conflicts, modify the port numbers on which individual instances listen.</p>
</div>
<div class="paragraph">
<p>If you modify an instance&#8217;s port number and later modify the port number
in the instance&#8217;s configuration, the instance&#8217;s port number remains
unchanged.</p>
</div>
<div class="paragraph">
<p>The port numbers of an instance are stored as Java system properties.
When Eclipse GlassFish is started, it treats these properties in the same
way as properties that are passed through the <code>-D</code> option of the Java
application launcher.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the DAS is running. Remote subcommands require a running server.</p>
</li>
<li>
<p>For each port number that you are modifying, determine the current
value and set the new value.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine the current value of the port number.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get
servers.server.instance-name.system-property.port-property.value</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance whose port numbers you are modifying.</p>
</dd>
<dt class="hdlist1">port-property</dt>
<dd>
<p>The name of the property that corresponds to the port number that you
are modifying. For a list of available properties, see
<a href="#properties-for-port-numbers-in-a-named-configuration">Properties for Port Numbers in a Named Configuration</a>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Set the port number to its new value.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get
servers.server.instance-name.system-property.port-property.value=new-value</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">instance-name</dt>
<dd>
<p>The name of the instance whose port numbers you are modifying.</p>
</dd>
<dt class="hdlist1">port-property</dt>
<dd>
<p>The name of the property that corresponds to the port number that you
are modifying. For a list of available properties, see
<a href="#properties-for-port-numbers-in-a-named-configuration">Properties for Port Numbers in a Named Configuration</a>.</p>
</dd>
<dt class="hdlist1">new-value</dt>
<dd>
<p>The value to which you are setting the port number.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div id="gkrma" class="paragraph">
<p>Example 6-6 Modifying a Port Number for an Instance</p>
</div>
<div class="paragraph">
<p>This example changes the port number of the HTTP port or the HTTPS port
for administration of the <code>pmdsainst</code> instance from 24849 to 24859.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get
servers.server.pmdsainst.system-property.ASADMIN_LISTENER_PORT.value
servers.server.pmdsainst.system-property.ASADMIN_LISTENER_PORT.value=24849
Command get executed successfully.
asadmin&gt; set
servers.server.pmdsainst.system-property.ASADMIN_LISTENER_PORT.value=24859
servers.server.pmdsainst.system-property.ASADMIN_LISTENER_PORT.value=24859
Command set executed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="reference-manual.html#get"><code>get</code>(1)</a></p>
</li>
<li>
<p><a href="reference-manual.html#set"><code>set</code>(1)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommands by
typing the following commands at the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>asadmin help get</code></p>
</li>
<li>
<p><code>asadmin help set</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-http-load-balancing"><a class="anchor" href="#configuring-http-load-balancing"></a>7 Configuring HTTP Load Balancing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to configure HTTP load balancing on Eclipse GlassFish 7.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#setting-up-http-load-balancing">Setting Up HTTP Load Balancing</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information on other types of load balancing, see
<a href="#configuring-java-message-service-high-availability">Configuring Java Message Service High Availability</a>
and <a href="#rmi-iiop-load-balancing-and-failover">RMI-IIOP Load Balancing and Failover</a>.</p>
</div>
<div class="sect2">
<h3 id="setting-up-http-load-balancing"><a class="anchor" href="#setting-up-http-load-balancing"></a>Setting Up HTTP Load Balancing</h3>
<div class="paragraph">
<p>This section describes how to set up load balancing for Eclipse GlassFish.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#prerequisites-for-setting-up-http-load-balancing">Prerequisites for Setting Up HTTP Load Balancing</a></p>
</li>
<li>
<p><a href="#configuring-glassfish-server-with-apache-http-server-and-mod_jk">Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_jk</code></a></p>
</li>
<li>
<p><a href="#configuring-glassfish-server-with-apache-http-server-and-mod_proxy_ajp">Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_proxy_ajp</code></a></p>
</li>
<li>
<p><a href="#http-load-balancer-deployments">HTTP Load Balancer Deployments</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="prerequisites-for-setting-up-http-load-balancing"><a class="anchor" href="#prerequisites-for-setting-up-http-load-balancing"></a>Prerequisites for Setting Up HTTP Load Balancing</h4>
<div class="paragraph">
<p>Before configuring your load balancer, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install a supported web server and configure it. If using the <code>mod_jk</code>
or <code>mod_proxy_ajp</code> modules, the only supported web server is Apache HTTP Server 2.2.x.</p>
</li>
<li>
<p>Configure the <code>mod_jk</code> connector module, as described in
<a href="#configuring-glassfish-server-with-apache-http-server-and-mod_jk">Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_jk</code></a>,
or configure the <code>mod_proxy_ajp</code> connector module, as
described in <a href="#configuring-glassfish-server-with-apache-http-server-and-mod_proxy_ajp">Configuring Eclipse GlassFish with Apache
HTTP Server and <code>mod_proxy_ajp</code></a>.</p>
</li>
<li>
<p>Create Eclipse GlassFish clusters or server instances to participate in load balancing.</p>
</li>
<li>
<p>Deploy applications to these clusters or instances.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuring-glassfish-server-with-apache-http-server-and-mod_jk"><a class="anchor" href="#configuring-glassfish-server-with-apache-http-server-and-mod_jk"></a>Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_jk</code></h4>
<div class="paragraph">
<p>Eclipse GlassFish 7 can be configured for load balancing with Apache
HTTP Server as a front end by enabling the Apache <code>mod_jk</code> connector
module. To enable the <code>mod_jk</code> module in Eclipse GlassFish, set the
Eclipse GlassFish <code>jk-enabled</code> <code>network-listener</code> attribute. You can also
create <code>jk-connectors</code> under different virtual-servers using the
<code>jk-enabled</code> <code>network-listener</code> attribute.</p>
</div>
<div class="sect4">
<h5 id="to-configure-the-mod_jk-connector-module"><a class="anchor" href="#to-configure-the-mod_jk-connector-module"></a>To Configure the <code>mod_jk</code> Connector Module</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install <a href="http://httpd.apache.org/docs/2.2/install.html">Apache HTTP Server</a>
(<code><a href="http://httpd.apache.org/docs/2.2/install.html" class="bare">http://httpd.apache.org/docs/2.2/install.html</a></code>) and
<a href="http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html">mod_jk</a>
(<code><a href="http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html" class="bare">http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html</a></code>).</p>
</li>
<li>
<p>Configure <code>workers.properties</code> and <code>httpd.conf</code>. For example:</p>
<div class="ulist">
<ul>
<li>
<p><code>apache2/config/workers.properties</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code># Define 1 real worker using ajp13
worker.list=worker1
# Set properties for worker1 (ajp13)
worker.worker1.type=ajp13
worker.worker1.host=localhost
worker.worker1.port=8009</code></pre>
</div>
</div>
</li>
<li>
<p><code>apache2/conf/httpd.conf</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>LoadModule jk_module /Users/Amy/apache2/modules/mod_jk-1.2.25-httpd-2.2.4.so
JkWorkersFile /Users/Amy/apache2/conf/worker.properties
# Where to put jk logs
JkLogFile /Users/Amy/apache2/logs/mod_jk.log
# Set the jk log level [debug/error/info]
JkLogLevel debug
# Select the log format
JkLogStampFormat &quot;[%a %b %d %H:%M:%S %Y] &quot;
# JkOptions indicate to send SSL KEY SIZE,
JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories
# JkRequestLogFormat set the request format
JkRequestLogFormat &quot;%w %V %T&quot;
# Send everything for context /examples to worker named worker1 (ajp13)
JkMount /examples/* worker1</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Start Apache HTTP Server.</p>
</li>
<li>
<p>Create a jk-enabled network listener by using the
<a href="reference-manual.html#create-network-listener"><code>create-network-listener</code></a> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-network-listener --protocol http-listener-1 \
--listenerport 8009 --jkenabled true jk-connector</code></pre>
</div>
</div>
</li>
<li>
<p>If you are using the <code>glassfish-jk.properties</code> file, set the
<code>jk-configuration-file</code> property of the network listener to the
fully-qualified file name of the <code>glassfish-jk.properties</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set server-config.network-config.network-listeners.network-listener.\
jk-connector.jk-configuration-file=domain-dir/config/glassfish-jk.properties</code></pre>
</div>
</div>
</li>
<li>
<p>If you expect to need more than five threads for the listener,
increase the maximum threads in the <code>http-thread-pool</code> pool:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set configs.config.server-config.thread-pools.thread-pool.\
http-thread-pool.max-thread-pool-size=value</code></pre>
</div>
</div>
</li>
<li>
<p>Restart Eclipse GlassFish.</p>
</li>
</ol>
</div>
<div id="gktpu" class="paragraph">
<p>Example 7-1 <code>httpd.conf</code> File for Load Balancing</p>
</div>
<div class="paragraph">
<p>This example shows an <code>httpd.conf</code> file that is set for load balancing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>LoadModule jk_module /usr/lib/httpd/modules/mod_jk.so
JkWorkersFile /etc/httpd/conf/worker.properties
# Where to put jk logs
JkLogFile /var/log/httpd/mod_jk.log
# Set the jk log level [debug/error/info]
JkLogLevel debug
# Select the log format
JkLogStampFormat &quot;[%a %b %d %H:%M:%S %Y] &quot;
# JkOptions indicate to send SSL KEY SIZE,
JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories
# JkRequestLogFormat set the request format
JkRequestLogFormat &quot;%w %V %T&quot;
# Send all jsp requests to GlassFish
JkMount /*.jsp worker1
# Send all glassfish-test requests to GlassFish
JkMount /glassfish-test/* loadbalancer</code></pre>
</div>
</div>
<div id="gktpe" class="paragraph">
<p>Example 7-2 <code>workers.properties</code> File for Load Balancing</p>
</div>
<div class="paragraph">
<p>This example shows a <code>workers.properties</code> or <code>glassfish-jk.properties</code>
file that is set for load balancing. The <code>worker.worker*.port</code> should
match with JK ports you created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>worker.list=worker1,worker2,loadbalancer
worker.worker1.type=ajp13
worker.worker1.host=localhost
worker.worker1.port=8009
worker.worker1.lbfactor=1
worker.worker1.socket_keepalive=1
worker.worker1.socket_timeout=300
worker.worker2.type=ajp13
worker.worker2.host=localhost
worker.worker2.port=8010
worker.worker2.lbfactor=1
worker.worker2.socket_keepalive=1
worker.worker2.socket_timeout=300
worker.loadbalancer.type=lb
worker.loadbalancer.balance_workers=worker1,worker2</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-glassfish-server-with-apache-http-server-and-mod_proxy_ajp"><a class="anchor" href="#configuring-glassfish-server-with-apache-http-server-and-mod_proxy_ajp"></a>Configuring Eclipse GlassFish with Apache HTTP Server and <code>mod_proxy_ajp</code></h4>
<div class="paragraph">
<p>Eclipse GlassFish 7 can be configured for load balancing with Apache
HTTP Server as a front end by enabling the Apache <code>mod_proxy_ajp</code>
connector module. To enable the <code>mod_proxy_ajp</code> module in Eclipse GlassFish, set the Eclipse GlassFish <code>jk-enabled</code> <code>network-listener</code>
attribute. You can also create <code>jk-connectors</code> under different
virtual-servers using the <code>jk-enabled</code> <code>network-listener</code> attribute.</p>
</div>
<div class="sect4">
<h5 id="to-configure-the-mod_proxy_ajp-connector-module"><a class="anchor" href="#to-configure-the-mod_proxy_ajp-connector-module"></a>To Configure the <code>mod_proxy_ajp</code> Connector Module</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install <a href="http://httpd.apache.org/docs/2.2/install.html">Apache HTTP Server</a>
(<code><a href="http://httpd.apache.org/docs/2.2/install.html" class="bare">http://httpd.apache.org/docs/2.2/install.html</a></code>).</p>
</li>
<li>
<p>Configure <code>httpd.conf</code>. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>LoadModule proxy_module /usr/lib/httpd/modules/mod_proxy.so
LoadModule proxy_ajp_module /usr/lib/httpd/modules/mod_proxy_ajp.so

Listen 1979
NameVirtualHost *:1979
&lt;VirtualHost *:1979&gt;
   ServerName localhost
   ErrorLog /var/log/apache2/ajp.error.log
   CustomLog /var/log/apache2/ajp.log combined

   &lt;Proxy *&gt;
     AddDefaultCharset Off
     Order deny,allow
     Allow from all
   &lt;/Proxy&gt;

   ProxyPass / ajp://localhost:8009/
   ProxyPassReverse / ajp://localhost:8009/
&lt;/VirtualHost&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Start Apache HTTP Server.</p>
</li>
<li>
<p>Create a jk-enabled network listener by using the <code>create-network-listener</code> subcommand.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; create-network-listener --protocol http-listener-1 \
--listenerport 8009 --jkenabled true jk-connector</code></pre>
</div>
</div>
</li>
<li>
<p>If you expect to need more than five threads for the listener,
increase the maximum threads in the <code>http-thread-pool</code> pool:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set configs.config.server-config.thread-pools.thread-pool.\
http-thread-pool.max-thread-pool-size=value</code></pre>
</div>
</div>
</li>
<li>
<p>Restart Eclipse GlassFish.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="http-load-balancer-deployments"><a class="anchor" href="#http-load-balancer-deployments"></a>HTTP Load Balancer Deployments</h4>
<div class="paragraph">
<p>You can configure your load balancer in different ways, depending on
your goals and environment, as described in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#using-clustered-server-instances">Using Clustered Server Instances</a></p>
</li>
<li>
<p><a href="#using-multiple-standalone-instances">Using Multiple Standalone Instances</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="using-clustered-server-instances"><a class="anchor" href="#using-clustered-server-instances"></a>Using Clustered Server Instances</h5>
<div class="paragraph">
<p>The most common way to deploy the load balancer is with a cluster or
clusters of server instances. By default all the instances in a cluster
have the same configuration and the same applications deployed to them.
The load balancer distributes the workload between the server instances
and requests fail over from an unhealthy instance to a healthy one. If
you&#8217;ve configured HTTP session persistence, session information persists
when the request is failed over.</p>
</div>
<div class="paragraph">
<p>If you have multiple clusters, requests can be load balanced across
clusters but are only failed over between the instances in a single
cluster. Use multiple clusters in a load balancer to easily enable
rolling upgrades of applications. For more information, see
<a href="#upgrading-applications-without-loss-of-availability">Upgrading Applications Without Loss of Availability</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Requests cannot be load balanced across clusters and standalone instances.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="using-multiple-standalone-instances"><a class="anchor" href="#using-multiple-standalone-instances"></a>Using Multiple Standalone Instances</h5>
<div class="paragraph">
<p>It is also possible to configure your load balancer to use multiple
standalone instances, and load balance and failover requests between
them. However, in this configuration, you must manually ensure that the
standalone instances have homogenous environments and the same
applications deployed to them. Because clusters automatically maintain a
homogenous environment, for most situations it is better and easier to
use clusters.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Load balancing across multiple standalone instances only provides
failover for requests, and any associated HTTP session data will not be
failed over. This is another reason why using a cluster, which can
provide session failover, is a more desirable load balancing
configuration.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-applications-without-loss-of-availability"><a class="anchor" href="#upgrading-applications-without-loss-of-availability"></a>8 Upgrading Applications Without Loss of Availability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Upgrading an application to a new version without loss of availability
to users is called a rolling upgrade. Carefully managing the two
versions of the application across the upgrade ensures that current
users of the application complete their tasks without interruption,
while new users transparently get the new version of the application.
With a rolling upgrade, users are unaware that the upgrade occurs.</p>
</div>
<div class="paragraph">
<p>For more information about application versions and how they are
identified, see "<a href="application-deployment-guide.html#module-and-application-versions">Module and Application Versions</a>" in
Eclipse GlassFish Application Deployment Guide.</p>
</div>
<div class="paragraph">
<p>In a clustered environment, a rolling upgrade redeploys an application
with a minimal loss of service and sessions. A session is any artifact
that can be replicated, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HttpSession</code></p>
</li>
<li>
<p><code>SingleSignOn</code></p>
</li>
<li>
<p><code>ServletTimer</code></p>
</li>
<li>
<p><code>DialogFragment</code></p>
</li>
<li>
<p>Stateful session bean</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A rolling upgrade can take place under light to moderate loads. The
procedure requires about 10-15 minutes for each Eclipse GlassFish
instance.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To prevent the risk of version mismatch when a session fails over,
upgrade all instances in a cluster at the same time. Otherwise a session
might fail over to an instance where different versions of components
are running.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Perform this task on each cluster separately. A cluster acts as a safe
boundary for session failover for instances in the cluster. Sessions in
one cluster can never fail over to sessions in another cluster.
Therefore, the risk of version mismatch is avoided.</p>
</div>
<div class="sect2">
<h3 id="application-compatibility"><a class="anchor" href="#application-compatibility"></a>Application Compatibility</h3>
<div class="paragraph">
<p>Rolling upgrades pose varying degrees of difficulty depending on the
magnitude of changes between the two application versions.</p>
</div>
<div class="paragraph">
<p>If the changes are superficial, for example, changes to static text and
images, the two versions of the application are compatible and can both
run at once in the same cluster.</p>
</div>
<div class="paragraph">
<p>Compatible applications must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the same session information</p>
</li>
<li>
<p>Use compatible database schemas</p>
</li>
<li>
<p>Have generally compatible application-level business logic</p>
</li>
<li>
<p>Use the same physical data source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can perform a rolling upgrade of a compatible application in either
a single cluster or multiple clusters. For more information, see
<a href="#upgrading-in-a-single-cluster">Upgrading In a Single Cluster</a>.</p>
</div>
<div class="paragraph">
<p>If the two versions of an application do not meet all the above
criteria, then the applications are considered incompatible. Executing
incompatible versions of an application in one cluster can corrupt
application data and cause session failover to not function correctly.
The problems depend on the type and extent of the incompatibility. It is
good practice to upgrade an incompatible application by creating a
"shadow cluster" to which to deploy the new version and slowly quiesce
the old cluster and application. For more information, see
<a href="#upgrading-incompatible-applications">Upgrading Incompatible Applications</a>.</p>
</div>
<div class="paragraph">
<p>The application developer and administrator are the best people to
determine whether application versions are compatible. If in doubt,
assume that the versions are incompatible, since this is the safest
approach.</p>
</div>
</div>
<div class="sect2">
<h3 id="upgrading-in-a-single-cluster"><a class="anchor" href="#upgrading-in-a-single-cluster"></a>Upgrading In a Single Cluster</h3>
<div class="paragraph">
<p>You can perform a rolling upgrade of an application deployed to a single
cluster, providing the cluster&#8217;s configuration is not shared with any
other cluster.</p>
</div>
<div class="sect3">
<h4 id="to-upgrade-an-application-in-a-single-cluster"><a class="anchor" href="#to-upgrade-an-application-in-a-single-cluster"></a>To Upgrade an Application in a Single Cluster</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the upgraded application to the cluster in a disabled state
and with a new version identifier. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; asadmin deploy --enabled=false --target myCluster myApp:1.1</code></pre>
</div>
</div>
</li>
<li>
<p>Perform the following steps for each server instance in the cluster.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Quiesce one server instance in the cluster from the load balancer.
Follow these steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Disable the server instance using <code>asadmin disable-http-lb-server.</code></p>
</li>
<li>
<p>Export the load balancer configuration file using
<code>asadmin export-http-lb-config</code>.</p>
</li>
<li>
<p>Copy the exported configuration file to the web server instance&#8217;s
configuration directory.<br>
For example, for Sun Java System Web Server, the location is
web-server-install-dir<code>/https-</code>host-name<code>/config/loadbalancer.xml</code>.</p>
</li>
<li>
<p>Wait until the timeout has expired.<br>
Monitor the load balancer&#8217;s log file.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Enable the upgraded application version on the quiesced server instance.<br>
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; asadmin enable --target instance01 myApp:1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enabling the upgraded application version automatically disables the previous version.</p>
</div>
</li>
<li>
<p>Test the upgraded application on the server instance to make sure it runs correctly.</p>
</li>
<li>
<p>Re-enable the server instance in load balancer. Follow these steps:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Enable the server instance using <code>asadmin enable-http-lb-server.</code></p>
</li>
<li>
<p>Export the load balancer configuration file using
<code>asadmin export-http-lb-config</code>.</p>
</li>
<li>
<p>Copy the configuration file to the web server&#8217;s configuration directory.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading-in-multiple-clusters"><a class="anchor" href="#upgrading-in-multiple-clusters"></a>Upgrading in Multiple Clusters</h3>
<div class="sect3">
<h4 id="to-upgrade-a-compatible-application-in-two-or-more-clusters"><a class="anchor" href="#to-upgrade-a-compatible-application-in-two-or-more-clusters"></a>To Upgrade a Compatible Application in Two or More Clusters</h4>
<div class="paragraph">
<p>Repeat the following procedure for each cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the upgraded application to one cluster in a disabled state
and with a new version identifier. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; asadmin deploy --enabled=false --target myCluster myApp:1.1</code></pre>
</div>
</div>
</li>
<li>
<p>Quiesce the cluster with the upgraded application from the load balancer.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Disable the cluster using <code>asadmin disable-http-lb-server</code>.</p>
</li>
<li>
<p>Export the load balancer configuration file using
<code>asadmin export-http-lb-config</code>.</p>
</li>
<li>
<p>Copy the exported configuration file to the web server instance&#8217;s configuration directory.<br>
For example, for Sun Java System Web Server, the location is
web-server-install-dir<code>/https-</code>host-name<code>/config/loadbalancer.xml</code>.</p>
</li>
<li>
<p>Wait until the timeout has expired.<br>
Monitor the load balancer&#8217;s log file.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Enable the upgraded application version on the quiesced cluster. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; asadmin enable --target myCluster myApp:1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enabling the upgraded application version automatically disables the
previous version.</p>
</div>
</li>
<li>
<p>Test the upgraded application on the cluster to make sure it runs correctly.</p>
</li>
<li>
<p>Enable the cluster in the load balancer:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable the cluster using <code>asadmin enable-http-lb-server.</code></p>
</li>
<li>
<p>Export the load balancer configuration file using
<code>asadmin export-http-lb-config</code>.</p>
</li>
<li>
<p>Copy the configuration file to the web server&#8217;s configuration directory.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading-incompatible-applications"><a class="anchor" href="#upgrading-incompatible-applications"></a>Upgrading Incompatible Applications</h3>
<div class="paragraph">
<p>If the new version of the application is incompatible with the old
version, use the following procedure. For information on what makes
applications compatible, see <a href="#application-compatibility">Application Compatibility</a>.
Also, you must upgrade incompatible application in two or more clusters.
If you have only one cluster, create a "shadow cluster" for the upgrade,
as described below.</p>
</div>
<div class="paragraph">
<p>When upgrading an incompatible application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Give the new version of the application a different version identifier
from the old version of the application. The steps below assume that the
application has a new version identifier.</p>
</li>
<li>
<p>If the data schemas are incompatible, use different physical data
sources after planning for data migration.</p>
</li>
<li>
<p>Deploy the new version to a different cluster from the cluster where
the old version is deployed.</p>
</li>
<li>
<p>Set an appropriately long timeout for the cluster running the old
application before you take it offline, because the requests for the
application won&#8217;t fail over to the new cluster. These user sessions will
simply fail.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-upgrade-an-incompatible-application-by-creating-a-second-cluster"><a class="anchor" href="#to-upgrade-an-incompatible-application-by-creating-a-second-cluster"></a>To Upgrade an Incompatible Application by Creating a Second Cluster</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a "shadow cluster" on the same or a different set of machines
as the existing cluster. If you already have a second cluster, skip this
step.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the Administration Console to create the new cluster and
reference the existing cluster&#8217;s named configuration.<br>
Customize the ports for the new instances on each machine to avoid
conflict with existing active ports.</p>
</li>
<li>
<p>For all resources associated with the cluster, add a resource
reference to the newly created cluster using
<code>asadmin create-resource-ref</code>.</p>
</li>
<li>
<p>Create a reference to all other applications deployed to the cluster
(except the current upgraded application) from the newly created cluster
using <code>asadmin create-application-ref</code>.</p>
</li>
<li>
<p>Configure the cluster to be highly available using
<code>asadmin configure-ha-cluster</code>.</p>
</li>
<li>
<p>Create reference to the newly-created cluster in the load balancer
configuration file using <code>asadmin create-http-lb-ref.</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Give the new version of the application a different version
identifier from the old version.</p>
</li>
<li>
<p>Deploy the new application version with the new cluster as the
target. Use a different context root or roots.</p>
</li>
<li>
<p>Start the new cluster while the other cluster is still running.<br>
The start causes the cluster to synchronize with the domain and be
updated with the new application.</p>
</li>
<li>
<p>Test the application on the new cluster to make sure it runs correctly.</p>
</li>
<li>
<p>Disable the old cluster from the load balancer using
<code>asadmin disable-http-lb-server</code>.</p>
</li>
<li>
<p>Set a timeout for how long lingering sessions survive.</p>
</li>
<li>
<p>Enable the new cluster from the load balancer using
<code>asadmin enable-http-lb-server</code>.</p>
</li>
<li>
<p>Export the load balancer configuration file using
<code>asadmin export-http-lb-config</code>.</p>
</li>
<li>
<p>Copy the exported configuration file to the web server instance&#8217;s configuration directory.<br>
For example, for Sun Java System Web Server, the location is
web-server-install-dir<code>/https-</code>host-name<code>/config/loadbalancer.xml</code>.</p>
</li>
<li>
<p>After the timeout period expires or after all users of the old
application have exited, stop the old cluster and undeploy the old
application version.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-high-availability-session-persistence-and-failover"><a class="anchor" href="#configuring-high-availability-session-persistence-and-failover"></a>9 Configuring High Availability Session Persistence and Failover</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter explains how to enable and configure high availability
session persistence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#overview-of-session-persistence-and-failover">Overview of Session Persistence and Failover</a></p>
</li>
<li>
<p><a href="#enabling-the-high-availability-session-persistence-service">Enabling the High Availability Session Persistence Service</a></p>
</li>
<li>
<p><a href="#stateful-session-bean-failover">Stateful Session Bean Failover</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="overview-of-session-persistence-and-failover"><a class="anchor" href="#overview-of-session-persistence-and-failover"></a>Overview of Session Persistence and Failover</h3>
<div class="paragraph">
<p>Eclipse GlassFish provides high availability session persistence through
failover of HTTP session data and stateful session bean (SFSB) session
data. Failover means that in the event of an server instance or hardware
failure, another server instance in a cluster takes over a distributed session.</p>
</div>
<div class="paragraph">
<p>For example, Jakarta EE applications typically have significant amounts of
session state data. A web shopping cart is the classic example of
session state. Also, an application can cache frequently-needed data in
the session object. In fact, almost all applications with significant
user interactions need to maintain session state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using high availability session persistence together with a load
balancer, use a load balancer that includes session-based stickiness as
part of its load-balancing algorithm. Otherwise, session data can be
misdirected or lost. An example of a load balancer that includes
session-based stickiness is the Loadbalancer Plug-In available in Eclipse GlassFish.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#requirements">Requirements</a></p>
</li>
<li>
<p><a href="#restrictions">Restrictions</a></p>
</li>
<li>
<p><a href="#scope">Scope</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="requirements"><a class="anchor" href="#requirements"></a>Requirements</h4>
<div class="paragraph">
<p>A distributed session can run in multiple Eclipse GlassFish
instances, if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each server instance has access to the same session state data.
Eclipse GlassFish supports in-memory session replication on other servers
in the cluster for maintaining HTTP session and stateful session bean
data. In-memory session replication is enabled by default for Eclipse GlassFish clustered environments if the Group Management Service is enabled.</p>
<div class="paragraph">
<p>The use of in-memory replication requires the Group Management Service
(GMS) to be enabled. For more information about GMS, see
<a href="#group-management-service">Group Management Service</a>.</p>
</div>
<div class="paragraph">
<p>If server instances in a cluster are located on different hosts, ensure
that the following prerequisites are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To ensure that GMS and in-memory replication function correctly, the
hosts must be on the same subnet.</p>
</li>
<li>
<p>To ensure that in-memory replication functions correctly, the system
clocks on all hosts in the cluster must be synchronized as closely as
possible.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Eclipse GlassFish 7 does not support High Availability Database (HADB)
configurations. Instead, use in-memory replication, as described in
<a href="#high-availability-session-persistence">High Availability Session Persistence</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Each server instance has the same distributable web application
deployed to it. The <code>web-app</code> element of the <code>web.xml</code> deployment
descriptor file must contain the <code>distributable</code> element.</p>
</li>
<li>
<p>The web application uses high-availability session persistence. If a
non-distributable web application is configured to use high-availability
session persistence, the server writes an error to the log file.</p>
</li>
<li>
<p>The web application must be deployed using the <code>deploy</code> or <code>deploydir</code>
subcommand with the <code>--availabilityenabled</code> option set to <code>true</code>. For
more information on these subcommands, see <a href="reference-manual.html#deploy"><code>deploy</code>(1)</a>
and <a href="reference-manual.html#deploydir"><code>deploydir</code>(1)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="restrictions"><a class="anchor" href="#restrictions"></a>Restrictions</h4>
<div class="paragraph">
<p>When configuring session persistence and failover, note the following restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a session fails over, any references to open files or network
connections are lost. Applications must be coded with this restriction in mind.</p>
</li>
<li>
<p>EJB Singletons are created for each server instance in a cluster, and
not once per cluster.</p>
</li>
<li>
<p>The high availability session persistence service is not compatible
with dynamic deployment, dynamic reloading, and autodeployment. These
features are for development, not production environments, so you must
disable them before enabling the session persistence service.
For information about how to disable these features, see the
<a href="application-deployment-guide.html#GSDPG">
Eclipse GlassFish Application Deployment Guide</a>.</p>
</li>
<li>
<p>Eclipse GlassFish 7 does not support High Availability Database
(HADB) configurations. Instead, use in-memory replication, as described
in <a href="#high-availability-session-persistence">High Availability Session Persistence</a>.</p>
</li>
<li>
<p>You can only bind certain objects to distributed sessions that support
failover. Contrary to the Servlet 2.4 specification, Eclipse GlassFish 7 does not throw an <code>IllegalArgumentException</code> if an object type not
supported for failover is bound into a distributed session.</p>
<div class="paragraph">
<p>You can bind the following objects into a distributed session that
supports failover:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Local home and object references for all EJB components.</p>
</li>
<li>
<p>Colocated stateless session, stateful session, or entity bean reference .</p>
</li>
<li>
<p>Distributed stateless session, stateful session, or entity bean reference.</p>
</li>
<li>
<p>JNDI Context for <code>InitialContext</code> and <code>java:comp/env</code>.</p>
</li>
<li>
<p><code>UserTransaction</code> objects. However, if the instance that fails is
never restarted, any prepared global transactions are lost and might not
be correctly rolled back or committed.</p>
</li>
<li>
<p>Serializable Java types.</p>
</li>
</ul>
</div>
</li>
<li>
<p>You cannot bind the following object types into sessions that support failover:</p>
<div class="ulist">
<ul>
<li>
<p>JDBC DataSource</p>
</li>
<li>
<p>Java Message Service (JMS) <code>ConnectionFactory</code> and <code>Destination</code> objects</p>
</li>
<li>
<p>Jakarta Mail Session</p>
</li>
<li>
<p>Connection Factory</p>
</li>
<li>
<p>Administered Objects</p>
</li>
<li>
<p>Web service reference<br>
In general, for these objects, failover will not work. However, failover
might work in some cases, if for example the object is serializable.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="scope"><a class="anchor" href="#scope"></a>Scope</h4>
<div class="paragraph">
<p>The availability service can be enabled for the following scopes,
ranging from highest to lowest:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cluster</p>
</li>
<li>
<p>Standalone server instance (not part of a cluster)</p>
</li>
<li>
<p>Web, EJB, or JMS container in a cluster</p>
</li>
<li>
<p>Application</p>
</li>
<li>
<p>Standalone Web, EJB, or JMS module</p>
</li>
<li>
<p>Individual Stateful Session Bean (SFSB)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general, enabling or disabling availability session persistence for a
cluster or container involves setting the boolean <code>availability-service</code>
property to <code>true</code> or <code>false</code> by means of the <code>asadmin set</code> subcommand.
The availability service is enabled by default for Eclipse GlassFish
clusters and all Web, EJB, and JMS containers running in a cluster.</p>
</div>
<div class="paragraph">
<p>The value set for the <code>availability-service</code> property is inherited by
all child objects running in a given cluster or container unless the
value is explicitly overridden at the individual module or application
level. For example, if the <code>availability-service</code> property is set to
<code>true</code> for an EJB container, the availability service will be enabled by
default for all EJB modules running in that container.</p>
</div>
<div class="paragraph">
<p>Conversely, to enable availability at a given scope, you must enable it
at all higher levels as well. For example, to enable availability at the
application level, you must also enable it at the cluster or server
instance and container levels.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enabling-the-high-availability-session-persistence-service"><a class="anchor" href="#enabling-the-high-availability-session-persistence-service"></a>Enabling the High Availability Session Persistence Service</h3>
<div class="paragraph">
<p>This section explains how to configure and enable the high availability
session persistence service.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#to-enable-availability-for-a-cluster-standalone-instance-or-container">To Enable Availability for a Cluster, Standalone Instance or Container</a></p>
</li>
<li>
<p><a href="#configuring-availability-for-individual-web-applications">Configuring Availability for Individual Web Applications</a></p>
</li>
<li>
<p><a href="#configuring-replication-and-multi-threaded-concurrent-access-to-httpsessions">Configuring Replication and Multi-Threaded Concurrent Access to <code>HttpSessions</code></a></p>
</li>
<li>
<p><a href="#using-single-sign-on-with-session-failover">Using Single Sign-on with Session Failover</a></p>
</li>
<li>
<p><a href="#using-coherenceweb-for-http-session-persistence">Using Coherence*Web for HTTP Session Persistence</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="to-enable-availability-for-a-cluster-standalone-instance-or-container"><a class="anchor" href="#to-enable-availability-for-a-cluster-standalone-instance-or-container"></a>To Enable Availability for a Cluster, Standalone Instance or Container</h4>
<div class="paragraph">
<p>This procedure explains how to enable high availability for a cluster as
a whole, or for Web, EJB, or JMS containers that run in a cluster, or
for a standalone server instance that is not part of a cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Eclipse GlassFish cluster.</p>
<div class="paragraph">
<p>For more information, see <a href="#to-create-a-cluster">To Create a Cluster</a>.</p>
</div>
</li>
<li>
<p>Set up load balancing for the cluster.</p>
<div class="paragraph">
<p>For instructions, see <a href="#setting-up-http-load-balancing">Setting Up HTTP Load Balancing</a>.</p>
</div>
</li>
<li>
<p>Verify that the cluster and all instances within the cluster for
which you want to enable availability is running.</p>
<div class="paragraph">
<p>These steps are also necessary when enabling availability for a Web,
EJB, or JMS container running in a cluster. The cluster and all
instances in the cluster for which you want to enable availability must be running.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that the cluster is running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-clusters</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list of clusters and their status (running, not running) is displayed.
If the cluster for which you want to enable availability is not running,
you can start it with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-cluster cluster-name</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that all instances in the cluster are running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list of instances and their status is displayed. If the instances for
which you want to enable availability are not running, you can start
them by using the following command for each instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; start-instance instance-name</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Use one of the following <code>asadmin</code> <a href="reference-manual.html#set"><code>set</code></a>
subcommands to enable availability for a specific cluster, or for a
specific Web, EJB, or JMS container.</p>
<div class="ulist">
<ul>
<li>
<p>For a cluster as a whole</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set cluster-name-config.availability-service.availability-enabled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, for a cluster named <code>c1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set c1-config.availability-service.availability-enabled=true</code></pre>
</div>
</div>
</li>
<li>
<p>For the Web container in a cluster</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set cluster-name-config.availability-service \
.web-container-availability.availability-enabled=true</code></pre>
</div>
</div>
</li>
<li>
<p>For the EJB container in a cluster</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set cluster-name-config.availability-service \
.ejb-container-availability.availability-enabled=true</code></pre>
</div>
</div>
</li>
<li>
<p>For the JMS container in a cluster</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set cluster-name-config.availability-service \
.jms-availability.availability-enabled=true</code></pre>
</div>
</div>
</li>
<li>
<p>For a standalone server instance (not part of a cluster)</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set instance-name-config.availability-service.availability-enabled=true</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Restart the standalone server instance or each server instance in the cluster.</p>
</li>
<li>
<p>Enable availability for any SFSB that requires it.</p>
<div class="paragraph">
<p>Select methods for which checkpointing the session state is necessary.
For more information, see <a href="#configuring-availability-for-an-individual-bean">Configuring Availability for an Individual Bean</a>.</p>
</div>
</li>
<li>
<p>Make each web module distributable if you want it to be highly available.</p>
<div class="paragraph">
<p>For more information, see "<a href="application-deployment-guide.html#web-module-deployment-guidelines">Web Module Deployment
Guidelines</a>" in Eclipse GlassFish Application Deployment Guide.</p>
</div>
</li>
<li>
<p>Enable availability for individual applications, web modules, or EJB
modules during deployment.</p>
<div class="paragraph">
<p>See the links below for instructions.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#configuring-availability-for-individual-web-applications">Configuring Availability for Individual Web Applications</a></p>
</li>
<li>
<p><a href="#using-single-sign-on-with-session-failover">Using Single Sign-on with Session Failover</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuring-availability-for-individual-web-applications"><a class="anchor" href="#configuring-availability-for-individual-web-applications"></a>Configuring Availability for Individual Web Applications</h4>
<div class="paragraph">
<p>To enable and configure availability for an individual web application,
edit the application deployment descriptor file, <code>glassfish-web.xml</code>.
The settings in an application&#8217;s deployment descriptor override the web
container&#8217;s availability settings.</p>
</div>
<div class="paragraph">
<p>The <code>session-manager</code> element&#8217;s <code>persistence-type</code> attribute determines
the type of session persistence an application uses. It must be set to
<code>replicated</code> to enable high availability session persistence.</p>
</div>
<div class="sect4">
<h5 id="example"><a class="anchor" href="#example"></a>Example</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;glassfish-web-app&gt;</span> ...
  <span class="tag">&lt;session-config&gt;</span>
    <span class="tag">&lt;session-manager</span> <span class="attribute-name">persistence-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">replicated</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;manager-properties&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistenceFrequency</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">web-method</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;/manager-properties&gt;</span>
      <span class="tag">&lt;store-properties&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">persistenceScope</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">session</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
      <span class="tag">&lt;/store-properties&gt;</span>
    <span class="tag">&lt;/session-manager&gt;</span> ...
<span class="tag">&lt;/session-config&gt;</span> ...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-replication-and-multi-threaded-concurrent-access-to-httpsessions"><a class="anchor" href="#configuring-replication-and-multi-threaded-concurrent-access-to-httpsessions"></a>Configuring Replication and Multi-Threaded Concurrent Access to <code>HttpSessions</code></h4>
<div class="paragraph">
<p>If you are using Memory Replication and your web application involves
multiple client threads concurrently accessing the same session ID, then
you may experience session loss even without any instance failure. The
problem is that the Eclipse GlassFish 7 memory replication framework
makes use of session versioning. This feature was designed with the more
traditional HTTP request/response communication model in mind.</p>
</div>
<div class="paragraph">
<p>However, for some types of applications, the traditional
request/response model does not work. Examples include many Ajax-related
frameworks and the use of Frames. Another example is when a page
includes many static resources, such as JPG files. In these situations,
most browsers will optimize the loading of these resources by using
multiple parallel connections, each of which is handled by a separate
request processing thread. If the application has already established a
session, then this will also involve more than one thread at a time
accessing a single <code>HttpSession</code>.</p>
</div>
<div class="paragraph">
<p>The solution in such cases is to use the <code>relaxVersionSemantics</code>
property in the <code>glassfish-web.xml</code> deployment descriptor file for the
application. This enables the web container to return for each
requesting thread whatever version of the session that is in the active
cache regardless of the version number. This is critical when multiple
threads are interacting in an essentially non-deterministic fashion with
the container.</p>
</div>
<div class="sect4">
<h5 id="example-1"><a class="anchor" href="#example-1"></a>Example</h5>
<div class="paragraph">
<p>The following is an example snippet from a <code>glassfish-web.xml</code> file that
illustrates where to add the <code>relaxVersionSemantics</code> property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;glassfish-web-app&gt;</span>
  <span class="tag">&lt;session-config&gt;</span>
    <span class="tag">&lt;session-manager</span> <span class="attribute-name">persistence-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">replicated</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;manager-properties&gt;</span>
    <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">relaxCacheVersionSemantics</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;/manager-properties&gt;</span>
    <span class="tag">&lt;/session-manager&gt;</span>
  <span class="tag">&lt;/session-config&gt;</span>

.....
<span class="tag">&lt;/glassfish-web-app&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-single-sign-on-with-session-failover"><a class="anchor" href="#using-single-sign-on-with-session-failover"></a>Using Single Sign-on with Session Failover</h4>
<div class="paragraph">
<p>In a single application server instance, once a user is authenticated by
an application, the user is not required to re-authenticate individually
to other applications running on the same instance. This is called
single sign-on.</p>
</div>
<div class="paragraph">
<p>For this feature to continue to work even when an HTTP session fails
over to another instance in a cluster, single sign-on information must
be persisted using in-memory replication. To persist single sign-on
information, first, enable availability for the server instance and the
web container, then enable single-sign-on state failover.</p>
</div>
<div class="paragraph">
<p>You can enable single sign-on state failover by using the <code>asadmin set</code>
command to set the configuration&#8217;s
<code>availability-service.web-container-availability.sso-failover-enabled</code>
property to true.</p>
</div>
<div class="paragraph">
<p>For example, use the <code>set</code> command as follows, where <code>config1</code> is the
configuration name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set config1.availability-service.web-container-availability. \
sso-failover-enabled=&quot;true&quot;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="single-sign-on-groups"><a class="anchor" href="#single-sign-on-groups"></a>Single Sign-On Groups</h5>
<div class="paragraph">
<p>Applications that can be accessed through a single name and password
combination constitute a single sign-on group. For HTTP sessions
corresponding to applications that are part of a single sign-on group,
if one of the sessions times out, other sessions are not invalidated and
continue to be available. This is because time out of one session should
not affect the availability of other sessions.</p>
</div>
<div class="paragraph">
<p>As a corollary of this behavior, if a session times out and you try to
access the corresponding application from the same browser window that
was running the session, you are not required to authenticate again.
However, a new session is created.</p>
</div>
<div class="paragraph">
<p>Take the example of a shopping cart application that is a part of a
single sign-on group with two other applications. Assume that the
session time out value for the other two applications is higher than the
session time out value for the shopping cart application. If your
session for the shopping cart application times out and you try to run
the shopping cart application from the same browser window that was
running the session, you are not required to authenticate again.
However, the previous shopping cart is lost, and you have to create a
new shopping cart. The other two applications continue to run as usual
even though the session running the shopping cart application has timed
out.</p>
</div>
<div class="paragraph">
<p>Similarly, suppose a session corresponding to any of the other two
applications times out. You are not required to authenticate again while
connecting to the application from the same browser window in which you
were running the session.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This behavior applies only to cases where the session times out. If
single sign-on is enabled and you invalidate one of the sessions using
<code>HttpSession.invalidate()</code>, the sessions for all applications belonging
to the single sign-on group are invalidated. If you try to access any
application belonging to the single sign-on group, you are required to
authenticate again, and a new session is created for the client
accessing the application.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-coherenceweb-for-http-session-persistence"><a class="anchor" href="#using-coherenceweb-for-http-session-persistence"></a>Using Coherence*Web for HTTP Session Persistence</h4>
<div class="paragraph">
<p>Built on top of Oracle Coherence, Coherence*Web is an HTTP session
management module dedicated to managing session state in clustered
environments. Starting with Coherence 3.7 and Eclipse GlassFish 7,
there is a new feature of Coherence*Web called ActiveCache for
GlassFish. ActiveCache for GlassFish provides Coherence*Web
functionality in web applications deployed on Eclipse GlassFishs. Within
Eclipse GlassFish, Coherence*Web functions as an additional web container
persistence type, named <code>coherence-web</code>.</p>
</div>
<div class="paragraph">
<p>For information about how to configure and deploy Coherence*Web on
Eclipse GlassFish, see
<a href="http://download.oracle.com/docs/cd/E18686_01/coh.37/e18690/glassfish.html">Using
Coherence*Web with Eclipse GlassFish</a>
(<code><a href="http://docs.oracle.com/cd/E18686_01/coh.37/e18690/glassfish.html" class="bare">http://docs.oracle.com/cd/E18686_01/coh.37/e18690/glassfish.html</a></code>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="stateful-session-bean-failover"><a class="anchor" href="#stateful-session-bean-failover"></a>Stateful Session Bean Failover</h3>
<div class="paragraph">
<p>Stateful session beans (SFSBs) contain client-specific state. There is a
one-to-one relationship between clients and the stateful session beans.
At creation, the EJB container gives each SFSB a unique session ID that
binds it to a client.</p>
</div>
<div class="paragraph">
<p>An SFSB&#8217;s state can be saved in a persistent store in case a server
instance fails. The state of an SFSB is saved to the persistent store at
predefined points in its life cycle. This is called</p>
</div>
<div class="paragraph">
<p>checkpointing. If enabled, checkpointing generally occurs after the bean
completes any transaction, even if the transaction rolls back.</p>
</div>
<div class="paragraph">
<p>However, if an SFSB participates in a bean-managed transaction, the
transaction might be committed in the middle of the execution of a bean
method. Since the bean&#8217;s state might be undergoing transition as a
result of the method invocation, this is not an appropriate time to
checkpoint the bean&#8217;s state. In this case, the EJB container checkpoints
the bean&#8217;s state at the end of the corresponding method, provided the
bean is not in the scope of another transaction when that method ends.
If a bean-managed transaction spans across multiple methods,
checkpointing is delayed until there is no active transaction at the end
of a subsequent method.</p>
</div>
<div class="paragraph">
<p>The state of an SFSB is not necessarily transactional and might be
significantly modified as a result of non-transactional business
methods. If this is the case for an SFSB, you can specify a list of
checkpointed methods, as described in <a href="#specifying-methods-to-be-checkpointed">Specifying Methods to
Be Checkpointed</a></p>
</div>
<div class="paragraph">
<p>If a distributable web application references an SFSB, and the web
application&#8217;s session fails over, the EJB reference is also failed over.</p>
</div>
<div class="paragraph">
<p>If an SFSB that uses session persistence is undeployed while the
Eclipse GlassFish instance is stopped, the session data in the
persistence store might not be cleared. To prevent this, undeploy the
SFSB while the Eclipse GlassFish instance is running.</p>
</div>
<div class="sect3">
<h4 id="configuring-availability-for-the-ejb-container"><a class="anchor" href="#configuring-availability-for-the-ejb-container"></a>Configuring Availability for the EJB Container</h4>
<div class="paragraph">
<p>To enable availability for the EJB container use the <code>asadmin set</code>
command to set the following three properties for the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>availability-service.ejb-container-availability.availability-enabled</code></p>
</li>
<li>
<p><code>availability-service.ejb-container-availability.sfsb-persistence-type</code></p>
</li>
<li>
<p><code>availability-service.ejb-container-availability.sfsb-ha-persistence-type</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if <code>config1</code> is the configuration name, use the following
commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; set --user admin --passwordfile password.txt
--host localhost
--port 4849
config1.availability-service.
ejb-container-availability.availability-enabled=&quot;true&quot;

asadmin&gt; set --user admin --passwordfile password.txt --host localhost --port
4849
config1.availability-service.
ejb-container-availability.sfsb-persistence-type=&quot;file&quot;
asadmin&gt; set --user admin --passwordfile password.txt
--host localhost
--port 4849
config1.availability-service.
ejb-container-availability.sfsb-ha-persistence-type=&quot;replicated&quot;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="configuring-the-sfsb-session-store-when-availability-is-disabled"><a class="anchor" href="#configuring-the-sfsb-session-store-when-availability-is-disabled"></a>Configuring the SFSB Session Store When Availability Is Disabled</h5>
<div class="paragraph">
<p>If availability is disabled, the local file system is used for SFSB
state passivation, but not persistence. To change where the SFSB state
is stored, change the Session Store Location setting in the EJB
container. For information about configuring store properties, see the
Administration Console online help.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-availability-for-an-individual-application-or-ejb-module"><a class="anchor" href="#configuring-availability-for-an-individual-application-or-ejb-module"></a>Configuring Availability for an Individual Application or EJB Module</h4>
<div class="paragraph">
<p>You can enable SFSB availability for an individual application or EJB
module during deployment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are deploying with the Administration Console, check the
Availability Enabled checkbox.</p>
</li>
<li>
<p>If you are deploying using use the <code>asadmin deploy</code> or
<code>asadmin deploydir</code> commands, set the <code>--availabilityenabled</code> option to
<code>true</code>. For more information, see <a href="reference-manual.html#deploy"><code>deploy</code>(1)</a> and
<a href="reference-manual.html#deploydir"><code>deploydir</code>(1)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuring-availability-for-an-individual-bean"><a class="anchor" href="#configuring-availability-for-an-individual-bean"></a>Configuring Availability for an Individual Bean</h4>
<div class="paragraph">
<p>To enable availability and select methods to be checkpointed for an
individual SFSB, use the <code>glassfish-ejb-jar.xml</code> deployment descriptor
file.</p>
</div>
<div class="paragraph">
<p>To enable high availability session persistence, set
<code>availability-enabled="true"</code> in the <code>ejb</code> element.</p>
</div>
<div id="fxjqx" class="paragraph">
<p>Example 9-1 Example of an EJB Deployment Descriptor With Availability
Enabled</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;glassfish-ejb-jar&gt;</span>
    ...
    <span class="tag">&lt;enterprise-beans&gt;</span>
        ...
        <span class="tag">&lt;ejb</span> <span class="attribute-name">availability-enabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;ejb-name&gt;</span>MySFSB<span class="tag">&lt;/ejb-name&gt;</span>
        <span class="tag">&lt;/ejb&gt;</span>
        ...
    <span class="tag">&lt;/enterprise-beans&gt;</span>
<span class="tag">&lt;/glassfish-ejb-jar&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="specifying-methods-to-be-checkpointed"><a class="anchor" href="#specifying-methods-to-be-checkpointed"></a>Specifying Methods to Be Checkpointed</h4>
<div class="paragraph">
<p>If enabled, checkpointing generally occurs after the bean completes any
transaction, even if the transaction rolls back. To specify additional
optional checkpointing of SFSBs at the end of non-transactional business
methods that cause important modifications to the bean&#8217;s state, use the
<code>checkpoint-at-end-of-method</code> element in the <code>ejb</code> element of the
<code>glassfish-ejb-jar.xml</code> deployment descriptor file.</p>
</div>
<div class="paragraph">
<p>The non-transactional methods in the <code>checkpoint-at-end-of-method</code>
element can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>create()</code> methods defined in the home interface of the SFSB, if you
want to checkpoint the initial state of the SFSB immediately after
creation</p>
</li>
<li>
<p>For SFSBs using container managed transactions only, methods in the
remote interface of the bean marked with the transaction attribute
<code>TX_NOT_SUPPORTED</code> or <code>TX_NEVER</code></p>
</li>
<li>
<p>For SFSBs using bean managed transactions only, methods in which a
bean managed transaction is neither started nor committed</p>
<div class="paragraph">
<p>Any other methods mentioned in this list are ignored. At the end of
invocation of each of these methods, the EJB container saves the state
of the SFSB to persistent store.</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If an SFSB does not participate in any transaction, and if none of its
methods are explicitly specified in the <code>checkpoint-at-end-of-method</code>
element, the bean&#8217;s state is not checkpointed at all even if
<code>availability-enabled="true"</code> for this bean.</p>
</div>
<div class="paragraph">
<p>For better performance, specify a small subset of methods. The methods
should accomplish a significant amount of work or result in important
modification to the bean&#8217;s state.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="fxjqg" class="paragraph">
<p>Example 9-2 Example of EJB Deployment Descriptor Specifying Methods
Checkpointing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;glassfish-ejb-jar&gt;</span>
    ...
    <span class="tag">&lt;enterprise-beans&gt;</span>
        ...
        <span class="tag">&lt;ejb</span> <span class="attribute-name">availability-enabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;ejb-name&gt;</span>ShoppingCartEJB<span class="tag">&lt;/ejb-name&gt;</span>
            <span class="tag">&lt;checkpoint-at-end-of-method&gt;</span>
                <span class="tag">&lt;method&gt;</span>
                    <span class="tag">&lt;method-name&gt;</span>addToCart<span class="tag">&lt;/method-name&gt;</span>
                <span class="tag">&lt;/method&gt;</span>
            <span class="tag">&lt;/checkpoint-at-end-of-method&gt;</span>
        <span class="tag">&lt;/ejb&gt;</span>
        ...
    <span class="tag">&lt;/enterprise-beans&gt;</span>
<span class="tag">&lt;/glassfish-ejb-jar&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-java-message-service-high-availability"><a class="anchor" href="#configuring-java-message-service-high-availability"></a>10 Configuring Java Message Service High Availability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to configure the high availability features
of the Java Message Service (JMS). It covers how to configure Message
Queue broker clusters and how to use them to provide connection failover
and load balancing, as described in the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#using-message-queue-broker-clusters-with-glassfish-server">Using Message Queue Broker Clusters With Eclipse GlassFish</a></p>
</li>
<li>
<p><a href="#connection-failover">Connection Failover</a></p>
</li>
<li>
<p><a href="#load-balanced-delivery-to-mdbs">Load-Balanced Delivery to MDBs</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="using-message-queue-broker-clusters-with-glassfish-server"><a class="anchor" href="#using-message-queue-broker-clusters-with-glassfish-server"></a>Using Message Queue Broker Clusters With Eclipse GlassFish</h3>
<div class="paragraph">
<p>This section describes how the JMS service uses Message Queue broker
clusters to support high-availability JMS messaging in Eclipse GlassFish
clusters. It describes the different cluster and broker types that are
supported and how to configure them.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#about-message-queue-broker-clusters">About Message Queue Broker Clusters</a></p>
</li>
<li>
<p><a href="#configuring-glassfish-clusters-to-use-message-queue-broker-clusters">Configuring GlassFish Clusters to Use Message Queue Broker
Clusters</a></p>
</li>
<li>
<p><a href="#to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-with-master-broker">To Configure a GlassFish Cluster to Use an Embedded or
Local Conventional Broker Cluster With Master Broker</a></p>
</li>
<li>
<p><a href="#to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-of-peer-brokers">To Configure a GlassFish Cluster to Use an Embedded or
Local Conventional Broker Cluster of Peer Brokers</a></p>
</li>
<li>
<p><a href="#to-change-the-master-broker-in-an-embedded-or-local-broker-cluster">To Change the Master Broker in an Embedded or Local Broker
Cluster</a></p>
</li>
<li>
<p><a href="#to-migrate-between-types-of-embedded-or-local-conventional-broker-clusters">To Migrate Between Types of Embedded or Local Conventional
Broker Clusters</a></p>
</li>
<li>
<p><a href="#to-configure-a-glassfish-cluster-to-use-a-local-enhanced-broker-cluster">To Configure a GlassFish Cluster to Use a Local Enhanced
Broker Cluster</a></p>
</li>
<li>
<p><a href="#to-configure-a-glassfish-cluster-to-use-a-remote-broker-cluster">To Configure a GlassFish Cluster to Use a Remote Broker
Cluster</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="about-message-queue-broker-clusters"><a class="anchor" href="#about-message-queue-broker-clusters"></a>About Message Queue Broker Clusters</h4>
<div class="paragraph">
<p>The following discussion provides a brief overview of Message Queue
broker clusters. For complete information, see "<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-tech-over/toc.html/broker-clusters.html#GMTOV00028">Broker
Clusters</a>" in Open Message Queue Technical Overview.</p>
</div>
<div class="paragraph">
<p>Message Queue supports two clustering models both of which provide a
scalable message service, but with each providing a different level of
message service availability:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Conventional broker clusters. A conventional broker cluster provides
for service availability. When a broker fails, clients connected to the
failed broker reconnect to another broker in the cluster. However,
messages and state information stored in the failed broker cannot be
recovered until the failed broker is brought back online. The broker
failure can therefore result in a significant delay and in JMS message
order semantics not being preserved.</p>
<div class="paragraph">
<p>Message Queue supports two types of conventional cluster, based on where
the cluster configuration change record is stored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Conventional cluster with master broker. In a conventional cluster
with a master broker, one of the brokers, designated as the master
broker, stores and maintains the cluster configuration change record.
The other brokers in the cluster must communicate with the master broker
to keep abreast of changes to the cluster configuration. This is the
simplest broker cluster to configure, and is the type of broker cluster
that Eclipse GlassFish uses by default to support GlassFish clusters.</p>
</li>
<li>
<p>Conventional cluster of peer brokers. In a conventional cluster of
peer brokers, the cluster configuration change record is stored in a
JDBC data store accessible to all the brokers. Thus, brokers can access
cluster configuration information whether any other brokers in the
cluster are running or not.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enhanced broker clusters. An enhanced broker cluster provides for data
availability in addition to service availability. When a broker fails,
another broker takes over the pending work of the failed broker. The
failover broker has access to the failed broker&#8217;s messages and state
information. Clients connected to the failed broker reconnect to the
failover broker. In an enhanced cluster, as compared to a conventional
cluster, messages owned by the failed broker are delivered by the
failover broker as soon as it takes over, and JMS message order
semantics are preserved.</p>
<div class="paragraph">
<p>By its very nature, an enhanced broker cluster is a cluster of peer
brokers.</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Despite the message service availability offered by both conventional
and enhanced broker clusters, they do not provide a guarantee against
failure and the possibility that certain failures, for example in the
middle of a transaction, could require that some operations be repeated.
It is the responsibility of the messaging application (both producers
and consumers) to respond to JMS exceptions appropriately.
For information about the kinds of exceptions that can occur and how to
respond to them,
see "<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-dev-guide-java/toc.html/client-design-and-features.html#GMJVG00229">Handling Exceptions When Failover Occurs</a>"
in Open Message Queue Developer&#8217;s Guide for Java Clients.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="configuring-glassfish-clusters-to-use-message-queue-broker-clusters"><a class="anchor" href="#configuring-glassfish-clusters-to-use-message-queue-broker-clusters"></a>Configuring GlassFish Clusters to Use Message Queue Broker Clusters</h4>
<div class="paragraph">
<p>When a Eclipse GlassFish cluster is created, the JMS service
automatically configures a Message Queue conventional broker cluster
with master broker for the cluster, provided that the JMS host type in
the Eclipse GlassFish cluster&#8217;s configuration is Embedded or Local. The
JMS service configures one Message Queue broker for each instance in the
Eclipse GlassFish cluster, and designates as master broker the broker
associated with the first instance created in the cluster. In the case
of Local JMS hosts, the JMS service configures each broker to run on the
same host as the instance with which it is associated. In the case of
Embedded JMS hosts, the each broker inherently runs on the same host as
the instance with which it is associated because it runs in the same JVM
as the instance.</p>
</div>
<div class="paragraph">
<p>The JMS service manages the lifecycle of Embedded and Local JMS hosts,
and this management extends to the management of Message Queue broker
clusters as Embedded and Local JMS hosts. For a GlassFish cluster whose
configuration specifies Embedded or Local JMS host type, the JMS
service:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creates and manages one Message Queue broker for each instance in the
GlassFish cluster, using this broker as the primary JMS host for the
instance.</p>
</li>
<li>
<p>Maintains the JMS host list for each instance in the GlassFish cluster
such that its primary JMS host appears first in its JMS host list.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The JMS service supports the following types of Message Queue broker
clusters with Eclipse GlassFish clusters, based on the JMS host type:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Embedded</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Conventional broker cluster with master broker (default)</p>
</li>
<li>
<p>Conventional broker cluster of peer brokers</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Local</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Conventional broker cluster with master broker (default)</p>
</li>
<li>
<p>Conventional broker cluster of peer brokers</p>
</li>
<li>
<p>Enhanced broker cluster</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Remote</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Conventional broker cluster with master broker; brokers can differ
in number from GlassFish instances and can be located on other hosts</p>
</li>
<li>
<p>Conventional broker cluster of peer brokers; brokers can differ in
number from GlassFish instances and can be located on other hosts</p>
</li>
<li>
<p>Enhanced broker cluster; brokers can differ in number from GlassFish
instances and can be located on other hosts</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following topics provide instructions for configuring broker
clusters in all these contexts.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-with-master-broker"><a class="anchor" href="#to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-with-master-broker"></a>To Configure a GlassFish Cluster to Use an Embedded or Local Conventional Broker Cluster With Master Broker</h4>
<div class="paragraph">
<p>Use the <code>configure-jms-cluster</code> subcommand in remote <code>asadmin</code> mode to
configure a conventional broker cluster with master broker to service a
Eclipse GlassFish cluster that uses either Embedded or Local JMS hosts.</p>
</div>
<div class="paragraph">
<p>Note that this configuration, with Embedded brokers, is the default for
Eclipse GlassFish clusters.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Perform the following steps after you have created the Eclipse GlassFish
cluster, but before you have added instances to the cluster or started
the cluster.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before using this procedure to reconfigure an existing cluster, you must
follow the special procedures to migrate to another type of broker
cluster, as described in <a href="#to-migrate-between-types-of-embedded-or-local-conventional-broker-clusters">To Migrate Between Types of
Embedded or Local Conventional Broker Clusters</a>. Failing to perform
these special procedures could lead to data loss or corruption and even
render your setup unusable, depending on the JMS operations performed on
the existing cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the server is running.
Remote <code>asadmin</code> subcommands require a running server.</p>
</li>
<li>
<p>Configure the Eclipse GlassFish cluster to use a Message Queue
conventional broker cluster with master broker by using the
<a href="reference-manual.html#configure-jms-cluster"><code>configure-jms-cluster</code></a>
subcommand:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; asadmin configure-jms-cluster --clustertype=conventional
--configstoretype=masterbroker glassfish-cluster-name</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help configure-jms-cluster</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-of-peer-brokers"><a class="anchor" href="#to-configure-a-glassfish-cluster-to-use-an-embedded-or-local-conventional-broker-cluster-of-peer-brokers"></a>To Configure a GlassFish Cluster to Use an Embedded or Local Conventional Broker Cluster of Peer Brokers</h4>
<div class="paragraph">
<p>Use the <code>configure-jms-cluster</code> subcommand in remote <code>asadmin</code> mode to
configure a conventional broker cluster of peer brokers to service a
Eclipse GlassFish cluster that uses Embedded or Local JMS hosts.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Perform the following steps after you have created the Eclipse GlassFish
cluster, but before you have added instances to the cluster or started
the cluster.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before using this procedure to reconfigure an existing cluster, you must
follow the special procedures to migrate to another type of broker
cluster, as described in <a href="#to-migrate-between-types-of-embedded-or-local-conventional-broker-clusters">To Migrate Between Types of
Embedded or Local Conventional Broker Clusters</a>. Failing to perform
these special procedures could lead to data loss or corruption and even
render your setup unusable, depending on the JMS operations performed on
the existing cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the server is running.
Remote <code>asadmin</code> subcommands require a running server.</p>
</li>
<li>
<p>Create a password file with the entry <code>AS_ADMIN_JMSDBPASSWORD</code>
specifying the password of the database user.<br>
For information about password file entries, see the
<a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a> help page.</p>
</li>
<li>
<p>Place a copy of, or a link to, the database&#8217;s JDBC driver <code>.jar</code>
file in the appropriate directory, depending on the JMS host type, on
each host where a Eclipse GlassFish cluster instance is to run:</p>
<div class="ulist">
<ul>
<li>
<p>Embedded: as-install-parent<code>/glassfish/lib/install/applications/jmsra</code></p>
</li>
<li>
<p>Local: as-install-parent<code>/mq/lib/ext</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure the Eclipse GlassFish cluster to use a Message Queue
conventional broker cluster with master broker by using the
<a href="reference-manual.html#configure-jms-cluster"><code>configure-jms-cluster</code></a>
subcommand:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; asadmin --passwordfile password-file configure-jms-cluster --clustertype=conventional
--configstoretype=shareddb --dbvendor database-vendor-name --dbuser database-user-name
--dburl database-url --property list-of-database-specific-properties glassfish-cluster-name</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help configure-jms-cluster</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-change-the-master-broker-in-an-embedded-or-local-broker-cluster"><a class="anchor" href="#to-change-the-master-broker-in-an-embedded-or-local-broker-cluster"></a>To Change the Master Broker in an Embedded or Local Broker Cluster</h4>
<div class="paragraph">
<p>Use the <code>change-master-broker</code> subcommand in remote <code>asadmin</code> mode to
change the master broker to a different broker in a conventional broker
cluster with master broker serving a Eclipse GlassFish cluster that uses
Embedded or Local JMS hosts.</p>
</div>
<div class="paragraph">
<p>Follow this procedure, for example, before you remove from a GlassFish
cluster the instance associated with the current master broker.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Although not an absolute requirement, you should make sure all GlassFish
instances and Message Queue brokers in the cluster are running before
using the <code>change-master-broker</code> command in order to avoid later
internal configuration synchronization of any unavailable instance or
broker.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the server is running.
Remote <code>asadmin</code> subcommands require a running server.</p>
</li>
<li>
<p>Change the master broker by using the
<a href="reference-manual.html#change-master-broker"><code>change-master-broker</code></a>
subcommand:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; asadmin change-master-broker glassfish-clustered-instance-name</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help change-master-broker</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-migrate-between-types-of-embedded-or-local-conventional-broker-clusters"><a class="anchor" href="#to-migrate-between-types-of-embedded-or-local-conventional-broker-clusters"></a>To Migrate Between Types of Embedded or Local Conventional Broker Clusters</h4>
<div class="paragraph">
<p>If the need arises to convert from a conventional broker cluster with
master broker to a conventional broker cluster of peer brokers, or the
reverse, follow the instructions in "<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/broker-clusters.html#GMADG00563">Managing
Conventional Clusters</a>" in Open Message Queue Administration Guide.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-configure-a-glassfish-cluster-to-use-a-local-enhanced-broker-cluster"><a class="anchor" href="#to-configure-a-glassfish-cluster-to-use-a-local-enhanced-broker-cluster"></a>To Configure a GlassFish Cluster to Use a Local Enhanced Broker Cluster</h4>
<div class="paragraph">
<p>Use the <code>configure-jms-cluster</code> subcommand in remote <code>asadmin</code> mode to
configure an enhanced broker cluster to service a Eclipse GlassFish
cluster that uses Local JMS hosts.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Perform the following steps after you have created the Eclipse GlassFish
cluster, but before you have added instances to the cluster or started
the cluster.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before using this procedure to reconfigure an existing cluster, you must
follow the special procedures to migrate from a conventional broker
cluster to an enhanced broker cluster, as described in
"<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/broker-clusters.html#GMADG00565">Converting a Conventional Cluster to an Enhanced
Cluster</a>" in Open Message Queue Administration Guide. Failing to perform
these special procedures could lead to data loss or corruption and even
render your setup unusable, depending on the JMS operations performed on
the existing cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the server is running.
Remote <code>asadmin</code> subcommands require a running server.</p>
</li>
<li>
<p>Create a password file with the entry <code>AS_ADMIN_JMSDBPASSWORD</code>
specifying the password of the database user.<br>
For information about password file entries, see the
<a href="reference-manual.html#asadmin"><code>asadmin</code>(1M)</a> help page.</p>
</li>
<li>
<p>Place a copy of, or a link to, the database&#8217;s JDBC driver <code>.jar</code>
file in the as-install-parent<code>/mq/lib/ext</code> directory on each host where
a Eclipse GlassFish cluster instance is to run.</p>
</li>
<li>
<p>Configure the Eclipse GlassFish cluster to use a Message Queue
enhanced broker cluster by using the
<a href="reference-manual.html#configure-jms-cluster"><code>configure-jms-cluster</code></a>
subcommand:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; asadmin --passwordfile password-file configure-jms-cluster --clustertype=enhanced
--configstoretype=shareddb --messagestoretype=jdbc
--dbvendor database-vendor-name --dbuser database-user-name --dburl database-url
--property list-of-database-specific-properties glassfish-cluster-name</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>You can also view the full syntax and options of the subcommand by
typing <code>asadmin help configure-jms-cluster</code> at the command line.</p>
</div>
</div>
<div class="sect3">
<h4 id="to-configure-a-glassfish-cluster-to-use-a-remote-broker-cluster"><a class="anchor" href="#to-configure-a-glassfish-cluster-to-use-a-remote-broker-cluster"></a>To Configure a GlassFish Cluster to Use a Remote Broker Cluster</h4>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>Perform the following steps after you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Used Message Queue to create a broker cluster.</p>
</li>
<li>
<p>Created the Eclipse GlassFish cluster, but not yet created instances
for the cluster.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the server is running.
The remote subcommands used in this procedure require a running server.</p>
</li>
<li>
<p>Delete the <code>default_JMS_host</code> JMS host by using the
<a href="reference-manual.html#delete-jms-host"><code>delete-jms-host</code></a> subcommand:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; asadmin delete-jms-host --target glassfish-cluster-name default_JMS_host</code></pre>
</div>
</div>
</li>
<li>
<p>Create a JMS host for each broker in the broker cluster by using the
<a href="reference-manual.html#create-jms-host"><code>create-jms-host</code></a> subcommand.<br>
For each broker, use an <code>asadmin create-jms-host</code> of the form:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; asadmin create-jms-host --target glassfish-cluster-name --mqhost broker-host
--mqport broker-port --mquser mq-user --mqpassword mq-user-password
jms-host-name-for-broker</code></pre>
</div>
</div>
</li>
<li>
<p>Start the brokers in the cluster by using the Message Queue
<code>imqbrokerd</code> command, as described in
"<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/broker-clusters.html#GMADG00254">Managing Broker Clusters</a>"
in Open Message Queue Administration Guide.</p>
</li>
<li>
<p>Create instances in the Eclipse GlassFish cluster, as described in
<a href="#to-create-an-instance-centrally">To Create an Instance Centrally</a> and
<a href="#to-create-an-instance-locally">To Create an Instance Locally</a>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connection-failover"><a class="anchor" href="#connection-failover"></a>Connection Failover</h3>
<div class="paragraph">
<p>The use of Message Queue broker clusters provides JMS connection
failover, including several options that control how connection failures
are handled.</p>
</div>
<div class="paragraph">
<p>Use the Administration Console&#8217;s Java Message Service page to configure
these options. To display this page, click the configuration for the
GlassFish cluster or instance in the navigation pane, and then click the
Java Message Service link on the Configuration page.</p>
</div>
<div class="paragraph">
<p>The way in which connection failover operates depends on whether the
broker cluster is configured to be conventional or enhanced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In a conventional cluster, when a broker fails, clients may reconnect
to any other broker in the cluster. The Reconnect field specifies
whether reconnection should take place, and the Address List Behavior
and Address List Iterations fields specify how the client chooses what
broker to fail over to.</p>
</li>
<li>
<p>In an enhanced cluster, when a broker fails, another broker
automatically takes over its messages and clients. Clients automatically
fail over to the appropriate broker. The Reconnect, Address List
Behavior and Address List Iterations fields are ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on connection failover, including how failover on
conventional clusters differs from failover on enhanced clusters, see
"<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/administered-objects.html#GMADG00087">Automatic Reconnection</a>" in Open Message Queue
Administration Guide.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reconnect</dt>
<dd>
<p>Applies only to conventional clusters. Enables reconnection and
connection failover. When disabled, the Java Message Service does not
attempt to reconnect if a connection fails.</p>
</dd>
<dt class="hdlist1">Reconnect Interval</dt>
<dd>
<p>Specifies the number of seconds between reconnection attempts. If it
is too short, this time interval does not give a broker time to
recover. If it is too long, the wait time might represent an
unacceptable delay. The default value is 5 seconds.</p>
</dd>
<dt class="hdlist1">Reconnect Attempts</dt>
<dd>
<p>Specifies the number of attempts to connect (or reconnect) to a
particular JMS host before trying another host in the JMS host list.
The host list is also known as the Address List. Hosts are chosen from
the address list either in order or randomly, depending on the setting
of Address List Behavior.</p>
</dd>
<dt class="hdlist1">Address List Behavior</dt>
<dd>
<p>For conventional clusters, this field specifies how the Java Message
Service selects which JMS host in the JMS hosts list to initially
connect to, and if the broker fails, how the Java Message Service
selects which JMS host in the JMS hosts list to fail over to.<br>
For enhanced clusters, this field specifies how the Java Message
Service selects which JMS host in the JMS hosts list to initially
connect to.<br>
When performing initial connection or, for conventional clusters only,
when performing failover, then if this attribute is set to Priority,
the Java Message Service tries to connect to the first JMS host
specified in the JMS hosts list and uses another one only if the first
one is not available. If this attribute is set to Random, the Java
Message Service selects the JMS host randomly from the JMS hosts list.
If that host is not available, another one is chosen randomly.<br>
The default for Embedded and Local JMS host types is Priority, and the
default for the Remote JMS host type is Random.<br>
For Embedded and Local JMS host types, the Java Message Service
ensures that the Message Queue broker servicing a clustered instance
appears first in that instance&#8217;s JMS host list.<br>
Thus, having Priority as the default Address List Behavior ensures
that an application deployed to a clustered instance will always try
to create its initial connection to that instance&#8217;s co-located broker.<br>
If there are many clients attempting a connection using the same
connection factory, use the Random setting to prevent them from all
attempting to create their initial connection to the same JMS host.</p>
</dd>
<dt class="hdlist1">Address List Iterations</dt>
<dd>
<p>For conventional clusters, this field specifies the number of times
the Java Message Service iterates through the JMS hosts list in an
effort to establish its initial connection. If the broker fails, this
field specifies the number of times the Java Message Service iterates
through the JMS hosts list in an effort to fail over to another
broker.<br>
For enhanced clusters, this field specifies the number of times the
Java Message Service iterates through the JMS hosts list in an effort
to establish its initial connection. If the broker fails, this field
is not used when performing reconnection.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can override these settings using JMS connection factory settings.
For details, see "<a href="administration-guide.html#administering-jms-connection-factories-and-destinations">Administering JMS Connection
Factories and Destinations</a>" in Eclipse GlassFish
Administration Guide.</p>
</div>
</div>
<div class="sect2">
<h3 id="load-balanced-delivery-to-mdbs"><a class="anchor" href="#load-balanced-delivery-to-mdbs"></a>Load-Balanced Delivery to MDBs</h3>
<div class="paragraph">
<p>When a message-driven bean (MDB) application is deployed to a GlassFish
cluster, incoming messages are delivered randomly to MDBs without regard
to the cluster instances in which they are running.</p>
</div>
<div class="paragraph">
<p>If the MDB is configured to receive messages from a durable or
non-durable subscription on a topic, then only one MDB instance across
the whole GlassFish cluster will receive each message.</p>
</div>
<div class="paragraph">
<p>For more information about these features, see
"<a href="https://eclipse-ee4j.github.io/openmq/guides//mq-admin-guide/toc.html/jmsra-properties.html#GMADG00300">
About Shared Topic Subscriptions for Clustered Containers</a>"
in Open Message Queue Administration Guide.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rmi-iiop-load-balancing-and-failover"><a class="anchor" href="#rmi-iiop-load-balancing-and-failover"></a>11 RMI-IIOP Load Balancing and Failover</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes using high-availability features for remote EJB
references and JNDI objects over RMI-IIOP in Eclipse GlassFish.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#overview">Overview</a></p>
</li>
<li>
<p><a href="#initialcontext-load-balancing"><code>InitialContext</code> Load Balancing</a></p>
</li>
<li>
<p><a href="#per-request-load-balancing-prlb">Per-Request Load Balancing (PRLB)</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="overview"><a class="anchor" href="#overview"></a>Overview</h3>
<div class="paragraph">
<p>With RMI-IIOP load balancing, IIOP client requests are distributed to
different server instances or name servers. The goal is to spread the
load evenly across the cluster, thus providing scalability. IIOP load
balancing combined with EJB clustering and availability also provides
EJB failover.</p>
</div>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#general-requirements-for-configuring-load-balancing">General Requirements for Configuring Load Balancing</a></p>
</li>
<li>
<p><a href="#load-balancing-models">Load Balancing Models</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="general-requirements-for-configuring-load-balancing"><a class="anchor" href="#general-requirements-for-configuring-load-balancing"></a>General Requirements for Configuring Load Balancing</h4>
<div class="paragraph">
<p>Eclipse GlassFish provides high availability of remote EJB
references and <code>NameService</code> objects over RMI-IIOP, provided all the
following apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your deployment has a cluster of at least two instances.</p>
</li>
<li>
<p>Jakarta EE applications are deployed to all instances and clusters that
participate in load balancing.</p>
</li>
<li>
<p>RMI-IIOP client applications are enabled for load balancing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eclipse GlassFish supports load balancing for Java applications executing
in the Application Client Container (ACC). See <a href="#enabling-rmi-iiop-hardware-load-balancing-and-failover">Enabling
RMI-IIOP Hardware Load Balancing and Failover</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Eclipse GlassFish does not support RMI-IIOP load balancing and failover
over secure sockets layer (SSL).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="load-balancing-models"><a class="anchor" href="#load-balancing-models"></a>Load Balancing Models</h4>
<div class="paragraph">
<p>Eclipse GlassFish supports two general models for load balancing:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#initialcontext-load-balancing"><code>InitialContext</code> Load Balancing</a></dt>
<dd>
<p>When a client performs a JNDI lookup for an object, the Naming Service
creates a <code>InitialContext</code> (IC) object associated with a particular
server instance. From then on, all lookup requests made using that IC
object are sent to the same server instance. <code>InitialContext</code> load
balancing can be configured automatically across an entire cluster.</p>
</dd>
<dt class="hdlist1"><a href="#per-request-load-balancing-prlb">Per-Request Load Balancing (PRLB)</a></dt>
<dd>
<p>Per Request Load Balancing (PRLB) is a method for load balancing
stateless EJBs that enables load-balancing for each request to an EJB
instance. PRLB chooses the first node in a cluster to use on each
request. PRLB is configured on a per-EJB basis.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="initialcontext-load-balancing"><a class="anchor" href="#initialcontext-load-balancing"></a><code>InitialContext</code> Load Balancing</h3>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#initialcontext-summary"><code>InitialContext</code> Summary</a></p>
</li>
<li>
<p><a href="#initialcontext-algorithm"><code>InitialContext</code> Algorithm</a></p>
</li>
<li>
<p><a href="#enabling-rmi-iiop-hardware-load-balancing-and-failover">Enabling RMI-IIOP Hardware Load Balancing and Failover</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="initialcontext-summary"><a class="anchor" href="#initialcontext-summary"></a><code>InitialContext</code> Summary</h4>
<div class="paragraph">
<p>When <code>InitialContext</code> load balancing is used, the client calls the
<code>InitialContext()</code> method to create a new <code>InitialContext</code> (IC) object
that is associated with a particular server instance. JNDI lookups are
then performed on that IC object, and all lookup requests made using
that IC object are sent to the same server instance. All <code>EJBHome</code>
objects looked up with that <code>InitialContext</code> are hosted on the same
target server. Any bean references obtained henceforth are also created
on the same target host. This effectively provides load balancing, since
all clients randomize the list of live target servers when creating
<code>InitialContext</code> objects. If the target server instance goes down, the
lookup or EJB method invocation will failover to another server
instance. All objects derived from same <code>InitialContext</code> will failover
to the same server instance.</p>
</div>
<div class="paragraph">
<p>IIOP load balancing and failover happens transparently. No special steps
are needed during application deployment. IIOP load balancing and
failover for the Eclipse GlassFish supports dynamically reconfigured
clusters. If the Eclipse GlassFish instance on which the application
client is deployed participates in a cluster, the Eclipse GlassFish finds
all currently active IIOP endpoints in the cluster automatically.
Therefore, you are not required to manually update the list of endpoints
if a new instance is added to the cluster or deleted from the cluster.
However, a client should have at least two endpoints specified for
bootstrapping purposes, in case one of the endpoints has failed.</p>
</div>
</div>
<div class="sect3">
<h4 id="initialcontext-algorithm"><a class="anchor" href="#initialcontext-algorithm"></a><code>InitialContext</code> Algorithm</h4>
<div class="paragraph">
<p>Eclipse GlassFish uses a randomization and round-robin algorithm for
RMI-IIOP load balancing and failover.</p>
</div>
<div class="paragraph">
<p>When an RMI-IIOP client first creates a new <code>InitialContext</code> object, the
list of available Eclipse GlassFish IIOP endpoints is randomized for that
client. For that <code>InitialContext</code> object, the load balancer directs
lookup requests and other <code>InitialContext</code> operations to an endpoint on
the randomized list. If that endpoint is not available then a different
random endpoint in the list is used.</p>
</div>
<div class="paragraph">
<p>Each time the client subsequently creates a new <code>InitialContext</code> object,
the endpoint list is rotated so that a different IIOP endpoint is used
for <code>InitialContext</code> operations. The rotation is randomized, so the
rotation is not to the next endpoint in the list, but instead to a
random endpoint in the list.</p>
</div>
<div class="paragraph">
<p>When you obtain or create beans from references obtained by an
<code>InitialContext</code> object, those beans are created on the Eclipse GlassFish
instance serving the IIOP endpoint assigned to the <code>InitialContext</code>
object. The references to those beans contain the IIOP endpoint
addresses of all Eclipse GlassFish instances in the cluster.</p>
</div>
<div class="paragraph">
<p>The primary endpoint is the bean endpoint corresponding to the
<code>InitialContext</code> endpoint used to look up or create the bean. The other
IIOP endpoints in the cluster are designated as alternate endpoints. If
the bean&#8217;s primary endpoint becomes unavailable, further requests on
that bean fail over to one of the alternate endpoints.</p>
</div>
<div class="paragraph">
<p>You can configure RMI-IIOP load balancing and failover to work with
applications running in the ACC.</p>
</div>
</div>
<div class="sect3">
<h4 id="enabling-rmi-iiop-hardware-load-balancing-and-failover"><a class="anchor" href="#enabling-rmi-iiop-hardware-load-balancing-and-failover"></a>Enabling RMI-IIOP Hardware Load Balancing and Failover</h4>
<div class="paragraph">
<p>You can enable RMI-IIOP load balancing and failover for applications
running in the application client container (ACC). Weighted round-robin
load balancing is also supported.</p>
</div>
<div class="sect4">
<h5 id="to-enable-rmi-iiop-hardware-load-balancing-for-the-application-client-container"><a class="anchor" href="#to-enable-rmi-iiop-hardware-load-balancing-for-the-application-client-container"></a>To Enable RMI-IIOP Hardware Load Balancing for the Application Client Container</h5>
<div class="paragraph">
<p>This procedure provides an overview of the steps necessary to enable
RMI-IIOP load balancing and failover with the application client
container (ACC). For additional information on the ACC, see
"<a href="application-development-guide.html#developing-clients-using-the-acc">Developing Clients Using the ACC</a>" in Eclipse GlassFish Application Development Guide.</p>
</div>
<div class="paragraph">
<p>Before You Begin</p>
</div>
<div class="paragraph">
<p>The first five steps in this procedure are only necessary if you are
enabling RMI-IIOP load balancing on a system other than the DAS. This is
common in production environment, but less common in a development
environment. For example, a developer who wants to experiment with a
cluster and load balancing might create two instances on the same system
on which the DAS is running. In such cases, these steps are unnecessary.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the install_dir <code>/bin</code> directory.</p>
</li>
<li>
<p>Run <code>package-appclient</code>.<br>
This utility produces an <code>appclient.jar</code> file. For more information on
<code>package-appclient</code>, see <a href="reference-manual.html#package-appclient"><code>package-appclient</code>(1M)</a>.</p>
</li>
<li>
<p>Copy the <code>appclient.jar</code> file to the machine where you want your
client and extract it.</p>
</li>
<li>
<p>Edit the <code>asenv.conf</code> or <code>asenv.bat</code> path variables to refer to the
correct directory values on that machine.</p>
<div class="paragraph">
<p>The file is at appclient-install-dir <code>/config/</code>.</p>
</div>
<div class="paragraph">
<p>For a list of the path variables to update, see
<a href="reference-manual.html#package-appclient"><code>package-appclient</code>(1M)</a>.</p>
</div>
</li>
<li>
<p>If required, make the <code>appclient</code> script executable.</p>
<div class="paragraph">
<p>For example, on UNIX use <code>chmod 700</code>.</p>
</div>
</li>
<li>
<p><a id="gevjb"></a>
Find the IIOP listener port number for at least two instances in the cluster.</p>
<div class="paragraph">
<p>You specify the IIOP listeners as endpoints in <a href="#gevkc">Add at least
two <code>target-server</code> elements in the <code>sun-acc.xml</code> file.</a>.</p>
</div>
<div class="paragraph">
<p>For each instance, obtain the IIOP listener ports as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that the instances for which you want to determine the IIOP
listener port numbers are running.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; list-instances</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list of instances and their status (running, not running) is displayed.</p>
</div>
<div class="paragraph">
<p>The instances for which you want to display the IIOP listener ports must be running.</p>
</div>
</li>
<li>
<p>For each instance, enter the following command to list the various
port numbers used by the instance.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get servers.server.instance-name.system-property.*.value</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, for an instance name <code>in1</code>, you would enter the following
command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin&gt; get servers.server.in1.system-property.*.value</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><a id="gevkc"></a>
Add at least two <code>target-server</code> elements in the <code>sun-acc.xml</code> file.</p>
<div class="paragraph">
<p>Use the endpoints that you obtained in <a href="#gevjb">Find the IIOP
listener port number for at least two instances in the cluster.</a>.</p>
</div>
<div class="paragraph">
<p>If the Eclipse GlassFish instance on which the application client is
deployed participates in a cluster, the ACC finds all currently active
IIOP endpoints in the cluster automatically. However, a client should
have at least two endpoints specified for bootstrapping purposes, in
case one of the endpoints has failed.</p>
</div>
<div class="paragraph">
<p>The <code>target-server</code> element specifies one or more IIOP endpoints used
for load balancing. The <code>address</code> attribute is an IPv4 address or host
name, and the <code>port</code> attribute specifies the port number. See
"<a href="application-deployment-guide.html#client-container">client-container</a>" in Eclipse GlassFish Application Deployment Guide.</p>
</div>
<div class="paragraph">
<p>As an alternative to using <code>target-server</code> elements, you can use the
<code>endpoints</code> property as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>jvmarg value = &quot;-Dcom.sun.appserv.iiop.endpoints=host1:port1,host2:port2,...&quot;</code></pre>
</div>
</div>
</li>
<li>
<p>If you require weighted round-robin load balancing, perform the following steps:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the load-balancing weight of each server instance.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin set instance-name.lb-weight=weight</code></pre>
</div>
</div>
</li>
<li>
<p>In the <code>sun-acc.xml</code>, set the
<code>com.sun.appserv.iiop.loadbalancingpolicy</code> property of the ACC to <code>ic-based-weighted</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">…
<span class="tag">&lt;client-container</span> <span class="attribute-name">send-password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.sun.appserv.iiop.loadbalancingpolicy</span><span class="delimiter">&quot;</span></span> <span class="error">\</span>
     <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ic-based-weighed</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
…</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Deploy your client application with the <code>--retrieve</code> option to get the client jar file.</p>
<div class="paragraph">
<p>Keep the client jar file on the client machine.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin  --user admin --passwordfile pw.txt deploy --target cluster1 \
--retrieve my_dir myapp.ear</code></pre>
</div>
</div>
</li>
<li>
<p>Run the application client as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>appclient --client my_dir/myapp.jar</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="gfohj" class="paragraph">
<p>Example 11-1 Setting Load-Balancing Weights for RMI-IIOP Weighted
Round-Robin Load Balancing</p>
</div>
<div class="paragraph">
<p>In this example, the load-balancing weights in a cluster of three
instances are to be set as shown in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44%;">
<col style="width: 56%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instance Name</th>
<th class="tableblock halign-left valign-top">Load-Balancing Weight</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>i1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>i2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>i3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The sequence of commands to set these load balancing weights is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>asadmin set i1.lb-weight=100
asadmin set i2.lb-weight=200
asadmin set i3.lb-weight=300</code></pre>
</div>
</div>
<div id="GSHAG441" class="paragraph">
<p>Next Steps</p>
</div>
<div class="paragraph">
<p>To test failover, stop one instance in the cluster and see that the
application functions normally. You can also have breakpoints (or
sleeps) in your client application.</p>
</div>
<div class="paragraph">
<p>To test load balancing, use multiple clients and see how the load gets
distributed among all endpoints.</p>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>See <a href="#enabling-the-high-availability-session-persistence-service">Enabling the High
Availability Session Persistence Service</a> for instructions on enabling
the session availability service for a cluster or for a Web, EJB, or JMS
container running in a cluster.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="per-request-load-balancing-prlb"><a class="anchor" href="#per-request-load-balancing-prlb"></a>Per-Request Load Balancing (PRLB)</h3>
<div class="paragraph">
<p>The following topics are addressed here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#prlb-summary">PRLB Summary</a></p>
</li>
<li>
<p><a href="#enabling-per-request-load-balancing">Enabling Per-Request Load Balancing</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="prlb-summary"><a class="anchor" href="#prlb-summary"></a>PRLB Summary</h4>
<div class="paragraph">
<p>Per Request Load Balancing (PRLB) is a method for load balancing
stateless EJBs that enables load-balancing for each request to an EJB
instance. PRLB chooses the first node in a cluster to use on each
request. By contrast, <code>InitialContext</code> (hardware) load balancing chooses
the first node to use when the <code>InitialContext</code> is created, and each
request thereafter uses the same node unless a failure occurred.</p>
</div>
<div class="paragraph">
<p>PRLB is enabled by means of the boolean <code>per-request-load-balancing</code>
property in the <code>glassfish-ejb-jar.xml</code> deployment descriptor file for
the EJB. If this property is not set, the original load balancing
behavior is preserved.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>PRLB is only supported for stateless session beans. Using PRLB with any
other bean types will result in a deployment error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="enabling-per-request-load-balancing"><a class="anchor" href="#enabling-per-request-load-balancing"></a>Enabling Per-Request Load Balancing</h4>
<div class="paragraph">
<p>You can enable Per-Request Load Balancing (PRLB) by setting the boolean
<code>per-request-load-balancing</code> property to <code>true</code> in the
<code>glassfish-ejb-jar.xml</code> deployment descriptor file for the EJB. On the
client side, the <code>initContext.lookup</code> method is used to access the
stateless EJB.</p>
</div>
<div class="sect4">
<h5 id="to-enable-rmi-iiop-per-request-load-balancing-for-a-stateless-ejb"><a class="anchor" href="#to-enable-rmi-iiop-per-request-load-balancing-for-a-stateless-ejb"></a>To Enable RMI-IIOP Per-Request Load Balancing for a Stateless EJB</h5>
<div class="paragraph">
<p>This procedure describes how to enable PRLB for a stateless EJB that is
deployed to clustered Eclipse GlassFish instances. This procedure also
provides an client-side example for accessing a stateless EJB that uses
PRLB.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose or assemble the EJB that you want to deploy.</p>
<div class="paragraph">
<p>In this example, an EJB named <code>TheGreeter</code> is used.</p>
</div>
<div class="paragraph">
<p>For instructions on developing and assembling an EJB for deployment to
Eclipse GlassFish, refer to the following documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"<a href="application-development-guide.html#using-enterprise-javabeans-technology">Using Enterprise JavaBeans Technology</a>" in Eclipse GlassFish Application Development Guide</p>
</li>
<li>
<p>"<a href="application-deployment-guide.html#ejb-module-deployment-guidelines">EJB Module Deployment Guidelines</a>" in Eclipse GlassFish Application Deployment Guide</p>
</li>
<li>
<p>"<a href="application-deployment-guide.html#assembling-and-deploying-an-application-client-module">Assembling and Deploying an Application Client
Module</a>" in Eclipse GlassFish Application Deployment Guide</p>
</li>
</ul>
</div>
</li>
<li>
<p>Set the <code>per-request-load-balancing</code> property to <code>true</code> in the
<code>glassfish-ejb-jar.xml</code> deployment descriptor file for the EJB.</p>
<div class="paragraph">
<p>For more information about the <code>glassfish-ejb-jar.xml</code> deployment
descriptor file, refer to
"<a href="application-deployment-guide.html#GSDPG00079">The glassfish-ejb-jar.xml File</a>"
in Eclipse GlassFish Application Deployment Guide</p>
</div>
<div class="paragraph">
<p>For example, the <code>glassfish-ejb-jar.xml</code> file for a sample EJB named
<code>TheGreeter</code> is listed below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;glassfish-ejb-jar&gt;</span>
  <span class="tag">&lt;enterprise-beans&gt;</span>
    <span class="tag">&lt;unique-id&gt;</span>1<span class="tag">&lt;/unique-id&gt;</span>
    <span class="tag">&lt;ejb&gt;</span>
      <span class="tag">&lt;ejb-name&gt;</span>TheGreeter<span class="tag">&lt;/ejb-name&gt;</span>
    <span class="tag">&lt;jndi-name&gt;</span>greeter<span class="tag">&lt;/jndi-name&gt;</span>
    <span class="tag">&lt;per-request-load-balancing&gt;</span>true<span class="tag">&lt;/per-request-load-balancing&gt;</span>
    <span class="tag">&lt;/ejb&gt;</span>
  <span class="tag">&lt;/enterprise-beans&gt;</span>
<span class="tag">&lt;/glassfish-ejb-jar&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p>Deploy the EJB.</p>
<div class="paragraph">
<p>If the EJB was previously deployed, it must be redployed.</p>
</div>
<div class="paragraph">
<p>For instructions on deploying EJBs, refer to the following documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"<a href="application-deployment-guide.html#to-deploy-an-application-or-module">To Deploy an Application or Module</a>" in Eclipse GlassFish Application Deployment Guide</p>
</li>
<li>
<p>"<a href="application-deployment-guide.html#to-redeploy-an-application-or-module">To Redeploy an Application or Module</a>" in Eclipse GlassFish Application Deployment Guide</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify the PRLB configuration by looking for the following <code>FINE</code>
message in the CORBA log file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Setting per-request-load-balancing policyfor EJB EJB-name</code></pre>
</div>
</div>
</li>
<li>
<p>Configure a client application to access the PRLB-enabled EJB.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">EJBClient</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span> args<span class="type">[]</span>) {
  <span class="comment">// ...</span>
  <span class="keyword">try</span> {
    <span class="comment">// only one lookup</span>
    <span class="predefined-type">Object</span> objref = initContext.lookup(<span class="string"><span class="delimiter">&quot;</span><span class="content">test.cluster.loadbalancing.ejb.TestSessionBeanRemote</span><span class="delimiter">&quot;</span></span>);
    myGreeterRemote = (TestSessionBeanRemote)<span class="predefined-type">PortableRemoteObject</span>.narrow(objref, TestSessionBeanRemote.class);
  } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
    <span class="comment">// ...</span>
  }

  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="integer">0</span>; i &lt; <span class="integer">10</span>; i++ ) {
    <span class="comment">// method calls in a loop.</span>
    <span class="predefined-type">String</span> theMessage = myGreeterRemote.sayHello(<span class="predefined-type">Integer</span>.toString(i));
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">got</span><span class="delimiter">&quot;</span></span>+<span class="string"><span class="delimiter">&quot;</span><span class="content">: </span><span class="delimiter">&quot;</span></span> + theMessage);
  }
  }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See Also</p>
</div>
<div class="paragraph">
<p>See <a href="#enabling-the-high-availability-session-persistence-service">Enabling the High
Availability Session Persistence Service</a> for instructions on enabling
the session availability service for a cluster or for a Web, EJB, or JMS
container running in a cluster.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-09-12 12:09:22 UTC
</div>
</div>
</body>
</html>